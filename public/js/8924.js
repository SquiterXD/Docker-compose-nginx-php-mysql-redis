(self.webpackChunk=self.webpackChunk||[]).push([[8924],{88924:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const s={props:["machinePowerTempList","productPeriodList","numberColumn","lookupTypeMachine","machineGroup","machine","btnTrans"],data:function(){return{lines:[],statusBtuSave:!1,checkText:!0}},computed:{getDataMachineType:function(){return _.groupBy(this.machinePowerTempList,"machine_type")}},mounted:function(){},methods:{addLine:function(){this.checkText=!1,this.lines.push({machine_id:this.machine?this.machine:"",machine_group:this.machineGroup?this.machineGroup:"",machine_type:"",power:[],uom_description:"",uom_code:""})},getDetailsUom:function(t,e){this.lookupTypeMachine.forEach((function(n){t==n.lookup_code&&(e.uom_description=n.description,e.uom_code=n.uom_code)}))},checkValue:function(t,e,n){var i=this;this.lines.forEach((function(a,s){a.power.forEach((function(a,r){if(n==s&&e>r){if(Number(a)>Number(t))return i.showAlert(),void(i.statusBtuSave=!0);i.statusBtuSave=!1}}))}))},showAlert:function(){swal({title:"Error !",text:"ไม่สามารถกรอกจำนวนเลขนี้ได้",type:"error",showConfirmButton:!0})},removeRow:function(t){this.lines.splice(t,1),0==this.lines.length?this.checkText=!0:this.checkText=!1},saveDataToTable:function(){var t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.lines);return axios.post("/pm/ajax/machine-power-temp/store",{params:t}).then((function(t){"succeed"==t.data.data&&(swal({title:"Success",text:"บันทึกสำเร็จ",timer:3e3,type:"success",showCancelButton:!1,showConfirmButton:!0}),setTimeout((function(){window.location.href="/pm/settings/machine-power-temp"}),3e3))}))}}};const r=(0,n(51900).Z)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[this.machineGroup&&this.machine?n("div",{staticClass:"text-right",staticStyle:{"padding-bottom":"15px"}},[n("button",{class:t.btnTrans.save.class,on:{click:function(e){return e.preventDefault(),t.addLine(e)}}},[n("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}}),t._v(" เพิ่มรายการ \n        ")]),t._v(" "),n("button",{class:t.btnTrans.save.class,attrs:{disabled:this.statusBtuSave},on:{click:function(e){return t.saveDataToTable()}}},[n("i",{class:t.btnTrans.save.icon,attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.btnTrans.save.text)+" \n        ")])]):t._e(),t._v(" "),n("table",{staticClass:"table table table-bordered"},[n("thead",[n("tr",[t._m(0),t._v(" "),t._l(t.productPeriodList,(function(e){return n("th",{key:e.key,staticClass:"text-center",attrs:{width:"10%"}},[n("div",[t._v(t._s(e.description))])])})),t._v(" "),t._m(1),t._v(" "),n("th",{staticClass:"text-center",attrs:{width:"5%"}}),t._v(" "),n("th",{staticClass:"text-center",attrs:{width:"5%"}})],2)]),t._v(" "),void 0===this.machinePowerTempList||0===this.machinePowerTempList.length?n("tbody",[t.checkText?n("tr",{staticClass:"text-center"},[n("td",{attrs:{colspan:t.numberColumn}},[t._v("ไม่มีข้อมูล")])]):t._e(),t._v(" "),t._l(t.lines,(function(e,i){return n("tr",{key:i},[n("td",[n("el-select",{staticClass:"w-100",attrs:{placeholder:"เลือกประเภทของการผลิตของเครื่องจักร",clearable:""},on:{change:function(n){return t.getDetailsUom(e.machine_type,e)}},model:{value:e.machine_type,callback:function(n){t.$set(e,"machine_type",n)},expression:"data.machine_type"}},t._l(t.lookupTypeMachine,(function(t,e){return n("el-option",{key:e,attrs:{label:t.meaning,value:t.lookup_code}})})),1)],1),t._v(" "),t._l(t.productPeriodList,(function(a,s){return n("td",{key:s},[n("el-input",{attrs:{placeholder:a.description},on:{blur:function(n){return t.checkValue(e.power[s+1],a.lookup_code,i)}},model:{value:e.power[s+1],callback:function(n){t.$set(e.power,s+1,n)},expression:"data.power[key+1]"}})],1)})),t._v(" "),n("td",{staticClass:"text-center",staticStyle:{"vertical-align":"middle"}},[t._v("\n                    "+t._s(e.uom_description)+"\n                ")]),t._v(" "),n("td",{staticClass:"text-center"},[n("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(e){return e.preventDefault(),t.removeRow(i)}}},[n("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),t._v(" "),n("td")],2)}))],2):n("tbody",[t._l(t.getDataMachineType,(function(e,i){return n("tr",{key:i},[n("td",{staticClass:"text-center",staticStyle:{"vertical-align":"middle"}},[t._v("\n                    "+t._s(i)+"\n                ")]),t._v(" "),t._l(t.productPeriodList,(function(a,s){return n("td",{key:s,staticClass:"text-center",staticStyle:{"vertical-align":"middle"}},t._l(e,(function(e,a){return n("div",{key:a},[e.machine_type==i&&e.product_time==s+1?n("div",[t._v("\n                            "+t._s(e.power)+"\n                        ")]):t._e()])})),0)})),t._v(" "),n("td",{staticClass:"text-center",staticStyle:{"vertical-align":"middle"}},[t._v("\n                    "+t._s(e[0].uom_v.description)+"\n                ")]),t._v(" "),n("td"),t._v(" "),n("td",{staticClass:"text-center",staticStyle:{"font-size":"12px"}},[n("a",{class:t.btnTrans.edit.class,attrs:{type:"button",href:"/pm/settings/machine-power-temp/"+e[0].machine_group+"/"+e[0].machine_id+"/"+e[0].machine_type+"/edit"}},[n("i",{class:t.btnTrans.edit.icon,attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.btnTrans.edit.text)+"\n                    ")])])],2)})),t._v(" "),t._l(t.lines,(function(e,i){return n("tr",{key:i},[n("td",[n("el-select",{staticClass:"w-100",attrs:{placeholder:"เลือกประเภทของการผลิตของเครื่องจักร",clearable:""},on:{change:function(n){return t.getDetailsUom(e.machine_type,e)}},model:{value:e.machine_type,callback:function(n){t.$set(e,"machine_type",n)},expression:"data.machine_type"}},t._l(t.lookupTypeMachine,(function(t,e){return n("el-option",{key:e,attrs:{label:t.meaning,value:t.lookup_code}})})),1)],1),t._v(" "),t._l(t.productPeriodList,(function(a,s){return n("td",{key:s},[n("el-input",{attrs:{placeholder:a.description},on:{blur:function(n){return t.checkValue(e.power[s+1],a.lookup_code,i)}},model:{value:e.power[s+1],callback:function(n){t.$set(e.power,s+1,n)},expression:"data.power[key+1]"}})],1)})),t._v(" "),n("td",{staticClass:"text-center",staticStyle:{"vertical-align":"middle"}},[t._v("\n                    "+t._s(e.uom_description)+"\n                ")]),t._v(" "),n("td",{staticClass:"text-center"},[n("button",{class:t.btnTrans.delete.class,on:{click:function(e){return e.preventDefault(),t.removeRow(i)}}},[n("i",{class:t.btnTrans.delete.icon,attrs:{"aria-hidden":"true"}})])]),t._v(" "),n("td")],2)}))],2)])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",{staticClass:"text-center",attrs:{width:"20%"}},[n("div",[t._v("ประเภทของการผลิตของเครื่องจักร")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",{staticClass:"text-center",attrs:{width:"5%"}},[n("div",[t._v("หน่วย")])])}],!1,null,null,null).exports}}]);