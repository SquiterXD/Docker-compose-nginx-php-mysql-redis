(self.webpackChunk=self.webpackChunk||[]).push([[3819],{9546:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>r});var n=a(23645),i=a.n(n)()((function(t){return t[1]}));i.push([t.id,".v--modal-overlay[data-v-4e9c241e]{z-index:2000;padding-top:3rem;padding-bottom:3rem}",""]);const r=i},73819:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>j});var n=a(87757),i=a.n(n),r=a(7398),s=a.n(r);a(2223),a(30381);function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){c(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function c(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const u={props:["organizationCode","salePlans","salePlanSummary"],data:function(){return{salePlanItems:this.salePlans.map((function(t){return l(l({},t),{},{oct_converted:Number(parseFloat(t.oct)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),nov_converted:Number(parseFloat(t.nov)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),dec_converted:Number(parseFloat(t.dec)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),jan_converted:Number(parseFloat(t.jan)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),feb_converted:Number(parseFloat(t.feb)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),mar_converted:Number(parseFloat(t.mar)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),apr_converted:Number(parseFloat(t.apr)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),may_converted:Number(parseFloat(t.may)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),jun_converted:Number(parseFloat(t.jun)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),jul_converted:Number(parseFloat(t.jul)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),aug_converted:Number(parseFloat(t.aug)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),sep_converted:Number(parseFloat(t.sep)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),total_converted:Number(parseFloat(t.total)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})})),salePlanSummaryItem:l(l({},this.salePlanSummary),{},{oct_converted:Number(parseFloat(this.salePlanSummary.oct)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),nov_converted:Number(parseFloat(this.salePlanSummary.nov)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),dec_converted:Number(parseFloat(this.salePlanSummary.dec)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),jan_converted:Number(parseFloat(this.salePlanSummary.jan)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),feb_converted:Number(parseFloat(this.salePlanSummary.feb)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),mar_converted:Number(parseFloat(this.salePlanSummary.mar)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),apr_converted:Number(parseFloat(this.salePlanSummary.apr)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),may_converted:Number(parseFloat(this.salePlanSummary.may)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),jun_converted:Number(parseFloat(this.salePlanSummary.jun)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),jul_converted:Number(parseFloat(this.salePlanSummary.jul)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),aug_converted:Number(parseFloat(this.salePlanSummary.aug)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),sep_converted:Number(parseFloat(this.salePlanSummary.sep)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),total_converted:Number(parseFloat(this.salePlanSummary.total)/1e3).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})}},computed:{},methods:{}};var p=a(51900);const y=(0,p.Z)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-responsive",staticStyle:{"max-height":"320px"}},[a("table",{staticClass:"table table-sticky table-bordered mb-0",staticStyle:{"min-width":"1306px"}},[a("thead",[a("tr",[t._m(0),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" ตุลาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" พฤศจิกายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" ธันวาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" มกราคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" กุมภาพันธ์ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" มีนาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" เมษายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" พฤษภาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" มิถุนายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" กรกฎาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" สิงหาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" กันยายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"200px","max-width":"200px"}},["M06"==t.organizationCode?a("span",[t._v(" รวม (พันมวน) ")]):a("span",[t._v(" รวม (ล้านมวน) ")])])])]),t._v(" "),t.salePlanItems.length>0?a("tbody",[t._l(t.salePlanItems,(function(e,n){return[a("tr",{key:""+n},[a("td",{staticClass:"text-center freeze-col",staticStyle:{"min-width":"320px"}},[a("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[a("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"100px","max-width":"100px"}},[t._v("\n                                "+t._s(e.item_code)+"\n                            ")]),t._v(" "),a("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"180px","max-width":"180px","border-left":"1px solid #ddd"}},[t._v("\n                                "+t._s(e.item_description)+" \n                            ")])])]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.oct_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.nov_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.dec_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.jan_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.feb_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.mar_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.apr_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.may_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.jun_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.jul_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.aug_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(e.sep_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"200px","max-width":"200px"}},[t._v(" "+t._s(e.total_converted)+" ")])])]})),t._v(" "),a("tr",[a("th",{staticClass:"text-left tw-bg-white freeze-col",staticStyle:{"min-width":"320px","max-width":"320px"}},[a("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[a("div",{staticClass:"tw-inline-block tw-pl-2 tw-py-4"},["M06"==t.organizationCode?a("span",[t._v(" ยอดรวมทุกตรา (พันมวน) ")]):a("span",[t._v(" ยอดรวมทุกตรา (ล้านมวน) ")])])])]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.oct_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.nov_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.dec_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.jan_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.feb_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.mar_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.apr_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.may_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.jun_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.jul_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.aug_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"92px","max-width":"92px"}},[t._v(" "+t._s(t.salePlanSummaryItem.sep_converted)+" ")]),t._v(" "),a("td",{staticClass:"text-right",staticStyle:{"min-width":"200px","max-width":"200px"}},[t._v(" "+t._s(t.salePlanSummaryItem.total_converted)+" ")])])],2):a("tbody",[t._m(1)])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-center freeze-col",staticStyle:{"min-width":"320px"}},[a("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[a("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"100px","max-width":"100px"}},[t._v("\n                            รหัสสินค้า\n                        ")]),t._v(" "),a("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"180px","max-width":"180px","border-left":"1px solid #ddd"}},[t._v("\n                            ตราบุหรี่ \n                        ")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{attrs:{colspan:"13"}},[a("h2",{staticClass:"p-5 text-center text-muted"},[t._v(" ไม่พบข้อมูล ")])])])}],!1,null,null,null).exports;var _=a(80455);function d(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function v(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?v(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const b={props:["planHeader","planMonths","planLines","salePlanSummary","itemOptions","uomCodes"],components:{VueNumeric:a.n(_)()},watch:{planHeader:function(t){this.planHeaderData=t}},data:function(){var t=this;return{planHeaderData:this.planHeader,planLineItems:this.planLines.map((function(e){return h(h({},e),{},{uom_desc:t.getUomCodeDescription(t.uomCodes,e.uom),user_gain_loss_qty:e.attribute11?Number(e.attribute11).toFixed(2):Number(e.gain_loss_qty).toFixed(2),user_oct_req_qty:e.oct_req_qty?e.oct_req_qty:0,user_nov_req_qty:e.nov_req_qty?e.nov_req_qty:0,user_dec_req_qty:e.dec_req_qty?e.dec_req_qty:0,user_jan_req_qty:e.jan_req_qty?e.jan_req_qty:0,user_feb_req_qty:e.feb_req_qty?e.feb_req_qty:0,user_mar_req_qty:e.mar_req_qty?e.mar_req_qty:0,user_apr_req_qty:e.apr_req_qty?e.apr_req_qty:0,user_may_req_qty:e.may_req_qty?e.may_req_qty:0,user_jun_req_qty:e.jun_req_qty?e.jun_req_qty:0,user_jul_req_qty:e.jul_req_qty?e.jul_req_qty:0,user_aug_req_qty:e.aug_req_qty?e.aug_req_qty:0,user_sep_req_qty:e.sep_req_qty?e.sep_req_qty:0,oct_buy_qty:e.oct_buy_qty?Number(e.oct_buy_qty).toFixed(2):0,nov_buy_qty:e.nov_buy_qty?Number(e.nov_buy_qty).toFixed(2):0,dec_buy_qty:e.dec_buy_qty?Number(e.dec_buy_qty).toFixed(2):0,jan_buy_qty:e.jan_buy_qty?Number(e.jan_buy_qty).toFixed(2):0,feb_buy_qty:e.feb_buy_qty?Number(e.feb_buy_qty).toFixed(2):0,mar_buy_qty:e.mar_buy_qty?Number(e.mar_buy_qty).toFixed(2):0,apr_buy_qty:e.apr_buy_qty?Number(e.apr_buy_qty).toFixed(2):0,may_buy_qty:e.may_buy_qty?Number(e.may_buy_qty).toFixed(2):0,jun_buy_qty:e.jun_buy_qty?Number(e.jun_buy_qty).toFixed(2):0,jul_buy_qty:e.jul_buy_qty?Number(e.jul_buy_qty).toFixed(2):0,aug_buy_qty:e.aug_buy_qty?Number(e.aug_buy_qty).toFixed(2):0,sep_buy_qty:e.sep_buy_qty?Number(e.sep_buy_qty).toFixed(2):0,percent:e.percent?e.percent:100,total_req_qty:t.calTotalReqQty(e),total_buy_qty:t.calTotalBuyQty(e),is_new_line:"Y"==e.attribute10,marked_as_deleted:!1})})).filter((function(t,e,a){return e===a.findIndex((function(e){return e.item_code===t.item_code}))})),planMonthItems:this.planMonths?this.planMonths:[]}},mounted:function(){var t=this;this.planLineItems.forEach((function(e){var a=parseFloat(e.user_gain_loss_qty);isNaN(a)||(t.autoCalculateUserReqQty(a,e),e.oct_buy_qty||e.nov_buy_qty||e.dec_buy_qty||e.jan_buy_qty||e.feb_buy_qty||e.mar_buy_qty||e.apr_buy_qty||e.may_buy_qty||e.jun_buy_qty||e.jul_buy_qty||e.aug_buy_qty||e.sep_buy_qty||t.autoCalculateBuyQty(e))})),this.emitPlanLineChanged()},computed:{},methods:{onUserGainLossQtyChanged:function(t){var e=parseFloat(t.user_gain_loss_qty);isNaN(e)||(this.autoCalculateUserReqQty(e,t),this.autoCalculateBuyQty(t))},calUserReqQty:function(t,e,a){return parseFloat(t)>0?a*parseFloat(e)/parseFloat(t):0},autoCalculateUserReqQty:function(t,e){e.user_oct_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.oct,t),e.user_nov_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.nov,t),e.user_dec_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.dec,t),e.user_jan_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.jan,t),e.user_feb_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.feb,t),e.user_mar_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.mar,t),e.user_apr_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.apr,t),e.user_may_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.may,t),e.user_jun_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.jun,t),e.user_jul_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.jul,t),e.user_aug_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.aug,t),e.user_sep_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.sep,t),e.is_new_line&&(e.gain_loss_qty=parseFloat(e.user_gain_loss_qty),e.oct_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.oct,t),e.nov_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.nov,t),e.dec_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.dec,t),e.jan_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.jan,t),e.feb_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.feb,t),e.mar_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.mar,t),e.apr_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.apr,t),e.may_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.may,t),e.jun_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.jun,t),e.jul_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.jul,t),e.aug_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.aug,t),e.sep_req_qty=this.calUserReqQty(this.salePlanSummary.total,this.salePlanSummary.sep,t))},calBuyQtyByPercent:function(t,e){return t?Number(parseFloat(t)*e/100).toFixed(2):Number(0).toFixed(2)},onPercentChanged:function(t){t.percent<0&&(t.percent=0),t.percent>100&&(t.percent=100),this.autoCalculateBuyQty(t)},autoCalculateBuyQty:function(t){var e=isNaN(parseFloat(t.percent))?100:parseFloat(t.percent);t.oct_buy_qty=this.calBuyQtyByPercent(t.user_oct_req_qty,e),t.nov_buy_qty=this.calBuyQtyByPercent(t.user_nov_req_qty,e),t.dec_buy_qty=this.calBuyQtyByPercent(t.user_dec_req_qty,e),t.jan_buy_qty=this.calBuyQtyByPercent(t.user_jan_req_qty,e),t.feb_buy_qty=this.calBuyQtyByPercent(t.user_feb_req_qty,e),t.mar_buy_qty=this.calBuyQtyByPercent(t.user_mar_req_qty,e),t.apr_buy_qty=this.calBuyQtyByPercent(t.user_apr_req_qty,e),t.may_buy_qty=this.calBuyQtyByPercent(t.user_may_req_qty,e),t.jun_buy_qty=this.calBuyQtyByPercent(t.user_jun_req_qty,e),t.jul_buy_qty=this.calBuyQtyByPercent(t.user_jul_req_qty,e),t.aug_buy_qty=this.calBuyQtyByPercent(t.user_aug_req_qty,e),t.sep_buy_qty=this.calBuyQtyByPercent(t.user_sep_req_qty,e),t.total_buy_qty=this.calTotalBuyQty(t),this.emitPlanLineChanged()},onBuyQtyChanged:function(t){t.total_buy_qty=this.calTotalBuyQty(t),this.emitPlanLineChanged()},calTotalBuyQty:function(t){return((isNaN(parseFloat(t.oct_buy_qty))?0:parseFloat(t.oct_buy_qty))+(isNaN(parseFloat(t.nov_buy_qty))?0:parseFloat(t.nov_buy_qty))+(isNaN(parseFloat(t.dec_buy_qty))?0:parseFloat(t.dec_buy_qty))+(isNaN(parseFloat(t.jan_buy_qty))?0:parseFloat(t.jan_buy_qty))+(isNaN(parseFloat(t.feb_buy_qty))?0:parseFloat(t.feb_buy_qty))+(isNaN(parseFloat(t.mar_buy_qty))?0:parseFloat(t.mar_buy_qty))+(isNaN(parseFloat(t.apr_buy_qty))?0:parseFloat(t.apr_buy_qty))+(isNaN(parseFloat(t.may_buy_qty))?0:parseFloat(t.may_buy_qty))+(isNaN(parseFloat(t.jun_buy_qty))?0:parseFloat(t.jun_buy_qty))+(isNaN(parseFloat(t.jul_buy_qty))?0:parseFloat(t.jul_buy_qty))+(isNaN(parseFloat(t.aug_buy_qty))?0:parseFloat(t.aug_buy_qty))+(isNaN(parseFloat(t.sep_buy_qty))?0:parseFloat(t.sep_buy_qty))).toFixed(2)},calTotalReqQty:function(t){return((isNaN(parseFloat(t.oct_req_qty))?0:parseFloat(t.oct_req_qty))+(isNaN(parseFloat(t.nov_req_qty))?0:parseFloat(t.nov_req_qty))+(isNaN(parseFloat(t.dec_req_qty))?0:parseFloat(t.dec_req_qty))+(isNaN(parseFloat(t.jan_req_qty))?0:parseFloat(t.jan_req_qty))+(isNaN(parseFloat(t.feb_req_qty))?0:parseFloat(t.feb_req_qty))+(isNaN(parseFloat(t.mar_req_qty))?0:parseFloat(t.mar_req_qty))+(isNaN(parseFloat(t.apr_req_qty))?0:parseFloat(t.apr_req_qty))+(isNaN(parseFloat(t.may_req_qty))?0:parseFloat(t.may_req_qty))+(isNaN(parseFloat(t.jun_req_qty))?0:parseFloat(t.jun_req_qty))+(isNaN(parseFloat(t.jul_req_qty))?0:parseFloat(t.jul_req_qty))+(isNaN(parseFloat(t.aug_req_qty))?0:parseFloat(t.aug_req_qty))+(isNaN(parseFloat(t.sep_req_qty))?0:parseFloat(t.sep_req_qty))).toFixed(2)},isAllowAddPlanLine:function(t){var e=!0;return t.filter((function(t){return t.is_new_line&&(!t.item_code||!t.user_gain_loss_qty||!t.oct_buy_qty||!t.nov_buy_qty||!t.dec_buy_qty||!t.jan_buy_qty||!t.feb_buy_qty||!t.mar_buy_qty||!t.apr_buy_qty||!t.may_buy_qty||!t.jun_buy_qty||!t.jul_buy_qty||!t.aug_buy_qty||!t.sep_buy_qty||!t.percent)&&0==t.marked_as_deleted})).length>0&&(e=!1),e},onAddPlanLine:function(){var t=this,e=h({},this.planLineItems.find((function(e,a){return a==t.planLineItems.length-1})));Object.keys(e).forEach((function(t){return e[t]=null})),this.planLineItems=[].concat(d(this.planLineItems),[h(h({},e),{},{percent:100,is_new_line:!0,marked_as_deleted:!1})]),this.emitPlanLineChanged()},onDeleteLine:function(t){var e=this;swal({title:"",text:"ต้องการลบรายการ ".concat(t.description?t.description:""," ?"),showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(a){a&&(t.marked_as_deleted=!0,e.emitPlanLineChanged())}))},onItemCodeChanged:function(t,e){e.inventory_item_id=t;var a=this.itemOptions.find((function(e){return e.inventory_item_id==t}));e.item_code=a.item_number,e.description=a.item_desc,e.uom=a.primary_uom_code,e.uom_desc=this.getUomCodeDescription(this.uomCodes,a.primary_uom_code),this.emitPlanLineChanged()},getUomCodeDescription:function(t,e){var a=t.find((function(t){return t.uom_code==e}));return a?a.unit_of_measure:""},emitPlanLineChanged:function(){this.$emit("onPlanLineChanged",{planLineItems:this.planLineItems})},formatNumber:function(t){return t.toString().replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")},isNumber:function(t){var e=(t=t||window.event).which?t.which:t.keyCode;if(!(e>31&&(e<48||e>57)&&46!==e))return!0;t.preventDefault()}}};const x=(0,p.Z)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["1"==t.planHeaderData.status?a("div",{staticClass:"text-right tw-mb-2"},[a("button",{staticClass:"btn btn-inline-block btn-sm btn-success tw-w-32",attrs:{disabled:!t.isAllowAddPlanLine(t.planLineItems)},on:{click:t.onAddPlanLine}},[a("i",{staticClass:"fa fa-plus tw-mr-1"}),t._v(" เพิ่มรายการ \n        ")])]):t._e(),t._v(" "),a("div",{staticClass:"table-responsive",staticStyle:{"max-height":"400px"}},[a("table",{staticClass:"table table-bordered table-sticky mb-0",staticStyle:{"min-width":"4100px"}},[t._m(0),t._v(" "),t.planLineItems.length>0?a("tbody",{staticClass:"yearly-lines"},[t._l(t.planLineItems,(function(e,n){return[e.marked_as_deleted?t._e():a("tr",{key:""+n,style:{backgroundColor:e.uom?"":"#FFEEEE"}},[a("td",{staticClass:"freeze-col",style:{minWidth:"480px",backgroundColor:e.uom?"":"#FFEEEE"}},[a("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[a("div",{staticClass:"tw-inline-block tw-align-top tw-py-4 tw-pr-2",staticStyle:{"min-width":"120px","max-width":"120px","vertical-align":"top"}},["1"==t.planHeaderData.status&&e.is_new_line?a("div",[a("pm-el-select",{attrs:{name:"item_code",id:"input_item_code","select-options":t.itemOptions,"option-key":"inventory_item_id","option-value":"inventory_item_id","option-label":"full_item_desc",value:e.item_code,filterable:!0},on:{onSelected:function(a){return t.onItemCodeChanged(a,e)}}})],1):a("div",{staticClass:"text-center"},[t._v("\n                                        "+t._s(e.item_code)+" \n                                    ")])]),t._v(" "),a("div",{staticClass:"tw-inline-block tw-align-top tw-py-4 tw-pl-4",staticStyle:{"min-height":"30px","min-width":"320px","max-width":"320px","border-left":"1px solid #ddd"}},[t._v("\n                                    "+t._s(e.description)+"\n                                ")])])]),t._v(" "),a("td",{staticClass:"text-right scroll-col",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.gain_loss_qty?Number(e.gain_loss_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00")+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right scroll-col",staticStyle:{"min-width":"152px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:2,minus:!1,name:"user_gain_loss_qty_"+n,id:"input_user_gain_loss_qty_"+n},on:{change:function(a){return t.onUserGainLossQtyChanged(e)}},model:{value:e.user_gain_loss_qty,callback:function(a){t.$set(e,"user_gain_loss_qty",a)},expression:"planLineItem.user_gain_loss_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.user_gain_loss_qty?Number(e.user_gain_loss_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-center",staticStyle:{"min-width":"120px"}},[t._v(" "+t._s(e.uom_desc)+" ")]),t._v(" "),a("td",{staticClass:"scroll-col text-center",staticStyle:{"min-width":"100px"}},["1"==t.planHeaderData.status?a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.percent,expression:"planLineItem.percent"}],staticClass:"form-control input-sm text-right",attrs:{id:"input_percent_"+n,type:"number",name:"percent_"+n,min:"0",max:"100",placeholder:""},domProps:{value:e.percent},on:{change:function(a){return t.onPercentChanged(e)},input:function(a){a.target.composing||t.$set(e,"percent",a.target.value)}}})]):a("div",[t._v("\n                                "+t._s(e.percent)+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.oct_req_qty?Number(e.oct_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,name:"oct_buy_qty_"+n,id:"input_oct_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.oct_buy_qty,callback:function(a){t.$set(e,"oct_buy_qty",a)},expression:"planLineItem.oct_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.oct_buy_qty?Number(e.oct_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.nov_req_qty?Number(e.nov_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_nov_buy_qty_"+n,name:"nov_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.nov_buy_qty,callback:function(a){t.$set(e,"nov_buy_qty",a)},expression:"planLineItem.nov_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.nov_buy_qty?Number(e.nov_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.dec_req_qty?Number(e.dec_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_dec_buy_qty_"+n,name:"dec_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.dec_buy_qty,callback:function(a){t.$set(e,"dec_buy_qty",a)},expression:"planLineItem.dec_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.dec_buy_qty?Number(e.dec_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.jan_req_qty?Number(e.jan_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_jan_buy_qty_"+n,name:"jan_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.jan_buy_qty,callback:function(a){t.$set(e,"jan_buy_qty",a)},expression:"planLineItem.jan_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.jan_buy_qty?Number(e.jan_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.feb_req_qty?Number(e.feb_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_feb_buy_qty_"+n,name:"feb_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.feb_buy_qty,callback:function(a){t.$set(e,"feb_buy_qty",a)},expression:"planLineItem.feb_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.feb_buy_qty?Number(e.feb_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.mar_req_qty?Number(e.mar_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_mar_buy_qty_"+n,name:"mar_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.mar_buy_qty,callback:function(a){t.$set(e,"mar_buy_qty",a)},expression:"planLineItem.mar_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.mar_buy_qty?Number(e.mar_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.apr_req_qty?Number(e.apr_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_apr_buy_qty_"+n,name:"apr_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.apr_buy_qty,callback:function(a){t.$set(e,"apr_buy_qty",a)},expression:"planLineItem.apr_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.apr_buy_qty?Number(e.apr_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.may_req_qty?Number(e.may_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_may_buy_qty_"+n,name:"may_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.may_buy_qty,callback:function(a){t.$set(e,"may_buy_qty",a)},expression:"planLineItem.may_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.may_buy_qty?Number(e.may_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.jun_req_qty?Number(e.jun_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_jun_buy_qty_"+n,name:"jun_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.jun_buy_qty,callback:function(a){t.$set(e,"jun_buy_qty",a)},expression:"planLineItem.jun_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.jun_buy_qty?Number(e.jun_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.jul_req_qty?Number(e.jul_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_jul_buy_qty_"+n,name:"jul_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.jul_buy_qty,callback:function(a){t.$set(e,"jul_buy_qty",a)},expression:"planLineItem.jul_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.jul_buy_qty?Number(e.jul_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.aug_req_qty?Number(e.aug_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_aug_buy_qty_"+n,name:"aug_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.aug_buy_qty,callback:function(a){t.$set(e,"aug_buy_qty",a)},expression:"planLineItem.aug_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.aug_buy_qty?Number(e.aug_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},[t._v(" \n                            "+t._s(e.sep_req_qty?Number(e.sep_req_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                        ")]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"140px"}},["1"==t.planHeaderData.status?a("div",[a("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_sep_buy_qty_"+n,name:"sep_buy_qty_"+n},on:{change:function(a){return t.onBuyQtyChanged(e)}},model:{value:e.sep_buy_qty,callback:function(a){t.$set(e,"sep_buy_qty",a)},expression:"planLineItem.sep_buy_qty"}})],1):a("div",[t._v("\n                                "+t._s(e.sep_buy_qty?Number(e.sep_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+"\n                            ")])]),t._v(" "),a("td",{staticClass:"scroll-col text-right",staticStyle:{"min-width":"200px"}},[t._v(" "+t._s(e.total_buy_qty?Number(e.total_buy_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"")+" ")]),t._v(" "),a("td",{staticClass:"scroll-col text-center",staticStyle:{"min-width":"60px"}},["1"==t.planHeaderData.status&&e.is_new_line?a("button",{staticClass:"btn btn-sm btn-danger",attrs:{type:"button"},on:{click:function(a){return t.onDeleteLine(e)}}},[a("i",{staticClass:"fa fa-trash"})]):t._e()])])]}))],2):a("tbody",[t._m(1)])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"freeze-col",staticStyle:{"min-width":"480px"},attrs:{rowspan:"2"}},[a("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[a("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4",staticStyle:{"min-width":"120px","max-width":"120px"}},[t._v("\n                                รหัสวัตถุดิบ \n                            ")]),t._v(" "),a("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4",staticStyle:{"min-height":"30px","min-width":"320px","max-width":"320px","border-left":"1px solid #ddd"}},[t._v("\n                                รายละเอียด \n                            ")])])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px"},attrs:{rowspan:"2"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"152px"},attrs:{rowspan:"2"}},[t._v(" ปริมาณที่ต้องใช้ + สูญเสีย / ล้านมวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"},attrs:{rowspan:"2"}},[t._v(" หน่วยนับ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"100px"},attrs:{rowspan:"2"}},[t._v(" % การใข้งาน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" ตุลาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" พฤศจิกายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" ธันวาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" มกราคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" กุมภาพันธ์ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" มีนาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" เมษายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" พฤษภาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" มิถุนายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" กรกฎาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" สิงหาคม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"280px"},attrs:{colspan:"2"}},[t._v(" กันยายน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"200px"},attrs:{rowspan:"2"}},[t._v(" รวม ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"60px"},attrs:{rowspan:"2"}})]),t._v(" "),a("tr",[a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ระบบคำนวน ")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{"min-width":"140px",top:"34px"}},[t._v(" ประมาณการใช้ ")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{attrs:{colspan:"9"}},[a("h2",{staticClass:"p-5 text-center text-muted"},[t._v(" ไม่พบข้อมูล ")])])])}],!1,null,null,null).exports;function f(t,e,a,n,i,r,s){try{var o=t[r](s),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,i)}function q(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function s(t){f(r,n,i,s,o,"next",t)}function o(t){f(r,n,i,s,o,"throw",t)}s(void 0)}))}}const w={props:["modalName","modalWidth","modalHeight","organizationCode","planHeader","periodYears","periodYearValue","printTypes","printTypeValue","saleTypes","saleTypeValue","ingredientGroups","ingredientGroupValue","sourceVersions","sourceVersionValue","yearlyPlanVersions","yearlyPlanVersionValue"],components:{Loading:s()},watch:{planHeader:function(t){this.planHeaderData=t},periodYears:function(t){this.periodYearOptions=t},periodYearValue:function(t){this.periodYear=t,this.periodYearLabel=this.getPeriodYearLabel(this.periodYearOptions,t)},printTypeValue:function(t){this.printType=t},saleTypeValue:function(t){this.saleType=t},ingredientGroupValue:function(t){this.ingredientGroup=t},sourceVersionValue:function(t){this.sourceVersion=t},sourceVersions:function(t){this.sourceVersionOptions=t},yearlyPlanVersionValue:function(t){this.yearlyPlanVersion=t},yearlyPlanVersions:function(t){this.yearlyPlanVersionOptions=t}},data:function(){return{is_loading:!1,width:this.modalWidth,planHeaderData:this.planHeader,periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),periodYearOptions:this.periodYears,printType:this.printTypeValue,saleType:this.saleTypeValue,ingredientGroup:this.ingredientGroupValue,sourceVersion:this.sourceVersionValue,sourceVersionOptions:this.sourceVersions,yearlyPlanVersion:this.yearlyPlanVersionValue,yearlyPlanVersionOptions:this.yearlyPlanVersions}},created:function(){this.handleResize()},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},onYearlyPlanChanged:function(t){var e=this;return q(i().mark((function a(){return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.periodYear=t,e.periodYearLabel=e.getPeriodYearLabel(e.periodYearOptions,e.periodYear),a.next=4,e.getSourceVersions(e.periodYear,e.printType,e.saleType);case 4:e.sourceVersion&&e.getYearlyPlanData(e.periodYear,e.printType,e.saleType,e.ingredientGroup,e.sourceVersion,null);case 5:case"end":return a.stop()}}),a)})))()},onPrintTypeChanged:function(t){this.printType=t,this.getYearlyPlanData(this.periodYear,this.printType,this.saleType,this.ingredientGroup,this.sourceVersion,null)},onSourceVersionChanged:function(t){this.sourceVersion=t},onSaleTypeChanged:function(t){this.saleType=t,this.getYearlyPlanData(this.periodYear,this.printType,this.saleType,this.ingredientGroup,this.sourceVersion,null)},onIngredientGroupChanged:function(t){this.ingredientGroup=t,this.getYearlyPlanData(this.periodYear,this.printType,this.saleType,this.ingredientGroup,this.sourceVersion,null)},onYearlyPlanVersionChanged:function(t){this.yearlyPlanVersion=t},getPeriodYearLabel:function(t,e){var a=t.find((function(t){return t.period_year_value==e}));return a?a.period_year_label:""},isAllowSelectPrintType:function(t){var e=!1;return"M06"==t&&(e=!0),e},isAllowSelectSaleType:function(t){var e=!1;return"M06"==t&&(e=!0),e},isAllowSelectIngredientGroup:function(t){var e=!1;return"M02"==t&&(e=!0),e},validateBeforeGetHeader:function(t,e,a,n,i,r){var s=!1;return"M06"==t?e&&a&&n&&r&&(s=!0):"M02"==t?e&&i&&r&&(s=!0):e&&r&&(s=!0),s},validateBeforeGetSourceVersions:function(t,e,a,n,i){var r=!1;return"M06"==t?e&&a&&n&&(r=!0):"M02"==t?e&&i&&(r=!0):e&&(r=!0),r},getYearlyPlanData:function(t,e,a,n,r,s){var o=this;return q(i().mark((function l(){var c;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o.is_loading=!0,o.yearlyPlanVersion=null,o.yearlyPlanVersionOptions=[],c={period_year:t,print_type:e,sale_type:a,ingredient_group:n,source_version:r,version:s},!o.validateBeforeGetHeader(o.organizationCode,t,e,a,n,r)){i.next=9;break}return i.next=8,axios.get("/ajax/pm/plans/yearly/get-info",{params:c}).then((function(t){var e=t.data.data;return"error"==e.status?swal("เกิดข้อผิดพลาด","ข้อมูลแผนประมาณการจำหน่ายประจำปี ".concat(o.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error"):o.yearlyPlanVersionOptions=e.versions.length>0?JSON.parse(e.versions):[],e})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","".concat(t.message),"error")}));case 8:o.yearlyPlanVersion=o.yearlyPlanVersionOptions.length>0?o.yearlyPlanVersionOptions[0].version:null;case 9:o.is_loading=!1;case 10:case"end":return i.stop()}}),l)})))()},getSourceVersions:function(t,e,a){var n=this;return q(i().mark((function r(){var s;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.isLoading=!0,n.sourceVersion=null,n.sourceVersionOptions=[],s={period_year:t,print_type:e,sale_type:a,ingredient_group:ingredientGroup},!n.validateBeforeGetSourceVersions(n.organizationCode,t,e,a,ingredientGroup)){i.next=8;break}return i.next=8,axios.get("/ajax/pm/plans/yearly/get-source-versions",{params:s}).then((function(t){var e=t.data.data;return"error"==e.status?swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(e.message),"error"):(n.sourceVersion=e.source_version?e.source_version:null,n.sourceVersionOptions=e.source_versions?JSON.parse(e.source_versions):[],n.sourceVersionOptions.length<=0&&swal("ไม่พบข้อมูล","ไม่พบข้อมูลแผนประมาณการจำหน่ายประจำปี (ฝ่ายขาย)","error")),e})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(t.message),"error")}));case 8:n.isLoading=!1;case 9:case"end":return i.stop()}}),r)})))()},onSearchPlanVersion:function(){this.$modal.hide(this.modalName),this.$emit("onSearchPlanVersion",{period_year:this.periodYear,print_type:this.printType,sale_type:this.saleType,ingredient_group:this.ingredientGroup,source_version:this.sourceVersion,source_versions:this.sourceVersionOptions,version:this.yearlyPlanVersion})}}};a(77790);const S=(0,p.Z)(w,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"fixed","z-index":"100"}},[a("modal",{attrs:{name:t.modalName,width:t.width,scrollable:!0,height:t.modalHeight,shiftX:.3,shiftY:.3}},[a("div",{staticClass:"p-4"},[a("h4",[t._v(" ค้นหาประมาณการวัตถุดิบประจำปี ")]),t._v(" "),a("hr"),t._v(" "),t.isAllowSelectPrintType(t.organizationCode)?a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" ระบบการพิมพ์ ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"print_type",id:"input_print_type","select-options":t.printTypes,"option-key":"print_type_value","option-value":"print_type_value","option-label":"print_type_label",value:t.printType,filterable:!0},on:{onSelected:t.onPrintTypeChanged}})],1)]):t._e(),t._v(" "),t.isAllowSelectSaleType(t.organizationCode)?a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" ประเภทแผน ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"sale_type",id:"input_sale_type","select-options":t.saleTypes,"option-key":"value","option-value":"value","option-label":"description",value:t.saleType,filterable:!0},on:{onSelected:t.onSaleTypeChanged}})],1)]):t._e(),t._v(" "),t.isAllowSelectIngredientGroup(t.organizationCode)?a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" ประเภทวัตถุดิบ ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"ingredient_group",id:"ingredient_group","select-options":t.ingredientGroups,"option-key":"value","option-value":"value","option-label":"description",value:t.ingredientGroup,filterable:!0},on:{onSelected:t.onIngredientGroupChanged}})],1)]):t._e(),t._v(" "),a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[t._v(" แผนประมาณการ "),a("br"),t._v(" จำหน่ายประจำปี ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":t.periodYearOptions,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:t.periodYear,filterable:!0},on:{onSelected:t.onYearlyPlanChanged}})],1)]),t._v(" "),a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" เวอร์ชั่น ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"yearly_plan_version",id:"input_yearly_plan_version","select-options":t.yearlyPlanVersionOptions,"option-key":"version","option-value":"version","option-label":"version",value:t.yearlyPlanVersion,filterable:!0},on:{onSelected:t.onYearlyPlanVersionChanged}})],1)]),t._v(" "),a("div",{staticClass:"text-right tw-mt-8"},[a("button",{staticClass:"btn btn-primary tw-w-32",attrs:{type:"button",disabled:!t.periodYear||!t.yearlyPlanVersion},on:{click:t.onSearchPlanVersion}},[t._v(" \n                    เลือก \n                ")]),t._v(" "),a("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(e){return t.$modal.hide(t.modalName)}}},[t._v(" \n                    ยกเลิก \n                ")])])])]),t._v(" "),a("loading",{attrs:{active:t.is_loading,"is-full-page":!0},on:{"update:active":function(e){t.is_loading=e}}})],1)}),[],!1,null,"4e9c241e",null).exports;function P(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function C(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?P(Object(a),!0).forEach((function(e){F(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function F(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function L(t,e,a,n,i,r,s){try{var o=t[r](s),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,i)}function N(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function s(t){L(r,n,i,s,o,"next",t)}function o(t){L(r,n,i,s,o,"throw",t)}s(void 0)}))}}const V={components:{Loading:s(),TableSalePlans:y,TablePlanLines:x,ModalSearchPlan:S},props:["defaultData","periodYears","periodYearValue","itemOptions","planStatuses","printTypes","printTypeValue","saleTypes","saleTypeValue","ingredientGroups","ingredientGroupValue","sourceVersionValue","uomCodes"],mounted:function(){var t=this;this.getSourceVersions(this.periodYearValue,this.printTypeValue,this.saleTypeValue,this.ingredientGroupValue).then((function(e){t.getYearlyPlanData(t.periodYearValue,t.printTypeValue,t.saleTypeValue,t.ingredientGroupValue,t.sourceVersionValue,null)}))},data:function(){return{organizationId:this.defaultData?JSON.parse(this.defaultData).organization_id:null,organizationCode:this.defaultData?JSON.parse(this.defaultData).organization_code:null,department:this.defaultData?JSON.parse(this.defaultData).department:null,periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),printType:this.printTypeValue?this.printTypeValue:this.printTypes.length>0?this.printTypes[0].print_type_value:null,printTypeLabel:this.printTypeValue?this.getPrintTypeLabel(this.printTypes,this.printTypeValue):this.printTypes.length>0?this.printTypes[0].print_type_label:null,saleType:this.saleTypeValue?this.saleTypeValue:this.saleTypes.length>0?this.saleTypes[0].value:null,saleTypeLabel:this.saleTypeValue?this.getSaleTypeLabel(this.saleTypes,this.saleTypeValue):this.saleTypes.length>0?this.saleTypes[0].description:null,ingredientGroup:this.ingredientGroupValue?this.ingredientGroupValue:this.ingredientGroups.length>0?this.ingredientGroups[0].value:null,ingredientGroupLabel:this.ingredientGroupValue?this.getIngredientGroupLabel(this.ingredientGroups,this.ingredientGroupValue):this.ingredientGroups.length>0?this.ingredientGroups[0].description:null,sourceVersion:this.sourceVersionValue?this.sourceVersionValue:null,sourceVersions:[],yearlyPlanHeader:null,yearlyPlanVersion:null,salePlans:[],salePlanSummary:null,yearlyPlanLines:[],periodYearMonths:[],yearlyPlanVersions:[],isNewlyCreate:!1,foundInvalidPlanLine:!1,isLoading:!1}},computed:{},methods:{setUrlParams:function(){var t=new URLSearchParams(window.location.search);t.set("period_year",this.periodYear?this.periodYear:""),t.set("print_type",this.printType?this.printType:""),t.set("sale_type",this.saleType?this.saleType:""),t.set("ingredient_group",this.ingredientGroup?this.ingredientGroup:""),t.set("source_version",this.sourceVersion?this.sourceVersion:""),window.history.replaceState(null,null,"?"+t.toString())},onYearlyPlanChanged:function(t){var e=this;return N(i().mark((function a(){return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.periodYear=t,e.periodYearLabel=e.getPeriodYearLabel(e.periodYears,e.periodYear),e.setUrlParams(),a.next=5,e.getSourceVersions(e.periodYear,e.printType,e.saleType,e.ingredientGroup);case 5:e.sourceVersion&&e.getYearlyPlanData(e.periodYear,e.printType,e.saleType,e.ingredientGroup,e.sourceVersion,null);case 6:case"end":return a.stop()}}),a)})))()},onSourceVersionChanged:function(t){var e=this;return N(i().mark((function a(){return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.sourceVersion=t,e.setUrlParams(),0==e.yearlyPlanLines.length&&(e.salePlans=[],e.salePlanSummary=null),!e.yearlyPlanHeader){a.next=6;break}return a.next=6,e.updateYearlyPlanSourceVersion(e.periodYear,e.printType,e.saleType,e.ingredientGroup,e.sourceVersion,e.yearlyPlanHeader.version);case 6:e.getYearlyPlanData(e.periodYear,e.printType,e.saleType,e.ingredientGroup,e.sourceVersion,null);case 7:case"end":return a.stop()}}),a)})))()},onPrintTypeChanged:function(t){var e=this;return N(i().mark((function a(){return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.printType=t,e.printTypeLabel=e.getPrintTypeLabel(e.printTypes,e.printType),e.setUrlParams(),a.next=5,e.getSourceVersions(e.periodYear,e.printType,e.saleType,e.ingredientGroup);case 5:e.sourceVersion&&e.getYearlyPlanData(e.periodYear,e.printType,e.saleType,e.ingredientGroup,e.sourceVersion,null);case 6:case"end":return a.stop()}}),a)})))()},onSaleTypeChanged:function(t){var e=this;return N(i().mark((function a(){return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.saleType=t,e.saleTypeLabel=e.getSaleTypeLabel(e.saleTypes,e.saleType),e.setUrlParams(),a.next=5,e.getSourceVersions(e.periodYear,e.printType,e.saleType,e.ingredientGroup);case 5:e.sourceVersion&&e.getYearlyPlanData(e.periodYear,e.printType,e.saleType,e.ingredientGroup,e.sourceVersion,null);case 6:case"end":return a.stop()}}),a)})))()},onIngredientGroupChanged:function(t){var e=this;return N(i().mark((function a(){return i().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.ingredientGroup=t,e.ingredientGroupLabel=e.getIngredientGroupLabel(e.ingredientGroups,e.ingredientGroup),e.setUrlParams(),a.next=5,e.getSourceVersions(e.periodYear,e.printType,e.saleType,e.ingredientGroup);case 5:e.sourceVersion&&e.getYearlyPlanData(e.periodYear,e.printType,e.saleType,e.ingredientGroup,e.sourceVersion,null);case 6:case"end":return a.stop()}}),a)})))()},onSearchPlanVersion:function(t){this.periodYear=t.period_year,this.periodYearLabel=this.getPeriodYearLabel(this.periodYears,this.periodYear),this.printType=t.print_type,this.printTypeLabel=this.getPrintTypeLabel(this.printTypes,this.printType),this.saleType=t.sale_type,this.saleTypeLabel=this.getSaleTypeLabel(this.saleTypes,this.saleType),this.ingredientGroup=t.ingredient_group,this.ingredientGroupLabel=this.getIngredientGroupLabel(this.ingredientGroups,this.ingredientGroup),this.sourceVersion=t.source_version,this.sourceVersions=t.source_versions,this.getYearlyPlanData(this.periodYear,this.printType,this.saleType,this.ingredientGroup,this.sourceVersion,t.version)},getPeriodYearLabel:function(t,e){var a=t.find((function(t){return t.period_year_value==e}));return a?a.period_year_label:""},getPeriodNameLabel:function(t,e){var a=t.find((function(t){return t.period_name_value==e}));return a?a.period_name_label:""},getPrintTypeLabel:function(t,e){var a=t.find((function(t){return t.print_type_value==e}));return a?a.print_type_label:""},getSaleTypeLabel:function(t,e){var a=t.find((function(t){return t.value==e}));return a?a.description:""},getIngredientGroupLabel:function(t,e){var a=t.find((function(t){return t.value==e}));return a?a.description:""},validateBeforeGetHeader:function(t,e,a,n,i,r){var s=!1;return"M06"==t?e&&a&&n&&r&&(s=!0):"M02"==t?e&&i&&r&&(s=!0):e&&r&&(s=!0),s},getYearlyPlanData:function(t,e,a,n,r,s){var o=this;return N(i().mark((function l(){var c,u;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o.isLoading=!0,o.yearlyPlanHeader=null,o.yearlyPlanLines=[],o.yearlyPlanVersion=s,o.yearlyPlanVersions=[],o.salePlans=[],o.salePlanSummary=null,c={period_year:t,print_type:e,sale_type:a,ingredient_group:n,source_version:r,version:s},!o.validateBeforeGetHeader(o.organizationCode,t,e,a,n,r)){i.next=25;break}return i.next=12,axios.get("/ajax/pm/plans/yearly/get-info",{params:c}).then((function(t){var e=t.data.data;return"error"==e.status?swal("เกิดข้อผิดพลาด","ข้อมูลแผนประมาณการจำหน่ายประจำปี ".concat(o.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error"):(o.yearlyPlanHeader=e.plan_header?JSON.parse(e.plan_header):null,o.yearlyPlanVersions=e.versions?JSON.parse(e.versions):[]),e})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ข้อมูลแผนประมาณการจำหน่ายประจำปี ".concat(o.periodYearLabel," ไม่ถูกต้อง | ").concat(t.message),"error")}));case 12:if(!o.yearlyPlanHeader){i.next=24;break}if(o.yearlyPlanVersion=o.yearlyPlanHeader.version,!(o.sourceVersions.length>0)){i.next=22;break}return u=o.sourceVersions.find((function(t){return t.version==o.yearlyPlanHeader.source_version})),o.sourceVersion=u?u.version:o.yearlyPlanHeader.source_version,i.next=19,o.onGetSalePlans();case 19:return i.next=21,o.onGetYearlyPlanLines();case 21:o.setUrlParams();case 22:i.next=25;break;case 24:o.yearlyPlanVersion=null;case 25:o.isLoading=!1;case 26:case"end":return i.stop()}}),l)})))()},validateBeforeGetSourceVersions:function(t,e,a,n,i){var r=!1;return"M06"==t?e&&a&&n&&(r=!0):"M02"==t?e&&i&&(r=!0):e&&(r=!0),r},getSourceVersions:function(t,e,a,n){var r=this;return N(i().mark((function s(){var o;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r.isLoading=!0,r.sourceVersion=null,r.sourceVersions=[],o={period_year:t,print_type:e,sale_type:a,ingredient_group:n},!r.validateBeforeGetSourceVersions(r.organizationCode,t,e,a,n)){i.next=8;break}return i.next=8,axios.get("/ajax/pm/plans/yearly/get-source-versions",{params:o}).then((function(t){var e=t.data.data;return"error"==e.status?swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(e.message),"error"):(r.sourceVersion=e.source_version?e.source_version:null,r.sourceVersions=e.source_versions?JSON.parse(e.source_versions):[],r.sourceVersions.length<=0&&(swal("ไม่พบข้อมูล","ไม่พบข้อมูลแผนประมาณการจำหน่ายประจำปี (ฝ่ายขาย)","error"),r.yearlyPlanHeader=null,r.yearlyPlanLines=[],r.yearlyPlanVersion=null,r.yearlyPlanVersions=[],r.salePlans=[],r.salePlanSummary=null)),e})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(t.message),"error")}));case 8:r.isLoading=!1;case 9:case"end":return i.stop()}}),s)})))()},getPlanStatusDesc:function(t){var e="-";if(t){var a=this.planStatuses.find((function(e){return e.lookup_code==t}));e=a?a.description:"-"}return e},onGetSalePlans:function(){var t=this;return N(i().mark((function e(){var a,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,a=t.getSalePlanLabel(t.organizationCode),n={period_year:t.periodYear,print_type:t.printType,sale_type:t.saleType,ingredient_group:t.ingredientGroup,source_version:t.sourceVersion},e.next=5,axios.get("/ajax/pm/plans/yearly/get-sale-plans",{params:n}).then((function(e){var n=e.data.data;if("error"==n.status)swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล ".concat(a," ").concat(t.periodYearLabel," | ").concat(n.message),"error");else if(n.sale_plans){var i=JSON.parse(n.sale_plans);i.length<=0?swal("ไม่พบข้อมูล","ไม่พบข้อมูล ".concat(a," ").concat(t.periodYearLabel),"info"):(t.salePlans=i.map((function(e){return C(C({},e),{},{total:t.getTotalSalePlanPerItem(e)})})),t.salePlanSummary=t.getSumAllSalePlanItem(i))}return n})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล ".concat(a," ").concat(t.periodYearLabel," | ").concat(e.message),"error")}));case 5:t.isLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},getTotalSalePlanPerItem:function(t){return(isNaN(parseFloat(t.oct))?0:parseFloat(t.oct))+(isNaN(parseFloat(t.nov))?0:parseFloat(t.nov))+(isNaN(parseFloat(t.dec))?0:parseFloat(t.dec))+(isNaN(parseFloat(t.jan))?0:parseFloat(t.jan))+(isNaN(parseFloat(t.feb))?0:parseFloat(t.feb))+(isNaN(parseFloat(t.mar))?0:parseFloat(t.mar))+(isNaN(parseFloat(t.apr))?0:parseFloat(t.apr))+(isNaN(parseFloat(t.may))?0:parseFloat(t.may))+(isNaN(parseFloat(t.jun))?0:parseFloat(t.jun))+(isNaN(parseFloat(t.jul))?0:parseFloat(t.jul))+(isNaN(parseFloat(t.aug))?0:parseFloat(t.aug))+(isNaN(parseFloat(t.sep))?0:parseFloat(t.sep))},getSumAllSalePlanItem:function(t){var e={oct:0,nov:0,dec:0,jan:0,feb:0,mar:0,apr:0,may:0,jun:0,jul:0,aug:0,sep:0,total:0},a=t.map((function(t){return isNaN(parseFloat(t.oct))?0:parseFloat(t.oct)}));e.oct=a.reduce((function(t,e){return t+e}),0);var n=t.map((function(t){return isNaN(parseFloat(t.nov))?0:parseFloat(t.nov)}));e.nov=n.reduce((function(t,e){return t+e}),0);var i=t.map((function(t){return isNaN(parseFloat(t.dec))?0:parseFloat(t.dec)}));e.dec=i.reduce((function(t,e){return t+e}),0);var r=t.map((function(t){return isNaN(parseFloat(t.jan))?0:parseFloat(t.jan)}));e.jan=r.reduce((function(t,e){return t+e}),0);var s=t.map((function(t){return isNaN(parseFloat(t.feb))?0:parseFloat(t.feb)}));e.feb=s.reduce((function(t,e){return t+e}),0);var o=t.map((function(t){return isNaN(parseFloat(t.mar))?0:parseFloat(t.mar)}));e.mar=o.reduce((function(t,e){return t+e}),0);var l=t.map((function(t){return isNaN(parseFloat(t.apr))?0:parseFloat(t.apr)}));e.apr=l.reduce((function(t,e){return t+e}),0);var c=t.map((function(t){return isNaN(parseFloat(t.may))?0:parseFloat(t.may)}));e.may=c.reduce((function(t,e){return t+e}),0);var u=t.map((function(t){return isNaN(parseFloat(t.jun))?0:parseFloat(t.jun)}));e.jun=u.reduce((function(t,e){return t+e}),0);var p=t.map((function(t){return isNaN(parseFloat(t.jul))?0:parseFloat(t.jul)}));e.jul=p.reduce((function(t,e){return t+e}),0);var y=t.map((function(t){return isNaN(parseFloat(t.aug))?0:parseFloat(t.aug)}));e.aug=y.reduce((function(t,e){return t+e}),0);var _=t.map((function(t){return isNaN(parseFloat(t.sep))?0:parseFloat(t.sep)}));return e.sep=_.reduce((function(t,e){return t+e}),0),e.total=e.oct+e.nov+e.dec+e.jan+e.feb+e.mar+e.apr+e.may+e.jun+e.jul+e.aug+e.sep,e},onGetYearlyPlanLines:function(){var t=this;return N(i().mark((function e(){var a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={period_year:t.periodYear,print_type:t.printType,sale_type:t.saleType,ingredient_group:t.ingredientGroup,source_version:t.sourceVersion,version:t.yearlyPlanVersion},e.next=4,axios.get("/ajax/pm/plans/yearly/get-lines",{params:a}).then((function(e){var a=e.data.data;if("success"==a.status){if(t.yearlyPlanHeader=a.plan_header?JSON.parse(a.plan_header):[],t.yearlyPlanLines=a.plan_lines?JSON.parse(a.plan_lines):[],t.yearlyPlanVersion=t.yearlyPlanHeader.version,t.yearlyPlanVersions=a.versions?JSON.parse(a.versions):[],t.yearlyPlanLines.length>0){t.foundInvalidPlanLine=!!t.yearlyPlanLines.find((function(t){return!t.uom}));var n=t.yearlyPlanLines.filter((function(t){return!t.uom})).map((function(t){return t.item_code}));t.foundInvalidPlanLine&&swal("เกิดข้อผิดพลาด","ตรวจพบรายการที่มีข้อมูลไม่สมบูรณ์ [ รหัสวัตถุดิบ : ".concat(n.join()," ]"),"error")}}else swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลประมาณการผลิตของ แผนประมาณการจำหน่ายประจำปี ".concat(t.periodYearLabel," | ").concat(a.message),"error");return a})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลประมาณการผลิตของ แผนประมาณการจำหน่ายประจำปี ".concat(t.periodYearLabel,"  | ").concat(e.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},onGenerateYearlyPlanLines:function(){var t=this;return N(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.yearlyPlanLines.length>0?swal({title:"",text:"ต้องการดึงข้อมูลประมาณการใช้ ใหม่อีกครั้ง ?",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(e){e&&(t.yearlyPlanLines=[],t.generateYearlyPlanLines())})):t.generateYearlyPlanLines();case 1:case"end":return e.stop()}}),e)})))()},generateYearlyPlanLines:function(){var t=this;return N(i().mark((function e(){var a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={period_year:t.periodYear,print_type:t.printType,sale_type:t.saleType,ingredient_group:t.ingredientGroup,source_version:t.sourceVersion,version:t.yearlyPlanVersion},e.next=4,axios.post("/ajax/pm/plans/yearly/generate-lines",a).then((function(e){var a=e.data.data;if("success"==a.status){if(t.yearlyPlanHeader=a.plan_header?JSON.parse(a.plan_header):[],t.yearlyPlanLines=a.plan_lines?JSON.parse(a.plan_lines):[],t.yearlyPlanVersion=t.yearlyPlanHeader.version,t.yearlyPlanVersions=a.versions?JSON.parse(a.versions):[],t.isNewlyCreate=a.is_newly_create,t.yearlyPlanLines.length>0){t.foundInvalidPlanLine=!!t.yearlyPlanLines.find((function(t){return!t.uom}));var n=t.yearlyPlanLines.filter((function(t){return!t.uom})).map((function(t){return t.item_code}));t.foundInvalidPlanLine&&swal("เกิดข้อผิดพลาด","ตรวจพบรายการที่มีข้อมูลไม่สมบูรณ์ [ รหัสวัตถุดิบ : ".concat(n.join()," ]"),"error")}}else swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลประมาณการผลิตของ แผนประมาณการจำหน่ายประจำปี ".concat(t.periodYearLabel," | ").concat(a.message),"error");return a})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลประมาณการผลิตของ แผนประมาณการจำหน่ายประจำปี ".concat(t.periodYearLabel,"  | ").concat(e.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},onPlanLineChanged:function(t){this.yearlyPlanLines=t.planLineItems},validateBeforeSave:function(t,e){var a={valid:!0,message:""};return e.filter((function(t){return t.is_new_line&&(!t.item_code||!t.user_gain_loss_qty||!t.oct_buy_qty||!t.nov_buy_qty||!t.dec_buy_qty||!t.jan_buy_qty||!t.feb_buy_qty||!t.mar_buy_qty||!t.apr_buy_qty||!t.may_buy_qty||!t.jun_buy_qty||!t.jul_buy_qty||!t.aug_buy_qty||!t.sep_buy_qty||!t.percent)&&0==t.marked_as_deleted})).length>0&&(a.valid=!1,a.message="กรอกข้อมูลรายการประมาณการวัตถุดิบประจำปีไม่ครบถ้วน กรุณาตรวจสอบ"),a},onSaveYearlyPlan:function(){var t=this;return N(i().mark((function e(){var a,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={period_year:t.periodYear,print_type:t.printType,sale_type:t.saleType,ingredient_group:t.ingredientGroup,source_version:t.sourceVersion,version:t.yearlyPlanVersion,plan_header:JSON.stringify(t.yearlyPlanHeader),plan_lines:JSON.stringify(t.yearlyPlanLines)},t.isLoading=!0,!(n=t.validateBeforeSave(t.yearlyPlanHeader,t.yearlyPlanLines)).valid){e.next=8;break}return e.next=6,axios.post("/ajax/pm/plans/yearly/store-lines",a).then((function(e){var a=e.data.data,n=a.message,i=a.plan_header?JSON.parse(a.plan_header):null;return"success"==a.status&&(t.yearlyPlanHeader=i,t.yearlyPlanVersion=i.version,t.yearlyPlanVersions=a.versions?JSON.parse(a.versions):[],t.isNewlyCreate=!1,swal("Success","บันทึกประมาณการใช้ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," version : ").concat(t.yearlyPlanVersion," )"),"success")),"error"==a.status&&swal("เกิดข้อผิดพลาด","บันทึกประมาณการใช้ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(n),"error"),a})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","บันทึกประมาณการใช้ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(e.message),"error")}));case 6:e.next=9;break;case 8:swal("เกิดข้อผิดพลาด","บันทึกประมาณการใช้ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(n.message),"error");case 9:t.isLoading=!1;case 10:case"end":return e.stop()}}),e)})))()},getSalePlanLabel:function(t){var e="แผนประมาณการจำหน่ายประจำปี (ฝ่ายขาย)";return"M06"!=t&&(e="แผนการผลิตบุหรี่ประจำปี"),e},isShowSubmitApprovalButton:function(t){return"M06"==t},isShowSubmitYearlyPlanButton:function(t){return"M02"==t||"M05"==t||"MG6"==t},onSubmitApproval:function(){var t=this;return N(i().mark((function e(){var a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={period_year:t.periodYear,print_type:t.printType,sale_type:t.saleType,ingredient_group:t.ingredientGroup,source_version:t.sourceVersion,version:t.yearlyPlanVersion,plan_header:JSON.stringify(t.yearlyPlanHeader),plan_lines:JSON.stringify(t.yearlyPlanLines)},t.isLoading=!0,e.next=4,axios.post("/ajax/pm/plans/yearly/store-lines",a).then((function(t){var e=t.data.data;return"error"==e.status&&console.log(e.message),e})).catch((function(t){console.log(t)}));case 4:return e.next=6,axios.post("/ajax/pm/plans/yearly/submit-approval",a).then((function(e){var a=e.data.data,n=a.message;return"success"==a.status&&(t.yearlyPlanHeader=a.plan_header?JSON.parse(a.plan_header):null,t.yearlyPlanVersions=a.versions?JSON.parse(a.versions):[],swal("Success","ส่งอนุมัติ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," version : ").concat(t.yearlyPlanVersion," )"),"success")),"error"==a.status&&swal("เกิดข้อผิดพลาด","ส่งอนุมัติ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(n),"error"),a})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ส่งอนุมัติ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(e.message),"error")}));case 6:t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},onSubmitYearlyPlan:function(){var t=this;return N(i().mark((function e(){var a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={period_year:t.periodYear,print_type:t.printType,sale_type:t.saleType,ingredient_group:t.ingredientGroup,source_version:t.sourceVersion,version:t.yearlyPlanVersion,plan_header:JSON.stringify(t.yearlyPlanHeader),plan_lines:JSON.stringify(t.yearlyPlanLines)},t.isLoading=!0,e.next=4,axios.post("/ajax/pm/plans/yearly/store-lines",a).then((function(t){var e=t.data.data;return"error"==e.status&&console.log(e.message),e})).catch((function(t){console.log(t)}));case 4:return e.next=6,axios.post("/ajax/pm/plans/yearly/submit-plan",a).then((function(e){var a=e.data.data,n=a.message;return"success"==a.status&&(t.yearlyPlanHeader=a.plan_header?JSON.parse(a.plan_header):null,t.yearlyPlanVersions=a.versions?JSON.parse(a.versions):[],swal("Success","ส่งข้อมูลประมาณการ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," version : ").concat(t.yearlyPlanVersion," )"),"success")),"error"==a.status&&swal("เกิดข้อผิดพลาด","ส่งข้อมูลประมาณการ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(n),"error"),a})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ส่งข้อมูลประมาณการ แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(e.message),"error")}));case 6:t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},onCreateNewYearlyPlanVersion:function(){var t=this;return N(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:swal({title:"",text:"ต้องการสร้าง ประมาณการวัตถุดิบประจำปี แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," เวอร์ชั่นใหม่ ?"),showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(e){e&&(t.salePlans=[],t.salePlanSummary=null,t.yearlyPlanLines=[],t.createNewPlanVersion())}));case 1:case"end":return e.stop()}}),e)})))()},isAllowSelectPrintType:function(t){var e=!1;return"M06"==t&&(e=!0),e},isAllowSelectSaleType:function(t){var e=!1;return"M06"==t&&(e=!0),e},isAllowSelectIngredientGroup:function(t){var e=!1;return"M02"==t&&(e=!0),e},isAllowSelectSourceVersion:function(t,e){var a=!1;return t?0==e.length&&(a=!0):a=!0,a},isAllowCreateNewPlanVersion:function(t){var e=!0;return 0==t.length&&(e=!1),e},createNewPlanVersion:function(){var t=this;return N(i().mark((function e(){var a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.sourceVersions.length>0&&(t.sourceVersion=t.sourceVersions[0].version),a={period_year:t.periodYear,print_type:t.printType,sale_type:t.saleType,ingredient_group:t.ingredientGroup,source_version:t.sourceVersion},t.isLoading=!0,e.next=5,axios.post("/ajax/pm/plans/yearly/add-new-header",a).then((function(e){var a=e.data.data,n=a.message;if("success"==a.status){if(t.yearlyPlanHeader=a.plan_header?JSON.parse(a.plan_header):null,t.yearlyPlanVersion=a.version,t.yearlyPlanVersions=a.versions?JSON.parse(a.versions):[],t.sourceVersions.length>0){var i=t.sourceVersions.find((function(e){return e.version==t.yearlyPlanHeader.source_version}));t.sourceVersion=i?i.version:t.yearlyPlanHeader.source_version}swal("Success","สร้าง แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," version : ").concat(t.yearlyPlanVersion," )"),"success")}return"error"==a.status&&swal("เกิดข้อผิดพลาด","สร้าง แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(n),"error"),a})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","สร้าง แผนประมาณการจำหน่ายประจำปี : ".concat(t.periodYearLabel," | ").concat(e.message),"error")}));case 5:t.isLoading=!1,t.setUrlParams();case 7:case"end":return e.stop()}}),e)})))()},updateYearlyPlanSourceVersion:function(t,e,a,n,r,s){var o=this;return N(i().mark((function l(){var c;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c={period_year:t,print_type:e,sale_type:a,ingredient_group:n,source_version:r,version:s},o.isLoading=!0,i.next=4,axios.post("/ajax/pm/plans/yearly/update-source-version",c).then((function(t){var e=t.data.data,a=e.message;return e.status,"error"==e.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถแก้ไขข้อมูลครั้งที่ ของประมานการประจำปี ".concat(o.periodYearLabel," | ").concat(a),"error"),e})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถแก้ไขข้อมูลครั้งที่ ของประมานการประจำปี ".concat(o.periodYearLabel," | ").concat(t.message),"error")}));case 4:o.isLoading=!1;case 5:case"end":return i.stop()}}),l)})))()}}};const j=(0,p.Z)(V,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ibox"},[a("div",{staticClass:"ibox-content",staticStyle:{"min-height":"600px"}},[a("div",{staticClass:"tw-mb-4"},[a("div",{staticClass:"text-right tw-mb-2"},[a("button",{staticClass:"btn btn-inline-block btn-sm btn-success tw-w-32",attrs:{disabled:!t.isAllowCreateNewPlanVersion(t.yearlyPlanVersions)},on:{click:t.onCreateNewYearlyPlanVersion}},[a("i",{staticClass:"fa fa-plus tw-mr-1"}),t._v(" สร้าง \n                ")]),t._v(" "),a("button",{staticClass:"btn btn-inline-block btn-sm btn-primary tw-w-32",attrs:{disabled:!t.periodYear||0==t.yearlyPlanLines.length||!t.yearlyPlanHeader||"1"!=t.yearlyPlanHeader.status},on:{click:t.onSaveYearlyPlan}},[a("i",{staticClass:"fa fa-save tw-mr-1"}),t._v(" บันทึก \n                ")]),t._v(" "),a("button",{staticClass:"btn btn-inline-block btn-sm hover:tw-text-white tw-text-white tw-bg-purple-500 tw-border-purple-500 tw-w-70",attrs:{disabled:!t.periodYear||!t.sourceVersion||t.salePlans.length>0||t.yearlyPlanLines.length>0},on:{click:t.onGetSalePlans}},[a("i",{staticClass:"fa fa-list tw-mr-1"}),t._v(" "+t._s(t.getSalePlanLabel(t.organizationCode))+" \n                ")]),t._v(" "),a("button",{staticClass:"btn btn-inline-block btn-sm btn-info tw-w-40",attrs:{disabled:!t.periodYear||!t.salePlanSummary||!!t.yearlyPlanHeader&&"1"!=t.yearlyPlanHeader.status},on:{click:t.onGenerateYearlyPlanLines}},[a("i",{staticClass:"fa fa-calculator tw-mr-1"}),t._v(" ประมาณการใช้ \n                ")])]),t._v(" "),a("div",{staticClass:"text-right"},[a("button",{staticClass:"btn btn-inline-block btn-sm btn-white tw-w-32",on:{click:function(e){return t.$modal.show("modal-search-plan")}}},[a("i",{staticClass:"fa fa-search tw-mr-1"}),t._v(" ค้นหา \n                ")]),t._v(" "),a("button",{staticClass:"btn btn-inline-block btn-sm btn-primary tw-w-40",attrs:{disabled:!t.yearlyPlanHeader||"1"==t.yearlyPlanHeader.status}},[a("i",{staticClass:"fa fa-print tw-mr-1"}),t._v(" พิมพ์รายงาน \n                ")]),t._v(" "),t.isShowSubmitApprovalButton(t.organizationCode)?a("div",{staticClass:"tw-inline-block"},[a("button",{staticClass:"btn btn-inline-block btn-sm btn-warning tw-w-40",attrs:{disabled:!t.yearlyPlanHeader||"1"!=t.yearlyPlanHeader.status||0==t.yearlyPlanLines.length||t.isNewlyCreate||t.foundInvalidPlanLine},on:{click:t.onSubmitApproval}},[a("i",{staticClass:"fa fa-check-square tw-mr-1"}),t._v(" ส่งอนุมัติ \n                    ")])]):t._e(),t._v(" "),t.isShowSubmitYearlyPlanButton(t.organizationCode)?a("div",{staticClass:"tw-inline-block"},[a("button",{staticClass:"btn btn-inline-block btn-sm btn-warning tw-w-40",attrs:{disabled:!t.yearlyPlanHeader||"1"!=t.yearlyPlanHeader.status||0==t.yearlyPlanLines.length||t.isNewlyCreate||t.foundInvalidPlanLine},on:{click:t.onSubmitYearlyPlan}},[a("i",{staticClass:"fa fa-check-square tw-mr-1"}),t._v(" ส่งข้อมูลประมาณการ \n                    ")])]):t._e()])]),t._v(" "),a("hr"),t._v(" "),a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[t.isAllowSelectPrintType(t.organizationCode)?a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" ระบบการพิมพ์ ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"print_type",id:"input_print_type","select-options":t.printTypes,"option-key":"print_type_value","option-value":"print_type_value","option-label":"print_type_label",value:t.printType,filterable:!0},on:{onSelected:t.onPrintTypeChanged}})],1)]):t._e(),t._v(" "),t.isAllowSelectSaleType(t.organizationCode)?a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" ประเภทแผน ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"sale_type",id:"sale_type","select-options":t.saleTypes,"option-key":"value","option-value":"value","option-label":"description",value:t.saleType,filterable:!0},on:{onSelected:t.onSaleTypeChanged}})],1)]):t._e(),t._v(" "),t.isAllowSelectIngredientGroup(t.organizationCode)?a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" ประเภทวัตถุดิบ ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("pm-el-select",{attrs:{name:"ingredient_group",id:"ingredient_group","select-options":t.ingredientGroups,"option-key":"value","option-value":"value","option-label":"description",value:t.ingredientGroup,filterable:!0},on:{onSelected:t.onIngredientGroupChanged}})],1)]):t._e(),t._v(" "),a("div",{staticClass:"row form-group"},["M06"==t.organizationCode?a("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[t._v(" แผนประมาณการ "),a("br"),t._v(" จำหน่ายประจำปี ")]):a("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[t._v(" แผนประมาณการ "),a("br"),t._v(" ผลิตประจำปี ")]),t._v(" "),a("div",{staticClass:"col-md-3"},[a("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":t.periodYears,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:t.periodYear,filterable:!0},on:{onSelected:t.onYearlyPlanChanged}})],1),t._v(" "),a("label",{staticClass:"col-md-2 col-form-label tw-font-bold"},[t._v(" ครั้งที่ ")]),t._v(" "),a("div",{staticClass:"col-md-3"},[t.isAllowSelectSourceVersion(t.yearlyPlanHeader,t.yearlyPlanLines)?a("pm-el-select",{attrs:{name:"source_version",id:"source_version","select-options":t.sourceVersions,"option-key":"version","option-value":"version","option-label":"version",value:t.sourceVersion,filterable:!0},on:{onSelected:t.onSourceVersionChanged}}):t._e(),t._v(" "),t.isAllowSelectSourceVersion(t.yearlyPlanHeader,t.yearlyPlanLines)?t._e():a("p",{staticClass:"col-form-label"},[t._v(" "+t._s(t.sourceVersion?t.sourceVersion:"-")+" ")])],1)]),t._v(" "),a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" เวอร์ชั่น ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[t.yearlyPlanHeader?a("p",{staticClass:"col-form-label"},[t._v(" "+t._s(t.yearlyPlanHeader.version?t.yearlyPlanHeader.version:"-")+" ")]):t._e(),t._v(" "),t.yearlyPlanHeader?t._e():a("p",{staticClass:"col-form-label"},[t._v(" - ")])])])]),t._v(" "),a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" หน่วยงาน ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("p",{staticClass:"col-form-label"},[t._v(" "+t._s(t.department?t.department.description:"-")+" ")])])]),t._v(" "),a("div",{staticClass:"row form-group"},[a("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[t._v(" สถานะ ")]),t._v(" "),a("div",{staticClass:"col-md-8"},[t.yearlyPlanHeader?a("p",{staticClass:"col-form-label"},[t._v(" "+t._s(t.getPlanStatusDesc(t.yearlyPlanHeader.status))+" ")]):t._e(),t._v(" "),t.yearlyPlanHeader?t._e():a("p",{staticClass:"col-form-label"},[t._v(" - ")])])])])])]),t._v(" "),t.salePlans.length>0?a("hr"):t._e(),t._v(" "),t.salePlans.length>0?a("div",{staticClass:"tw-m-8"},[a("h3",[t._v(" "+t._s(t.getSalePlanLabel(t.organizationCode))+"  ")]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("table-sale-plans",{attrs:{"organization-code":t.organizationCode,"sale-plans":t.salePlans,"sale-plan-summary":t.salePlanSummary}})],1)])]):t._e(),t._v(" "),t.yearlyPlanLines.length>0?a("hr"):t._e(),t._v(" "),t.yearlyPlanLines.length>0?a("div",{staticClass:"tw-m-8"},[a("h3",[t._v(" รายการวัตถุดิบ ")]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("table-plan-lines",{attrs:{"plan-header":t.yearlyPlanHeader,"plan-lines":t.yearlyPlanLines,"plan-months":t.periodYearMonths,"uom-codes":t.uomCodes,"sale-plan-summary":t.salePlanSummary,"item-options":t.itemOptions},on:{onPlanLineChanged:t.onPlanLineChanged}})],1)])]):t._e()]),t._v(" "),a("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),a("modal-search-plan",{attrs:{"modal-name":"modal-search-plan","modal-width":"640","modal-height":"auto","organization-code":t.organizationCode,"period-years":t.periodYears,"period-year-value":t.periodYear,"print-types":t.printTypes,"print-type-value":t.printType,"sale-types":t.saleTypes,"sale-type-value":t.saleType,"ingredient-groups":t.ingredientGroups,"ingredient-group-value":t.ingredientGroup,"source-versions":t.sourceVersions,"source-version-value":t.sourceVersion,"yearly-plan-version-value":t.yearlyPlanVersion,"yearly-plan-versions":t.yearlyPlanVersions},on:{onSearchPlanVersion:t.onSearchPlanVersion}})],1)}),[],!1,null,null,null).exports},77790:(t,e,a)=>{var n=a(9546);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);(0,a(45346).Z)("395ad32a",n,!0,{})}}]);