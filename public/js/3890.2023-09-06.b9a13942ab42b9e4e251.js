(self.webpackChunk=self.webpackChunk||[]).push([[3890],{43890:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>m});var s=a(87757),n=a.n(s),i=a(30381),r=a.n(i);function o(t,e,a,s,n,i,r){try{var o=t[i](r),c=o.value}catch(t){return void a(t)}o.done?e(c):Promise.resolve(c).then(s,n)}function c(t){return function(){var e=this,a=arguments;return new Promise((function(s,n){var i=t.apply(e,a);function r(t){o(i,s,n,r,c,"next",t)}function c(t){o(i,s,n,r,c,"throw",t)}r(void 0)}))}}const l={props:["data","oldIput","transDate","pRequest","url","transBtn","profile"],computed:{secondaryUomList:function(){}},watch:{step:function(t,e){2==e&&1==t&&(this.input.item="",this.input.compare_item=""),3==e&&2==t&&(this.input.compare_item=""),3==e&&1==t&&(this.input.item="",this.input.compare_item="")}},data:function(){return{header:this.pHeader,user:this.profile,loading:!1,input:{item:"",compare_item:"",transfer_date:""},validate:{item:{msg:!1},compare_item:{msg:!1},transfer_date:{msg:!1}},step:1,process:{1:{html:"",can_next_step:!1},2:{html:"",can_next_step:!1},3:{html:"",can_next_step:!1}}}},mounted:function(){},methods:{setdate:function(t,e){var a=this;return c(n().mark((function s(){var i;return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return i=a,s.next=3,r()(t).format(i.transDate["js-format"]);case 3:i.input[e]=s.sent;case 4:case"end":return s.stop()}}),s)})))()},validateInput:function(t){var e=this;switch(t){case"transfer_date":e.validate.transfer_date.msg=!1,""!=e.input.transfer_date&&"Invalid date"!=e.input.transfer_date||(e.validate.transfer_date.msg="กรุณาระบุ วันที่");break;case"item":e.validate.item.msg=!1,""==e.input.item&&(e.validate.item.msg="กรุณาระบุ รหัสวัตถุดิบ");break;case"compare_item":e.validate.compare_item.msg=!1,""==e.input.compare_item&&(e.validate.compare_item.msg="กรุณาระบุ รหัสวัตถุดิบบนชั้นวางของ")}},scanMaterial:function(){var t=this;return c(n().mark((function e(){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=(a=t).step){e.next=4;break}if(a.input.transfer_date&&a.input.item){e.next=4;break}return e.abrupt("return");case 4:return a.loading=!0,e.next=7,axios.get(a.url.ajax_qrcode_check_materials_detail,{params:{item:a.input.item,transfer_date:a.input.transfer_date,compare_item:a.input.compare_item,step:a.step}}).then((function(t){var e=t.data.data;"S"==e.status&&(1==a.step?a.step=2:2==a.step?e.can_next_step&&(a.step=3,a.scanMaterial()):3==a.step&&(swal({title:"<br>ตรวจสอบวัตถุดิบสำเร็จ",type:"success",html:!0}),a.step=1),a.process[a.step].can_next_step=e.can_next_step,a.process[a.step].html=e.html),"S"!=t.data.data.status&&swal({title:"Error !",text:t.data.data.msg,type:"error",showConfirmButton:!0})})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){a.loading=!1}));case 7:return e.abrupt("return");case 8:case"end":return e.stop()}}),e)})))()}}};const m=(0,a(51900).Z)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ibox float-e-margins"},[a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"form-group mb-0 col-lg-6 col-md-6 col-sm-12 col-xs-12 offset-md-3"},[a("h1",{staticClass:"font-bold p-3 text-center"},[t._v(" ตรวจสอบวัตถุดิบ ")]),t._v(" "),1==t.step?a("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanMaterial(e)}}},[a("div",{staticClass:"form-group  row"},[t._m(0),t._v(" "),a("div",{staticClass:"col-9",on:{mouseleave:function(e){return t.validateInput("transfer_date")}}},[a("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{name:"input_date",id:"input_date",placeholder:"โปรดเลือกวันที่",value:t.input.transfer_date,format:t.transDate["js-format"]},on:{dateWasSelected:function(e){for(var a=arguments.length,s=Array(a);a--;)s[a]=arguments[a];return t.setdate.apply(void 0,s.concat(["transfer_date"]))}}}),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.transfer_date.msg?a("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.transfer_date.msg)+"\n                                    ")]):t._e()])],1)]),t._v(" "),a("div",{staticClass:"form-group  row"},[t._m(1),t._v(" "),a("div",{staticClass:"col-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.input.item,expression:"input.item"}],staticClass:"form-control",attrs:{placeholder:"สแกน QR Code ที่ชั้นวางของ",type:"text"},domProps:{value:t.input.item},on:{blur:function(e){return t.validateInput("item")},input:function(e){e.target.composing||t.$set(t.input,"item",e.target.value)}}}),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.item.msg?a("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.item.msg)+"\n                                    ")]):t._e()])],1)]),t._v(" "),a("div",{staticClass:"text-center"},[a("button",{staticClass:"btn btn-success btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.scanMaterial(e)}}},[a("i",{staticClass:"fa fa-qrcode"}),t._v("\n                                ตกลง\n                            ")])])]):t._e(),t._v(" "),2==t.step?a("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanMaterial(e)}}},[a("div",{domProps:{innerHTML:t._s(t.process[t.step].html)}}),t._v(" "),a("div",{staticClass:"hr-line-dashed"}),t._v(" "),a("div",{staticClass:"form-group  row"},[a("div",{staticClass:"col-sm-12"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.input.compare_item,expression:"input.compare_item"}],staticClass:"form-control",attrs:{placeholder:"รหัสวัตถุดิบบนชั้นวางของ",type:"text"},domProps:{value:t.input.compare_item},on:{blur:function(e){return t.validateInput("compare_item")},input:function(e){e.target.composing||t.$set(t.input,"compare_item",e.target.value)}}}),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.compare_item.msg?a("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.compare_item.msg)+"\n                                    ")]):t._e()])],1)]),t._v(" "),a("div",{staticClass:"text-center"},[a("button",{staticClass:"btn btn-danger btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){t.step=1}}},[a("i",{staticClass:"fa fa-times"}),t._v(" กลับ\n                            ")])])]):t._e(),t._v(" "),3==t.step?a("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanMaterial(e)}}},[a("div",{domProps:{innerHTML:t._s(t.process[t.step].html)}}),t._v(" "),a("div",{staticClass:"hr-line-dashed"}),t._v(" "),a("div",{staticClass:"text-center"},[t.process[t.step].can_next_step?a("button",{staticClass:"btn btn-success btn-lg btn-block",attrs:{disabled:!t.process[t.step].can_next_step,type:"button"},on:{click:t.scanMaterial}},[a("i",{staticClass:"fa fa-check"}),t._v(" ยืนยันตรวจสอบวัตถุดิบ\n                            ")]):t._e(),t._v(" "),a("button",{staticClass:"btn btn-danger btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){t.step=2}}},[a("i",{staticClass:"fa fa-times"}),t._v(" ยกเลิก\n                            ")])])]):t._e()])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-3 text-right"},[a("h3",{staticClass:"font-bold no-margins"},[t._v("วันที่ในเอกสาร:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-3 text-right"},[a("h3",{staticClass:"font-bold no-margins"},[t._v("รหัสวัตถุดิบ:")])])}],!1,null,null,null).exports}}]);