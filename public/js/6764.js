(self.webpackChunk=self.webpackChunk||[]).push([[6764],{86764:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>c});var r=o(87757),n=o.n(r);function a(t,e,o,r,n,a,s){try{var c=t[a](s),i=c.value}catch(t){return void o(t)}c.done?e(i):Promise.resolve(i).then(r,n)}const s={data:function(){return{tableData:[],options:[],cost_center:""}},computed:{sum_dl_absorption_rate:function(){var t=_.filter(this.tableData,(function(t){return!t.disable}));return _.sumBy(t,(function(t){return parseFloat(t.dl_absorption_rate)||0}))},sum_voh_absorption_rate:function(){var t=_.filter(this.tableData,(function(t){return!t.disable}));return _.sumBy(t,(function(t){return parseFloat(t.voh_absorption_rate)||0}))},sum_foh_absorption_rate:function(){var t=_.filter(this.tableData,(function(t){return!t.disable}));return _.sumBy(t,(function(t){return parseFloat(t.foh_absorption_rate)||0}))}},mounted:function(){this.getCostCenters()},methods:{getCostCenters:function(){var t=this;axios.get("/ct/ajax/cost_center/cost-center-view").then((function(e){t.options=e.data}))},sumTableData:function(){_.sumBy(this.data_test,(function(t){return t.percen_of_wage}));return{code:"",name:"รวม",percen_of_wage:0,percen_of_cp_vc:0,percen_of_cp_fe:0,disable:!0}},selectCostCenter:function(){var t,e=this;return(t=n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:axios.get("/ct/ajax/product_processes/".concat(e.cost_center)).then((function(t){console.log("selectCostCenter: ",t.data),e.tableData=t.data,e.tableData.push(e.sumTableData())}));case 1:case"end":return t.stop()}}),t)})),function(){var e=this,o=arguments;return new Promise((function(r,n){var s=t.apply(e,o);function c(t){a(s,r,n,c,i,"next",t)}function i(t){a(s,r,n,c,i,"throw",t)}c(void 0)}))})()},submitForm:function(){var t=_.filter(this.tableData,(function(t){return!t.disable})),e=[];t.forEach((function(t){e.push({id:t.cc_production_process_id,percen_of_wage:t.percen_of_wage,percen_of_cp_vc:t.percen_of_cp_vc,percen_of_cp_fe:t.percen_of_cp_fe})})),axios.put("/ct/ajax/product_processes/",e).then((function(t){swal("Success","บันทึกสำเร็จ","success")})).catch((function(t){swal("Error","ไม่สามารถบันทึกได้ | ".concat(t.response.data.error),"error")}))}}};const c=(0,o(51900).Z)(s,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-select",{attrs:{placeholder:"เลือกศูนย์ต้นทุน"},on:{change:t.selectCostCenter},model:{value:t.cost_center,callback:function(e){t.cost_center=e},expression:"cost_center"}},t._l(t.options,(function(t){return o("el-option",{key:t.cost_code,attrs:{label:t.description,value:t.cost_code}})})),1),t._v(" "),t.cost_center?o("div",[o("div",{staticClass:"mt-4"},[o("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.tableData}},[o("el-table-column",{attrs:{prop:"wip_step",label:"รหัสขั้นตอน",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{prop:"wip_step_desc",label:"ขั้นตอนการผลิต",width:"180",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{prop:"dl_absorption_rate",label:"%เทียบสำเร็จค่าแรง",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.disable?o("el-input-number",{staticStyle:{width:"100%"},attrs:{value:t.sum_dl_absorption_rate,placeholder:"%เทียบสำเร็จค่าแรง",disabled:e.row.disable,controls:!1,precision:2}}):o("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,controls:!1,precision:2,placeholder:"%เทียบสำเร็จค่าแรง",disabled:e.row.disable},model:{value:e.row.dl_absorption_rate,callback:function(o){t.$set(e.row,"dl_absorption_rate",o)},expression:"scope.row.dl_absorption_rate"}})]}}],null,!1,3980652853)}),t._v(" "),o("el-table-column",{attrs:{prop:"voh_absorption_rate",label:"%เทียบสำเร็จค่าใช้จ่ายผันแปร",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.disable?o("el-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"%เทียบสำเร็จค่าใช้จ่ายผันแปร",value:t.sum_voh_absorption_rate,disabled:e.row.disable,controls:!1,precision:2}}):o("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,controls:!1,precision:2,placeholder:"%เทียบสำเร็จค่าใช้จ่ายผันแปร"},model:{value:e.row.voh_absorption_rate,callback:function(o){t.$set(e.row,"voh_absorption_rate",o)},expression:"scope.row.voh_absorption_rate"}})]}}],null,!1,1594927495)}),t._v(" "),o("el-table-column",{attrs:{label:"%เทียบสำเร็จค่าใช้จ่ายคงที่",align:"center",prop:"foh_absorption_rate"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.disable?o("el-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"%เทียบสำเร็จค่าใช้จ่ายคงที่",value:t.sum_foh_absorption_rate,disabled:e.row.disable,controls:!1,precision:2}}):o("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,controls:!1,precision:2,placeholder:"%เทียบสำเร็จค่าใช้จ่ายคงที่"},model:{value:e.row.foh_absorption_rate,callback:function(o){t.$set(e.row,"foh_absorption_rate",o)},expression:"scope.row.foh_absorption_rate"}})]}}],null,!1,4076021607)})],1)],1),t._v(" "),o("div",{staticClass:"mt-4 text-right"},[o("el-button",{staticClass:"btn-success",attrs:{type:"success"},on:{click:function(e){return t.submitForm()}}},[t._v("บันทึก\n            ")])],1)]):t._e()],1)}),[],!1,null,"2498aaf6",null).exports}}]);