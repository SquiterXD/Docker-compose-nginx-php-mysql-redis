(self.webpackChunk=self.webpackChunk||[]).push([[2417],{29040:(t,e,s)=>{"use strict";s.d(e,{Z:()=>l});var a=s(23645),n=s.n(a)()((function(t){return t[1]}));n.push([t.id,".vld-overlay,.vld-shown{overflow:hidden}.vld-overlay{bottom:0;left:0;position:absolute;right:0;top:0;align-items:center;display:none;justify-content:center;z-index:9999}.vld-overlay.is-active{display:flex}.vld-overlay.is-full-page{z-index:9999;position:fixed}.vld-overlay .vld-background{bottom:0;left:0;position:absolute;right:0;top:0;background:#fff;opacity:.5}.vld-overlay .vld-icon,.vld-parent{position:relative}",""]);const l=n},34224:(t,e,s)=>{"use strict";s.d(e,{Z:()=>l});var a=s(23645),n=s.n(a)()((function(t){return t[1]}));n.push([t.id,".v--modal-overlay[data-v-200c1d66]{z-index:2000;padding-top:3rem;padding-bottom:3rem}",""]);const l=n},19371:(t,e,s)=>{"use strict";var a=s(93379),n=s.n(a),l=s(29040),i={insert:"head",singleton:!1};n()(l.Z,i),l.Z.locals},82417:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>q});var a=s(87757),n=s.n(a),l=s(80455),i=s.n(l),r=s(7398),o=s.n(r),c=(s(19371),s(30381)),u=s.n(c);function _(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function d(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?_(Object(s),!0).forEach((function(e){p(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function p(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function m(t,e,s,a,n,l,i){try{var r=t[l](i),o=r.value}catch(t){return void s(t)}r.done?e(o):Promise.resolve(o).then(a,n)}function f(t){return function(){var e=this,s=arguments;return new Promise((function(a,n){var l=t.apply(e,s);function i(t){m(l,a,n,i,r,"next",t)}function r(t){m(l,a,n,i,r,"throw",t)}i(void 0)}))}}const v={props:["modalName","modalWidth","modalHeight","sampleResultLine"],components:{Loading:o()},watch:{sampleResultLine:function(t){this.sampleResultLineData=t||null}},data:function(){return{isLoading:!1,width:this.modalWidth,sampleResultLineData:this.sampleResultLine?this.sampleResultLine:null}},created:function(){this.handleResize()},mounted:function(){},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},onDeleteResultLineImage:function(t){var e=this;return f(n().mark((function s(){var a;return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=d({},e.sampleResultLineData.uploadedImages[t]),s.next=3,e.deleteResultLineImage(e.sampleResultLineData,a);case 3:e.sampleResultLineData.uploadedImages.splice(t,1),e.$emit("onModalResultLineImageChanged",{sampleResultLine:e.sampleResultLineData});case 5:case"end":return s.stop()}}),s)})))()},deleteResultLineImage:function(t,e){var s=this;return f(n().mark((function a(){var l;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l={sample_result_line:JSON.stringify(t),uploaded_image:JSON.stringify(e)},s.isLoading=!0,a.next=4,axios.post("/qm/ajax/finished-products/delete-result-quality-line-image",l).then((function(t){var s=t.data.data,a=s.message;return"success"==s.status&&swal("Success","ลบรูปภาพ: ".concat(e.attribute1),"success"),"error"==s.status&&swal("Error","ไม่สามารถ ลบรูปภาพ: ".concat(e.attribute1," | ").concat(a),"error"),s})).catch((function(t){console.log(t),swal("Error","ไม่สามารถ ลบรูปภาพ: ".concat(e.attribute1," | ").concat(t.message),"error")}));case 4:s.isLoading=!1;case 5:case"end":return a.stop()}}),a)})))()},formatDateTh:function(t){return t?u()(t).add(543,"years").format("DD/MM/YYYY"):""}}};var h=s(93379),g=s.n(h),w=s(34224),y={insert:"head",singleton:!1};g()(w.Z,y);w.Z.locals;var b=s(51900);const x=(0,b.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"z-index":"100"}},[s("modal",{attrs:{name:t.modalName,width:t.width,scrollable:!0,height:t.modalHeight,shiftX:.3,shiftY:.3}},[s("div",{staticClass:"p-4 text-left"},[s("h3",{staticClass:"text-left"},[t._v(" ดูแนบรูปภาพ ")]),t._v(" "),s("hr",{staticClass:"tw-mt-1"}),t._v(" "),s("div",{staticStyle:{"min-height":"300px"}},t._l(t.sampleResultLineData.uploadedImages,(function(e,a){return s("div",{key:a,staticClass:"tw-py-2",staticStyle:{"border-bottom":"1px solid #f0f0f0"}},[s("a",{staticClass:"tw-inline-block",attrs:{href:"/qm/files/image/qm/finished-products/result-quality-line/"+e.file_name,target:"_blank"}},[s("span",{staticClass:"fa fa-picture-o tw-mr-1"}),t._v(" "+t._s(e.attribute1)+"\n                    ")]),t._v(" "),s("button",{staticClass:"btn btn-xs btn-outline tw-text-red-700 fa fa-times tw-pt-0",staticStyle:{"font-size":".9rem"},attrs:{type:"buttonn"},on:{click:function(e){return t.onDeleteResultLineImage(a)}}})])})),0),t._v(" "),s("hr",{staticClass:"tw-mt-1"}),t._v(" "),s("div",{staticClass:"text-right"},[s("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(e){return t.$modal.hide(t.modalName)}}},[t._v(" \n                    ปิด \n                ")])])])]),t._v(" "),s("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}})],1)}),[],!1,null,"200c1d66",null).exports;function C(t){return function(t){if(Array.isArray(t))return S(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return S(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return S(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,a=new Array(e);s<e;s++)a[s]=t[s];return a}function k(t,e,s,a,n,l,i){try{var r=t[l](i),o=r.value}catch(t){return void s(t)}r.done?e(o):Promise.resolve(o).then(a,n)}function R(t){return function(){var e=this,s=arguments;return new Promise((function(a,n){var l=t.apply(e,s);function i(t){k(l,a,n,i,r,"next",t)}function r(t){k(l,a,n,i,r,"throw",t)}i(void 0)}))}}function L(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function D(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?L(Object(s),!0).forEach((function(e){O(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function O(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const I={props:["authUser","showType","listBrands","listTestServerityCodes","approvalData","sample","items","resultHeaderItems","resultItems","resultItemLines","attachments","defaultData"],components:{Loading:o(),VueNumeric:i(),ModalShowResultLineImages:x},data:function(){var t=this;return{sampleData:JSON.parse(this.sample),specifications:JSON.parse(this.items),sampleResultHeaders:JSON.parse(this.resultHeaderItems).map((function(e){return D(D({},e),{},{selected_test_id:e.test_id,selected_test_code:e.test_code,selected_test_desc:e.test_desc,selected_test_unit:e.test_unit,selected_test_unit_desc:e.test_unit_desc,selected_optimal_value:t.getOptimalValue(JSON.parse(t.items),e),selected_min_value:e.min_value,selected_max_value:e.max_value,result_status:"",severity_level:"",test_serverity_code:"",additional_line_flag:null,uploadedImages:[],result_value:"RESULT_BY"==e.test_code?t.authUser.name:e.result_value,images:[]})})).sort((function(t,e){return t.seq-e.seq})),sampleResults:JSON.parse(this.resultItems).map((function(e){return{qm_process_seq:e.qm_process_seq,qm_process:e.qm_process,sample_qty:e.sample_qty,qc_unit_code:e.qc_unit_code,machine_description:e.machine_description,issue_not_found:t.checkIssueNotFoundValue(e,JSON.parse(t.resultItemLines)),show_input_issue_not_found:t.checkDisplayInputIssueNotFound(e,JSON.parse(t.resultItemLines))}})).sort((function(t,e){return t.qm_process_seq-e.qm_process_seq})),sampleResultLines:JSON.parse(this.resultItemLines).map((function(e){return D(D({},e),{},{check_list:e.check_list?e.check_list.trim():null,selected_test_id:e.test_id,selected_test_code:e.test_code,selected_test_desc:e.test_desc,selected_test_unit:e.test_unit,selected_test_unit_desc:e.test_unit_desc,selected_optimal_value:t.getOptimalValue(JSON.parse(t.items),e),selected_min_value:e.min_value,selected_max_value:e.max_value,result_value:e.result_value,result_status:t.calResultStatus(D(D({},e),{},{selected_min_value:e.min_value,selected_max_value:e.max_value,result_value:e.result_value})),failed_status:t.calFailedStatus(D(D({},e),{},{selected_min_value:e.min_value,selected_max_value:e.max_value,result_value:e.result_value})),cannot_get_result_flag:e.cannot_get_result_flag,cannot_get_result_reason:e.cannot_get_result_reason,optimal_result_flag:e.optimal_result_flag,severity_level:t.calSeverityLevel(e),test_serverity_code:e.test_serverity_code?e.test_serverity_code.toUpperCase():null,additional_line_flag:e.additional_line_flag?e.additional_line_flag:null,uploadedImages:t.getUplodedImages(e),cause_of_defect:e.cause_of_defect,images:[]})})).filter((function(t,e,s){return"Y"!=t.show_header_flag})),checkListItems:JSON.parse(this.items).map((function(t){return{qm_process:t.qm_process?t.qm_process.trim():null,check_list:t.check_list?t.check_list.trim():null}})).filter((function(t,e,s){return e===s.findIndex((function(e){return e.qm_process===t.qm_process&&e.check_list===t.check_list}))})),checkListTestItems:JSON.parse(this.items).map((function(e){return{qm_process:e.qm_process?e.qm_process.trim():null,check_list:e.check_list?e.check_list.trim():null,result_id:e.result_id,result_line_id:e.result_line_id,test_id:e.test_id,test_code:e.test_code,test_desc:e.test_desc,test_unit:e.test_unit,test_unit_desc:e.test_unit_desc,test_serverity_code:e.test_serverity_code?e.test_serverity_code.toUpperCase():null,optimal_value:t.getOptimalValue(JSON.parse(t.items),e),min_value:e.min_value,max_value:e.max_value}})).filter((function(t,e,s){return e===s.findIndex((function(e){return e.qm_process===t.qm_process&&e.check_list===t.check_list&&e.test_id===t.test_id}))})),showedModalSampleResultLine:[],isLoading:!1}},mounted:function(){var t=this;this.sampleResultLines.forEach(function(){var e=R(n().mark((function e(s,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.test_serverity_code=s.test_serverity_code?s.test_serverity_code.toUpperCase():t.calTestSeverityCode(s);case 1:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}())},methods:{getTestData:function(t){var e=JSON.parse(this.resultItems).find((function(e){return e.test_id==t.test_id}));return{test_id:e?e.test_id:"",test_code:e?e.test_code:"",test_desc:e?e.test_desc:"",test_unit:e?e.test_unit:"",optimal_value:e?this.getOptimalValue(this.specifications,e):"",min_value:e?e.min_value:"",max_value:e?e.max_value:""}},getUplodedImages:function(t){return JSON.parse(this.attachments).filter((function(e){return e.attribute2==t.result_id}))},getOptimalValue:function(t,e){var s=t.find((function(t){return t.test_id==e.test_id}));return s?s.optimal_value:""},getBrandLabel:function(t){var e="";if(t){var s=this.listBrands.find((function(e){return e.brand_value==t}));e=s?s.brand_label:""}return e},onResultValueChanged:function(t,e,s){var a=this;this.calResultStatus(s),this.calSeverityLevel(s),"0"!=s.result_value&&(e.issue_not_found=!1),e.show_input_issue_not_found=this.checkDisplayInputIssueNotFound(e,this.sampleResultLines),this.sampleResultLines.filter((function(t){return t.qm_process==s.qm_process&&t.check_list==s.check_list&&t.test_id!=s.test_id})).forEach(function(){var t=R(n().mark((function t(e,s){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.result_value||(e.result_value="0",a.calResultStatus(e),a.calSeverityLevel(e));case 1:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}())},checkDisplayInputIssueNotFound:function(t,e){var s=!1;return e.filter((function(e){return t.qm_process==e.qm_process})).find((function(t){return null!=t.result_value&&""!=t.result_value}))||(s=!0),s},checkIssueNotFoundValue:function(t,e){var s=e.filter((function(e){return e.qm_process==t.qm_process})),a=s.filter((function(t){return"0"==t.result_value}));return s.length==a.length},calSeverityLevel:function(t){console.log("item : ",t);var e="";return t.result_value&&(e="NONE",t.high_level_minor&&parseFloat(t.result_value)>=parseFloat(t.high_level_minor)&&(e="MINOR"),t.high_level_major&&parseFloat(t.result_value)>=parseFloat(t.high_level_major)&&(e="MAJOR"),t.high_level_critical&&parseFloat(t.result_value)>=parseFloat(t.high_level_critical)&&(e="CRITICAL")),t.severity_level=e,e},calResultStatus:function(t){var e="";return t.selected_min_value&&t.selected_max_value&&t.result_value&&(e=parseFloat(t.result_value)>=parseFloat(t.selected_min_value)&&parseFloat(t.result_value)<=parseFloat(t.selected_max_value)?"PASSED":"FAILED",this.calFailedStatus(t)),t.result_status=e,e},calFailedStatus:function(t){var e="";return t.selected_min_value&&t.selected_max_value&&t.result_value&&(parseFloat(t.result_value)<parseFloat(t.selected_min_value)&&(e="UNDER"),parseFloat(t.result_value)>parseFloat(t.selected_max_value)&&(e="OVER")),t.failed_status=e,e},calTestSeverityCode:function(t){console.log("item : ",t);var e=this.checkListTestItems.find((function(e){return e.check_list==t.check_list&&e.test_id==t.test_id}));console.log("testItem : ",e);var s=e?e.test_serverity_code:"";return t.test_serverity_code=s,s},onHeaderResultChanged:function(t,e){e.result_value=t},onIssueNotFouldCheckBoxChanged:function(t,e){var s=this;(e.issue_not_found=t,1==t)&&this.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process})).forEach((function(t){t.result_value="0",s.calResultStatus(t),s.calSeverityLevel(t)}))},onOptimalResultCheckBoxChanged:function(t,e){var s=this,a=null,l=null,i=null;1==t&&(a=!1,l="",i="0"),this.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process&&t.check_list==e.check_list})).forEach(function(){var e=R(n().mark((function e(r,o){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.optimal_result_flag=t,r.cannot_get_result_flag=null!==a?a:r.cannot_get_result_flag,r.cannot_get_result_reason=null!==l?l:r.cannot_get_result_reason,r.result_value=null!==i?i:r.result_value,s.calResultStatus(r),s.calSeverityLevel(r);case 6:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}())},onCannotGetResultCheckBoxChanged:function(t,e){var s=this,a=null,l=null,i=null;1==t?(l=!1,i="0"):a="",this.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process&&t.check_list==e.check_list})).forEach(function(){var e=R(n().mark((function e(r,o){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.cannot_get_result_flag=t,r.cannot_get_result_reason=null!==a?a:r.cannot_get_result_reason,r.optimal_result_flag=null!==l?l:r.optimal_result_flag,r.result_value=null!==i?i:r.result_value,s.calResultStatus(r),s.calSeverityLevel(r);case 6:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}())},onCannotGetResultReasonChanged:function(t,e){var s=e.cannot_get_result_reason;this.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process&&t.check_list==e.check_list})).forEach(function(){var t=R(n().mark((function t(e,a){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.cannot_get_result_reason=s;case 1:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}())},onSelectedCheckListItem:function(t,e){e.check_list=t;var s=this.checkListTestItems.find((function(s){return s.qm_process==e.qm_process&&s.check_list==t}));this.onSelectedCheckListTestItem(s.test_id,e)},onSelectedCheckListTestItem:function(t,e){var s=this.checkListTestItems.find((function(s){return s.check_list==e.check_list&&s.test_id==t}));e.result_id=s.result_id,e.result_line_id=s.result_line_id,e.selected_test_id=s.test_id,e.selected_test_code=s.test_code,e.selected_test_desc=s.test_desc,e.selected_optimal_value=this.getOptimalValue(this.specifications,s),e.selected_min_value=s.min_value,e.selected_max_value=s.max_value,this.calResultStatus(e),this.calSeverityLevel(e),this.calTestSeverityCode(e)},onSelectedTestServerityCode:function(t,e){e.test_serverity_code=t},onAddNewResultLine:function(t){t.issue_not_found=!1;var e=D({},this.sampleResultLines.find((function(e){return e.qm_process==t.qm_process})));e.additional_line_flag="Y",e.result_value="",e.result_status=null,e.severity_level="",e.test_serverity_code="",e.optimal_result_flag=!1,e.cannot_get_result_flag=!1,e.cannot_get_result_reason="";var s=this.checkListTestItems.find((function(s){return s.qm_process==t.qm_process&&s.check_list==e.check_list&&s.test_id!=e.selected_test_id}));e.result_id=s?s.result_id:null,e.result_line_id=s?s.result_line_id:null,e.selected_test_id=s?s.test_id:null,e.selected_test_code=s?s.test_code:null,e.selected_test_desc=s?s.test_desc:null,e.selected_optimal_value=s?this.getOptimalValue(this.specifications,s):null,e.selected_min_value=s?s.min_value:null,e.selected_max_value=s?s.max_value:null,this.sampleResultLines.push(e)},onRemoveResultLine:function(t){var e=this.sampleResultLines.findIndex((function(e){return e==t}));e>0&&this.sampleResultLines.splice(e,1)},validateBeforeChooseImages:function(t,e,s){var a=this,n="finished_products_result_quality_line_image_".concat(e,"_").concat(s);"PASSED"==t.result_status?swal({title:"",text:"ค่าที่ตรวจสอบอยู่ในเกณฑ์มาตรฐาน ต้องการที่จะแนบรูปภาพใช่หรือไม่ ?",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(t){t&&a.$refs[n][0].click()})):this.$refs[n][0].click()},validateImages:function(t,e){var s=JSON.parse(this.defaultData).upload_max_file_size,a=1024*s*1024,n=C(t.target.files);n.filter((function(t){return t.size<a})).length<n.length?swal("Error","สามารถแนบรูป ได้ขนาดไม่เกิน ".concat(s," MB, กรุณาอัพโหลดใหม่อีกครั้ง"),"error"):n.length>1?(swal("Error","สามารถแนบรูป ได้ไม่เกิน ".concat(1," รูป"),"error"),e.images=n.slice(0,1)):e.images=n},onDeleteResultLineImage:function(t,e){t.images.splice(e,1)},onSubmitSampleResult:function(t){var e=this;return R(n().mark((function t(){var s,a,l,i,r,o,c,u,_,d,p,m,f,v;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e,!(a=e.validateBeforeSave(e.sampleData,e.sampleResultHeaders,e.sampleResultLines)).valid){t.next=44;break}return(l=new FormData).append("organization_code",e.sampleData.organization_code?e.sampleData.organization_code:""),l.append("oracle_sample_id",e.sampleData.oracle_sample_id?e.sampleData.oracle_sample_id:""),l.append("sample_no",e.sampleData.sample_no?e.sampleData.sample_no:""),l.append("sample_desc",e.sampleData.sample_desc?e.sampleData.sample_desc:""),l.append("inventory_item_id",e.sampleData.inventory_item_id?e.sampleData.inventory_item_id:""),l.append("item_number",e.sampleData.item_number?e.sampleData.item_number:""),l.append("item_desc",e.sampleData.item_desc?e.sampleData.item_desc:""),l.append("date_drawn",e.sampleData.date_drawn?e.sampleData.date_drawn:""),l.append("sample_disposition",e.sampleData.sample_disposition?e.sampleData.sample_disposition:""),l.append("sample_disposition_desc",e.sampleData.sample_disposition_desc?e.sampleData.sample_disposition_desc:""),l.append("sample_id",e.sampleData.sample_id?e.sampleData.sample_id:""),l.append("department_code",e.sampleData.department_code?e.sampleData.department_code:""),l.append("qm_group",e.sampleData.qm_group?e.sampleData.qm_group:""),l.append("organization_id",e.sampleData.organization_id?e.sampleData.organization_id:""),l.append("subinventory_code",e.sampleData.subinventory_code?e.sampleData.subinventory_code:""),l.append("locator_id",e.sampleData.locator_id?e.sampleData.locator_id:""),l.append("sample_date",e.sampleData.sample_date?e.sampleData.sample_date:""),l.append("batch_id",e.sampleData.batch_id?e.sampleData.batch_id:""),l.append("qc_area",e.sampleData.qc_area?e.sampleData.qc_area:""),l.append("machine_set",e.sampleData.machine_set?e.sampleData.machine_set:""),l.append("program_code",e.sampleData.program_code?e.sampleData.program_code:""),i=[].concat(C(e.sampleResultHeaders),C(e.sampleResultLines)),r=i.map((function(t,e){var s={result_id:t.result_id,test_id:t.selected_test_id,test_code:t.selected_test_code,test_desc:t.selected_test_desc,optimal_value:t.selected_optimal_value,min_value:t.selected_min_value,max_value:t.selected_max_value,result_status:t.result_status?t.result_status:"",result_value:t.result_value?t.result_value:"",cannot_get_result_flag:1==t.cannot_get_result_flag?"Y":"N",cannot_get_result_reason:t.cannot_get_result_reason?t.cannot_get_result_reason:"",optimal_result_flag:1==t.optimal_result_flag?"Y":"N",test_serverity_code:t.test_serverity_code?t.test_serverity_code:"",show_header_flag:t.show_header_flag,additional_line_flag:t.additional_line_flag?t.additional_line_flag:null,images:""};return t.images.length>0&&(s.images=t.images.map((function(t,s){return l.append("image_".concat(e,"_").concat(s),t),"image_".concat(e,"_").concat(s)}))),s})),l.append("result_quality_lines",JSON.stringify(r)),e.isLoading=!0,o="success",c=e.sampleData.sample_disposition,u=e.sampleData.sample_disposition_desc,_=e.sampleData.severity_level_minor,d=e.sampleData.severity_level_major,p=e.sampleData.severity_level_critical,m=e.sampleData.test_serverity_code_minor,f=e.sampleData.test_serverity_code_major,v=e.sampleData.test_serverity_code_critical,t.next=40,axios.post("/qm/ajax/finished-products/result",l).then((function(t){var e=t.data.data,a=e.message,n=e.sample?JSON.parse(e.sample):null;return o=e.status,n&&(c=n.sample_disposition,u=n.sample_disposition_desc,_=n.severity_level_minor,d=n.severity_level_major,p=n.severity_level_critical,m=n.test_serverity_code_minor,f=n.test_serverity_code_major,v=n.test_serverity_code_critical),"success"==e.status&&swal("Success","บันทึกลงผลการตรวจสอบคุณภาพกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no," )"),"success"),"error"==e.status&&swal("Error","บันทึกลงผลการตรวจสอบคุณภาพกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no,") | ").concat(a),"error"),e})).catch((function(t){console.log(t),o="error",swal("Error","บันทึกลงผลการตรวจสอบคุณภาพกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(e.sampleData.sample_no,") | ").concat(t.message),"error")}));case 40:e.isLoading=!1,e.$emit("onSampleResultSubmitted",{status:o,sample_no:e.sampleData.sample_no,sample_disposition:c,sample_disposition_desc:u,severity_level_minor:_,severity_level_major:d,severity_level_critical:p,test_serverity_code_minor:m,test_serverity_code_major:f,test_serverity_code_critical:v}),t.next=45;break;case 44:swal("เกิดข้อผิดพลาด","".concat(a.message),"error");case 45:case"end":return t.stop()}}),t)})))()},validateBeforeSave:function(t,e,s){var a={valid:!0,message:""},n=e.find((function(t){return"Y"==t.brand_flag}));return n&&(n.result_value||(a.valid=!1,a.message='กรูณากรอกข้อมูล "'.concat(n.selected_test_desc,'"'))),s.filter((function(t){return!t.result_value})).length>0&&(a.valid=!1,a.message='กรูณากรอกข้อมูล "ผลการตรวจสอบ" ให้ครบถ้วน'),s.filter((function(t){return 1==t.cannot_get_result_flag&&!t.cannot_get_result_reason})).length>0&&(a.valid=!1,a.message='กรูณากรอกข้อมูล "เหตุผลที่ไม่สามารถเก็บข้อมูลได้" ให้ครบถ้วน'),a},onSubmitCauseOfDefect:function(t){var e=this;return R(n().mark((function t(){var s,a,l,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e,(a=new FormData).append("organization_code",e.sampleData.organization_code?e.sampleData.organization_code:""),a.append("oracle_sample_id",e.sampleData.oracle_sample_id?e.sampleData.oracle_sample_id:""),a.append("sample_no",e.sampleData.sample_no?e.sampleData.sample_no:""),l=[].concat(C(e.sampleResultHeaders),C(e.sampleResultLines)),i=l.map((function(t,e){return{result_id:t.result_id,test_id:t.selected_test_id,test_code:t.selected_test_code,test_desc:t.selected_test_desc,optimal_value:t.selected_optimal_value,cause_of_defect:t.cause_of_defect?t.cause_of_defect:""}})),a.append("result_quality_lines",JSON.stringify(i)),e.isLoading=!0,"success",t.next=12,axios.post("/qm/ajax/finished-products/defect",a).then((function(t){var e=t.data.data,a=e.message;e.sample&&JSON.parse(e.sample);return e.status,"success"==e.status&&swal("Success","บันทึกสาเหตุความผิดปกติกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no," )"),"success"),"error"==e.status&&swal("Error","บันทึกสาเหตุความผิดปกติกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no,") | ").concat(a),"error"),e})).catch((function(t){console.log(t),"error",swal("Error","บันทึกสาเหตุความผิดปกติกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(e.sampleData.sample_no,") | ").concat(t.message),"error")}));case 12:e.isLoading=!1;case 13:case"end":return t.stop()}}),t)})))()},onCancelSampleResult:function(t){this.$emit("onCancelSampleResult",t)},onShowModalSampleResultLineImages:function(t){this.showedModalSampleResultLine=t,window.scrollTo(0,150),this.$modal.show("modal-show-result-line-images")},onModalResultLineImageChanged:function(t){var e=this;return R(n().mark((function s(){var a;return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:a=t.sampleResultLine,e.sampleResultLines=e.sampleResultLines.map((function(t){var e=[];return e=a.result_line_id==t.result_line_id&&a.selected_test_id==t.selected_test_id?a.uploadedImages:t.uploadedImages,D(D({},t),{},{uploadedImages:e})}));case 2:case"end":return s.stop()}}),s)})))()}}};const q=(0,b.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tw-ml-5 tw-mr-20 tw-py-2"},[s("table",{staticClass:"table table-borderless-horizontal mb-0"},[s("thead",[s("tr",{staticClass:"tw-bg-opacity-40 tw-bg-blue-100"},[s("th",{staticClass:"tw-text-gray-600",staticStyle:{"z-index":"auto"},attrs:{width:"2%"}},[t._v("\n                    กระบวนการ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"10%"}},[t._v("\n                    รายการตรวจสอบ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600",staticStyle:{"z-index":"auto"},attrs:{width:"15%"}},[t._v("\n                    ข้อมูลการตรวจสอบ/ความผิดปกติ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{colspan:"2",width:"12%"}},[t._v("\n                    จำนวนที่พบ/ผลการตรวจสอบ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}},[t._v("\n                    ค่าOPTIMAL\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"5%"}},[t._v("\n                    อยู่ในช่วงควบคุม\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}},[t._v("\n                    ผลปกติ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}},[t._v("\n                    ไม่สามารถลงผลการตรวจสอบได้\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"10%"}},[t._v("\n                    เหตุผลที่ไม่สามารถเก็บข้อมูลได้\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}}),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"6%"}},[t._v("\n                    ระดับความรุนแรงของความผิดปกติ (จำนวน)\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"6%"}},[t._v("\n                    ระดับความรุนแรงของความผิดปกติ (อาการ)\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto","min-width":"100px"},attrs:{width:"7%"}},["result"!=t.showType?s("span",[t._v(" รูปภาพ ")]):t._e()]),t._v(" "),"result"==t.showType?s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto","min-width":"100px"},attrs:{width:"7%"}},[t._v("\n                    แนบรูปภาพ\n                ")]):t._e(),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto","min-width":"100px"},attrs:{width:"7%"}},[t._v("\n                    รูปภาพตัวอย่าง\n                ")]),t._v(" "),"defect"==t.showType?s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"10%"}},[t._v("\n                    สาเหตุ\n                ")]):t._e()])]),t._v(" "),t.sampleResults.length>0?s("tbody",[t._m(0),t._v(" "),t._l(t.sampleResultHeaders,(function(e,a){return s("tr",{key:"header_"+a},[s("td",{staticClass:"tw-text-xs md:tw-table-cell tw-text-blue-600 tw-font-bold tw-hidden"}),t._v(" "),s("td",{staticClass:"tw-text-xs"}),t._v(" "),s("td",{staticClass:"tw-text-xs"},[s("div",{staticClass:"tw-py-2"},[t._v("\n                        "+t._s(e.selected_test_desc)+"\n                    ")])]),t._v(" "),s("td",{attrs:{colspan:"2"}},["result"==t.showType&&"Y"!=e.read_only?s("div",["Y"==e.brand_flag?[s("div",{class:["qm-el-select-required"]},[s("qm-el-select",{attrs:{id:"input_header_result_value_"+a,name:"header_result_value_"+a,"option-key":"brand_value","option-value":"brand_value","option-label":"brand_label","select-options":t.listBrands,value:e.result_value,size:"small",clearable:!0,filterable:!0},on:{onSelected:function(s){return t.onHeaderResultChanged(s,e)}}})],1)]:e.test&&"Y"==e.test.time_flag?[s("qm-timepicker",{attrs:{id:"input_header_result_value_"+a,name:"header_result_value_"+a,value:e.result_value},on:{change:function(s){return t.onHeaderResultChanged(s,e)}}})]:"RESULT_BY"==e.selected_test_code?[s("div",{staticClass:"tw-py-2"},[t._v("\n                                "+t._s(t.authUser?t.authUser.name:"-")+"\n                            ")])]:"N"==e.data_type_code?[s("input",{directives:[{name:"model",rawName:"v-model",value:e.result_value,expression:"sampleResultHeader.result_value"}],staticClass:"form-control input-sm text-center",attrs:{id:"input_header_result_value_"+a,type:"number",name:"header_result_value_"+a,placeholder:""},domProps:{value:e.result_value},on:{input:function(s){s.target.composing||t.$set(e,"result_value",s.target.value)}}})]:[s("input",{directives:[{name:"model",rawName:"v-model",value:e.result_value,expression:"sampleResultHeader.result_value"}],staticClass:"form-control input-sm text-center",attrs:{id:"input_header_result_value_"+a,type:"text",name:"header_result_value_"+a,placeholder:""},domProps:{value:e.result_value},on:{input:function(s){s.target.composing||t.$set(e,"result_value",s.target.value)}}})]],2):t._e(),t._v(" "),"result"!=t.showType||"Y"==e.read_only?s("div",{staticClass:"tw-px-2"},["Y"==e.brand_flag?[t._v("\n                            "+t._s(e.result_value?t.getBrandLabel(e.result_value):"-")+"\n                        ")]:[t._v("\n                            "+t._s(e.result_value)+"\n                        ")]],2):t._e()]),t._v(" "),s("td",{attrs:{colspan:"9"}})])})),t._v(" "),t._l(t.sampleResults,(function(e,a){return[s("tr",{key:""+a},[s("td",{staticClass:"tw-text-xs tw-bg-opacity-60 tw-bg-gray-200 tw-font-bold",attrs:{colspan:"16"}},[s("div",[t._v(" "+t._s(e.qm_process)+" : "+t._s(e.machine_description)+" จำนวนตัวอย่าง "+t._s(e.sample_qty)+" "+t._s(e.qc_unit_code)+"  ")])])]),t._v(" "),t._l(t.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process})),(function(n,l){return s("tr",{key:a+"-"+l},[s("td",{staticClass:"tw-text-right tw-text-xs md:tw-table-cell tw-text-blue-600 tw-font-bold tw-hidden"},["Y"==n.additional_line_flag&&"result"==t.showType?s("div",{staticClass:"tw-pt-1"},[s("button",{staticClass:"btn btn-xs btn-danger",on:{click:function(e){return t.onRemoveResultLine(n)}}},[s("span",{staticClass:"fa fa-times"})])]):t._e()]),t._v(" "),s("td",{staticClass:"tw-text-xs"},["Y"!=n.additional_line_flag||"result"!=t.showType?s("div",{},[t._v("\n                            "+t._s(n.check_list)+"\n                            "),"Y"!=n.optional_ind?s("span",{staticClass:"tw-text-red-600"},[t._v(" * ")]):t._e()]):t._e(),t._v(" "),"Y"==n.additional_line_flag&&"result"==t.showType?s("div",[s("qm-el-select",{attrs:{id:"input_check_list_"+a+"_"+l,name:"check_list["+a+"]["+l+"]","option-key":"check_list","option-value":"check_list","option-label":"check_list","select-options":t.checkListItems.filter((function(t){return t.qm_process==n.qm_process})),value:n.check_list,size:"small",clearable:!1,filterable:!0},on:{onSelected:function(e){return t.onSelectedCheckListItem(e,n)}}})],1):t._e()]),t._v(" "),s("td",{staticClass:"tw-text-xs"},[s("div",["result"==t.showType&&"Y"!=n.read_only?s("div",[s("qm-el-select",{attrs:{id:"input_test_id_"+a+"_"+l,name:"test_id["+a+"]["+l+"]","option-key":"test_id","option-value":"test_id","option-label":"test_desc","select-options":t.checkListTestItems.filter((function(t){return t.qm_process==n.qm_process&&t.check_list==n.check_list})),value:n.selected_test_id,size:"small",clearable:!1,filterable:!0},on:{onSelected:function(e){return t.onSelectedCheckListTestItem(e,n)}}})],1):s("div",[t._v("\n                                "+t._s(n.selected_test_desc)+"\n                            ")])])]),t._v(" "),s("td",{staticClass:"text-center"},[s("div",["result"!=t.showType||"Y"==n.read_only?[s("input",{staticClass:"form-control input-sm text-right tw-border-white",staticStyle:{"background-color":"#ffffff","max-width":"100px"},attrs:{type:"text",disabled:""},domProps:{value:n.result_value?n.result_value:"-"}})]:"N"==e.data_type_code?[s("input",{directives:[{name:"model",rawName:"v-model",value:n.result_value,expression:"sampleResultLine.result_value"}],staticClass:"form-control input-sm text-center",staticStyle:{"max-width":"100px"},attrs:{id:"input_result_value_"+a+"_"+l,name:"result_value_"+a+"_"+l,type:"number",disabled:n.optimal_result_flag||n.cannot_get_result_flag,placeholder:""},domProps:{value:n.result_value},on:{change:function(s){return t.onResultValueChanged(s,e,n)},input:function(e){e.target.composing||t.$set(n,"result_value",e.target.value)}}})]:[s("input",{directives:[{name:"model",rawName:"v-model",value:n.result_value,expression:"sampleResultLine.result_value"}],staticClass:"form-control input-sm text-center",staticStyle:{"max-width":"100px"},attrs:{id:"input_result_value_"+a+"_"+l,name:"result_value_"+a+"_"+l,type:"text",disabled:n.optimal_result_flag||n.cannot_get_result_flag,placeholder:""},domProps:{value:n.result_value},on:{change:function(s){return t.onResultValueChanged(s,e,n)},input:function(e){e.target.composing||t.$set(n,"result_value",e.target.value)}}})]],2)]),t._v(" "),s("td",{staticClass:"text-left tw-text-xs md:tw-table-cell tw-hidden"},[s("div",{},[t._v(" "+t._s(n.selected_test_unit_desc)+" ")])]),t._v(" "),s("td",{staticClass:"text-right tw-text-xs md:tw-table-cell tw-hidden"},[s("input",{staticClass:"form-control input-sm text-right tw-border-white",staticStyle:{"background-color":"#ffffff"},attrs:{type:"text",disabled:""},domProps:{value:n.selected_optimal_value}})]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["PASSED"==n.result_status?s("span",{staticClass:"fa fa-2x fa-check-circle tw-text-green-500"}):t._e(),t._v(" "),"FAILED"==n.result_status?s("span",{staticClass:"fa fa-2x fa-times tw-text-red-500"}):t._e(),t._v(" "),n.result_status?t._e():s("span",{staticClass:"fa fa-2x fa-minus"})]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["result"==t.showType?s("div",{staticClass:"tw-mt-2"},[s("qm-el-checkbox",{attrs:{value:n.optimal_result_flag,label:"",name:"optimal_result_flag_"+a,id:"optimal_result_flag_"+a,size:"medium"},on:{change:function(e){return t.onOptimalResultCheckBoxChanged(e,n)}}})],1):s("div",[n.optimal_result_flag?s("span",{staticClass:"fa fa-2x fa-check-circle tw-text-red-500"}):t._e()])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["result"==t.showType?s("div",{staticClass:"tw-mt-2"},[s("qm-el-checkbox",{attrs:{value:n.cannot_get_result_flag,label:"",name:"cannot_get_result_flag_"+a,id:"input_cannot_get_result_flag_"+a,size:"medium"},on:{change:function(e){return t.onCannotGetResultCheckBoxChanged(e,n)}}})],1):s("div",[n.cannot_get_result_flag?s("span",{staticClass:"fa fa-2x fa-check-circle tw-text-red-500"}):t._e()])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["result"==t.showType?s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:n.cannot_get_result_reason,expression:"sampleResultLine.cannot_get_result_reason"}],staticClass:"form-control input-sm tw-text-xs text-left",style:{backgroundColor:n.cannot_get_result_flag?"#fffbe4":""},attrs:{type:"text",disabled:!n.cannot_get_result_flag,placeholder:"เหตุผลที่ไม่สามารถเก็บข้อมูล"},domProps:{value:n.cannot_get_result_reason},on:{blur:function(e){return t.onCannotGetResultReasonChanged(e,n)},input:function(e){e.target.composing||t.$set(n,"cannot_get_result_reason",e.target.value)}}})]):s("div",{staticClass:"tw-py-2"},[n.cannot_get_result_flag?s("span",[t._v("\n                                "+t._s(n.cannot_get_result_reason)+"\n                            ")]):t._e()])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["UNDER"==n.failed_status?s("span",{staticClass:"fa fa-2x fa-arrow-down tw-text-blue-500"}):"OVER"==n.failed_status?s("span",{staticClass:"fa fa-2x fa-arrow-up tw-text-red-500"}):t._e()]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},[n.severity_level?"NONE"==n.severity_level?s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")]):"MINOR"==n.severity_level?s("div",{staticClass:"tw-text-blue-500 tw-font-bold"},[t._v(" MINOR ")]):"MAJOR"==n.severity_level?s("div",{staticClass:"tw-text-yellow-500 tw-font-bold"},[t._v(" MAJOR ")]):"CRITICAL"==n.severity_level?s("div",{staticClass:"tw-text-red-700 tw-font-bold"},[t._v(" CRITICAL ")]):t._e():s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},["result"==t.showType&&"Y"!=n.read_only?s("div",[s("qm-el-select",{attrs:{id:"input_test_serverity_code_"+a+"_"+l,name:"test_serverity_code["+a+"]["+l+"]","option-key":"value","option-value":"value","option-label":"label","select-options":t.listTestServerityCodes,value:n.test_serverity_code,size:"small",clearable:!1,filterable:!0},on:{onSelected:function(e){return t.onSelectedTestServerityCode(e,n)}}})],1):s("div",[n.test_serverity_code?"NONE"==n.test_serverity_code?s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")]):"MINOR"==n.test_serverity_code?s("div",{staticClass:"tw-text-blue-500 tw-font-bold"},[t._v(" MINOR ")]):"MAJOR"==n.test_serverity_code?s("div",{staticClass:"tw-text-yellow-500 tw-font-bold"},[t._v(" MAJOR ")]):"CRITICAL"==n.test_serverity_code?s("div",{staticClass:"tw-text-red-700 tw-font-bold"},[t._v(" CRITICAL ")]):t._e():s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")])])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},t._l(n.uploadedImages,(function(e,a){return s("a",{key:a,staticClass:"btn btn-xs btn-outline btn-primary tw-py-2",attrs:{href:"/qm/files/image/qm/finished-products/result-quality-line/"+e.file_name,target:"_blank"}},[s("span",{staticClass:"fa fa-picture-o tw-mr-1"}),t._v(" ดูแนบรูปภาพ\n                        ")])})),0),t._v(" "),"result"==t.showType?s("td",{staticClass:"text-center tw-text-xs"},[s("button",{staticClass:"btn btn-xs btn-outline btn-success tw-py-2",attrs:{type:"button"},on:{click:function(e){return t.validateBeforeChooseImages(n,a,l)}}},[s("i",{staticClass:"fa fa fa-upload tw-mr-1"}),t._v(" เลือกรูปภาพ\n                        ")]),t._v(" "),s("div",{staticClass:"tw-hidden"},[s("div",{staticClass:"custom-file custom-file-th"},[s("input",{ref:"finished_products_result_quality_line_image_"+a+"_"+l,refInFor:!0,staticClass:"custom-file-input",attrs:{type:"file",accept:"image/jpeg,image/gif,image/png",id:"input_image_"+a+"_"+l,name:"image_"+a+"_"+l,"ref-label":"label_image_"+a+"_"+l,multiple:""},on:{change:function(e){return t.validateImages(e,n)}}})])]),t._v(" "),t._l(n.images,(function(e,a){return s("div",{key:a},[s("label",{staticClass:"tw-mt-2 tw-mb-1 tw-text-gray-500",staticStyle:{"max-width":"80px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v("\n                                "+t._s(e.name)+"\n                            ")]),t._v(" "),s("label",{staticClass:"tw-mb-1 tw-ml-2 tw-text-red-700 fa fa-times tw-cursor-pointer tw-inline-block",staticStyle:{overflow:"hidden"},on:{click:function(e){return t.onDeleteResultLineImage(n,a)}}})])}))],2):t._e(),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},[s("a",{staticClass:"btn btn-xs btn-outline tw-w-20 tw-bg-opacity-20 tw-bg-purple-200 tw-border-purple-400 hover:tw-bg-purple-200 hover:tw-border-purple-400 tw-py-2",attrs:{href:"#",target:"_blank"}},[s("span",{staticClass:"fa fa-picture-o tw-mr-1"}),t._v(" ดูภาพ\n                        ")])]),t._v(" "),"defect"==t.showType?s("td",{staticClass:"text-left tw-text-xs",staticStyle:{"padding-right":"0px"}},["FAILED"==n.result_status?[s("input",{directives:[{name:"model",rawName:"v-model",value:n.cause_of_defect,expression:"sampleResultLine.cause_of_defect"}],staticClass:"form-control input-sm text-left",attrs:{type:"text",placeholder:"ระบุสาเหตุ"},domProps:{value:n.cause_of_defect},on:{input:function(e){e.target.composing||t.$set(n,"cause_of_defect",e.target.value)}}})]:[s("input",{staticClass:"form-control input-sm text-left",attrs:{type:"text",disabled:""}})]],2):t._e()])})),t._v(" "),"result"==t.showType&&e.show_input_issue_not_found?s("tr",{key:a+"-issue_not_found"},[s("td"),t._v(" "),t._m(1,!0),t._v(" "),s("td",{staticClass:"qm_issue_not_found_checkbox"},[s("div",{staticClass:"tw-pt-2"},[s("qm-el-checkbox",{attrs:{value:e.issue_not_found,label:"",name:"issue_not_found_"+a,id:"input_issue_not_found_"+a,size:"medium"},on:{change:function(s){return t.onIssueNotFouldCheckBoxChanged(s,e)}}})],1)]),t._v(" "),s("td",{attrs:{colspan:"8"}})]):t._e(),t._v(" "),"result"==t.showType?s("tr",{key:a+"-add_button"},[s("td"),t._v(" "),s("td",{attrs:{colspan:"15"}},[s("button",{staticClass:"btn btn-xs btn-primary",on:{click:function(s){return t.onAddNewResultLine(e)}}},[s("span",{staticClass:"fa fa-plus"})])])]):t._e()]})),t._v(" "),"result"==t.showType||"defect"==t.showType?s("tr",[s("td",{attrs:{colspan:"16"}},[s("div",{staticClass:"row justify-content-center clearfix tw-my-4"},[s("div",{staticClass:"col text-center"},["result"==t.showType?s("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"button"},on:{click:function(e){return t.onSubmitSampleResult(e)}}},[s("i",{staticClass:"fa fa-save"}),t._v(" บันทึก\n                            ")]):t._e(),t._v(" "),"defect"==t.showType?s("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"button"},on:{click:function(e){return t.onSubmitCauseOfDefect(e)}}},[s("i",{staticClass:"fa fa-save"}),t._v(" บันทึก\n                            ")]):t._e(),t._v(" "),s("button",{staticClass:"btn btn-sm btn-danger tw-ml-4",attrs:{type:"button"},on:{click:t.onCancelSampleResult}},[s("i",{staticClass:"fa fa-times"}),t._v(" ยกเลิก\n                            ")])])])])]):t._e()],2):s("tbody",[t._m(2)])]),t._v(" "),s("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),s("modal-show-result-line-images",{attrs:{"modal-name":"modal-show-result-line-images","modal-width":"640","modal-height":"auto","sample-result-line":t.showedModalSampleResultLine},on:{onModalResultLineImageChanged:t.onModalResultLineImageChanged}})],1)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticClass:"tw-text-xs tw-bg-opacity-60 tw-bg-gray-200 tw-font-bold",attrs:{colspan:"16"}},[s("div",[t._v(" ข้อมูลการตรวจสอบ ")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"tw-text-xs"},[s("div",{},[t._v(" ไม่พบความผิดปกติ ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{attrs:{colspan:"16"}},[s("h2",{staticClass:"p-5 text-center text-muted"},[t._v("ไม่พบข้อมูล")])])])}],!1,null,null,null).exports},51900:(t,e,s)=>{"use strict";function a(t,e,s,a,n,l,i,r){var o,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=s,c._compiled=!0),a&&(c.functional=!0),l&&(c._scopeId="data-v-"+l),i?(o=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=o):n&&(o=r?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),o)if(c.functional){c._injectStyles=o;var u=c.render;c.render=function(t,e){return o.call(e),u(t,e)}}else{var _=c.beforeCreate;c.beforeCreate=_?[].concat(_,o):[o]}return{exports:t,options:c}}s.d(e,{Z:()=>a})},7398:function(t){"undefined"!=typeof self&&self,t.exports=function(t){var e={};function s(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t,e,s){},function(t,e,s){"use strict";s.r(e);var a="undefined"!=typeof window?window.HTMLElement:Object,n={mounted:function(){this.enforceFocus&&document.addEventListener("focusin",this.focusIn)},methods:{focusIn:function(t){if(this.isActive&&t.target!==this.$el&&!this.$el.contains(t.target)){var e=this.container?this.container:this.isFullPage?null:this.$el.parentElement;(this.isFullPage||e&&e.contains(t.target))&&(t.preventDefault(),this.$el.focus())}}},beforeDestroy:function(){document.removeEventListener("focusin",this.focusIn)}};function l(t,e,s,a,n,l,i,r){var o,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=s,c._compiled=!0),a&&(c.functional=!0),l&&(c._scopeId="data-v-"+l),i?(o=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=o):n&&(o=r?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),o)if(c.functional){c._injectStyles=o;var u=c.render;c.render=function(t,e){return o.call(e),u(t,e)}}else{var _=c.beforeCreate;c.beforeCreate=_?[].concat(_,o):[o]}return{exports:t,options:c}}var i=l({name:"spinner",props:{color:{type:String,default:"#000"},height:{type:Number,default:64},width:{type:Number,default:64}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",width:this.width,height:this.height,stroke:this.color}},[e("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[e("g",{attrs:{transform:"translate(1 1)","stroke-width":"2"}},[e("circle",{attrs:{"stroke-opacity":".25",cx:"18",cy:"18",r:"18"}}),e("path",{attrs:{d:"M36 18c0-9.94-8.06-18-18-18"}},[e("animateTransform",{attrs:{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.8s",repeatCount:"indefinite"}})],1)])])])}),[],!1,null,null,null).exports,r=l({name:"dots",props:{color:{type:String,default:"#000"},height:{type:Number,default:240},width:{type:Number,default:60}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:this.color,width:this.width,height:this.height}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15"}},[e("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})]),e("circle",{attrs:{cx:"60",cy:"15",r:"9","fill-opacity":"0.3"}},[e("animate",{attrs:{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"}})]),e("circle",{attrs:{cx:"105",cy:"15",r:"15"}},[e("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})])])}),[],!1,null,null,null).exports,o=l({name:"bars",props:{color:{type:String,default:"#000"},height:{type:Number,default:40},width:{type:Number,default:40}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",height:this.height,width:this.width,fill:this.color}},[e("rect",{attrs:{x:"0",y:"13",width:"4",height:"5"}},[e("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}})]),e("rect",{attrs:{x:"10",y:"13",width:"4",height:"5"}},[e("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}})]),e("rect",{attrs:{x:"20",y:"13",width:"4",height:"5"}},[e("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}})])])}),[],!1,null,null,null).exports,c=l({name:"vue-loading",mixins:[n],props:{active:Boolean,programmatic:Boolean,container:[Object,Function,a],isFullPage:{type:Boolean,default:!0},enforceFocus:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!1},transition:{type:String,default:"fade"},canCancel:Boolean,onCancel:{type:Function,default:function(){}},color:String,backgroundColor:String,blur:{type:String,default:"2px"},opacity:Number,width:Number,height:Number,zIndex:Number,loader:{type:String,default:"spinner"}},data:function(){return{isActive:this.active}},components:{Spinner:i,Dots:r,Bars:o},beforeMount:function(){this.programmatic&&(this.container?(this.isFullPage=!1,this.container.appendChild(this.$el)):document.body.appendChild(this.$el))},mounted:function(){this.programmatic&&(this.isActive=!0),document.addEventListener("keyup",this.keyPress)},methods:{cancel:function(){this.canCancel&&this.isActive&&(this.hide(),this.onCancel.apply(null,arguments))},hide:function(){var t=this;this.$emit("hide"),this.$emit("update:active",!1),this.programmatic&&(this.isActive=!1,setTimeout((function(){var e;t.$destroy(),void 0!==(e=t.$el).remove?e.remove():e.parentNode.removeChild(e)}),150))},disableScroll:function(){this.isFullPage&&this.lockScroll&&document.body.classList.add("vld-shown")},enableScroll:function(){this.isFullPage&&this.lockScroll&&document.body.classList.remove("vld-shown")},keyPress:function(t){27===t.keyCode&&this.cancel()}},watch:{active:function(t){this.isActive=t},isActive:function(t){t?this.disableScroll():this.enableScroll()}},computed:{bgStyle:function(){return{background:this.backgroundColor,opacity:this.opacity,backdropFilter:"blur(".concat(this.blur,")")}}},beforeDestroy:function(){document.removeEventListener("keyup",this.keyPress)}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:t.transition}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"vld-overlay is-active",class:{"is-full-page":t.isFullPage},style:{zIndex:t.zIndex},attrs:{tabindex:"0","aria-busy":t.isActive,"aria-label":"Loading"}},[s("div",{staticClass:"vld-background",style:t.bgStyle,on:{click:function(e){return e.preventDefault(),t.cancel(e)}}}),s("div",{staticClass:"vld-icon"},[t._t("before"),t._t("default",[s(t.loader,{tag:"component",attrs:{color:t.color,width:t.width,height:t.height}})]),t._t("after")],2)])])}),[],!1,null,null,null).exports,u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{show:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,l={programmatic:!0},i=Object.assign({},e,a,l),r=new(t.extend(c))({el:document.createElement("div"),propsData:i}),o=Object.assign({},s,n);return Object.keys(o).map((function(t){r.$slots[t]=o[t]})),r}}};s(0),c.install=function(t){var e=u(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});t.$loading=e,t.prototype.$loading=e},e.default=c}]).default}}]);