(self.webpackChunk=self.webpackChunk||[]).push([[8811],{29040:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>r});var s=a(23645),n=a.n(s)()((function(t){return t[1]}));n.push([t.id,".vld-overlay,.vld-shown{overflow:hidden}.vld-overlay{bottom:0;left:0;position:absolute;right:0;top:0;align-items:center;display:none;justify-content:center;z-index:9999}.vld-overlay.is-active{display:flex}.vld-overlay.is-full-page{z-index:9999;position:fixed}.vld-overlay .vld-background{bottom:0;left:0;position:absolute;right:0;top:0;background:#fff;opacity:.5}.vld-overlay .vld-icon,.vld-parent{position:relative}",""]);const r=n},88423:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>r});var s=a(23645),n=a.n(s)()((function(t){return t[1]}));n.push([t.id,".v--modal-overlay[data-v-eb9d3556]{z-index:2000;padding-top:3rem;padding-bottom:3rem}",""]);const r=n},8811:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>y});var s=a(87757),n=a.n(s),r=a(7398),i=a.n(r),o=a(30381),l=a.n(o);a(2223);const c={props:["modalName","modalWidth","modalHeight","sheets","sampleDates","locators","preparedLocators","samples","inputSamples","comparedInputSamples"],components:{Loading:i()},watch:{sheets:function(t){this.sheetItems=t||[],this.sheetActiveStatuses=t?t.map((function(t,e){return{sheet_index:e,sheet_name:t,active:0===e}})):[],this.activatedLocatorLength=this.getActivatedLocators(this.sheetActiveStatuses,this.preparedLocatorItems).length},sampleDates:function(t){this.sampleDateItems=t||[]},locators:function(t){this.locatorItems=t||[]},preparedLocators:function(t){this.preparedLocatorItems=t||[],this.activatedLocatorLength=this.getActivatedLocators(this.sheetActiveStatuses,this.preparedLocatorItems).length},samples:function(t){this.sampleItems=t||[]},inputSamples:function(t){this.inputSampleItems=t||[]},comparedInputSamples:function(t){this.cisItems=t||[],this.isAllowConfirmUpload=!!t&&t.filter((function(t){return t.selected})).length>0}},data:function(){return{isLoading:!1,width:this.modalWidth,sheetItems:this.sheets?this.sheets:[],activatedLocatorLength:this.getActivatedLocators([],[]).length,sheetActiveStatuses:this.sheets?this.sheets.map((function(t,e){return{sheet_index:e,sheet_name:t,active:0===e}})):[],sampleDateItems:this.sampleDates?this.sampleDates:[],locatorItems:this.locators?this.locators:[],preparedLocatorItems:this.preparedLocators?this.preparedLocators:[],sampleItems:this.samples?this.samples:[],inputSampleItems:this.inputSamples?this.inputSamples:[],cisItems:this.comparedInputSamples?this.comparedInputSamples:[],isAllowConfirmUpload:!!this.comparedInputSamples&&this.comparedInputSamples.filter((function(t){return t.selected})).length>0}},created:function(){this.handleResize()},mounted:function(){this.activatedLocatorLength=this.getActivatedLocators(this.sheetActiveStatuses,this.preparedLocatorItems).length},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},toggleSheet:function(t){this.sheetActiveStatuses=this.sheetItems.map((function(e,a){return{sheet_index:a,sheet_name:e,active:a===t}})),this.activatedLocatorLength=this.getActivatedLocators(this.sheetActiveStatuses,this.preparedLocatorItems).length},isLocatorShow:function(t){var e=!1,a=this.preparedLocatorItems.find((function(e){return e.locator_id===t}));if(a){var s=this.sheetActiveStatuses.find((function(t){return t.sheet_index===a.sheet_index}));e=!!s&&s.active}return e},getActivatedLocators:function(t,e){var a=[],s=t.find((function(t){return!0===t.active}));return s&&(a=e.filter((function(t){return t.sheet_index==s.sheet_index}))),a},onSampleItemHasChanged:function(t){this.isAllowConfirmUpload=!!this.comparedInputSamples&&this.comparedInputSamples.filter((function(t){return t.selected})).length>0},onConfirmUpload:function(t){var e=this.cisItems.filter((function(t){return t.selected}));this.$emit("onSampleResultSubmitted",{input_samples:e})},formatDateTh:function(t){return t?l()(t).add(543,"years").format("DD/MM/YYYY"):""}}};a(44016);var d=a(51900);const u=(0,d.Z)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"z-index":"100"}},[a("modal",{attrs:{name:t.modalName,width:t.width,scrollable:!0,height:t.modalHeight,shiftX:.1,shiftY:.4}},[a("div",{staticClass:"p-4 text-left"},[a("h3",{staticClass:"text-left"},[t._v(" Upload ผลการทดสอบ ")]),t._v(" "),a("hr",{staticClass:"tw-mt-1"}),t._v(" "),a("div",{staticClass:"btn-group tw-pb-3",attrs:{role:"group"}},[t._l(t.sheetItems,(function(e,s){return[a("button",{key:""+s,staticClass:"btn",class:[t.sheetActiveStatuses[s].active?"btn-primary":"btn-white"],attrs:{type:"button"},on:{click:function(e){return t.toggleSheet(s)}}},[t._v(" \n                        "+t._s(e)+" \n                    ")])]}))],2),t._v(" "),a("div",{staticClass:"table-responsive",staticStyle:{"max-height":"400px"}},[a("table",{staticClass:"table table-bordered table-sticky mb-0",staticStyle:{"min-width":"800px"}},[a("thead",[a("tr",[a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("\n                                โซนที่ตั้ง  \n                            ")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("\n                                บริเวณที่ติดตั้ง\n                            ")]),t._v(" "),t._l(t.sampleDateItems,(function(e,s){return[a("th",{key:""+s,staticClass:"text-center",attrs:{colspan:"3"}},[t._v("\n                                    "+t._s(e.sample_date_formatted)+"\n                                ")])]}))],2),t._v(" "),a("tr",[t._l(t.sampleDateItems,(function(e,s){return[a("th",{key:s+"_1",staticClass:"text-center",staticStyle:{top:"34px",padding:"0px"}},[a("div",{staticClass:"tw-p-2",staticStyle:{"border-top":"1px solid #e7eaec"}},[t._v(" เลือก ")])]),t._v(" "),a("th",{key:s+"_2",staticClass:"text-center",staticStyle:{top:"34px",padding:"0px"}},[a("div",{staticClass:"tw-p-2",staticStyle:{"border-top":"1px solid #e7eaec"}},[t._v(" มอดยาสูบ ")])]),t._v(" "),a("th",{key:s+"_3",staticClass:"text-center",staticStyle:{top:"34px",padding:"0px"}},[a("div",{staticClass:"tw-p-2",staticStyle:{"border-top":"1px solid #e7eaec"}},[t._v(" สถานะการลงผล ")])])]}))],2)]),t._v(" "),t.activatedLocatorLength>0?a("tbody",[t._l(t.preparedLocatorItems,(function(e,s){return[a("tr",{directives:[{name:"show",rawName:"v-show",value:t.isLocatorShow(e.locator_id),expression:"isLocatorShow(pl.locator_id)"}],key:""+s},[a("td",{staticClass:"text-center"},[t._v("\n                                    "+t._s(e.location_desc)+"\n                                ")]),t._v(" "),a("td",{staticClass:"text-left"},[t._v("\n                                    "+t._s(e.location_full_desc)+"\n                                ")]),t._v(" "),t._l(t.sampleDateItems,(function(s,n){return[a("td",{key:n+"_1",staticClass:"text-center"},[t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted}))?[t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).is_new_sample?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected,expression:"(cisItems.find(item => (item.locator_id == pl.locator_id && item.sample_date_formatted == sd.sample_date_formatted))).selected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected)?t._i(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected,null)>-1:t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected},on:{change:[function(a){var n=t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected,r=a.target,i=!!r.checked;if(Array.isArray(n)){var o=t._i(n,null);r.checked?o<0&&t.$set(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})),"selected",n.concat([null])):o>-1&&t.$set(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})),"selected",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})),"selected",i)},function(e){return t.onSampleItemHasChanged(e)}]}})]):t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).result_value_has_changed?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected,expression:"(cisItems.find(item => (item.locator_id == pl.locator_id && item.sample_date_formatted == sd.sample_date_formatted))).selected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected)?t._i(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected,null)>-1:t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected},on:{change:[function(a){var n=t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).selected,r=a.target,i=!!r.checked;if(Array.isArray(n)){var o=t._i(n,null);r.checked?o<0&&t.$set(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})),"selected",n.concat([null])):o>-1&&t.$set(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})),"selected",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})),"selected",i)},function(e){return t.onSampleItemHasChanged(e)}]}})]):a("span",[a("input",{attrs:{type:"checkbox",disabled:""},on:{change:function(e){return t.onSampleItemHasChanged(e)}}})])]:t._e()],2),t._v(" "),a("td",{key:n+"_2",staticClass:"text-center"},[t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted}))?[t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).is_new_sample?a("span",{staticClass:"tw-text-green-600 tw-font-bold"},[t._v("\n                                                "+t._s(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).result_value)+"\n                                            ")]):t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).result_value_has_changed?a("span",{staticClass:"tw-text-red-600 tw-font-bold"},[t._v("\n                                                "+t._s(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).result_value)+"\n                                            ")]):a("span",{staticClass:"tw-text-gray-400 tw-font-bold"},[t._v("\n                                                "+t._s(t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).result_value)+"\n                                            ")])]:t._e()],2),t._v(" "),a("td",{key:n+"_3",staticClass:"text-center"},[t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted}))?[t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).is_new_sample?a("span",{staticClass:"tw-text-green-600 tw-font-bold"},[t._v("\n                                                ยังไม่อัพโหลด\n                                            ")]):t.cisItems.find((function(t){return t.locator_id==e.locator_id&&t.sample_date_formatted==s.sample_date_formatted})).result_value_has_changed?a("span",{staticClass:"tw-text-blue-600 tw-font-bold"},[t._v("\n                                                อัพโหลดแล้ว\n                                            ")]):a("span",{staticClass:"tw-text-gray-600 tw-font-bold"},[t._v("\n                                                อัพโหลดแล้ว\n                                            ")])]:t._e()],2)]}))],2)]}))],2):a("tbody",[a("tr",[a("td",{attrs:{colspan:"10"}},[a("h2",{staticClass:"p-5 text-center text-muted"},[t._v(" ไม่พบข้อมูล ")])])])])])]),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"text-right tw-mt-2"},[a("button",{staticClass:"btn btn-primary tw-w-32",attrs:{type:"button",disabled:!t.isAllowConfirmUpload},on:{click:t.onConfirmUpload}},[t._v(" \n                    ยืนยัน\n                ")]),t._v(" "),a("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(e){return t.$modal.hide(t.modalName)}}},[t._v(" \n                    ยกเลิก \n                ")])])])]),t._v(" "),a("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}})],1)}),[],!1,null,"eb9d3556",null).exports;function p(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m(t,e)}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var s=0,n=function(){};return{s:n,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,o=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return i=t.done,t},e:function(t){o=!0,r=t},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw r}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function f(t,e,a,s,n,r,i){try{var o=t[r](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(s,n)}function h(t){return function(){var e=this,a=arguments;return new Promise((function(s,n){var r=t.apply(e,a);function i(t){f(r,s,n,i,o,"next",t)}function o(t){f(r,s,n,i,o,"throw",t)}i(void 0)}))}}function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(Object(a),!0).forEach((function(e){g(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function g(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const b={props:["id","name","action","locators"],components:{Loading:i(),ModalReviewSampleResults:u},data:function(){return{isLoading:!1,isUploading:!1,uploadingPercentage:0,uploadingStatus:"warning",fileList:[],sheets:[],sampleDates:[],preparedLocators:[],samples:[],inputSamples:[],comparedInputSamples:[]}},methods:{submitUpload:function(){var t=this,e=new FormData;this.fileList[0]?(this.isLoading=!0,e.append("file",this.fileList[0].raw),axios.post(this.action,e).then((function(e){var a=e.data.data,s=a.message;return"success"==a.status&&t.showModalReviewSampleResults(a),"error"==a.status&&swal("Error","".concat(s),"error"),t.fileList=[],t.isLoading=!1,a})).catch((function(e){t.isLoading=!1,console.log(e),swal("Error","".concat(e.message),"error")}))):(this.isLoading=!1,swal("Error","กรุณาเลือกไฟล์ที่ต้องการอัพโหลด","error"))},handleUploadChange:function(t,e){this.fileList=e.slice(-1)},handleBeforeUpload:function(t){if(["text/csv","text/plain","application/csv","text/comma-separated-values","application/excel","application/vnd.ms-excel","application/vnd.msexcel","text/anytext","application/octet-stream","application/txt"].includes(t.type))return!0;this.$message.error("ประเภทไฟล์ไม่ถูกต้อง (รองรับ .xlsx .csv เท่านั้น)"),this.fileList.pop(t)},showModalReviewSampleResults:function(t){var e=this;this.inputSamples=t.inputSamples.map((function(t){return v(v({},t),{},{sample_date_formatted:l()(t.sample_date).add(543,"years").format("DD/MM/YYYY")})})),this.samples=t.samples.map((function(t){return v(v({},t),{},{sample_date_formatted:l()(t.date_drawn).add(543,"years").format("DD/MM/YYYY")})})),this.sheets=t.sheets,this.comparedInputSamples=this.inputSamples.map((function(t){var a=e.samples.find((function(e){return e.sample_date_formatted==t.sample_date_formatted&&e.locator_id==t.locator_id})),s=a?a.results[0].result_value:null,n=!a||a.results[0].result_value!=t.result_value;return v(v({},t),{},{is_new_sample:!a,old_result_value:s,result_value_has_changed:n,selected:!!n})})),this.sampleDates=this.comparedInputSamples.map((function(t){return{sample_date_formatted:t.sample_date_formatted}})).filter((function(t,e,a){return e===a.findIndex((function(e){return e.sample_date_formatted===t.sample_date_formatted}))})),this.preparedLocators=this.comparedInputSamples.map((function(t){var a=e.getLocatorDesc(t);return{locator_id:t.locator_id,sheet_index:t.sheet_index,sheet_name:t.sheet_name,location_code:a.location_code,location_desc:a.location_desc,location_full_desc:a.location_full_desc}})).filter((function(t,e,a){return e===a.findIndex((function(e){return e.locator_id===t.locator_id}))})),window.scrollTo(0,150),this.$modal.show("modal-review-sample-results")},onSampleResultSubmitted:function(t){var e=this;return h(n().mark((function a(){var s,r,i,o,l,c,d,u,m,f,h,_,v;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!((s=t.input_samples).length>0)){a.next=51;break}e.$modal.hide("modal-review-sample-results"),e.isUploading=!0,r=[],i=[],o=0,l=e.sampleDates.length,c=p(e.sampleDates),a.prev=9,u=n().mark((function t(){var a,i,c,u;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=d.value,i=a.sample_date_formatted,c=s.filter((function(t){return t.sample_date_formatted==i})),t.next=5,e.storeSamples(c);case 5:"error"==(u=t.sent).status&&r.push(u.message),o+=parseFloat(50/l),console.log("percentage : ",o),e.uploadingPercentage=o,e.uploadingStatus=o>=49?"primary":"warning";case 11:case"end":return t.stop()}}),t)})),c.s();case 12:if((d=c.n()).done){a.next=16;break}return a.delegateYield(u(),"t0",14);case 14:a.next=12;break;case 16:a.next=21;break;case 18:a.prev=18,a.t1=a.catch(9),c.e(a.t1);case 21:return a.prev=21,c.f(),a.finish(21);case 24:if(console.log("errStoreSampleResponses : ",r),!(r.length>0)){a.next=32;break}e.isUploading=!1,m=r.join(", "),swal("Error","บันทึกสร้างตัวอย่างการระบาดของมอดยาสูบ ไม่สำเร็จ : ".concat(m),"error"),a.next=50;break;case 32:f=p(e.sampleDates),a.prev=33,_=n().mark((function t(){var a,r,c,d;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=h.value,r=a.sample_date_formatted,c=s.filter((function(t){return t.sample_date_formatted==r})),t.next=5,e.storeSampleResults(c);case 5:"error"==(d=t.sent).status&&i.push(d.message),o+=parseFloat(50/l),console.log("percentage : ",o),e.uploadingPercentage=o,e.uploadingStatus=o>=99?"success":"primary";case 11:case"end":return t.stop()}}),t)})),f.s();case 36:if((h=f.n()).done){a.next=40;break}return a.delegateYield(_(),"t2",38);case 38:a.next=36;break;case 40:a.next=45;break;case 42:a.prev=42,a.t3=a.catch(33),f.e(a.t3);case 45:return a.prev=45,f.f(),a.finish(45);case 48:console.log("errStoreSampleResultResponses : ",i),i.length<=0?(setTimeout((function(){e.isUploading=!1,e.uploadingPercentage=0,e.uploadingStatus="warning"}),5e3),swal("Success","บันทึกลงผลการระบาดของมอดยาสูบ","success")):(e.isUploading=!1,v=i.join(", "),swal("Error","บันทึกลงผลการระบาดของมอดยาสูบ ไม่สำเร็จ : ".concat(v),"error"));case 50:e.isLoading=!1;case 51:case"end":return a.stop()}}),a,null,[[9,18,21,24],[33,42,45,48]])})))()},storeSamples:function(t){var e=this;return h(n().mark((function a(){var s,r;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s={input_samples:JSON.stringify(t)},a.next=3,axios.post("/qm/ajax/moth-outbreaks/samples",s).then((function(t){var e=t.data.data;e.message;return e})).catch((function(t){e.isLoading=!1,console.log(t),swal("Error","บันทึกลงผลการการระบาดของมอดยาสูบ | ".concat(t.message),"error")}));case 3:return r=a.sent,a.abrupt("return",r);case 5:case"end":return a.stop()}}),a)})))()},storeSampleResults:function(t){var e=this;return h(n().mark((function a(){var s,r,i,o;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s={input_samples:JSON.stringify(t)},a.next=3,axios.post("/qm/ajax/moth-outbreaks/results",s).then((function(t){var e=t.data.data;e.message;return e})).catch((function(t){e.isUploading=!1,console.log(t),swal("Error","บันทึกลงผลการการระบาดของมอดยาสูบ | ".concat(t.message),"error")}));case 3:if("success"!=(r=a.sent).status){a.next=11;break}return i=r.web_batch_no?r.web_batch_no:null,a.next=8,e.callPackageAddSampleResults(i);case 8:if("error"!=(o=a.sent).status){a.next=11;break}return a.abrupt("return",o);case 11:return a.abrupt("return",r);case 12:case"end":return a.stop()}}),a)})))()},callPackageAddSampleResults:function(t){var e=this;return h(n().mark((function a(){var s,r;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s={web_batch_no:t},a.next=3,axios.post("/qm/ajax/moth-outbreaks/call-pkg-add-results",s).then((function(t){var e=t.data.data;e.message;return e})).catch((function(t){e.isUploading=!1,console.log(t),swal("Error","บันทึกลงผลการการระบาดของมอดยาสูบ | ".concat(t.message),"error")}));case 3:return r=a.sent,a.abrupt("return",r);case 5:case"end":return a.stop()}}),a)})))()},getLocatorDesc:function(t){var e=this.locators.find((function(e){return e.inventory_location_id==t.locator_id}));return{location_code:e?"".concat(e.location_code?e.location_code:""):"",location_desc:e?"".concat(e.location_desc?e.location_desc:""):"",location_full_desc:e?"".concat(e.location_full_desc?e.location_full_desc:""):""}}}};const y=(0,d.Z)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row"},[a("label",{staticClass:"col-md-3 col-form-label"},[t._v(" ลงผลการตรวจสอบ ")]),t._v(" "),a("div",{staticClass:"col-md-9 text-center tw-border-2 tw-border-dashed tw-border-gray-200 tw-py-4 "},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{id:t.id,name:t.name,action:"","on-change":t.handleUploadChange,"before-upload":t.handleBeforeUpload,accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","file-list":t.fileList,"auto-upload":!1,limit:1,disabled:t.isUploading}},[a("el-button",{attrs:{slot:"trigger",disabled:t.isUploading,size:"medium",type:"success"},slot:"trigger"},[a("i",{staticClass:"fa fa fa-file-excel-o tw-mr-1"}),t._v(" Choose file\n                ")]),t._v(" "),a("el-button",{attrs:{disabled:t.isUploading,type:"primary",size:"medium"},on:{click:t.submitUpload}},[a("i",{staticClass:"fa fa-upload tw-mr-1"}),t._v(" Upload ผลการทดสอบ\n                ")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n                    รองรับ .xlsx .csv เท่านั้น\n                ")])],1)],1)]),t._v(" "),a("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),a("modal-review-sample-results",{attrs:{"modal-name":"modal-review-sample-results","modal-width":"1280","modal-height":"640",locators:t.locators,sheets:t.sheets,"sample-dates":t.sampleDates,"prepared-locators":t.preparedLocators,samples:t.samples,"input-samples":t.inputSamples,"compared-input-samples":t.comparedInputSamples},on:{onSampleResultSubmitted:t.onSampleResultSubmitted}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isUploading,expression:"isUploading"}],staticClass:"tw-mt-5"},[a("p",{staticClass:"tw-mb-2"},[t._v(" Uploading ... ")]),t._v(" "),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:t.uploadingPercentage,status:t.uploadingStatus}})],1)],1)}),[],!1,null,null,null).exports},51900:(t,e,a)=>{"use strict";function s(t,e,a,s,n,r,i,o){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=a,c._compiled=!0),s&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),i?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=l):n&&(l=o?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}a.d(e,{Z:()=>s})},7398:function(t){"undefined"!=typeof self&&self,t.exports=function(t){var e={};function a(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=t,a.c=e,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(s,n,function(e){return t[e]}.bind(null,n));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=1)}([function(t,e,a){},function(t,e,a){"use strict";a.r(e);var s="undefined"!=typeof window?window.HTMLElement:Object,n={mounted:function(){this.enforceFocus&&document.addEventListener("focusin",this.focusIn)},methods:{focusIn:function(t){if(this.isActive&&t.target!==this.$el&&!this.$el.contains(t.target)){var e=this.container?this.container:this.isFullPage?null:this.$el.parentElement;(this.isFullPage||e&&e.contains(t.target))&&(t.preventDefault(),this.$el.focus())}}},beforeDestroy:function(){document.removeEventListener("focusin",this.focusIn)}};function r(t,e,a,s,n,r,i,o){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=a,c._compiled=!0),s&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),i?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=l):n&&(l=o?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}var i=r({name:"spinner",props:{color:{type:String,default:"#000"},height:{type:Number,default:64},width:{type:Number,default:64}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",width:this.width,height:this.height,stroke:this.color}},[e("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[e("g",{attrs:{transform:"translate(1 1)","stroke-width":"2"}},[e("circle",{attrs:{"stroke-opacity":".25",cx:"18",cy:"18",r:"18"}}),e("path",{attrs:{d:"M36 18c0-9.94-8.06-18-18-18"}},[e("animateTransform",{attrs:{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.8s",repeatCount:"indefinite"}})],1)])])])}),[],!1,null,null,null).exports,o=r({name:"dots",props:{color:{type:String,default:"#000"},height:{type:Number,default:240},width:{type:Number,default:60}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:this.color,width:this.width,height:this.height}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15"}},[e("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})]),e("circle",{attrs:{cx:"60",cy:"15",r:"9","fill-opacity":"0.3"}},[e("animate",{attrs:{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"}})]),e("circle",{attrs:{cx:"105",cy:"15",r:"15"}},[e("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})])])}),[],!1,null,null,null).exports,l=r({name:"bars",props:{color:{type:String,default:"#000"},height:{type:Number,default:40},width:{type:Number,default:40}}},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",height:this.height,width:this.width,fill:this.color}},[e("rect",{attrs:{x:"0",y:"13",width:"4",height:"5"}},[e("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}})]),e("rect",{attrs:{x:"10",y:"13",width:"4",height:"5"}},[e("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}})]),e("rect",{attrs:{x:"20",y:"13",width:"4",height:"5"}},[e("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}}),e("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}})])])}),[],!1,null,null,null).exports,c=r({name:"vue-loading",mixins:[n],props:{active:Boolean,programmatic:Boolean,container:[Object,Function,s],isFullPage:{type:Boolean,default:!0},enforceFocus:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!1},transition:{type:String,default:"fade"},canCancel:Boolean,onCancel:{type:Function,default:function(){}},color:String,backgroundColor:String,blur:{type:String,default:"2px"},opacity:Number,width:Number,height:Number,zIndex:Number,loader:{type:String,default:"spinner"}},data:function(){return{isActive:this.active}},components:{Spinner:i,Dots:o,Bars:l},beforeMount:function(){this.programmatic&&(this.container?(this.isFullPage=!1,this.container.appendChild(this.$el)):document.body.appendChild(this.$el))},mounted:function(){this.programmatic&&(this.isActive=!0),document.addEventListener("keyup",this.keyPress)},methods:{cancel:function(){this.canCancel&&this.isActive&&(this.hide(),this.onCancel.apply(null,arguments))},hide:function(){var t=this;this.$emit("hide"),this.$emit("update:active",!1),this.programmatic&&(this.isActive=!1,setTimeout((function(){var e;t.$destroy(),void 0!==(e=t.$el).remove?e.remove():e.parentNode.removeChild(e)}),150))},disableScroll:function(){this.isFullPage&&this.lockScroll&&document.body.classList.add("vld-shown")},enableScroll:function(){this.isFullPage&&this.lockScroll&&document.body.classList.remove("vld-shown")},keyPress:function(t){27===t.keyCode&&this.cancel()}},watch:{active:function(t){this.isActive=t},isActive:function(t){t?this.disableScroll():this.enableScroll()}},computed:{bgStyle:function(){return{background:this.backgroundColor,opacity:this.opacity,backdropFilter:"blur(".concat(this.blur,")")}}},beforeDestroy:function(){document.removeEventListener("keyup",this.keyPress)}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:t.transition}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"vld-overlay is-active",class:{"is-full-page":t.isFullPage},style:{zIndex:t.zIndex},attrs:{tabindex:"0","aria-busy":t.isActive,"aria-label":"Loading"}},[a("div",{staticClass:"vld-background",style:t.bgStyle,on:{click:function(e){return e.preventDefault(),t.cancel(e)}}}),a("div",{staticClass:"vld-icon"},[t._t("before"),t._t("default",[a(t.loader,{tag:"component",attrs:{color:t.color,width:t.width,height:t.height}})]),t._t("after")],2)])])}),[],!1,null,null,null).exports,d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{show:function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,r={programmatic:!0},i=Object.assign({},e,s,r),o=new(t.extend(c))({el:document.createElement("div"),propsData:i}),l=Object.assign({},a,n);return Object.keys(l).map((function(t){o.$slots[t]=l[t]})),o}}};a(0),c.install=function(t){var e=d(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});t.$loading=e,t.prototype.$loading=e},e.default=c}]).default},2223:(t,e,a)=>{var s=a(29040);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);(0,a(45346).Z)("22571fa1",s,!0,{})},44016:(t,e,a)=>{var s=a(88423);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);(0,a(45346).Z)("1708da7a",s,!0,{})}}]);