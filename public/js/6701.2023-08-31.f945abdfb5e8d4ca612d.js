(self.webpackChunk=self.webpackChunk||[]).push([[6701],{98564:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var o=a(23645),c=a.n(o)()((function(e){return e[1]}));c.push([e.id,".btn-success[data-v-614e2b2f]{background-color:#1ab394;border-color:#1ab394}.btn-cancle[data-v-614e2b2f]{background-color:#ec4958;border-color:#ec4958;color:#fff}.text-refresh[data-v-614e2b2f]{color:#ec4958}",""]);const s=c},56701:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});const o={props:["carInfo"],data:function(){var e,t,a,o,c,s;return{carInfos:[],carTypes:[],carFuels:[],aLiasNames:[],form:[],coaDeptCodes:[],selectedCar:{},car_license_plate:(null===(e=this.carInfo)||void 0===e?void 0:e.car_license_plate)||"",account_code:(null===(t=this.carInfo)||void 0===t?void 0:t.account_code)||"",car_group:(null===(a=this.carInfo)||void 0===a?void 0:a.car_group)||"",car_fuel:(null===(o=this.carInfo)||void 0===o?void 0:o.car_fuel)||"",asset_number:"",asset_id:(null===(c=this.carInfo)||void 0===c?void 0:c.asset_id)||"",quota_per_month:"",default_dept_code:(null===(s=this.carInfo)||void 0===s?void 0:s.default_dept_code)||"",loadingInput:{carInfos:!1,carTypes:!1,carFuels:!1,aliasName:!1,coaDeptCodes:!1},loading:!1}},created:function(){this.getMasterData()},mounted:function(){var e,t;this.carInfo&&(this.selectedCar=this.carInfo,this.account_code=null===(e=this.selectedCar)||void 0===e?void 0:e.account_code,this.quota_per_month=null===(t=this.selectedCar)||void 0===t?void 0:t.quota_per_month);this.carInfo.default_dept_code&&(this.getCOAsWithDefault(this.carInfo.default_dept_code),this.default_dept_code=this.carInfo.default_dept_code)},watch:{car_license_plate:function(e){var t,a,o,c,s,n,l=this;this.selectedCar=this.carInfos.find((function(e){return e.car_license_plate==l.car_license_plate})),this.car_group=null===(t=this.selectedCar)||void 0===t?void 0:t.car_group,this.car_fuel=null===(a=this.selectedCar)||void 0===a?void 0:a.car_fuel,this.car_user=null===(o=this.selectedCar)||void 0===o?void 0:o.car_user,this.account_code=null===(c=this.selectedCar)||void 0===c?void 0:c.account_code,this.quota_per_month=null===(s=this.selectedCar)||void 0===s?void 0:s.quota_per_month,this.getCOAsWithDefault(this.selectedCar.default_dept_code),this.default_dept_code=null===(n=this.selectedCar)||void 0===n?void 0:n.default_dept_code}},methods:{getMasterData:function(){this.getCarInfos(),this.getCarType(),this.getCarFuel(),this.getAliasName(),this.getCOAsWithDefault("")},getCarInfos:function(e){var t=this;this.loadingInput.carInfos=!0,axios.get("/inv/ajax/car_info",{params:{text:e,source_data:"NON_FA"}}).then((function(e){t.carInfos=e.data})).catch((function(e){console.log("error get car info")})).then((function(){t.loadingInput.carInfos=!1}))},getCarType:function(e){var t=this;this.loadingInput.carTypes=!0,axios.get("/inv/ajax/car_types",{params:{text:e}}).then((function(e){t.carTypes=e.data})).catch((function(e){console.log("error get car types")})).then((function(){t.loadingInput.carTypes=!1}))},getCarFuel:function(e){var t=this;this.loadingInput.carFuels=!0,axios.get("/inv/ajax/car_fuels",{params:{text:e}}).then((function(e){t.carFuels=e.data})).catch((function(e){console.log("error get car fuels")})).then((function(){t.loadingInput.carFuels=!1}))},getAliasName:function(e){var t=this;this.loadingInput.aliasName=!0,axios.get("/inv/ajax/alias_name",{params:{text:e,prefix:"T21"}}).then((function(e){t.aLiasNames=e.data})).catch((function(e){console.log("error get alias name")})).then((function(){t.loadingInput.aliasName=!1}))},getCOAsWithDefault:function(e){var t=this;this.loadingInput.coaDeptCodes=!0;var a=axios.get("/inv/ajax/coa_dept_code",{params:{text:e}}),o=axios.get("/inv/ajax/coa_dept_code",{});axios.all([a,o]).then((function(e){e[0].data.map((function(e){t.coaDeptCodes.push(e)})),e[1].data.map((function(e){t.coaDeptCodes.push(e)}))})).then((function(){t.loadingInput.coaDeptCodes=!1}))},getCOAs:function(e){var t=this;axios.get("/inv/ajax/coa_dept_code",{params:{text:e,value_set_name:"TOAT_GL_ACCT_CODE-DEPT_CODE"}}).then((function(e){t.coaDeptCodes=e.data})).then((function(){t.loadingInput.coaDeptCodes=!1}))},refresh:function(){window.location.reload()},confirm:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;confirm("ยืนยันการขอสิทธิ์เติมน้ำมัน ?")&&(this.loading=!0,axios.get("/inv/disbursement_fuel/update-non-fa-interface",{params:{car_license_plate:this.car_license_plate,car_group:this.car_group,car_fuel:this.car_fuel,account_code:this.account_code,quota_per_month:this.quota_per_month,default_dept_code:this.default_dept_code}}).then((function(t){e.$notify({title:"Success",message:"Update Successfully",type:"success"}),window.location.replace("/inv/disbursement_fuel/show")})).catch((function(t){e.loading=!1,403==t.response.status&&e.$notify.error({title:"Error",message:t.response.data.msg,duration:4500});var a=e.$formatErrorMessage(error);e.$notify.error({title:"Error",dangerouslyUseHTMLString:!0,message:a.outerHTML,duration:0})})))}))},computed:{acc_segment:function(){var e,t=this;return(null===(e=this.aLiasNames.find((function(e){return e.alias_name==t.account_code})))||void 0===e?void 0:e.template)||""}}};var c=a(93379),s=a.n(c),n=a(98564),l={insert:"head",singleton:!1};s()(n.Z,l);n.Z.locals;const i=(0,a(51900).Z)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"container"},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-2 col-form-label required"},[e._v("เลขที่เครื่องจักร")]),e._v(" "),a("div",{staticClass:"col-md-6"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",debounce:2e3,"remote-method":e.getCarInfos,placeholder:"เลขที่เครื่องจักร",loading:e.loadingInput.carInfos},model:{value:e.car_license_plate,callback:function(t){e.car_license_plate=t},expression:"car_license_plate"}},e._l(e.carInfos,(function(e,t){return a("el-option",{key:t,attrs:{label:e.car_license_plate,value:e.car_license_plate}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-2 col-form-label required"},[e._v("กลุ่มเครื่องจักร")]),e._v(" "),a("div",{staticClass:"col-md-6"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",debounce:2e3,"remote-method":e.getCarType,placeholder:"กลุ่มเครื่องจักร",loading:e.loadingInput.carTypes},model:{value:e.car_group,callback:function(t){e.car_group=t},expression:"car_group"}},e._l(e.carTypes,(function(e,t){return a("el-option",{key:t,attrs:{label:e.description,value:e.flex_value}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-2 col-form-label required"},[e._v("ชนิดน้ำมันที่เติม")]),e._v(" "),a("div",{staticClass:"col-md-6"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",debounce:2e3,"remote-method":e.getCarFuel,placeholder:"ชนิดน้ำมันที่เติม",loading:e.loadingInput.carFuels},model:{value:e.car_fuel,callback:function(t){e.car_fuel=t},expression:"car_fuel"}},e._l(e.carFuels,(function(e,t){return a("el-option",{key:t,attrs:{label:e.description,value:e.segment1}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-2 col-form-label required"},[e._v("หน่วยงานเจ้าของเครื่องจักร")]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingInput.coaDeptCode,expression:"loadingInput.coaDeptCode"}],staticClass:"col-md-6"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",debounce:2e3,"remote-method":e.getCOAs,placeholder:"หน่วยงานเจ้าของเครื่องจักร",loading:e.loadingInput.coaDeptCodes},model:{value:e.default_dept_code,callback:function(t){e.default_dept_code=t},expression:"default_dept_code"}},e._l(e.coaDeptCodes,(function(e,t){return a("el-option",{key:t,attrs:{label:e.department_code+" - "+e.description,value:e.department_code}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-2 col-form-label required"},[e._v("รหัสบัญชี")]),e._v(" "),a("div",{staticClass:"col-md-6"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",debounce:2e3,"remote-method":e.getAliasName,placeholder:"รหัสบัญชี",loading:e.loadingInput.aliasName},model:{value:e.account_code,callback:function(t){e.account_code=t},expression:"account_code"}},e._l(e.aLiasNames,(function(e,t){return a("el-option",{key:t,attrs:{label:e.alias_name+" - "+e.description,value:e.alias_name}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group row"},[a("div",{staticClass:"offset-md-2 col-md-6"},[e._v("\n            "+e._s(this.acc_segment)+"\n        ")])]),e._v(" "),a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-2 col-form-label required"},[e._v("ขอสิทธิ์จำนวน")]),e._v(" "),a("div",{staticClass:"col-md-2 p-0"},[a("el-input",{attrs:{type:"number"},model:{value:e.quota_per_month,callback:function(t){e.quota_per_month=t},expression:"quota_per_month"}})],1),e._v(" "),a("label",{staticClass:"col-md-2 col-form-label"},[e._v("ลิตร / เดือน")])])])]),e._v(" "),a("div",{staticClass:"col-md-12 text-right mt-4 p-0"},[a("el-button",{staticClass:"btn-success",attrs:{type:"primary"},on:{click:function(t){return e.confirm()}}},[e._v("ยืนยัน")]),e._v(" "),a("el-button",{staticClass:"text-refresh",attrs:{type:"text"},nativeOn:{click:function(t){return t.preventDefault(),e.refresh()}}},[e._v("ล้างข้อมูล")])],1)])}),[],!1,null,"614e2b2f",null).exports}}]);