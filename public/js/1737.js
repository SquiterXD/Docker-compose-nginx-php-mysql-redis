(self.webpackChunk=self.webpackChunk||[]).push([[1737],{60947:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var o=r(23645),a=r.n(o)()((function(e){return e[1]}));a.push([e.id,".v--modal-overlay[data-v-70d39daa]{z-index:2000;padding-top:3rem;padding-bottom:3rem}.vm--overlay[data-modal=modal-search-allocate-year][data-v-70d39daa]{height:100%!important}",""]);const n=a},81737:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var o=r(87757),a=r.n(o),n=r(7398),s=r.n(n),i=(r(2223),r(30381)),c=r.n(i),d=r(80455),u=r.n(d);function l(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function _(e,t,r,o,a,n,s){try{var i=e[n](s),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,a)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var n=e.apply(t,r);function s(e){_(n,o,a,s,i,"next",e)}function i(e){_(n,o,a,s,i,"throw",e)}s(void 0)}))}}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const v={props:["periodYearValue","oemCostHeader","oemCostLines","accountCodes","subAccountCodes","accountTypes"],components:{Loading:s(),VueNumeric:u()},watch:{periodYearValue:function(e){this.periodYear=e},oemCostHeader:function(e){this.oemCostHeaderData=e},oemCostLines:function(e){this.oemCostLineItems=e.map((function(e){return C(C({},e),{},{sub_account_disp:e.sub_account_code?"".concat(e.account_code).concat(e.sub_account_code):"",expense_amount:isNaN(e.expense_amount)?0:e.expense_amount})})),this.calTotalSummaryAmount()}},data:function(){return{periodYear:this.periodYearValue,oemCostHeaderData:this.oemCostHeader,oemCostLineItems:this.oemCostLines.map((function(e){return C(C({},e),{},{sub_account_disp:e.sub_account_code?"".concat(e.account_code).concat(e.sub_account_code):"",expense_amount:isNaN(e.expense_amount)?0:e.expense_amount})})),totalEstimateExpenseAmount:0,isLoading:!1}},mounted:function(){},computed:{},methods:{getAllocateTypeLabel:function(e,t){var r="";if(e.length>0&&t){var o=e.find((function(e){return e.allocate_type_value==t}));r=o?o.allocate_type_label:""}return r},isAllowAddNewLine:function(){var e=!1;if(this.oemCostHeaderData)if(this.oemCostLineItems.length>0){var t=this.oemCostLineItems[0];t.transfer_data&&"N"!=t.transfer_data||(e=!0)}else e=!0;return e},isAllowUpdate:function(){var e=!1;if(this.oemCostHeaderData&&this.oemCostLineItems.length>0){var t=this.oemCostLineItems[0];t.transfer_data&&"N"!=t.transfer_data||(e=!0)}return e},validateBeforeSaveLine:function(e){var t={valid:!0,message:""};return void 0!==e.expense_amount&&null!=e.expense_amount||(t.valid=!1,t.message='ข้อมูล "ค่าใช้จ่ายประมาณการ" ไม่ถูกต้อง กรุณาตรวจสอบ'),t},calTotalSummaryAmount:function(){var e=this;return m(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.totalEstimateExpenseAmount=e.oemCostLineItems.reduce((function(e,t){return e+(t.expense_amount?parseFloat(t.expense_amount):0)}),0);case 1:case"end":return t.stop()}}),t)})))()},onAddNewOemCostLine:function(){var e=this;return m(a().mark((function t(){var r,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={oem_cost_header_id:e.oemCostHeaderData.oem_cost_header_id,oem_cost_line_id:null,account_code:null,account_desc:null,sub_account_code:null,sub_account_disp:null,sub_account_desc:null,account_type:null,account_type_desc:null,expense_amount:0},e.oemCostLineItems=[].concat(l(e.oemCostLineItems),[r]),t.next=4,e.saveOemCostLine(r);case 4:o=t.sent,r.oem_cost_line_id=o?o.oem_cost_line_id:null,e.calTotalSummaryAmount(),e.emitOemCostLinesChanged();case 8:case"end":return t.stop()}}),t)})))()},onSubAccountCodeChanged:function(e,t){var r=this;return m(a().mark((function o(){var n,s,i,c;return a().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t.sub_account_disp=e,(n=r.subAccountCodes.find((function(t){return t.sub_account_disp==e})))&&(t.account_code=n.account_code,s=r.accountCodes.find((function(e){return e.account_code==n.account_code})),t.account_desc=s?s.account_desc:"",t.sub_account_code=n.sub_account_code,t.sub_account_desc=n.sub_account_desc,t.account_type=n.account_type,i=r.accountTypes.find((function(e){return e.account_type==n.account_type})),t.account_type_desc=i?i.account_type_desc:""),o.next=5,r.saveOemCostLine(t);case 5:c=o.sent,t.oem_cost_line_id=c?c.oem_cost_line_id:null,r.calTotalSummaryAmount(),r.emitOemCostLinesChanged();case 9:case"end":return o.stop()}}),o)})))()},onOemCostLineExpenseAmountChanged:function(e){var t=this;return m(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:isNaN(e.expense_amount)?t.$nextTick((function(){e.expense_amount=0,t.calTotalSummaryAmount(),t.emitOemCostLinesChanged()})):t.$nextTick(m(a().mark((function r(){var o;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.saveOemCostLine(e);case 2:o=r.sent,e.oem_cost_line_id=o?o.oem_cost_line_id:null,t.calTotalSummaryAmount(),t.emitOemCostLinesChanged();case 6:case"end":return r.stop()}}),r)}))));case 1:case"end":return r.stop()}}),r)})))()},onDeleteLine:function(e){var t=this;swal({title:"",text:"ต้องการลบรายการ ".concat(e.sub_account_disp?e.sub_account_disp:""," ").concat(e.sub_account_desc?e.sub_account_desc:"","  ?"),showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},function(){var r=m(a().mark((function r(o){var n;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!o){r.next=5;break}return r.next=3,t.deleteOemCostLine(e);case 3:n=t.oemCostLineItems.findIndex((function(t){return t==e})),t.oemCostLineItems.splice(n,1);case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},saveOemCostLine:function(e){var t=this;return m(a().mark((function r(){var o,n;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o={period_year:t.periodYear,input_oem_cost_header:JSON.stringify(t.oemCostHeader),input_oem_cost_line:JSON.stringify(e)},t.isLoading=!0,r.next=4,axios.post("/ajax/ct/oem-costs/line",o).then((function(e){var t=e.data.data,r=t.message,o=null;return"success"==t.status&&(o=t.oem_cost_line?JSON.parse(t.oem_cost_line):null),"error"==t.status&&swal("เกิดข้อผิดพลาด","บันทึกข้อมูล | ".concat(r),"error"),o})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","บันทึกข้อมูล | ".concat(e.message),"error")}));case 4:return n=r.sent,t.isLoading=!1,r.abrupt("return",n);case 7:case"end":return r.stop()}}),r)})))()},deleteOemCostLine:function(e){var t=this;return m(a().mark((function r(){var o;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o={period_year:t.periodYear,input_oem_cost_header:JSON.stringify(t.oemCostHeader),input_oem_cost_line:JSON.stringify(e)},t.isLoading=!0,r.next=4,axios.post("/ajax/ct/oem-costs/delete-line",o).then((function(e){var t=e.data.data,r=t.message;return t.status,"error"==t.status&&swal("เกิดข้อผิดพลาด","บันทึกข้อมูล | ".concat(r),"error"),t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","บันทึกข้อมูล | ".concat(e.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return r.stop()}}),r)})))()},emitOemCostLinesChanged:function(){this.$emit("onOemCostLinesChanged",{oemCostLines:this.oemCostLineItems})}}};var g=r(51900);const b=(0,g.Z)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.isAllowAddNewLine()?r("div",{staticClass:"text-right"},[r("button",{staticClass:"btn btn-sm btn-inline-block btn-primary tw-w-72 tw-mb-2",attrs:{type:"button",disabled:!e.oemCostHeader},on:{click:e.onAddNewOemCostLine}},[r("i",{staticClass:"fa fa-plus tw-mr-1"}),e._v(" เพิ่มรายการค่าแรงและค่าใช้จ่าย-รับจ้างผลิต \n        ")])]):e._e(),e._v(" "),r("div",{staticClass:"table-responsive",staticStyle:{"max-height":"600px"}},[r("table",{staticClass:"table table-bordered table-sticky mb-0"},[r("thead",[r("tr",[r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",staticStyle:{"z-index":"2"},attrs:{width:"15%"}},[e._v(" รหัสบัญชี ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",staticStyle:{"z-index":"2"},attrs:{width:"35%"}},[e._v(" ชื่อบัญชี ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",staticStyle:{"z-index":"2"},attrs:{width:"20%"}},[e._v(" ค่าแรง/ค่าใช้จ่าย  ")]),e._v(" "),r("th",{staticClass:"text-right tw-text-xs md:tw-table-cell",staticStyle:{"z-index":"2"},attrs:{width:"20%"}},[e._v(" ค่าใช้จ่าย (บาท)  ")]),e._v(" "),e.isAllowUpdate()?r("th",{attrs:{width:"10%"}}):e._e()])]),e._v(" "),e.oemCostLineItems.length>0?r("tbody",[e._l(e.oemCostLineItems,(function(t,o){return[r("tr",{key:""+o},[r("td",{staticClass:"text-center md:tw-table-cell"},[e.isAllowUpdate()?[r("pm-el-select",{attrs:{name:"sub_account_code",id:"input_sub_account_code","select-options":e.subAccountCodes,"option-key":"sub_account_disp","option-value":"sub_account_disp","option-label":"sub_account_disp",value:t.sub_account_disp,filterable:!0},on:{onSelected:function(r){return e.onSubAccountCodeChanged(r,t)}}})]:[e._v("\n                                "+e._s(t.sub_account_disp)+"\n                            ")]],2),e._v(" "),r("td",{staticClass:"text-left md:tw-table-cell"},[e._v("\n                            "+e._s(t.sub_account_desc)+"\n                        ")]),e._v(" "),r("td",{staticClass:"text-left md:tw-table-cell"},[e._v("\n                            "+e._s(t.account_desc)+"\n                        ")]),e._v(" "),r("td",{staticClass:"text-right md:tw-table-cell"},[e.isAllowUpdate()?[r("input",{directives:[{name:"model",rawName:"v-model",value:t.expense_amount,expression:"oemCostLineItem.expense_amount"}],staticClass:"form-control input-sm text-right",attrs:{type:"text",name:"expense_amount"+o,id:"input_expense_amount"+o,disabled:e.isLoading},domProps:{value:t.expense_amount},on:{blur:function(r){return e.onOemCostLineExpenseAmountChanged(t)},input:function(r){r.target.composing||e.$set(t,"expense_amount",r.target.value)}}})]:[e._v("\n                                "+e._s(t.expense_amount?Number(t.expense_amount).toLocaleString(void 0,{minimumFractionDigits:9,maximumFractionDigits:9}):"0.000000000")+" \n                            ")]],2),e._v(" "),e.isAllowUpdate()?r("td",{staticClass:"text-center md:tw-table-cell"},[e.isAllowUpdate()?[r("button",{staticClass:"btn btn-inline-block btn-danger",on:{click:function(r){return e.onDeleteLine(t)}}},[r("i",{staticClass:"fa fa-times"}),e._v(" ลบ\n                                ")])]:e._e()],2):e._e()])]}))],2):r("tbody",[e._m(0)])])]),e._v(" "),e.oemCostLineItems.length>0?r("div",[r("table",{staticClass:"table table-bordered table-sticky mb-0"},[r("thead",[e.oemCostLineItems.length>0?r("tr",[e._m(1),e._v(" "),r("td",{staticClass:"text-right md:tw-table-cell",staticStyle:{"border-left":"0"},attrs:{width:"20%"}},[r("b",[e._v(" "+e._s(Number(e.totalEstimateExpenseAmount).toLocaleString(void 0,{minimumFractionDigits:9,maximumFractionDigits:9}))+"  ")])]),e._v(" "),e.isAllowUpdate()?r("td",{staticClass:"text-left md:tw-table-cell",staticStyle:{"border-right":"0"},attrs:{width:"10%"}}):e._e()]):e._e()])])]):e._e(),e._v(" "),r("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}})],1)}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("td",{attrs:{colspan:"7"}},[r("h2",{staticClass:"p-5 text-center text-muted"},[e._v("ไม่พบข้อมูล")])])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("td",{staticClass:"text-right md:tw-table-cell",staticStyle:{"border-left":"0"},attrs:{width:"70%"}},[r("b",[e._v(" รวม ")])])}],!1,null,null,null).exports;function w(e,t,r,o,a,n,s){try{var i=e[n](s),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,a)}function y(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var n=e.apply(t,r);function s(e){w(n,o,a,s,i,"next",e)}function i(e){w(n,o,a,s,i,"throw",e)}s(void 0)}))}}const Y={props:["modalName","modalWidth","modalHeight","organizationCode","periodYearValue","periodYears","prdgrpPlans","ct14VersionNos","costCenters","productGroups","productItems"],components:{Loading:s()},watch:{periodYears:function(e){this.periodYearOptions=e},periodYearValue:function(e){this.periodYearLabel=this.getPeriodYearLabel(this.periodYears,e),this.periodYearLabel&&(this.periodYear=e,this.getListPrdgrps(this.periodYear),this.getListCostCenters(this.periodYear,this.prdgrpYearId),this.getListCt14VersionNos(this.periodYear,this.prdgrpYearId,this.costCode))}},data:function(){return{isLoading:!1,width:this.modalWidth,periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),periodYearOptions:this.periodYears,filteredPrdgrpPlans:[],prdgrpYearId:this.prdgrpYearIdValue,planVersionNo:null,filteredCostCenters:[],costCode:null,filteredCt14VersionNos:[],ct14VersionNo:null,oemCostHeaders:[],selectedOemCostHeader:null}},created:function(){this.handleResize()},mounted:function(){this.periodYearOptions=this.periodYears,this.periodYearLabel=this.getPeriodYearLabel(this.periodYears,this.periodYearValue),this.periodYearLabel&&(this.periodYear=this.periodYearValue,this.getListPrdgrps(this.periodYear),this.getListCostCenters(this.periodYear,this.prdgrpYearId),this.getListCt14VersionNos(this.periodYear,this.prdgrpYearId,this.costCode))},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},onPeriodYearChanged:function(e){var t=this;return y(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.periodYear=e,t.periodYearLabel=t.getPeriodYearLabel(t.periodYears,t.periodYear),t.periodNameFrom=null,t.periodNameTo=null,t.prdgrpYearId=null,t.costCode=null,t.ct14VersionNo=null,t.getListPrdgrps(t.periodYear),t.getListCostCenters(t.periodYear,t.prdgrpYearId),t.getListCt14VersionNos(t.periodYear,t.prdgrpYearId,t.costCode);case 10:case"end":return r.stop()}}),r)})))()},onPrdgrpVersionChanged:function(e){var t=this;return y(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.prdgrpYearId=e,t.planVersionNo=t.getPrdgrpPlanVersionNo(t.prdgrpPlans,t.prdgrpYearId),t.costCode=null,t.ct14VersionNo=null,t.getListCostCenters(t.periodYear,t.prdgrpYearId),t.getListCt14VersionNos(t.periodYear,t.prdgrpYearId,t.costCode);case 6:case"end":return r.stop()}}),r)})))()},onCostCodeChanged:function(e){var t=this;return y(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.costCode=e,t.ct14VersionNo=null,t.getListCt14VersionNos(t.periodYear,t.prdgrpYearId,t.costCode);case 3:case"end":return r.stop()}}),r)})))()},onCt14VersionNoChanged:function(e){var t=this;return y(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.ct14VersionNo=e;case 1:case"end":return r.stop()}}),r)})))()},getPeriodYearLabel:function(e,t){var r=null;return e&&t&&e.length>0&&(r=e.find((function(e){return e.period_year_value==t}))),r?r.period_year_label:""},getCostCodeLabel:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.cost_code==t}));r=o?o.cost_code_label:""}return r},getProductGroupLabel:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.product_group==t}));r=o?o.product_group_label:""}return r},getProductItemLabel:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.inventory_item_id==t}));r=o?o.item_desc:""}return r},getPrdgrpPlanVersionNo:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.prdgrp_year_id==t}));r=o?o.plan_version_no:""}return r},getListOemCostHeaders:function(){var e=this;return y(a().mark((function t(){var r,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoading=!0,e.oemCostHeaders=[],e.selectedOemCostHeader=null,r={period_year:e.periodYear,plan_version_no:e.planVersionNo,prdgrp_year_id:e.prdgrpYearId,cost_code:e.costCode,ct14_version_no:e.ct14VersionNo},o=null,e.periodYearOptions&&e.periodYear&&e.periodYearOptions.length>0&&(o=e.periodYearOptions.find((function(t){return t.period_year_value==e.periodYear}))),!o){t.next=11;break}return t.next=9,axios.get("/ajax/ct/oem-costs/list-headers",{params:r}).then((function(t){var r=t.data.data;return"error"==r.status?swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลปันส่วนของปีปัญชี ไม่ถูกต้อง | ".concat(r.message),"error"):e.oemCostHeaders=r.oem_cost_headers?JSON.parse(r.oem_cost_headers):null,r})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลปันส่วนของปีปัญชี ไม่ถูกต้อง | ".concat(e.message),"error")}));case 9:t.next=12;break;case 11:swal("เกิดข้อผิดพลาด","กรุณากรอกข้อมูลให้ครบถ้วน","error");case 12:e.isLoading=!1;case 13:case"end":return t.stop()}}),t)})))()},getListPrdgrps:function(e){var t=this;return y(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.filteredPrdgrpPlans=e?t.prdgrpPlans.filter((function(t){return t.period_year==e})):[];case 1:case"end":return r.stop()}}),r)})))()},getListCostCenters:function(e,t){this.filteredCostCenters=e&&t?this.costCenters.filter((function(r){return r.period_year==e&&r.prdgrp_year_id==t})):[]},getListCt14VersionNos:function(e,t,r){var o=this;return y(a().mark((function n(){return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o.filteredCt14VersionNos=e&&t?r?o.ct14VersionNos.filter((function(o){return o.period_year==e&&o.prdgrp_year_id==t&&o.cost_code==r&&!!o.ct14_version_no})).filter((function(e,t,r){return t===r.findIndex((function(t){return t.ct14_version_no===e.ct14_version_no}))})):o.ct14VersionNos.filter((function(r){return r.period_year==e&&r.prdgrp_year_id==t&&!!r.ct14_version_no})).filter((function(e,t,r){return t===r.findIndex((function(t){return t.ct14_version_no===e.ct14_version_no}))})):[];case 1:case"end":return a.stop()}}),n)})))()},onSelectOemCostHeaderVersion:function(e){this.selectedOemCostHeader=e,this.onSearchOemCostHeader()},onSearchOemCostHeader:function(){this.$modal.hide(this.modalName),this.$emit("onSearchOemCostHeader",{oem_cost_header:this.selectedOemCostHeader})}}};r(70524);const L=(0,g.Z)(Y,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"fixed","z-index":"100"}},[r("modal",{attrs:{name:e.modalName,width:e.width,scrollable:!0,height:e.modalHeight,shiftX:.3,shiftY:.3}},[r("div",{staticClass:"p-4"},[r("h4",[e._v(" ค้นหากำหนดเกณฑ์การปันส่วน ")]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-8"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" ปีบัญชีงบประมาณ ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":e.periodYearOptions,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:e.periodYear,filterable:!0},on:{onSelected:e.onPeriodYearChanged}})],1)]),e._v(" "),r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" แผนการผลิตครั้งที่ ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"prdgrp_year_id",id:"input_prdgrp_year_id","select-options":e.filteredPrdgrpPlans,"option-key":"prdgrp_year_id","option-value":"prdgrp_year_id","option-label":"plan_version_no",value:e.prdgrpYearId,filterable:!0,clearable:!0},on:{onSelected:e.onPrdgrpVersionChanged}})],1)]),e._v(" "),r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" ศูนย์ต้นทุน  ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"cost_code",id:"input_cost_code","select-options":e.filteredCostCenters,"option-key":"cost_code_value","option-value":"cost_code_value","option-label":"cost_code_label",value:e.costCode,filterable:!0,clearable:!0},on:{onSelected:e.onCostCodeChanged}})],1)]),e._v(" "),r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" ครั้งที่ ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"ct14_version_no",id:"input_ct14_version_no","select-options":e.filteredCt14VersionNos,"option-key":"ct14_version_no","option-value":"ct14_version_no","option-label":"ct14_version_no",value:e.ct14VersionNo,filterable:!0,clearable:!0},on:{onSelected:e.onCt14VersionNoChanged}})],1)])]),e._v(" "),r("div",{staticClass:"col-md-4"},[r("div",{staticClass:"text-right"},[r("button",{staticClass:"btn btn-primary tw-w-32",attrs:{type:"button",disabled:!e.periodYear},on:{click:e.getListOemCostHeaders}},[e._v(" \n                            ค้นหา \n                        ")]),e._v(" "),r("button",{staticClass:"btn btn-link tw-w-32 tw-mt-2",attrs:{type:"button"},on:{click:function(t){return e.$modal.hide(e.modalName)}}},[e._v(" \n                            ยกเลิก \n                        ")])])])]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"table-responsive",staticStyle:{"max-height":"360px"}},[r("table",{staticClass:"table table-bordered table-sticky mb-0"},[r("thead",[r("tr",[r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",attrs:{width:"10%"}},[e._v(" ปีบัญชีงบประมาณ ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",attrs:{width:"10%"}},[e._v(" แผนการผลิตครั้งที่ ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",attrs:{width:"10%"}},[e._v(" ศูนย์ต้นทุน ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",attrs:{width:"7%"}},[e._v(" ครั้งที่ ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",attrs:{width:"10%"}},[e._v(" กลุ่มผลิตภัณฑ์ ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",attrs:{width:"20%"}},[e._v(" ผลิตภัณฑ์ ")]),e._v(" "),r("th",{staticClass:"text-center tw-text-xs md:tw-table-cell",attrs:{width:"10%"}},[e._v(" จำนวนผลิต ")]),e._v(" "),r("th",{attrs:{width:"10%"}})])]),e._v(" "),e.oemCostHeaders.length>0?r("tbody",[e._l(e.oemCostHeaders,(function(t,o){return[r("tr",{key:o},[r("td",{staticClass:"text-center md:tw-table-cell"},[e._v(" "+e._s(t.period_year_thai)+" ")]),e._v(" "),r("td",{staticClass:"text-center md:tw-table-cell"},[e._v(" "+e._s(t.plan_version_no)+" ")]),e._v(" "),r("td",{staticClass:"text-center md:tw-table-cell"},[e._v(" "+e._s(t.cost_code?e.getCostCodeLabel(e.costCenters,t.cost_code):"-")+" ")]),e._v(" "),r("td",{staticClass:"text-center md:tw-table-cell"},[e._v(" "+e._s(t.ct14_version_no)+" ")]),e._v(" "),r("td",{staticClass:"text-left md:tw-table-cell"},[e._v(" "+e._s(t.product_group)+" : "+e._s(t.product_group_desc)+" ")]),e._v(" "),r("td",{staticClass:"text-left md:tw-table-cell"},[e._v(" "+e._s(t.product_item_number)+" : "+e._s(t.product_item_desc))]),e._v(" "),r("td",{staticClass:"text-right md:tw-table-cell"},[e._v(" "+e._s(t.product_quantity?Number(t.product_quantity).toLocaleString(void 0,{minimumFractionDigits:9,maximumFractionDigits:9}):"0.000000000")+" ")]),e._v(" "),r("td",{staticClass:"text-center md:tw-table-cell"},[r("button",{staticClass:"btn btn-inline-block btn-primary",on:{click:function(r){return e.onSelectOemCostHeaderVersion(t)}}},[e._v("\n                                        เลือก\n                                    ")])])])]}))],2):r("tbody",[r("tr",[r("td",{attrs:{colspan:"8"}},[r("h2",{staticClass:"p-2 text-center text-muted"},[e._v("ไม่พบข้อมูล")])])])])])])])]),e._v(" "),r("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}})],1)}),[],!1,null,"70d39daa",null).exports;function x(e,t,r,o,a,n,s){try{var i=e[n](s),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,a)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var n=e.apply(t,r);function s(e){x(n,o,a,s,i,"next",e)}function i(e){x(n,o,a,s,i,"throw",e)}s(void 0)}))}}const I={components:{Loading:s(),TableOemCostLines:b,ModalSearchOemCost:L},props:["defaultData","periodYearValue","prdgrpYearIdValue","ct14VersionNoValue","costCodeValue","productGroupValue","productItemValue","prdgrpPlans","ct14VersionNos","periodYears","existPeriodYears","costCenters","productGroups","productItems","accountCodes","subAccountCodes","accountTypes"],mounted:function(){var e=this;this.periodYearValue&&(this.getListPrdgrps(this.periodYearValue),this.prdgrpYearIdValue&&(this.planVersionNo=this.getPrdgrpPlanVersionNo(this.prdgrpPlans,this.prdgrpYearIdValue),this.getListCostCenters(this.periodYearValue,this.prdgrpYearIdValue),this.costCodeValue&&(this.costCode=this.costCodeValue,this.costCodeLabel=this.getCostCodeLabel(this.costCenters,this.costCode),this.getListVersionNos(this.periodYearValue,this.costCodeValue),this.ct14VersionNoValue&&(this.ct14AllocateYearId=this.getAllocateYearId(this.ct14VersionNos,this.periodYearValue,this.ct14VersionNoValue,this.costCodeValue)),this.filteredProductGroups=this.productGroups.filter((function(t){return t.period_year==e.periodYearValue&&t.cost_code==e.costCodeValue&&t.prdgrp_year_id==e.prdgrpYearIdValue})),this.productGroupValue&&(this.productGroup=this.productGroupValue,this.productGroupLabel=this.getProductGroupLabel(this.productGroups,this.productGroup),this.filteredProductItems=this.productItems.filter((function(t){return t.period_year==e.periodYearValue&&t.cost_code==e.costCodeValue&&t.prdgrp_year_id==e.prdgrpYearIdValue&&t.product_group==e.productGroupValue})),this.productItemValue&&(this.productItem=this.productItemValue,this.productItemLabel=this.getProductItemLabel(this.productItems,this.productItem)))))),this.periodYearValue&&this.prdgrpYearIdValue&&this.ct14VersionNoValue&&this.costCodeValue&&this.productGroupValue&&this.productItemValue&&this.getOemCostHeaderData(this.periodYearValue,this.prdgrpYearIdValue,this.planVersionNo,this.ct14VersionNoValue,this.costCodeValue,this.productGroupValue,this.productItemValue,!1)},data:function(){return{organizationId:this.defaultData?JSON.parse(this.defaultData).organization_id:null,organizationCode:this.defaultData?JSON.parse(this.defaultData).organization_code:null,department:this.defaultData?JSON.parse(this.defaultData).department:null,periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),filteredCt14VersionNos:[],ct14VersionNo:this.ct14VersionNoValue,ct14AllocateYearId:null,filteredCostCenters:[],costCode:this.costCodeValue,costCodeLabel:null,filteredProductGroups:[],productGroup:this.productGroupValue,productGroupLabel:null,filteredProductItems:[],productItem:this.productItemValue,productItemLabel:null,productQuantity:null,filteredPrdgrpPlans:[],prdgrpYearId:this.prdgrpYearIdValue,planVersionNo:null,oemCostHeader:null,oemCostLines:[],selectedOemCostYearData:{},isLoading:!1}},computed:{},methods:{setUrlParams:function(){var e=new URLSearchParams(window.location.search);e.set("period_year",this.periodYear?this.periodYear:""),e.set("plan_version_no",this.planVersionNo?this.planVersionNo:""),e.set("prdgrp_year_id",this.prdgrpYearId?this.prdgrpYearId:""),e.set("ct14_version_no",this.ct14VersionNo?this.ct14VersionNo:""),e.set("cost_code",this.costCode?this.costCode:""),e.set("product_group",this.productGroup?this.productGroup:""),e.set("product_inventory_item_id",this.productItem?this.productItem:""),window.history.replaceState(null,null,"?"+e.toString())},onPeriodYearChanged:function(e){var t=this;return V(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.periodYear=e,t.periodYearLabel=t.getPeriodYearLabel(t.periodYears,t.periodYear),t.setUrlParams(),t.oemCostHeader=null,t.oemCostLines=[],t.productGroup=null,t.productItem=null,t.productQuantity=null,t.ct14VersionNo=null,t.ct14AllocateYearId=null,t.prdgrpYearId=null,t.getListPrdgrps(t.periodYear),t.getListCostCenters(t.periodYear,t.prdgrpYearId),t.getListVersionNos(t.periodYear,t.prdgrpYearId,t.costCode);case 14:case"end":return r.stop()}}),r)})))()},onPrdgrpVersionChanged:function(e){var t=this;return V(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.prdgrpYearId=e,t.planVersionNo=t.getPrdgrpPlanVersionNo(t.prdgrpPlans,t.prdgrpYearId),t.oemCostHeader=null,t.oemCostLines=[],t.productQuantity=null,t.getListCostCenters(t.periodYear,t.prdgrpYearId),t.periodYear&&t.costCode&&t.prdgrpYearId?t.filteredProductGroups=t.productGroups.filter((function(e){return e.period_year==t.periodYear&&e.cost_code==t.costCode&&e.prdgrp_year_id==t.prdgrpYearId})):(t.filteredProductGroups=[],t.filteredProductItems=[]),t.periodYear&&t.prdgrpYearId&&t.ct14VersionNo&&t.costCode&&t.productGroup&&t.productItem&&t.getOemCostHeaderData(t.periodYear,t.prdgrpYearId,t.planVersionNo,t.ct14VersionNo,t.costCode,t.productGroup,t.productItem,!1),t.setUrlParams();case 9:case"end":return r.stop()}}),r)})))()},onCt14VersionNoChanged:function(e){var t=this;return V(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.ct14VersionNo=e,t.ct14AllocateYearId=t.getAllocateYearId(t.ct14VersionNos,t.periodYear,t.ct14VersionNo,t.costCode),t.oemCostHeader=null,t.oemCostLines=[],t.productQuantity=null,t.periodYear&&t.prdgrpYearId&&t.ct14VersionNo&&t.costCode&&t.productGroup&&t.productItem&&t.getOemCostHeaderData(t.periodYear,t.prdgrpYearId,t.planVersionNo,t.ct14VersionNo,t.costCode,t.productGroup,t.productItem,!1),t.setUrlParams();case 7:case"end":return r.stop()}}),r)})))()},onCostCodeChanged:function(e){var t=this;return V(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.costCode=e,t.costCodeLabel=t.getCostCodeLabel(t.costCenters,t.costCode),t.oemCostHeader=null,t.oemCostLines=[],t.getListVersionNos(t.periodYear,t.prdgrpYearId,t.costCode),t.periodYear&&t.costCode&&t.prdgrpYearId?t.filteredProductGroups=t.productGroups.filter((function(e){return e.period_year==t.periodYear&&e.cost_code==t.costCode&&e.prdgrp_year_id==t.prdgrpYearId})):(t.filteredProductGroups=[],t.filteredProductItems=[]),t.productGroup=null,t.productGroupLabel=null,t.productItem=null,t.productItemLabel=null,t.setUrlParams();case 11:case"end":return r.stop()}}),r)})))()},onProductGroupChanged:function(e){var t=this;return V(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.productGroup=e,t.productGroupLabel=t.getProductGroupLabel(t.productGroups,t.productGroup),t.oemCostHeader=null,t.oemCostLines=[],t.periodYear&&t.costCode&&t.prdgrpYearId&&t.productGroup?t.filteredProductItems=t.productItems.filter((function(e){return e.period_year==t.periodYear&&e.cost_code==t.costCode&&e.prdgrp_year_id==t.prdgrpYearId&&e.product_group==t.productGroup})):t.filteredProductItems=[],t.productItem=null,t.productItemLabel=null,t.productQuantity=null,t.setUrlParams();case 9:case"end":return r.stop()}}),r)})))()},onProductItemChanged:function(e){var t=this;return V(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.productItem=e,t.productItemLabel=t.getProductItemLabel(t.productItems,t.productItem),t.oemCostHeader=null,t.oemCostLines=[],t.productQuantity=null,r.next=7,t.getOemCostHeaderData(t.periodYear,t.prdgrpYearId,t.planVersionNo,t.ct14VersionNo,t.costCode,t.productGroup,t.productItem,!1);case 7:t.setUrlParams();case 8:case"end":return r.stop()}}),r)})))()},onProductQuantityChanged:function(e){var t=this;return V(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onSaveOemCostHeader();case 2:case"end":return e.stop()}}),e)})))()},isAllowUpdate:function(){var e=!0;this.oemCostHeader&&this.oemCostLines.length>0&&("Y"==this.oemCostLines[0].transfer_data&&(e=!1));return e},isAllowTransfer:function(){var e=!1;if(this.oemCostHeader&&this.oemCostLines.length>0){var t=this.oemCostLines[0];this.oemCostLines.find((function(e){return!e.expense_amount}))||t.transfer_data&&"N"!=t.transfer_data||(e=!0)}return e},isAllowCancelTransfer:function(){var e=!1;this.oemCostHeader&&this.oemCostLines.length>0&&("Y"==this.oemCostLines[0].transfer_data&&(e=!0));return e},getPeriodYearLabel:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.period_year_value==t}));r=o?o.period_year_label:""}return r},getCostCodeLabel:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.cost_code==t}));r=o?o.cost_code_label:""}return r},getProductGroupLabel:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.product_group==t}));r=o?o.product_group_label:""}return r},getProductItemLabel:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.inventory_item_id==t}));r=o?o.item_desc:""}return r},getPrdgrpPlanVersionNo:function(e,t){var r=null;if(t){var o=e.find((function(e){return e.prdgrp_year_id==t}));r=o?o.plan_version_no:""}return r},getAllocateYearId:function(e,t,r,o){var a=null;if(r){var n=e.find((function(e){return e.period_year==t&&e.ct14_version_no==r&&e.cost_code==o}));a=n?n.ct14_allocate_year_id:""}return a},getAllocateVersionNo:function(e,t,r,o){var a=null;if(r){var n=e.find((function(e){return e.period_year==t&&e.ct14_allocate_year_id==r&&e.cost_code==o}));a=n?n.ct14_version_no:""}return a},validateBeforeGetOemCostHeader:function(e,t,r,o,a,n){var s=!1;return e&&t&&r&&o&&a&&n&&(s=!0),s},validateBeforeSaveOemCostHeader:function(e,t,r,o,a,n,s){var i=!1;return e&&t&&r&&o&&a&&n&&s&&(i=!0),i},validateBeforeGetOemCostLines:function(e,t){var r=!1;return e&&t&&(r=!0),r},validateBeforeGenerateAccountTargets:function(e,t){var r=!1;return e&&t&&(r=!0),r},getOemCostHeaderData:function(e,t,r,o,n,s,i,c){var d=this;return V(a().mark((function u(){var l;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(d.isLoading=!0,d.oemCostHeader=null,l={period_year:e,prdgrp_year_id:t,plan_version_no:r,ct14_version_no:o,cost_code:n,product_group:s,product_inventory_item_id:i},d.selectedOemCostYearData={period_year:e,prdgrp_year_id:t,plan_version_no:r,ct14_version_no:o,cost_code:n,product_group:s,product_inventory_item_id:i,product_quantity:d.productQuantity},!d.validateBeforeGetOemCostHeader(e,t,o,n,s,i)){a.next=15;break}return a.next=8,axios.get("/ajax/ct/oem-costs/header",{params:l}).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลต้นทุนมาตรฐานค่าแรงและค่าใช้จ่าย-รับจ้างผลิต | ".concat(t.message),"error"):(d.oemCostHeader=t.oem_cost_header?JSON.parse(t.oem_cost_header):null,d.oemCostHeader&&!c&&(d.prdgrpYearId=d.oemCostHeader.prdgrp_year_id,d.ct14AllocateYearId=d.oemCostHeader.ct14_allocate_year_id,d.costCode=d.oemCostHeader.cost_code,d.costCodeLabel=d.getCostCodeLabel(d.costCenters,d.costCode),d.productGroup=d.oemCostHeader.product_group,d.productGroupLabel=d.getProductGroupLabel(d.productGroups,d.productGroup),d.productItem=d.oemCostHeader.product_inventory_item_id,d.productQuantity=d.oemCostHeader.product_quantity,d.planVersionNo=d.getPrdgrpPlanVersionNo(d.prdgrpPlans,d.prdgrpYearId),d.ct14VersionNo=d.getAllocateVersionNo(d.ct14VersionNos,d.periodYear,d.ct14AllocateYearId,d.costCode),d.productGroupLabel=d.getProductGroupLabel(d.productGroups,d.productGroup),d.productItemLabel=d.getProductItemLabel(d.productItems,d.productItem))),t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลต้นทุนมาตรฐานค่าแรงและค่าใช้จ่าย-รับจ้างผลิต | ".concat(e.message),"error")}));case 8:if("error"==a.sent.status){a.next=12;break}return a.next=12,d.getOemCostLines(d.periodYear,d.oemCostHeader);case 12:d.setUrlParams(),a.next=16;break;case 15:swal("เกิดข้อผิดพลาด","กรุณากรอกข้อมูลให้ครบถ้วน","error");case 16:d.isLoading=!1;case 17:case"end":return a.stop()}}),u)})))()},onTransferOemCostData:function(e,t){var r=this;return V(a().mark((function o(){var n;return a().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r.isLoading=!0,n={period_year:r.periodYear,input_oem_cost_header:JSON.stringify(e),input_oem_cost_lines:JSON.stringify(t)},o.next=4,axios.post("/ajax/ct/oem-costs/transfer",n).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ไม่สามารถโอนข้อมูล | ".concat(t.message),"error"):r.oemCostLines=t.oem_cost_lines?JSON.parse(t.oem_cost_lines):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถโอนข้อมูล | ".concat(e.message),"error")}));case 4:r.isLoading=!1;case 5:case"end":return o.stop()}}),o)})))()},onCancelTransferOemCostData:function(e,t){var r=this;return V(a().mark((function o(){var n;return a().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r.isLoading=!0,n={period_year:r.periodYear,input_oem_cost_header:JSON.stringify(e),input_oem_cost_lines:JSON.stringify(t)},o.next=4,axios.post("/ajax/ct/oem-costs/cancel-transfer",n).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ไม่สามารถยกเลิกโอนข้อมูล | ".concat(t.message),"error"):r.oemCostLines=t.oem_cost_lines?JSON.parse(t.oem_cost_lines):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถยกเลิกโอนข้อมูล | ".concat(e.message),"error")}));case 4:r.isLoading=!1;case 5:case"end":return o.stop()}}),o)})))()},getListPrdgrps:function(e){this.filteredPrdgrpPlans=e?this.prdgrpPlans.filter((function(t){return t.period_year==e})):[]},getListCostCenters:function(e,t){this.filteredCostCenters=e&&t?this.costCenters.filter((function(r){return r.period_year==e&&r.prdgrp_year_id==t})):[]},getListVersionNos:function(e,t,r){this.filteredCt14VersionNos=e&&r?this.ct14VersionNos.filter((function(o){return o.period_year==e&&o.prdgrp_year_id==t&&o.cost_code==r})):[]},getOemCostLines:function(e,t){var r=this;return V(a().mark((function o(){var n,s;return a().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=null,r.isLoading=!0,r.oemCostLines=[],s={period_year:e,input_oem_cost_header:JSON.stringify(t)},!r.validateBeforeGetOemCostLines(e,t)){o.next=9;break}return o.next=8,axios.get("/ajax/ct/oem-costs/lines",{params:s}).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรายการต้นทุนมาตรฐานค่าแรงและค่าใช้จ่าย-รับจ้างผลิต | ".concat(t.message),"error"):r.oemCostLines=t.oem_cost_lines?JSON.parse(t.oem_cost_lines):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรายการต้นทุนมาตรฐานค่าแรงและค่าใช้จ่าย-รับจ้างผลิต | ".concat(e.message),"error")}));case 8:n=o.sent;case 9:return r.isLoading=!1,o.abrupt("return",n);case 11:case"end":return o.stop()}}),o)})))()},getApproveStatusDesc:function(e){var t="-";if(e){var r=this.approveStatuses.find((function(t){return t.lookup_code==e}));t=r?r.description:"-"}return t},onOemCostLinesChanged:function(e){this.oemCostLines=e.oemCostLines},onSearchOemCostHeader:function(e){var t=this;return V(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.oemCostHeader=e.oem_cost_header,t.periodYear=t.oemCostHeader.period_year,t.periodYearLabel=t.getPeriodYearLabel(t.periodYears,t.periodYear),t.prdgrpYearId=t.oemCostHeader.prdgrp_year_id,t.costCode=t.oemCostHeader.cost_code,t.costCodeLabel=t.getCostCodeLabel(t.costCenters,t.costCode),t.ct14AllocateYearId=t.oemCostHeader.ct14_allocate_year_id,t.ct14VersionNo=t.getAllocateVersionNo(t.ct14VersionNos,t.periodYear,t.ct14AllocateYearId,t.costCode),t.productGroup=t.oemCostHeader.product_group,t.productGroupLabel=t.getProductGroupLabel(t.productGroups,t.productGroup),t.productItem=t.oemCostHeader.product_inventory_item_id,t.productQuantity=t.oemCostHeader.product_quantity,t.planVersionNo=t.getPrdgrpPlanVersionNo(t.prdgrpPlans,t.prdgrpYearId),t.productGroupLabel=t.getProductGroupLabel(t.productGroups,t.productGroup),t.productItemLabel=t.getProductItemLabel(t.productItems,t.productItem),t.periodYear&&(t.getListPrdgrps(t.periodYear),t.getListCostCenters(t.periodYear,t.prdgrpYearId),t.getListVersionNos(t.periodYear,t.prdgrpYearId,t.costCode),t.filteredProductGroups=t.productGroups.filter((function(e){return e.period_year==t.periodYearValue&&e.cost_code==t.costCode&&e.prdgrp_year_id==t.prdgrpYearId})),t.filteredProductItems=t.productItems.filter((function(e){return e.period_year==t.periodYearValue&&e.cost_code==t.costCode&&e.prdgrp_year_id==t.prdgrpYearId&&e.product_group==t.productGroup}))),r.next=18,t.getOemCostHeaderData(t.periodYear,t.prdgrpYearId,t.planVersionNo,t.ct14VersionNo,t.costCode,t.productGroup,t.productItem,!1);case 18:case"end":return r.stop()}}),r)})))()},onSaveOemCostHeader:function(){var e=this;return V(a().mark((function t(){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r={period_year:e.periodYear,prdgrp_year_id:e.prdgrpYearId,plan_version_no:e.planVersionNo,ct14_version_no:e.ct14VersionNo,cost_code:e.costCode,product_group:e.productGroup,product_inventory_item_id:e.productItem,product_quantity:e.productQuantity},!e.validateBeforeSaveOemCostHeader(e.periodYear,e.prdgrpYearId,e.ct14VersionNo,e.costCode,e.productGroup,e.productItem,e.productQuantity)){t.next=8;break}return e.isLoading=!0,t.next=6,axios.post("/ajax/ct/oem-costs/header",r).then((function(t){var r=t.data.data,o=r.message;return"success"==r.status&&(e.oemCostHeader=r.oem_cost_header?JSON.parse(r.oem_cost_header):null),"error"==r.status&&swal("เกิดข้อผิดพลาด","บันทึกต้นทุนมาตรฐานค่าแรงและค่าใช้จ่าย-รับจ้างผลิต | ".concat(o),"error"),r})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","บันทึกต้นทุนมาตรฐานค่าแรงและค่าใช้จ่าย-รับจ้างผลิต | ".concat(e.message),"error")}));case 6:t.next=8;break;case 8:e.isLoading=!1;case 9:case"end":return t.stop()}}),t)})))()},formatDateTh:function(e){return e?c()(e).add(543,"years").format("DD/MM/YYYY"):""}}};const N=(0,g.Z)(I,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ibox"},[r("div",{staticClass:"ibox-content tw-pt-10",staticStyle:{"min-height":"600px"}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-5"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" ปีบัญชีงบประมาณ ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":e.periodYears,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:e.periodYear,filterable:!0},on:{onSelected:e.onPeriodYearChanged}})],1)])]),e._v(" "),r("div",{staticClass:"col-md-7"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" แผนการผลิตครั้งที่ ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"prdgrp_year_id",id:"input_prdgrp_year_id","select-options":e.filteredPrdgrpPlans,"option-key":"prdgrp_year_id","option-value":"prdgrp_year_id","option-label":"plan_version_no",value:e.prdgrpYearId,filterable:!0},on:{onSelected:e.onPrdgrpVersionChanged}})],1)])])]),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-5"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" ครั้งที่ ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"ct14_version_no",id:"input_ct14_version_no","select-options":e.filteredCt14VersionNos,"option-key":"ct14_version_no","option-value":"ct14_version_no","option-label":"ct14_version_no",value:e.ct14VersionNo,filterable:!0},on:{onSelected:e.onCt14VersionNoChanged}})],1)])]),e._v(" "),r("div",{staticClass:"col-md-7"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" ศูนย์ต้นทุน  ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"cost_code",id:"input_cost_code","select-options":e.filteredCostCenters,"option-key":"cost_code_value","option-value":"cost_code_value","option-label":"cost_code_label",value:e.costCode,filterable:!0},on:{onSelected:e.onCostCodeChanged}})],1)])])]),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-5"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" กลุ่มผลิตภัณฑ์  ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"product_group",id:"input_product_group","select-options":e.filteredProductGroups,"option-key":"product_group_value","option-value":"product_group_value","option-label":"product_group_full_label",value:e.productGroup,filterable:!0},on:{onSelected:e.onProductGroupChanged}})],1)])]),e._v(" "),r("div",{staticClass:"col-md-7"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" ผลิตภัณฑ์ ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("pm-el-select",{attrs:{name:"product_inventory_item_id",id:"input_product_inventory_item_id","select-options":e.filteredProductItems,"option-key":"inventory_item_id","option-value":"inventory_item_id","option-label":"item_full_desc",value:e.productItem,filterable:!0},on:{onSelected:e.onProductItemChanged}})],1)])])]),e._v(" "),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-5"},[r("div",{staticClass:"row form-group"},[r("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0 required"},[e._v(" ปริมาณผลิต ")]),e._v(" "),r("div",{staticClass:"col-md-8"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.productQuantity,expression:"productQuantity"}],staticClass:"input-sm text-right form-control",attrs:{type:"number",name:"product_quantity",id:"input_product_quantity",min:"0",oninput:"this.value = Math.abs(this.value)",disabled:!e.isAllowUpdate()},domProps:{value:e.productQuantity},on:{blur:function(t){return e.onProductQuantityChanged(t)},input:function(t){t.target.composing||(e.productQuantity=t.target.value)}}})])])])]),e._v(" "),r("div",{staticClass:"row tw-mt-5"},[r("div",{staticClass:"col-md-12"},[r("div",{staticClass:"text-right"},[r("button",{staticClass:"btn btn-inline-block btn-white tw-w-32",on:{click:function(t){return e.$modal.show("modal-search-oem-cost")}}},[r("i",{staticClass:"fa fa-search tw-mr-1"}),e._v(" ค้นหา \n                    ")]),e._v(" "),r("button",{staticClass:"btn btn-inline-block btn-primary tw-w-52",attrs:{disabled:!e.isAllowTransfer()},on:{click:function(t){return e.onTransferOemCostData(e.oemCostHeader,e.oemCostLines)}}},[r("i",{staticClass:"fa fa-arrow-down"}),e._v(" โอนข้อมูล\n                    ")]),e._v(" "),r("button",{staticClass:"btn btn-inline-block btn-danger tw-w-52",attrs:{disabled:!e.isAllowCancelTransfer()},on:{click:function(t){return e.onCancelTransferOemCostData(e.oemCostHeader,e.oemCostLines)}}},[r("i",{staticClass:"fa fa-times"}),e._v(" ยกเลิกโอนข้อมูล \n                    ")])])])]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"row tw-mb-5"},[r("div",{staticClass:"col-12"},[r("table-oem-cost-lines",{attrs:{"period-year-value":e.periodYear,"oem-cost-header":e.oemCostHeader,"oem-cost-lines":e.oemCostLines,"account-codes":e.accountCodes,"sub-account-codes":e.subAccountCodes,"account-types":e.accountTypes},on:{onOemCostLinesChanged:e.onOemCostLinesChanged}})],1)])]),e._v(" "),r("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}}),e._v(" "),r("modal-search-oem-cost",{attrs:{"modal-name":"modal-search-oem-cost","modal-width":"1024","modal-height":"auto","organization-code":e.organizationCode,"period-year-value":e.periodYear,"period-years":e.periodYears,"prdgrp-plans":e.prdgrpPlans,"ct14-version-nos":e.ct14VersionNos,"cost-centers":e.costCenters,"product-groups":e.productGroups,"product-items":e.productItems},on:{onSearchOemCostHeader:e.onSearchOemCostHeader}})],1)}),[],!1,null,null,null).exports},70524:(e,t,r)=>{var o=r(60947);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,r(45346).Z)("01b0aecc",o,!0,{})}}]);