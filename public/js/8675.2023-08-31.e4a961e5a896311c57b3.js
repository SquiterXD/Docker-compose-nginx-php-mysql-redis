(self.webpackChunk=self.webpackChunk||[]).push([[8675],{98675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var i=r(87757),n=r.n(i),s=r(30381),o=r.n(s),c=r(80455);function f(e,t,r,i,n,s,o){try{var c=e[s](o),f=c.value}catch(e){return void r(e)}c.done?t(f):Promise.resolve(f).then(i,n)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var s=e.apply(t,r);function o(e){f(s,i,n,o,c,"next",e)}function c(e){f(s,i,n,o,c,"throw",e)}o(void 0)}))}}const a={props:["productTypes","budgetYears","defaultInput","searchInput","search","lines","workingHour"],components:{VueNumeric:r.n(c)()},data:function(){return{budget_year:this.defaultInput.current_year,month:"",bi_weekly:"",efficiency_machine:"",efficiency_product:this.defaultInput.efficiency_product,working_hour:this.defaultInput.working_hour,product_type:this.defaultInput.product_type,month_lists:[],bi_weekly_lists:[],loading:!1,m_loading:!1,b_loading:!1,errors:{budget_year:!1,month:!1,bi_weekly:!1,efficiency_product:!1}}},mounted:function(){this.budget_year&&this.getMonth()},computed:{monthLists:function(){return this.month_lists},biWeeklyLists:function(){return this.bi_weekly_lists},efficiencyMachine:function(){return this.efficiency_machine},efficiencyProduct:function(){return this.efficiency_product}},watch:{errors:{handler:function(e){e.budget_year?this.setError("budget_year"):this.resetError("budget_year"),e.month?this.setError("month"):this.resetError("month"),e.bi_weekly?this.setError("bi_weekly"):this.resetError("bi_weekly"),e.efficiency_product?this.setError("efficiency_product"):this.resetError("efficiency_product")},deep:!0}},methods:{getMonth:function(){this.search||(this.month="",this.bi_weekly="");o()().format("MMM-YY");this.month_lists=this.searchInput.months},getBiWeeklySeq:function(){var e=this;this.bi_weekly="",this.bi_weekly_lists=this.searchInput.bi_weekly.filter((function(t){return t.period_num==e.month}))},setError:function(e){(this.$refs[e].$refs.reference?this.$refs[e].$refs.reference.$refs.input:this.$refs[e].$refs.textarea?this.$refs[e].$refs.textarea:this.$refs[e].$refs.input.$refs?this.$refs[e].$refs.input.$refs.input:this.$refs[e].$refs.input).style="border: 1px solid red;"},resetError:function(e){(this.$refs[e].$refs.reference?this.$refs[e].$refs.reference.$refs.input:this.$refs[e].$refs.textarea?this.$refs[e].$refs.textarea:this.$refs[e].$refs.input.$refs?this.$refs[e].$refs.input.$refs.input:this.$refs[e].$refs.input).style=""},submit:function(){var e=this;return u(n().mark((function t(){var r,i,s,o,c;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=$("#machine-create-form"),i=r.serialize(),s=!0,o="",e.errors.budget_year=!1,e.errors.month=!1,e.errors.bi_weekly=!1,e.errors.efficiency_machine=!1,e.errors.efficiency_product=!1,$(r).find("div[id='budget_year']").html(""),$(r).find("div[id='el_explode_month']").html(""),$(r).find("div[id='el_explode_bi_weekly']").html(""),$(r).find("div[id='el_explode_efficiency_machine']").html(""),$(r).find("div[id='el_explode_efficiency_product']").html(""),""==e.budget_year&&(e.errors.budget_year=!0,s=!1,o="กรุณาเลือกปีงบประมาณ",$(r).find("div[id='el_explode_budget_year']").html(o)),""==e.month&&(e.errors.month=!0,s=!1,o="กรุณาเลือกเดือน",$(r).find("div[id='el_explode_month']").html(o)),""==e.bi_weekly&&(e.errors.bi_weekly=!0,s=!1,o="กรุณาเลือกปักษ์",$(r).find("div[id='el_explode_bi_weekly']").html(o)),""==e.efficiency_product&&(e.errors.efficiency_product=!0,s=!1,o="กรุณากรอกเปอร์เซ็นต์สั่งผลิต",$(r).find("div[id='el_explode_efficiency_product']").html(o)),s){t.next=20;break}return t.abrupt("return");case 20:return e.loading=!0,t.next=23,e.createMachineTransactions(i);case 23:"S"==(c=t.sent).status?(swal({title:"สร้างประมาณการผลิตประจำปักษ์",text:'<span style="font-size: 16px; text-align: left;"> ทำการสร้างข้อมูลประมาณการผลิตประจำปักษ์เรียบร้อยแล้ว </span>',type:"success",html:!0}),window.setTimeout((function(){window.location.href="/planning/machine-biweekly?search[budget_year]="+c.param.budget_year+"&search[month]="+c.param.month+"&search[bi_weekly]="+c.param.bi_weekly+"&search[product_type]="+c.product_type}),2e3)):swal({title:"มีข้อผิดพลาด",text:'<span style="font-size: 16px; text-align: left;">'+c.msg+"</span>",type:"warning",html:!0});case 25:case"end":return t.stop()}}),t)})))()},createMachineTransactions:function(e){var t=this;return u(n().mark((function r(){var i;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=[],r.next=3,axios.post("/planning/machine-biweekly",e).then((function(e){i=e.data})).catch((function(e){var t=e.response.data;swal({title:"มีข้อผิดพลาด",text:t.message,type:"error"})})).then((function(){t.loading=!1}));case 3:return r.abrupt("return",i);case 4:case"end":return r.stop()}}),r)})))()}}};const h=(0,r(51900).Z)(a,undefined,undefined,!1,null,null,null).exports}}]);