(self.webpackChunk=self.webpackChunk||[]).push([[3227],{17413:(t,e,r)=>{"use strict";r.d(e,{Z:()=>m});var a=r(87757),n=r.n(a),s=r(71170),o=(r(68737),r(30381)),i=r.n(o);function c(t,e,r,a,n,s,o){try{var i=t[s](o),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(a,n)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function o(t){c(s,a,n,o,i,"next",t)}function i(t){c(s,a,n,o,i,"throw",t)}o(void 0)}))}}var u,f;const d={props:["value","name","id","inputClass","placeholder","disabledDateTo","format","pType"],mounted:function(){},watch:{disabledDateTo:(f=l(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i()(e,this.format).toDate();case 2:if(t.t0=t.sent,t.t1=this.date,!(t.t0>t.t1)){t.next=6;break}this.date=null;case 6:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)}),value:(u=l(n().mark((function t(e,r){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.date=e&&e?i()(e,this.format).toDate():null;case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},components:{DatePicker:s.Z},data:function(){var t=this;return{type:null!=this.pType&&""!=this.pType?this.pType:"date",date:this.value?i()(this.value,this.format).toDate():null,defaultDate:this.value?i()(this.value,this.format).toDate():i()().add(543,"years").toDate(),lang:{formatLocale:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],monthsShort:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],weekdays:["พฤหัสบดี","ศุกร์","เสาร์","อาทิตย์","จันทร์","อังคาร","อังคาร"],weekdaysShort:["พฤหัสบดี","ศุกร์","เสาร์","อาทิตย์","จันทร์","อังคาร","อังคาร"],weekdaysMin:["พฤ.","ศ.","ส.","อา.","จ.","อ.","พ."],firstDayOfWeek:3},yearFormat:"YYYY",monthFormat:"MMM",monthBeforeYear:!0},disabledDate:function(e){if(t.disabledDateTo)return e<i()(t.disabledDateTo,t.format).toDate()}}},methods:{dateWasSelected:function(t){this.date=t,this.$emit("dateWasSelected",t)}}};const m=(0,r(51900).Z)(d,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("date-picker",{attrs:{"input-class":[t.inputClass],"default-value":t.defaultDate,"input-attr":{name:t.name,id:t.id},placeholder:t.placeholder,lang:t.lang,type:t.type,"disabled-date":t.disabledDate,format:t.format},on:{change:t.dateWasSelected},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})}),[],!1,null,null,null).exports},33227:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>T});var a=r(87757),n=r.n(a),s=r(80455),o=r.n(s),i=r(7398),c=r.n(i),l=(r(19371),r(30381)),u=r.n(l),f=r(17413);function d(t,e,r,a,n,s,o){try{var i=t[s](o),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(a,n)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function o(t){d(s,a,n,o,i,"next",t)}function i(t){d(s,a,n,o,i,"throw",t)}o(void 0)}))}}var v;const b={props:["countOpen","transBtn"],data:function(){return{newHeader:{},loading:!1,getParamlLoading:!1,transferDateFrom:u()().add(543,"years").toDate(),transferDateFromFormatted:this.getDateFormatted(u()().add(543,"years").toDate()),transferDateTo:"",transferDateToFormatted:"",inventoryItemId:"",inventoryItemList:[],transferNumber:"",transferNumberList:[],transferStatus:"",transferStatusList:[],transferHeaders:[]}},beforeMount:function(){},mounted:function(){},computed:{},watch:{countOpen:(v=m(n().mark((function t(e,r){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openModal(),this.getParam();case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return v.apply(this,arguments)})},methods:{onTransferDateFromWasSelected:function(t){var e=this;return m(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.transferDateFrom=t,e.transferDateFromFormatted=e.getDateFormatted(e.transferDateFrom),e.getParam();case 3:case"end":return r.stop()}}),r)})))()},onTransferDateToWasSelected:function(t){var e=this;return m(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t||(e.inventoryItemId="",e.transferNumber="",e.transferStatus=""),e.transferDateTo=t,e.transferDateToFormatted=e.getDateFormatted(e.transferDateTo),e.getParam();case 4:case"end":return r.stop()}}),r)})))()},getDateFormatted:function(t){return u()(t).format("DD/MM/YYYY")},openModal:function(){$("#modal_search").modal("show"),$(".slimScroll").slimScroll({height:"250px",width:"100%"})},searchForm:function(){var t=this;return m(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.search({action:"search"});case 1:case"end":return e.stop()}}),e)})))()},getParam:function(){var t=this;return m(n().mark((function e(){var r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t).loading=!0,r.inventoryItemList=[],r.transferNumberList=[],r.transferStatusList=[],r.transferHeaders=[],a={action:"get-param",transfer_date_from:r.transferDateFromFormatted,transfer_date_to:r.transferDateToFormatted,inventory_item_id:r.inventoryItemId,transfer_number:r.transferNumber,transfer_status:r.transferStatus},e.next=9,axios.get("/ajax/pm/products/trans/get-headers",{params:a}).then((function(t){var e=t.data.data;r.inventoryItemList=e.inventory_item_list,r.transferNumberList=e.transfer_number_list,r.transferStatusList=e.transfer_status_list})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล  | ".concat(t.message),"error")}));case 9:r.loading=!1;case 10:case"end":return e.stop()}}),e)})))()},getHeaders:function(){var t=this;return m(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,r={transfer_date_from:t.transferDateFromFormatted,transfer_date_to:t.transferDateToFormatted,inventory_item_id:t.inventoryItemId,transfer_number:t.transferNumber,transfer_status:t.transferStatus},e.next=4,axios.get("/ajax/pm/products/trans/get-headers",{params:r}).then((function(e){var r=e.data.data;return"success"==r.status?t.transferHeaders=r.transfer_headers?JSON.parse(r.transfer_headers):[]:swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล | ".concat(r.message),"error"),r})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล  | ".concat(t.message),"error")}));case 4:t.loading=!1;case 5:case"end":return e.stop()}}),e)})))()},selectRequestHeader:function(t){var e=this;return m(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.transferHeaders=[],$("#modal_search").modal("hide"),e.$emit("onSearchRequestHeader",{transferHeader:t});case 3:case"end":return r.stop()}}),r)})))()}}};var p=r(51900);const h=(0,p.Z)(b,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",[r("div",{staticClass:"modal inmodal fade",attrs:{id:"modal_search",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog modal-lg",staticStyle:{width:"90%","max-width":"1230px","padding-top":"1%"}},[r("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modal-body text-left"},[r("div",{staticClass:"row mb-2"},[r("div",{staticClass:"col-4"},[r("div",{staticClass:"row"},[t._m(1),t._v(" "),r("div",{staticClass:"col-7"},[r("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{name:"transfer_date_from",id:"input_transfer_date_from",placeholder:"โปรดเลือกวันที่",format:"DD/MM/YYYY",value:t.transferDateFrom},on:{dateWasSelected:t.onTransferDateFromWasSelected}})],1)])]),t._v(" "),r("div",{staticClass:"col-4"},[r("div",{staticClass:"row"},[t._m(2),t._v(" "),r("div",{staticClass:"col-8"},[r("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{name:"transfer_to",id:"input_transfer_to",placeholder:"โปรดเลือกวันที่",format:"DD/MM/YYYY",value:t.transferDateTo,"disabled-date-to":t.transferDateFromFormatted},on:{dateWasSelected:t.onTransferDateToWasSelected}})],1)])]),t._v(" "),r("div",{staticClass:"col-4"},[r("div",{staticClass:"row"},[t._m(3),t._v(" "),r("div",{staticClass:"col-7"},[r("el-select",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],staticClass:"w-100",attrs:{filterable:"",placeholder:"สินค้าที่จะผลิต",clearable:"","popper-append-to-body":!1},on:{change:function(e){e||(t.transferNumber="",t.transferStatus=""),t.getParam()}},model:{value:t.inventoryItemId,callback:function(e){t.inventoryItemId=e},expression:"inventoryItemId"}},t._l(t.inventoryItemList,(function(e,a){return t.inventoryItemList.length?r("el-option",{key:a,attrs:{label:e.label,value:e.value}}):t._e()})),1)],1)])])]),t._v(" "),r("div",{staticClass:"row mb-2"},[r("div",{staticClass:"col-4"},[r("div",{staticClass:"row"},[t._m(4),t._v(" "),r("div",{staticClass:"col-7"},[r("el-select",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],staticClass:"w-100",attrs:{filterable:"",placeholder:"ใบส่งเลขที่",clearable:"","popper-append-to-body":!1},on:{change:function(e){e||(t.transferStatus=""),t.getParam()}},model:{value:t.transferNumber,callback:function(e){t.transferNumber=e},expression:"transferNumber"}},t._l(t.transferNumberList,(function(t,e){return r("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)],1)])]),t._v(" "),r("div",{staticClass:"col-4"},[r("div",{staticClass:"row"},[t._m(5),t._v(" "),r("div",{staticClass:"col-8"},[r("el-select",{directives:[{name:"loading",rawName:"v-loading",value:!1,expression:"false"}],staticClass:"w-100",attrs:{filterable:"",placeholder:"สถานะ",clearable:"","popper-append-to-body":!1},on:{change:function(e){t.getParam()}},model:{value:t.transferStatus,callback:function(e){t.transferStatus=e},expression:"transferStatus"}},t._l(t.transferStatusList,(function(t,e){return r("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)],1)])]),t._v(" "),r("div",{staticClass:"col-4"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-4"}),t._v(" "),r("div",{staticClass:"col-7"},[r("button",{class:t.transBtn.search.class+" btn-lg tw-w-fullx",attrs:{type:"button"},on:{click:t.getHeaders}},[r("i",{class:t.transBtn.search.icon}),t._v("\n                                        "+t._s(t.transBtn.search.text)+"\n                                    ")])])])])]),t._v(" "),r("div",{staticClass:" "},[r("div",{staticClass:"table-responsive mb-5"},[r("table",{staticClass:"table table-hover"},[t._m(6),t._v(" "),r("tbody",t._l(t.transferHeaders,(function(e,a){return r("tr",{key:a},[r("td",{staticClass:"text-center"},[t._v(t._s(t.getDateFormatted(e.transfer_date)))]),t._v(" "),r("td",[t._v(t._s(e.transfer_number))]),t._v(" "),r("td",{staticClass:"text-left"},[e.status?r("div",[t._v("\n                                                "+t._s(e.status.description)+"\n                                            ")]):t._e()]),t._v(" "),r("td",{staticClass:"text-right"},[r("button",{class:t.transBtn.detail.class+" tw-w-25 btn-sm",attrs:{type:"button"},on:{click:function(r){return t.selectRequestHeader(e)}}},[r("i",{class:t.transBtn.detail.icon}),t._v("\n                                                "+t._s(t.transBtn.detail.text)+"\n                                            ")])])])})),0)])])])]),t._v(" "),t._m(7)])])])])}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[r("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),r("span",{staticClass:"sr-only"},[t._v("Close")])]),t._v(" "),r("h4",{staticClass:"modal-title"},[t._v("ค้นหารายการบันทึกส่งสินค้า")]),t._v(" "),r("small",{staticClass:"font-bold"},[t._v("\n                         \n                    ")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-5"},[r("div",{staticClass:"text-right tw-font-bold tw-uppercase mt-2"},[t._v(" วันที่ส่งผลผลิต :")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-4"},[r("div",{staticClass:"text-right tw-font-bold tw-uppercase mt-2"},[t._v(" ถึง :")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-4"},[r("div",{staticClass:"text-left tw-font-bold tw-uppercase mt-2"},[t._v(" สินค้าที่จะผลิต :")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-5"},[r("div",{staticClass:"text-right tw-font-bold tw-uppercase mt-2"},[t._v(" ใบส่งเลขที่ :")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-4"},[r("div",{staticClass:"text-right tw-font-bold tw-uppercase mt-2"},[t._v(" สถานะ :")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",{staticClass:"text-center",attrs:{width:"200px"}},[t._v("วันที่ส่งผลผลิต")]),t._v(" "),r("th",[t._v("ใบส่งเลขที่")]),t._v(" "),r("th",{staticClass:"text-left",attrs:{width:"200px"}},[t._v("สถานะส่งสินค้า")]),t._v(" "),r("th",{staticClass:"text-center",attrs:{width:"150px"}})])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal-footer"},[r("button",{staticClass:"btn btn-white",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])}],!1,null,null,null).exports;r(27361);function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function w(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach((function(e){I(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function I(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function C(t,e,r,a,n,s,o){try{var i=t[s](o),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(a,n)}function L(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function o(t){C(s,a,n,o,i,"next",t)}function i(t){C(s,a,n,o,i,"throw",t)}o(void 0)}))}}const D={components:{Loading:c(),modalSearch:h,DatepickerTh:f.Z,VueNumeric:o()},props:["pUrl","organizationCode","transferNumberValue","transferDateValue","profile","transBtn","transferObjectives","transferObjectiveValue","locators","toLocatorIdValue","deptCodes","requestStatuses"],computed:{},watch:{transferInvItemLines:function(t,e){},inputToLocators:function(t,e){var r=this,a=!1;r.toLocatorId&&(a=t.find((function(t){return t.locator_id==r.toLocatorId})))&&(r.toLocatorId=a.locator_id),0!=t.length&&a||(r.toLocatorId=""),r.setUrlParams()}},data:function(){return{isLoading:!1,transferNumber:this.transferNumberValue?this.transferNumberValue:"",transferDate:this.transferDateValue?u()(this.transferDateValue,"DD/MM/YYYY").toDate():u()().add(543,"years").toDate(),transferDateFormatted:this.transferDateValue?this.transferDateValue:this.getDateFormatted(u()().add(543,"years").toDate()),transferObjective:"",transferObjectiveLabel:"",inputToLocators:this.locators,toLocatorId:this.toLocatorIdValue?this.toLocatorIdValue:null,toLocatorDesc:"",invItems:[],availableInvItems:[],transferHeader:null,transferInvItemLines:[],confirmInvItems:[],transactionItems:[],availableTransactionItems:[],countOpenModal:0,reportUrl:""}},beforeMount:function(){},mounted:function(){var t=this;return L(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.transferObjectives.length>0&&(t.transferObjective=t.transferObjectiveValue?t.transferObjectiveValue:t.transferObjectives[0].lookup_code,t.transferObjectiveLabel=t.getTransObjectiveLabel(t.transferObjectives,t.transferObjectiveValue?t.transferObjectiveValue:t.transferObjectives[0].lookup_code)),t.inputToLocators=[],t.setLocators(),!t.transferNumber){e.next=14;break}return e.next=6,t.findHeader();case 6:if(!t.transferHeader){e.next=13;break}return e.next=9,t.getLines();case 9:return e.next=11,t.getConfirmItems(!1);case 11:e.next=14;break;case 13:swal({title:"ไม่พบข้อมูล",type:"warning",text:"ใบส่งเลขที่ : ".concat(t.transferNumber),confirmButtonClass:"btn-primary",confirmButtonText:"รับทราบ",showCancelButton:!1,closeOnConfirm:!0},(function(){var e=t.pUrl.index.substr(0,t.pUrl.index.lastIndexOf("?"));location.href=e}));case 14:case"end":return e.stop()}}),e)})))()},methods:{setUrlParams:function(){var t=new URLSearchParams(window.location.search);t.set("transfer_number",this.transferNumber?this.transferNumber:""),t.set("transfer_date",this.transferDateFormatted?this.transferDateFormatted:""),t.set("to_locator_id",this.toLocatorId?this.toLocatorId:""),t.set("transfer_objective",this.transferObjective?this.transferObjective:""),window.history.replaceState(null,null,"?"+t.toString());var e=this,r=e.transferNumber?e.transferNumber:"",a=e.transferDateFormatted?e.transferDateFormatted:"",n=e.toLocatorId?e.toLocatorId:"",s=e.transferObjective?e.transferObjective:"";e.reportUrl="",r&&n&&(e.reportUrl=window.location.origin+window.location.pathname,e.reportUrl=e.reportUrl+"?transfer_number="+r,e.reportUrl=e.reportUrl+"&transfer_date="+a,e.reportUrl=e.reportUrl+"&to_locator_id="+n,e.reportUrl=e.reportUrl+"&transfer_objective="+s,e.reportUrl=e.reportUrl+"&report=pdf")},onSearchRequestHeader:function(t){var e=this;return L(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.transferHeader=t.transferHeader,!t.transferHeader){r.next=14;break}return e.transferNumber=e.transferHeader.transfer_number,e.toLocatorId=e.transferHeader?e.transferHeader.attribute11:e.toLocatorId,e.transferObjective=e.transferHeader.transaction_type,e.transferDate=u()(e.transferHeader.transfer_date).add(543,"years").toDate(),e.transferDateFormatted=e.getDateFormatted(e.transferDate),r.next=9,e.findHeader();case 9:return r.next=11,e.getLines();case 11:return r.next=13,e.getConfirmItems();case 13:e.setUrlParams();case 14:case"end":return r.stop()}}),r)})))()},onTransferInvItemChanged:function(t,e,r){var a=this,n=e.inventory_item_id,s=this.invItems.find((function(e){return t==e.inventory_item_id})),o=this.availableTransactionItems.find((function(t){return t.inventory_item_id==s.inventory_item_id}));if(e.inventory_item_id=t,o){this.$nextTick((function(){e.item_number=s.item_number,e.item_desc=s.item_desc,e.organization_id=s.organization_id,e.organization_id_from=s.organization_id_from,e.transaction_uom=s.transaction_uom,e.uom_code=s.uom_code,e.unit_of_measure=s.unit_of_measure,e.convert_flag=s.convert_flag,e.destination_organization_id=s.destination_organization_id,e.destination_locator_id=s.destination_locator_id,e.locators=s.locators,e.lot_number_items=a.transactionItems.filter((function(e){return e.inventory_item_id==t})),e.lot_number=o.lot_number,e.onhand_qty=o.transaction_qty,e.transaction_qty=0,e.tobacco_type_code=s.tobacco_type_code,e.tobacco_group_code=s.tobacco_group_code,a.availableTransactionItems=a.getAvailableTransactionItems(a.transactionItems,a.transferInvItemLines),a.availableInvItems=a.getAvailableInvItems(a.invItems,a.availableTransactionItems)}))}else swal("เกิดข้อผิดพลาด"," รหัสสินค้าสำเร็จรูป : ".concat(s.item_number," ถูกเลือกใช้งานครบทุก Lot No. แล้ว"),"error"),this.$nextTick((function(){e.inventory_item_id=null==n?"":""==n?null:n}));this.checkConversItem()},onTransferLotNumberChanged:function(t,e,r){var a=this,n=e.lot_number,s=this.invItems.find((function(t){return e.inventory_item_id==t.inventory_item_id})),o=this.transactionItems.find((function(e){return e.inventory_item_id==s.inventory_item_id&&e.lot_number==t})),i=this.transferInvItemLines.find((function(r){return r.inventory_item_id==e.inventory_item_id&&r.lot_number==t}));if(e.lot_number=t,i)swal("เกิดข้อผิดพลาด"," รหัสสินค้าสำเร็จรูป : ".concat(i.item_number,", Lot No. : ").concat(t," ถูกเลือกใช้งานแล้ว"),"error"),this.$nextTick((function(){e.lot_number=n}));else{this.$nextTick((function(){e.item_number=s.item_number,e.item_desc=s.item_desc,e.organization_id=s.organization_id,e.organization_id_from=s.organization_id_from,e.transaction_uom=s.transaction_uom,e.uom_code=s.uom_code,e.unit_of_measure=s.unit_of_measure,e.convert_flag=s.convert_flag,e.destination_organization_id=s.destination_organization_id,e.destination_locator_id=s.destination_locator_id,e.locators=s.locators,e.lot_number=o.lot_number,e.onhand_qty=o.transaction_qty,e.transaction_qty=0,a.availableTransactionItems=a.getAvailableTransactionItems(a.transactionItems,a.transferInvItemLines),a.availableInvItems=a.getAvailableInvItems(a.invItems,a.availableTransactionItems)}))}},onTransactionQtyChanged:function(t){var e=this.invItems.find((function(e){return e.inventory_item_id==t.inventory_item_id})),r=this.transactionItems.find((function(e){return e.inventory_item_id==t.inventory_item_id&&e.lot_number==t.lot_number}));return this.validateOnhandQty(t)?this.transferInvItemLines.filter((function(t){return t.inventory_item_id==e.inventory_item_id})).reduce((function(t,e){return t+e.transaction_qty}),0)>e.available_confirm_issue_qty?(swal("เกิดข้อผิดพลาด","รหัสสินค้าสำเร็จรูป : ".concat(e.item_number,', ไม่สามารถกรอกผลรวม "จำนวนส่งเข้าคลัง" ได้เกินกว่า ').concat(e.available_confirm_issue_qty),"error"),void this.$nextTick((function(){t.transaction_qty=0}))):void 0:(swal("เกิดข้อผิดพลาด","รหัสสินค้าสำเร็จรูป : ".concat(e.item_number,", Lot No. : ").concat(r.lot_number,', ไม่สามารถกรอกผลรวม "จำนวนส่งเข้าคลัง" ได้เกินกว่า ').concat(r.transaction_qty),"error"),void this.$nextTick((function(){t.transaction_qty=0})))},validateOnhandQty:function(t){var e=!0,r=this.transactionItems.find((function(e){return e.inventory_item_id==t.inventory_item_id&&e.lot_number==t.lot_number}));if(r){var a=parseFloat(r.transaction_qty);parseFloat(t.transaction_qty)>a&&(e=!1)}return e},onAddNewLine:function(){var t=this;return L(n().mark((function e(){var r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.availableInvItems.length>0?t.availableInvItems[0]:null,t.transferObjectives.length>0&&"40"==t.transferObjective&&0==t.transferInvItemLines.length?t.transferInvItemLines=[{lot_number_items:"",lot_number:"",onhand_qty:[],transaction_qty:""}]:r&&(a=t.availableTransactionItems.length>0?t.availableTransactionItems.find((function(t){return t.inventory_item_id==r.inventory_item_id})):null,0,t.transferInvItemLines=[].concat(y(t.transferInvItemLines),[w(w({},r),{},{lot_number_items:t.transactionItems.length>0?t.transactionItems.filter((function(t){return t.inventory_item_id==r.inventory_item_id})):[],lot_number:a?a.lot_number:null,onhand_qty:a?a.transaction_qty:0,transaction_qty:0})])),t.isLoading=!0,t.availableTransactionItems=t.getAvailableTransactionItems(t.transactionItems,t.transferInvItemLines),t.availableInvItems=t.getAvailableInvItems(t.invItems,t.availableTransactionItems),t.isLoading=!1,t.checkConversItem();case 7:case"end":return e.stop()}}),e)})))()},calDefaultTransactionQty:function(t,e){var r=parseFloat(t.transaction_qty),a=parseFloat(e.transaction_qty),n=this.transferInvItemLines.filter((function(t){return t.inventory_item_id==e.inventory_item_id&&t.lot_number!=e.lot_number})).reduce((function(t,e){return t+e.transaction_qty}),0),s=a;return n+a>r&&(s=r-n>=0?r-n:0),s},onDeleteLine:function(t,e,r){var a=this;return L(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:swal({title:"",text:"ต้องการลบรายการ ".concat(e.item_desc?e.item_desc:""," ?"),showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(t){if(t){var r=a.transferInvItemLines.findIndex((function(t){return t==e}));a.transferInvItemLines.splice(r,1),a.availableTransactionItems=a.getAvailableTransactionItems(a.transactionItems,a.transferInvItemLines),a.availableInvItems=a.getAvailableInvItems(a.invItems,a.availableTransactionItems)}}));case 1:case"end":return t.stop()}}),t)})))()},onTransObjectiveWasChanged:function(t){this.transferObjective=t,this.transferObjectiveLabel=this.getTransObjectiveLabel(this.transferObjectives,this.transferObjective),this.setUrlParams(),this.setLocators()},onToLocatorWasChanged:function(t){this.toLocatorId=t,this.toLocatorDesc=this.getLocatorDesc(this.inputToLocators,t),this.setUrlParams()},onTransferDateWasSelected:function(t){var e=this;return L(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.transferDate=t,e.transferDateFormatted=e.getDateFormatted(e.transferDate),e.confirmInvItems=[],e.transactionItems=[],e.invItems=[],e.availableInvItems=[],e.availableTransactionItems=[],e.transferInvItemLines=[],e.setUrlParams();case 9:case"end":return r.stop()}}),r)})))()},setLocators:function(){var t=this,e=!1;if(t.transferObjective){var r=t.transferObjectives.find((function(e){return e.lookup_code==t.transferObjective}));e=t.locators[r.tag],"M12"!=t.profile.organization_code&&"M03"!=t.profile.organization_code||(e=t.locators[r.lookup_code])}t.inputToLocators=e||t.locators.WIP_COMPLETION,t.inputToLocators.length&&"M06"==t.profile.organization_code&&("10"==t.transferObjective&&(t.inputToLocators=_.filter(t.inputToLocators,(function(t){return"PURROJ04.99999999"==t.locator}))),"20"!=t.transferObjective&&"30"!=t.transferObjective||(t.inputToLocators=_.filter(t.inputToLocators,(function(t){return"FC6ROJ01.ZONE002"==t.locator||"FC6ROJ01.ZONE006"==t.locator})))),t.toLocatorDesc=t.toLocatorIdValue?t.getLocatorDesc(t.inputToLocators,t.toLocatorIdValue):""},onCreateNew:function(){location.href="/pm/products/trans"},onGetConfirmItems:function(){var t=this;return L(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getConfirmItems();case 2:t.transferInvItemLines.length>0&&t.$nextTick((function(){t.transferInvItemLines.map((function(e){var r=t.confirmInvItems.find((function(t){return t.inventory_item_id==e.inventory_item_id}));return e.transaction_qty=r.transaction_qty,e}))}));case 3:case"end":return e.stop()}}),e)})))()},getDateFormatted:function(t){return u()(t).format("DD/MM/YYYY")},onSave:function(){var t=this;return L(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.saveHeader();case 2:return e.next=4,t.saveLines();case 4:case"end":return e.stop()}}),e)})))()},findHeader:function(){var t=this;return L(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,r={transfer_number:t.transferNumber},e.next=4,axios.get("/ajax/pm/products/trans/find-header",{params:r}).then((function(e){var r=e.data.data;return"success"==r.status?(t.transferNumber=t.transferHeader?t.transferHeader.transfer_number:t.transferNumber,t.transferHeader=r.transfer_header?JSON.parse(r.transfer_header):t.transferHeader,t.toLocatorId=t.transferHeader?t.transferHeader.attribute11:t.toLocatorId,t.transferObjective=t.transferHeader?t.transferHeader.attribute15:t.transferObjective):swal("เกิดข้อผิดพลาด","".concat(r.message),"error"),r})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","".concat(t.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},validateBeforeSaveHeader:function(t){return{valid:!0,message:""}},saveHeader:function(){var t=this;return L(n().mark((function e(){var r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={transfer_number:t.transferNumber,transfer_date:t.transferDateFormatted,transfer_objective:t.transferObjective,to_locator_id:t.toLocatorId,transfer_header:JSON.stringify(t.transferHeader)},t.isLoading=!0,!(a=t.validateBeforeSaveHeader(t.transferHeader)).valid){e.next=8;break}return e.next=6,axios.post("/ajax/pm/products/trans/store-header",r).then((function(e){var r=e.data.data,a=r.message;return"success"==r.status&&(t.isNewlyCreate=!1,t.transferHeader=r.transfer_header?JSON.parse(r.transfer_header):t.transferHeader,t.transferNumber=t.transferHeader?t.transferHeader.transfer_number:t.transferNumber,t.toLocatorId=t.transferHeader?t.transferHeader.attribute11:t.toLocatorId,t.transferNumber&&t.setUrlParams()),"error"==r.status&&swal("เกิดข้อผิดพลาด","".concat(a),"error"),r})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","".concat(t.message),"error")}));case 6:e.next=9;break;case 8:swal("เกิดข้อผิดพลาด","".concat(a.message),"error");case 9:t.isLoading=!1;case 10:case"end":return e.stop()}}),e)})))()},validateBeforeSaveLines:function(t,e){return L(n().mark((function t(){var e;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={valid:!0,message:""},t.abrupt("return",e);case 2:case"end":return t.stop()}}),t)})))()},saveLines:function(){var t=this;return L(n().mark((function e(){var r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={transfer_number:t.transferNumber,transfer_date:t.transferDateFormatted,transfer_objective:t.transferObjective,to_locator_id:t.toLocatorId,transfer_header:JSON.stringify(t.transferHeader),transfer_inv_item_lines:JSON.stringify(t.transferInvItemLines)},t.isLoading=!0,e.next=4,t.validateBeforeSaveLines(t.transferHeader,t.transferInvItemLines);case 4:if(!(a=e.sent).valid){e.next=10;break}return e.next=8,axios.post("/ajax/pm/products/trans/store-lines",r).then((function(e){var r=e.data.data,a=r.message;return"success"==r.status&&(t.isNewlyCreate=!1,t.transferInvItemLines=r.transfer_inv_item_lines?JSON.parse(r.transfer_inv_item_lines):[],swal("Success","บันทึกข้อมูล เลขที่ใบส่ง : ".concat(t.transferNumber," "),"success")),"error"==r.status&&swal("เกิดข้อผิดพลาด","เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(a),"error"),r})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(e.message),"error")}));case 8:e.next=11;break;case 10:swal("เกิดข้อผิดพลาด","เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(a.message),"error");case 11:t.isLoading=!1;case 12:case"end":return e.stop()}}),e)})))()},confirmRequest:function(){var t=this;return L(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={transfer_header:JSON.stringify(t.transferHeader)},t.isLoading=!0,e.next=4,axios.post("/ajax/pm/products/trans/confirm-request",r).then((function(e){var r=e.data.data,a=r.message;return"success"==r.status&&(t.isNewlyCreate=!1,t.transferHeader=r.transfer_header?JSON.parse(r.transfer_header):t.transferHeader,t.transferNumber=t.transferHeader?t.transferHeader.transfer_number:t.transferNumber,t.toLocatorId=t.transferHeader?t.transferHeader.attribute11:t.toLocatorId,swal("Success","ยืนยันส่งสินค้าสำเร็จรูป เลขที่ใบส่ง : ".concat(t.transferNumber," "),"success")),"error"==r.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถยืนยันส่งสินค้าสำเร็จรูป เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(a),"error"),r})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถยืนยันส่งสินค้าสำเร็จรูป เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(e.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},discardConfirmedRequest:function(){var t=this;return L(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,helperAlert.showProgressConfirm("ต้องการยกเลิกส่งสินค้าสำเร็จรูป : ".concat(t.transferNumber," ?"));case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return r={transfer_number:t.transferNumber,transfer_header:JSON.stringify(t.transferHeader)},t.isLoading=!0,e.next=9,axios.post("/ajax/pm/products/trans/discard-confirmed-request",r).then((function(e){var r=e.data.data,a=r.message;return"success"==r.status&&(t.isNewlyCreate=!1,t.transferHeader=r.transfer_header?JSON.parse(r.transfer_header):t.transferHeader,t.transferNumber=t.transferHeader?t.transferHeader.transfer_number:t.transferNumber,t.toLocatorId=t.transferHeader?t.transferHeader.attribute11:t.toLocatorId,swal("Success","ยกเลิก เลขที่ใบส่ง : ".concat(t.transferNumber," "),"success")),"error"==r.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถยกเลิก เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(a),"error"),r})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถยกเลิก เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(e.message),"error")}));case 9:t.isLoading=!1;case 10:case"end":return e.stop()}}),e)})))()},cancelRequest:function(){var t=this;return L(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={transfer_number:t.transferNumber,transfer_header:JSON.stringify(t.transferHeader)},t.isLoading=!0,e.next=4,axios.post("/ajax/pm/products/trans/cancel-request",r).then((function(e){var r=e.data.data,a=r.message;return"success"==r.status&&(t.isNewlyCreate=!1,t.transferHeader=r.transfer_header?JSON.parse(r.transfer_header):t.transferHeader,t.transferNumber=t.transferHeader?t.transferHeader.transfer_number:t.transferNumber,t.toLocatorId=t.transferHeader?t.transferHeader.attribute11:t.toLocatorId,swal("Success","ยกเลิกข้อมูล เลขที่ใบส่ง : ".concat(t.transferNumber," "),"success")),"error"==r.status&&swal("เกิดข้อผิดพลาด","ยกเลิกข้อมูล เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(a),"error"),r})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ยกเลิกข้อมูล เลขที่ใบส่ง : ".concat(t.transferNumber," | ").concat(e.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},getConfirmItems:function(){var t=arguments,e=this;return L(n().mark((function r(){var a,s;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=!(t.length>0&&void 0!==t[0])||t[0],e.isLoading=!0,s={transfer_date:e.transferDateFormatted,objective_code:e.transferObjective},r.next=5,axios.get("/ajax/pm/products/trans/get-confirm-items",{params:s}).then((function(t){var r=t.data.data;return"success"==r.status?(e.confirmInvItems=r.confirm_inv_items?JSON.parse(r.confirm_inv_items):[],e.transactionItems=r.transaction_items?JSON.parse(r.transaction_items):[],e.invItems=e.confirmInvItems.filter((function(t){return!!e.transactionItems.find((function(e){return t.inventory_item_id==e.inventory_item_id}))})),e.availableTransactionItems=e.getAvailableTransactionItems(e.transactionItems,e.transferInvItemLines),e.availableInvItems=e.getAvailableInvItems(e.invItems,e.availableTransactionItems),e.confirmInvItems.length<=0&&a&&swal("ไม่พบข้อมูล","ไม่พบข้อมูลสินค้าสำเร็จรูป วันที่ส่งผลผลิต ".concat(e.transferDateFormatted),"info")):swal("เกิดข้อผิดพลาด","".concat(r.message),"error"),r})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","".concat(t.message),"error")}));case 5:e.isLoading=!1;case 6:case"end":return r.stop()}}),r)})))()},getLines:function(){var t=this;return L(n().mark((function e(){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,r={transfer_number:t.transferNumber},e.next=4,axios.get("/ajax/pm/products/trans/get-lines",{params:r}).then((function(e){var r=e.data.data;return"success"==r.status?t.transferInvItemLines=r.transfer_inv_item_lines?JSON.parse(r.transfer_inv_item_lines):[]:swal("เกิดข้อผิดพลาด","".concat(r.message),"error"),r})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","".concat(t.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})))()},getAvailableInvItems:function(t,e){return t.filter((function(t){return e.find((function(e){return t.inventory_item_id==e.inventory_item_id}))}))},getAvailableTransactionItems:function(t,e){return t.filter((function(t){return!e.find((function(e){return t.inventory_item_id==e.inventory_item_id&&t.lot_number==e.lot_number}))}))},getTransObjectiveLabel:function(t,e){var r=t.find((function(t){return t.lookup_code==e}));return r?r.description:""},getLocatorDesc:function(t,e){var r=t.find((function(t){return t.locator_id==e}));return r?r.locator_full_desc:""},getDepartmentDesc:function(t,e){var r=t.find((function(t){return t.department_code==e}));return r?r.department_desc:""},getTransferStatusDesc:function(t){var e="",r=t?t.transfer_status:"";if(r){var a=this.requestStatuses.find((function(t){return t.lookup_code==r}));a&&(e=a.description)}return e},isAllowAddNewLine:function(t){var e=!0;return t?("1"!=t.transfer_status&&(e=!1),(this.availableInvItems.length<=0||this.availableTransactionItems.length<=0)&&(e=!1)):(this.availableInvItems.length<=0||this.availableTransactionItems.length<=0)&&(e=!1),e},isAllowDeleteLine:function(t){var e=!0;return t&&"1"!=t.transfer_status&&(e=!1),e},isAllowCreateNewTransfer:function(t){return!0},isAllowGetConfirmItems:function(t){return!t||"1"==t.transfer_status},isAllowUpdateTransfer:function(t){return!t||"1"==t.transfer_status},isAllowConfirmTransfer:function(t){return!!t&&"1"==t.transfer_status},isAllowDiscardTransfer:function(t){var e=!0;return t?("1"==t.transfer_status&&(e=!1),"2"==t.transfer_status&&(e=!0),"3"==t.transfer_status&&(e=!1),"4"==t.transfer_status&&(e=!1),1==t.can_cancel_after_inf&&(e=!0)):e=!1,e},isAllowCancelTransfer:function(t){var e=!0;return t?("1"==t.transfer_status&&(e=!0),"2"==t.transfer_status&&(e=!0),"3"==t.transfer_status&&(e=!1),"4"==t.transfer_status&&(e=!1)):e=!1,e},isAllowInputTransactionQty:function(t){return!t||"1"==t.transfer_status},checkConversItem:function(){var t=this;return L(n().mark((function e(){var r,a,s,o,i,c,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t,a=JSON.parse(JSON.stringify(r.inputToLocators)),1!=r.transferInvItemLines.length){e.next=18;break}return e.next=5,r.transferInvItemLines[0];case 5:if(!(s=e.sent).item_number){e.next=18;break}return e.next=9,t.confirmInvItems.filter((function(t){return t.convert_flag==s.convert_flag&&t.destination_organization_id==s.destination_organization_id}));case 9:return o=e.sent,e.next=12,t.transactionItems.filter((function(t){return t.convert_flag==s.convert_flag&&t.destination_organization_id==s.destination_organization_id}));case 12:i=e.sent,t.invItems=o.filter((function(e){return!!t.transactionItems.find((function(t){return e.inventory_item_id==t.inventory_item_id}))})),t.availableTransactionItems=t.getAvailableTransactionItems(i,t.transferInvItemLines),t.availableInvItems=t.getAvailableInvItems(t.invItems,t.availableTransactionItems),"Y"==s.convert_flag&&(r.inputToLocators=s.locators);case 18:c=!1,r.toLocatorId&&(l=a.find((function(t){return t.locator_id==r.toLocatorId})),(c=r.inputToLocators.find((function(t){return t.locator==l.locator})))&&(r.toLocatorId=c.locator_id)),0!=r.inputToLocators.length&&c||(r.toLocatorId="");case 21:case"end":return e.stop()}}),e)})))()}}};const T=(0,p.Z)(D,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"ibox float-e-margins"},[r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"row tw-mb-2"},[r("div",{staticClass:"col-12 text-right"},[r("modal-search",{attrs:{countOpen:t.countOpenModal,"trans-btn":t.transBtn},on:{onSearchRequestHeader:t.onSearchRequestHeader}}),t._v(" "),r("button",{class:t.transBtn.search.class+" btn-lg tw-w-40 mr-2",on:{click:function(e){e.preventDefault(),t.countOpenModal+=1}}},[r("i",{class:t.transBtn.search.icon}),t._v("\n                        "+t._s(t.transBtn.search.text)+"\n                    ")]),t._v(" "),r("button",{class:t.transBtn.create.class+" btn-lg tw-w-25 mr-2",attrs:{type:"button",disabled:!t.isAllowCreateNewTransfer(t.transferHeader)},on:{click:t.onCreateNew}},[r("i",{class:t.transBtn.create.icon}),t._v("\n                        "+t._s(t.transBtn.create.text)+"\n                    ")]),t._v(" "),r("button",{class:t.transBtn.save.class+" btn-lg tw-w-25 mr-2",attrs:{type:"button",disabled:!t.isAllowUpdateTransfer(t.transferHeader)},on:{click:t.onSave}},[r("i",{class:t.transBtn.save.icon}),t._v("\n                        "+t._s(t.transBtn.save.text)+"\n                    ")]),t._v(" "),r("button",{staticClass:"btn btn-primary btn-lg tw-w-48 mr-2",attrs:{type:"button",disabled:!t.isAllowConfirmTransfer(t.transferHeader)},on:{click:t.confirmRequest}},[r("i",{staticClass:"fa fa-check"}),t._v(" "),r("strong",[t._v(" ยืนยันส่งสินค้าสำเร็จรูป ")])]),t._v(" "),r("button",{staticClass:"btn btn-w-m btn-danger btn-lg tw-w-48 mr-2",attrs:{type:"button",disabled:!t.isAllowDiscardTransfer(t.transferHeader)},on:{click:t.discardConfirmedRequest}},[r("i",{staticClass:"fa fa-times"}),t._v(" ยกเลิกส่งสินค้าสำเร็จรูป\n                    ")]),t._v(" "),r("button",{staticClass:"btn btn-w-m btn-danger btn-lg tw-w-32",attrs:{type:"button",disabled:!t.isAllowCancelTransfer(t.transferHeader)},on:{click:t.cancelRequest}},[r("i",{staticClass:"fa fa-times"}),t._v(" ยกเลิกใบส่ง\n                    ")]),t._v(" "),t.transferObjective&&t.transferObjective>="40"?r("a",{class:t.reportUrl?"btn btn-info btn-lg tw-w-25":"btn btn-info btn-lg tw-w-25 disabled",attrs:{target:"_blank",href:t.reportUrl}},[r("i",{staticClass:"fa fa-print"}),t._v(" พิมพ์\n                    ")]):t._e()],1)])]),t._v(" "),r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-lg-5"},[r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right",attrs:{for:"lb-2"}},[t._v("ใบส่งเลขที่: ")]),t._v(" "),r("div",{staticClass:"col-lg-7"},[r("input",{staticClass:"form-control",attrs:{id:"lb-2",type:"text",name:"transfer_number",disabled:!0},domProps:{value:t.transferNumber}})])]),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v("วันที่ส่งผลผลิต: ")]),t._v(" "),r("div",{staticClass:"col-lg-7"},[t.isAllowUpdateTransfer(t.transferHeader)?r("div",[r("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",attrs:{name:"transfer_date",id:"input_transfer_date",placeholder:"โปรดเลือกวันที่",format:"DD/MM/YYYY",value:t.transferDate,disabled:!t.isAllowUpdateTransfer(t.transferHeader)},on:{dateWasSelected:t.onTransferDateWasSelected}})],1):r("div",[r("input",{staticClass:"form-control",attrs:{id:"lb-2",type:"text",name:"transfer_date",disabled:!0},domProps:{value:t.transferDateFormatted}})])])])]),t._v(" "),r("div",{staticClass:"col-lg-7"},[r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v(" สถานะส่งสินค้าสำเร็จรูป : ")]),t._v(" "),r("div",{staticClass:"col-lg-7"},[r("input",{staticClass:"form-control",attrs:{type:"text",readonly:"",disabled:""},domProps:{value:t.getTransferStatusDesc(t.transferHeader)}})])]),t._v(" "),t.transferObjectives.length>1?r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v(" ประเภทการส่ง : ")]),t._v(" "),r("div",{staticClass:"col-lg-7"},[t.isAllowUpdateTransfer(t.transferHeader)&&!this.transferNumber?r("div",[r("pm-el-select",{attrs:{name:"transfer_objective",id:"transfer_objective","select-options":t.transferObjectives,"option-key":"lookup_code","option-value":"lookup_code","option-label":"description",value:t.transferObjective,filterable:!0,disabled:!t.isAllowUpdateTransfer(t.transferHeader)},on:{onSelected:t.onTransObjectiveWasChanged}})],1):r("div",[t.transferHeader?r("input",{staticClass:"form-control",attrs:{id:"lb-2",type:"text",name:"transfer_objective",disabled:!0},domProps:{value:t.transferHeader.obj_desc}}):t._e()])])]):t._e(),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right required"},[t._v(" สถานที่จัดเก็บปลายทาง : ")]),t._v(" "),r("div",{staticClass:"col-lg-7"},[t.isAllowUpdateTransfer(t.transferHeader)?r("div",[r("pm-el-select",{attrs:{name:"to_locator_id",id:"input_to_locator_id","select-options":t.inputToLocators,"option-key":"locator_id","option-value":"locator_id","option-label":"locator_full_desc",value:t.toLocatorId,filterable:!0},on:{onSelected:t.onToLocatorWasChanged}})],1):r("div",[r("input",{staticClass:"form-control",attrs:{id:"lb-2",type:"text",name:"locator_id",disabled:!0},domProps:{value:t.transferHeader.to_locator_desc}})])])]),t._v(" "),r("div",{staticClass:"form-group row"},[r("div",{staticClass:"col-lg-11 text-right"},[r("button",{class:t.transBtn.search.class+" btn-lg tw-w-32",attrs:{disabled:!t.isAllowGetConfirmItems(t.transferHeader)},on:{click:t.onGetConfirmItems}},[r("i",{class:t.transBtn.search.icon}),t._v("\n                                แสดงข้อมูล\n                            ")])])])])])])]),t._v(" "),r("div",{staticClass:"ibox float-e-margins"},[r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"text-right tw-mb-2"},[r("button",{staticClass:"btn btn-inline-block btn-sm btn-success tw-w-32",attrs:{disabled:!t.isAllowAddNewLine(t.transferHeader)},on:{click:t.onAddNewLine}},[r("i",{staticClass:"fa fa-plus tw-mr-1"}),t._v(" เพิ่มรายการ\n                ")])]),t._v(" "),r("div",{staticClass:"table-responsive",staticStyle:{"max-height":"600px"}},[r("table",{staticClass:"table table-bordered table-sticky"},[r("thead",[r("tr",[r("th",{staticClass:"text-center",attrs:{width:"30px;"}}),t._v(" "),r("th",{staticClass:"text-center",attrs:{width:"170px;"}},[t._v("\n                                รหัสสินค้าสำเร็จรูป\n                            ")]),t._v(" "),r("th",{staticClass:"text-center"},[t._v("\n                                รายละเอียด\n                            ")]),t._v(" "),r("th",{staticClass:"text-center",attrs:{width:"310px;"}},[t._v("\n                                Lot No.\n                            ")]),t._v(" "),r("th",{staticClass:"text-center",attrs:{width:"200px;"}},[t._v("\n                                จำนวนส่งเข้าคลัง\n                            ")]),t._v(" "),r("th",{staticClass:"text-center",attrs:{width:"100px;"}},[t._v("\n                                หน่วยนับ\n                            ")]),t._v(" "),t.isAllowDeleteLine(t.transferHeader)?r("th",{staticClass:"text-center",attrs:{width:"30px;"}}):t._e()])]),t._v(" "),t.transferInvItemLines.length>0?r("tbody",[t._l(t.transferInvItemLines,(function(e,a){return[r("tr",{key:""+a},[r("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(a+1)+" ")]),t._v(" "),r("td",{staticClass:"align-middle text-center"},[t.isAllowUpdateTransfer(t.transferHeader)?[r("pm-el-select",{attrs:{name:"item_number_"+a,id:"input_item_number_"+a,"select-options":t.invItems,"option-key":"inventory_item_id","option-value":"inventory_item_id","option-label":"item_number",value:e.inventory_item_id,filterable:!0},on:{onSelected:function(r){return t.onTransferInvItemChanged(r,e,a)}}})]:[t._v("\n                                        "+t._s(e.item_number)+"\n                                    ")]],2),t._v(" "),r("td",{staticClass:"align-middle text-left"},[t._v("\n                                    "+t._s(e.item_desc)+"\n                                ")]),t._v(" "),r("td",{staticClass:"align-middle text-center"},[t.isAllowUpdateTransfer(t.transferHeader)?[r("pm-el-select",{attrs:{name:"lot_number_"+a,id:"input_lot_number_"+a,"select-options":e.lot_number_items,"option-key":"lot_number","option-value":"lot_number","option-label":"lot_number_desc",value:e.lot_number,filterable:!0},on:{onSelected:function(r){return t.onTransferLotNumberChanged(r,e,a)}}})]:[t._v("\n                                        "+t._s(e.lot_number)+"\n                                    ")]],2),t._v(" "),r("td",{staticClass:"align-middle text-right"},[t.isAllowInputTransactionQty(t.transferHeader)?[r("vue-numeric",{staticClass:"form-control input-sm text-right",staticStyle:{"min-width":"120px"},attrs:{separator:",",precision:2,minus:!1,id:"input_transaction_qty_"+a,name:"transaction_qty_"+a},on:{change:function(r){return t.onTransactionQtyChanged(e)}},model:{value:e.transaction_qty,callback:function(r){t.$set(e,"transaction_qty",r)},expression:"transferInvItemLine.transaction_qty"}})]:[t._v("\n                                        "+t._s(Number(e.transaction_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))+"\n                                    ")]],2),t._v(" "),r("td",{staticClass:"align-middle text-center",attrs:{title:e.unit_of_measure}},[t._v("\n                                    "+t._s(e.unit_of_measure)+"\n                                ")]),t._v(" "),t.isAllowDeleteLine(t.transferHeader)?r("td",[r("button",{staticClass:"btn btn-sm btn-danger",attrs:{type:"button"},on:{click:function(r){return t.onDeleteLine(t.transferInvItemLines,e,a)}}},[r("i",{staticClass:"fa fa-trash"})])]):t._e()])]}))],2):r("tbody",[t._m(0)])])])])]),t._v(" "),r("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}})],1)}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",[r("td",{attrs:{colspan:"11"}},[r("h2",{staticClass:"p-5 text-center text-muted"},[t._v(" ไม่พบข้อมูล ")])])])}],!1,null,null,null).exports}}]);