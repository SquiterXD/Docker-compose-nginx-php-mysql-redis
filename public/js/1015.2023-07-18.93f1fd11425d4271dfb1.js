(self.webpackChunk=self.webpackChunk||[]).push([[1015],{52208:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(23645),o=n.n(s)()((function(e){return e[1]}));o.push([e.id,".mx-datepicker{height:32px}",""]);const r=o},41015:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var s=n(87757),o=n.n(s),r=n(30381),i=n.n(r);function m(e,t,n,s,o,r,i){try{var m=e[r](i),a=m.value}catch(e){return void n(e)}m.done?t(a):Promise.resolve(a).then(s,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(s,o){var r=e.apply(t,n);function i(e){m(r,s,o,i,a,"next",e)}function a(e){m(r,s,o,i,a,"throw",e)}i(void 0)}))}}const g={props:["ledgers","budgetLists","amountLists","encumbranceLists","accountLevelLists","inquiryFunds","search","defaultInput","defaultValueSetName"],data:function(){return{aliLoad:!1,loading:!1,get_data_loading:!1,value:"",period:this.search.period?this.search.period:i()().format("MMM-YY"),ledger:this.search.ledger?this.search.ledger:this.defaultInput.ledger,budget:this.search.budget?this.search.budget:"1000",amountType:this.search.amount_type?this.search.amount_type:"YTDE",encumType:this.search.encum_type?this.search.encum_type:"ALL",accLevel:this.search.account_level?this.search.account_level:"A",detail:"",segment1From:"",segment2From:"",segment3From:"",segment4From:"",segment5From:"",segment6From:"",segment7From:"",segment8From:"",segment9From:"",segment10From:"",segment11From:"",segment12From:"",segment1To:"",segment2To:"",segment3To:"",segment4To:"",segment5To:"",segment6To:"",segment7To:"",segment8To:"",segment9To:"",segment10To:"",segment11To:"",segment12To:"",option1:[],option2:[],option3:[],option4:[],option5:[],option6:[],option7:[],option8:[],option9:[],option10:[],option11:[],option12:[],account_from:this.search?this.search.account_from:"",account_to:this.search?this.search.account_to:"",coaEnter:this.search?this.search.account_from:"",alias:"",aliasLists:"",funds:this.inquiryFunds,periodBalances:[],reqEncumbranceAmount:"",poEncumbranceAmount:"",otherEncumbranceAmount:"",encumbrances:[],errors:{period:!1,segmentOverride:!1,segment1:!1,segment2:!1,segment3:!1,segment4:!1,segment5:!1,segment6:!1,segment7:!1,segment8:!1,segment9:!1,segment10:!1,segment11:!1,segment12:!1},get_data_flag:!1,sel_concate_segment:"",adj_flag:!(!this.search.adj_flag||"true"!=this.search.adj_flag),adj_period:this.search.adj_period?this.search.adj_period:i()().format("YYYY"),sel_fund:"",sel_period:"",currentPage:1,perPage:10,defaultPeriodYear:""}},mounted:function(){this.getValueSetList(),this.enterAccSegment(),this.getPeriodYear()},computed:{budgetTotal:function(){return this.periodBalances.reduce((function(e,t){return e+parseFloat(t.budget)}),0)},encumbrancePeriodTotal:function(){return this.periodBalances.reduce((function(e,t){return e+parseFloat(t.encumbrance)}),0)},encumbranceBcTotal:function(){return this.encumbrances.reduce((function(e,t){return e+parseFloat(t.encumbrance_amount)}),0)},actualTotal:function(){return this.periodBalances.reduce((function(e,t){return e+parseFloat(t.actual)}),0)},availableTotal:function(){return this.periodBalances.reduce((function(e,t){return e+parseFloat(t.available)}),0)},rows:function(){return this.inquiryFunds.length},itemsForList:function(){return this.funds.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage)}},watch:{errors:{handler:function(e){e.period?this.setError("period"):this.resetError("period"),e.segmentOverride?this.setError("segmentOverride"):this.resetError("segmentOverride")},deep:!0}},methods:{decimal:function(e){return Number(e).toLocaleString(void 0,{minimumFractionDigits:2})},calEncumbrance:function(e,t){var n=0;this.encumbrances.length>0&&this.encumbrances.filter((function(e){e.period_name==t&&(n=e.encumbrance_amount)}));var s=Number(e)+Number(n);return Number(s).toLocaleString(void 0,{minimumFractionDigits:2})},calAvaliable:function(e,t){var n=0;this.encumbrances.length>0&&this.encumbrances.filter((function(e){e.period_name==t&&(n=e.encumbrance_amount)}));var s=Number(e)-Number(n);return Number(s).toLocaleString(void 0,{minimumFractionDigits:2})},encumbranceTotal:function(e,t){var n=Number(e)+Number(t);return Number(n).toLocaleString(void 0,{minimumFractionDigits:2})},avaliableTotal:function(e,t){var n=Number(e)-Number(t);return Number(n).toLocaleString(void 0,{minimumFractionDigits:2})},changeAdjPeriod:function(){this.adj_period=i()(this.adj_period).format("YYYY")},selAdjPeriod:function(){0==this.adj_flag&&(this.period=i()().format("MMM-YY"))},updateCoaFrom:function(e){e.name==this.defaultValueSetName.segment1&&(this.segment1From=e.segment1From,this.segment1To=e.segment1To,this.option1=e.options),e.name==this.defaultValueSetName.segment2&&(this.segment2From=e.segment2From,this.segment2To=e.segment2To,this.option2=e.options),e.name==this.defaultValueSetName.segment3&&(this.segment3From=e.segment3From,this.segment3To=e.segment3To,this.option3=e.options),e.name==this.defaultValueSetName.segment4&&(this.segment4From=e.segment4From,this.segment4To=e.segment4To,this.option4=e.options),e.name==this.defaultValueSetName.segment5&&(this.segment5From=e.segment5From,this.segment5To=e.segment5To,this.option5=e.options),e.name==this.defaultValueSetName.segment6&&(this.segment6From=e.segment6From,this.segment6To=e.segment6To,this.option6=e.options),e.name==this.defaultValueSetName.segment7&&(this.segment7From=e.segment7From,this.segment7To=e.segment7To,this.option7=e.options),e.name==this.defaultValueSetName.segment8&&(this.segment8From=e.segment8From,this.segment8To=e.segment8To,this.option8=e.options),e.name==this.defaultValueSetName.segment9&&(this.segment9From=e.segment9From,this.segment9To=e.segment9To,this.option9=e.options),e.name==this.defaultValueSetName.segment10&&(this.segment10From=e.segment10From,this.segment10To=e.segment10To,this.option10=e.options),e.name==this.defaultValueSetName.segment11&&(this.segment11From=e.segment11From,this.segment11To=e.segment11To,this.option11=e.options),e.name==this.defaultValueSetName.segment12&&(this.segment12From=e.segment12From,this.segment12To=e.segment12To,this.option12=e.options)},updateCoaTo:function(e){e.name==this.defaultValueSetName.segment1&&(this.segment1To=e.segment1To,this.option1=e.options),e.name==this.defaultValueSetName.segment2&&(this.segment2To=e.segment2To,this.option2=e.options),e.name==this.defaultValueSetName.segment3&&(this.segment3To=e.segment3To,this.option3=e.options),e.name==this.defaultValueSetName.segment4&&(this.segment4To=e.segment4To,this.option4=e.options),e.name==this.defaultValueSetName.segment5&&(this.segment5To=e.segment5To,this.option5=e.options),e.name==this.defaultValueSetName.segment6&&(this.segment6To=e.segment6To,this.option6=e.options),e.name==this.defaultValueSetName.segment7&&(this.segment7To=e.segment7To,this.option7=e.options),e.name==this.defaultValueSetName.segment8&&(this.segment8To=e.segment8To,this.option8=e.options),e.name==this.defaultValueSetName.segment9&&(this.segment9To=e.segment9To,this.option9=e.options),e.name==this.defaultValueSetName.segment10&&(this.segment10To=e.segment10To,this.option10=e.options),e.name==this.defaultValueSetName.segment11&&(this.segment11To=e.segment11To,this.option11=e.options),e.name==this.defaultValueSetName.segment12&&(this.segment12To=e.segment12To,this.option12=e.options)},accountConfirm:function(){var e=this,t=$("#tb-segment-override"),n=$("#modal-flexfield"),s=!0;if(e.errors.segment1From=!1,e.errors.segment2From=!1,e.errors.segment3From=!1,e.errors.segment4From=!1,e.errors.segment5From=!1,e.errors.segment6From=!1,e.errors.segment7From=!1,e.errors.segment8From=!1,e.errors.segment9From=!1,e.errors.segment10From=!1,e.errors.segment11From=!1,e.errors.segment12From=!1,e.errors.segmentOverride=!1,$(t).find("div[id='el_explode_acc_1']").html(""),$(t).find("div[id='el_explode_acc_2']").html(""),$(t).find("div[id='el_explode_acc_3']").html(""),$(t).find("div[id='el_explode_acc_4']").html(""),$(t).find("div[id='el_explode_acc_5']").html(""),$(t).find("div[id='el_explode_acc_6']").html(""),$(t).find("div[id='el_explode_acc_7']").html(""),$(t).find("div[id='el_explode_acc_8']").html(""),$(t).find("div[id='el_explode_acc_9']").html(""),$(t).find("div[id='el_explode_acc_10']").html(""),$(t).find("div[id='el_explode_acc_11']").html(""),$(t).find("div[id='el_explode_acc_12']").html(""),$(t).find("div[id='el_explode_segment']").html(""),""==e.segment1From&&""==e.segment2From&&""==e.segment3From&&""==e.segment4From&&""==e.segment5From&&""==e.segment6From&&""==e.segment7From&&""==e.segment8From&&""==e.segment9From&&""==e.segment10From&&""==e.segment11From&&""==e.segment12From&&(e.errors.segmentOverride=!0,s=!1,"ยังไม่มีการกรอกชุดบัญชี กรุณาตรวจสอบ",$(n).find("div[id='el_explode_segment']").html("ยังไม่มีการกรอกชุดบัญชี กรุณาตรวจสอบ")),s){e.account_from=e.segment1From+"."+e.segment2From+"."+e.segment3From+"."+e.segment4From+"."+e.segment5From+"."+e.segment6From+"."+e.segment7From+"."+e.segment8From+"."+e.segment9From+"."+e.segment10From+"."+e.segment11From+"."+e.segment12From,e.account_to=e.segment1To+"."+e.segment2To+"."+e.segment3To+"."+e.segment4To+"."+e.segment5To+"."+e.segment6To+"."+e.segment7To+"."+e.segment8To+"."+e.segment9To+"."+e.segment10To+"."+e.segment11To+"."+e.segment12To,e.coaEnter=e.account_from;t=$("#fund-form");$(t).find("div[id='el_explode_segment']").html(""),$("#modal-flexfield").modal("hide")}},findFund:function(){var e=this;return a(o().mark((function t(){var n,s,r,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("#fund-form"),n=$("#fund-form"),s=n.serialize(),r=!0,e.errors.period=!1,e.errors.segmentOverride=!1,$(n).find("div[id='el_explode_period']").html(""),$(n).find("div[id='el_explode_segment']").html(""),""!=e.period&&null!=e.period||(e.errors.period=!0,r=!1,"กรุณากรอกงวดบัญชี",$(n).find("div[id='el_explode_period']").html("กรุณากรอกงวดบัญชี")),r){t.next=11;break}return t.abrupt("return");case 11:return e.loading=!0,t.next=14,e.getFundBySegment(s);case 14:"S"==(i=t.sent).status?window.setTimeout((function(){window.location.href=i.redirect_show_page}),500):swal({title:"มีข้อผิดพลาด",text:'<span style="font-size: 16px; text-align: left;">'+i.msg+"</span>",type:"error",html:!0});case 16:case"end":return t.stop()}}),t)})))()},getFundBySegment:function(e){var t=this;return a(o().mark((function n(){var s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=[],n.next=3,axios.post("/inquiry-funds",e).then((function(e){s=e.data})).catch((function(e){var t=e.response.data;swal({title:"มีข้อผิดพลาด",text:t.message,type:"error"})})).then((function(){t.loading=!0}));case 3:return n.abrupt("return",s);case 4:case"end":return n.stop()}}),n)})))()},getValueSetList:function(e){var t=this;return a(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.aliLoad=!0,axios.get("/ajax/inquiry-funds",{params:{flex_value_set_name:t.defaultValueSetName.alias,flex_value_set_data:t.alias,query:e}}).then((function(e){t.aliasLists=e.data})).catch((function(e){console.log(e)})).then((function(){t.aliLoad=!1}));case 2:case"end":return n.stop()}}),n)})))()},chooseAlias:function(){var e=this,t=$("#tb-segment-override");if(e.errors.segment1From=!1,e.errors.segment2From=!1,e.errors.segment3From=!1,e.errors.segment4From=!1,e.errors.segment5From=!1,e.errors.segment6From=!1,e.errors.segment7From=!1,e.errors.segment8From=!1,e.errors.segment9From=!1,e.errors.segment10From=!1,e.errors.segment11From=!1,e.errors.segment12From=!1,$(t).find("div[id='el_explode_acc_1']").html(""),$(t).find("div[id='el_explode_acc_2']").html(""),$(t).find("div[id='el_explode_acc_3']").html(""),$(t).find("div[id='el_explode_acc_4']").html(""),$(t).find("div[id='el_explode_acc_5']").html(""),$(t).find("div[id='el_explode_acc_6']").html(""),$(t).find("div[id='el_explode_acc_7']").html(""),$(t).find("div[id='el_explode_acc_8']").html(""),$(t).find("div[id='el_explode_acc_9']").html(""),$(t).find("div[id='el_explode_acc_10']").html(""),$(t).find("div[id='el_explode_acc_11']").html(""),$(t).find("div[id='el_explode_acc_12']").html(""),e.alias){var n=e.alias.split(".");if(e.alias)return e.segment1From=n[0],e.segment2From=n[1],e.segment3From=n[2],e.segment4From=n[3],e.segment5From=e.defaultPeriodYear,e.segment6From=n[5],e.segment7From=n[6],e.segment8From=n[7],e.segment9From=n[8],e.segment10From=n[9],e.segment11From=n[10],e.segment12From=n[11],e.segment1To=n[0],e.segment2To=n[1],e.segment3To=n[2],e.segment4To=n[3],e.segment5To=e.defaultPeriodYear,e.segment6To=n[5],e.segment7To=n[6],e.segment8To=n[7],e.segment9To=n[8],e.segment10To=n[9],e.segment11To=n[10],e.segment12To=n[11],e.account_from=e.segment1From+"."+e.segment2From+"."+e.segment3From+"."+e.segment4From+"."+e.segment5From+"."+e.segment6From+"."+e.segment7From+"."+e.segment8From+"."+e.segment9From+"."+e.segment10From+"."+e.segment11From+"."+e.segment12From,e.account_to=e.segment1To+"."+e.segment2To+"."+e.segment3To+"."+e.segment4To+"."+e.segment5To+"."+e.segment6To+"."+e.segment7To+"."+e.segment8To+"."+e.segment9To+"."+e.segment10To+"."+e.segment11To+"."+e.segment12To,void(e.coaEnter=e.account_from)}e.account_from="",e.account_to=""},setError:function(e){(this.$refs[e].$refs.reference?this.$refs[e].$refs.reference.$refs.input:this.$refs[e].$refs.textarea?this.$refs[e].$refs.textarea:this.$refs[e].$refs.input.$refs?this.$refs[e].$refs.input.$refs.input:this.$refs[e].$refs.input).style="border: 1px solid red;"},resetError:function(e){(this.$refs[e].$refs.reference?this.$refs[e].$refs.reference.$refs.input:this.$refs[e].$refs.textarea?this.$refs[e].$refs.textarea:this.$refs[e].$refs.input.$refs?this.$refs[e].$refs.input.$refs.input:this.$refs[e].$refs.input).style=""},getTransactionGL:function(e,t){this.sel_period=e,$.ajax({url:"/ajax/inquiry-funds/transaction",type:"GET",data:{period:e,coa:t},beforeSend:function(e){$("#_content_transaction").html('                        <div class="m-t-lg m-b-lg">                            <div class="text-center sk-spinner sk-spinner-wave">                                <div class="sk-rect1"></div>                                <div class="sk-rect2"></div>                                <div class="sk-rect3"></div>                                <div class="sk-rect4"></div>                                <div class="sk-rect5"></div>                            </div>                        </div>')}}).done((function(e){$("#_content_transaction").html(e.data.html),$(".transactions_tb").DataTable({pageLength:25,searching:!1,lengthChange:!1,bPaginate:!1,bInfo:!1,responsive:!0,aaSorting:[],dom:'<"html5buttons"B>lTfgitp',buttons:[{extend:"csv",title:"Transaction_CSV_"+i()().format("YYYYMMDD")},{extend:"excel",title:"Transaction_EXCEL_"+i()().format("YYYYMMDD")}]})}))},periodWasSelected:function(e){this.period=e},enterAccSegment:function(){var e,t=$("#modal-flexfield");this.errors.segmentOverride=!1,$(t).find("div[id='el_explode_segment']").html("");var n=this.account_from;if(this.account_from=this.coaEnter,this.account_to=null!==(e=this.account_to)&&void 0!==e?e:this.coaEnter,this.coaEnter){var s=this.coaEnter.split(".");this.segment1From=s[0],this.segment2From=s[1],this.segment3From=s[2],this.segment4From=s[3],this.segment5From=s[4],this.segment6From=s[5],this.segment7From=s[6],this.segment8From=s[7],this.segment9From=s[8],this.segment10From=s[9],this.segment11From=s[10],this.segment12From=s[11]}if(this.account_to&&n==this.coaEnter){var o=this.account_to.split(".");this.segment1To=o[0],this.segment2To=o[1],this.segment3To=o[2],this.segment4To=o[3],this.segment5To=o[4],this.segment6To=o[5],this.segment7To=o[6],this.segment8To=o[7],this.segment9To=o[8],this.segment10To=o[9],this.segment11To=o[10],this.segment12To=o[11]}else this.coaEnter&&(this.segment1To=s[0],this.segment2To=s[1],this.segment3To=s[2],this.segment4To=s[3],this.segment5To=s[4],this.segment6To=s[5],this.segment7To=s[6],this.segment8To=s[7],this.segment9To=s[8],this.segment10To=s[9],this.segment11To=s[10],this.segment12To=s[11])},clearAccSegment:function(){var e=$("#modal-flexfield");this.errors.segmentOverride=!1,$(e).find("div[id='el_explode_segment']").html(""),this.account_from="",this.account_to="",this.coaEnter="",this.segment1From="",this.segment2From="",this.segment3From="",this.segment4From="",this.segment5From="",this.segment6From="",this.segment7From="",this.segment8From="",this.segment9From="",this.segment10From="",this.segment11From="",this.segment12From="",this.segment1To="",this.segment2To="",this.segment3To="",this.segment4To="",this.segment5To="",this.segment6To="",this.segment7To="",this.segment8To="",this.segment9To="",this.segment10To="",this.segment11To="",this.segment12To=""},getDataFund:function(e,t,n){var s=this;return a(o().mark((function r(){var m,a,g,c;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(m=s,"Y"!=n){o.next=3;break}return o.abrupt("return");case 3:return m.get_data_loading=!0,m.get_data_flag=!1,m.sel_concate_segment=t,m.sel_fund=e,a=$("#transaction-form"),$(a).find("div[id='_content_transaction']").html(""),g={ccid:e,account_from:m.account_from,account_to:m.account_to,period_name:m.period,adj_flag:m.adj_flag,adj_period:m.adj_period},o.next=12,m.getData(g);case 12:"S"==(c=o.sent).status?(m.get_data_flag=!0,m.reqEncumbranceAmount=c.fund.req_encumbrance_amount,m.poEncumbranceAmount=c.fund.po_encumbrance_amount,m.otherEncumbranceAmount=c.fund.other_encumbrance_amount,m.periodBalances=c.period_balance,m.encumbrances=c.encumbrances,$(document).ready((function(){$(".period_tb").DataTable({pageLength:25,searching:!1,lengthChange:!1,bPaginate:!1,bInfo:!1,responsive:!0,aaSorting:[],dom:'<"html5buttons"B>lTfgitp',buttons:[{extend:"csv",title:"Period_Balance_CSV_"+i()().format("YYYYMMDD")},{extend:"excel",title:"Period_Balance_EXCEL_"+i()().format("YYYYMMDD")}]})}))):swal({title:"มีข้อผิดพลาด",text:'<span style="font-size: 16px; text-align: left;">'+c.msg+"</span>",type:"error",html:!0});case 14:case"end":return o.stop()}}),r)})))()},getData:function(e){var t=this;return a(o().mark((function n(){var s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=[],console.log(e),n.next=4,axios.post("ajax/inquiry-funds/period-balance",e).then((function(e){s=e.data})).catch((function(e){var t=e.response.data;swal({title:"มีข้อผิดพลาด",text:t.message,type:"error"})})).then((function(){t.get_data_loading=!1}));case 4:return n.abrupt("return",s);case 5:case"end":return n.stop()}}),n)})))()},getPeriodYear:function(){var e=this;return a(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={period:e.period},t.next=3,axios.post("ajax/inquiry-funds/period-year",n).then((function(t){e.segment5From=e.segment5To=e.defaultPeriodYear=t.data.periodYear,e.alias&&e.accountConfirm()})).catch((function(e){console.log(e.response);var t=e.response;swal({title:"มีข้อผิดพลาด",text:t.message,type:"error"})})).then((function(){}));case 3:case"end":return t.stop()}}),t)})))()}}};var c=n(93379),d=n.n(c),u=n(52208),l={insert:"head",singleton:!1};d()(u.Z,l);u.Z.locals;const h=(0,n(51900).Z)(g,undefined,undefined,!1,null,null,null).exports}}]);