(self.webpackChunk=self.webpackChunk||[]).push([[690],{96203:(t,e,a)=>{"use strict";a.d(e,{Z:()=>s});var n=a(23645),r=a.n(n)()((function(t){return t[1]}));r.push([t.id,".fruit-table-move[data-v-8f6e7810]{transition:transform 1s}",""]);const s=r},18845:(t,e,a)=>{"use strict";a.d(e,{Z:()=>s});var n=a(23645),r=a.n(n)()((function(t){return t[1]}));r.push([t.id,".fruit-table-move[data-v-748055f6]{transition:transform 1s}",""]);const s=r},29650:(t,e,a)=>{"use strict";a.d(e,{Z:()=>s});var n=a(23645),r=a.n(n)()((function(t){return t[1]}));r.push([t.id,".fruit-table-move[data-v-360ddc9f]{transition:transform 1s}",""]);const s=r},80690:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>ft});var n=a(87757),r=a.n(n),s=a(30381),i=a.n(s);function o(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}const l={props:["pHeader","inventoryItemId","url"],computed:{},watch:{},data:function(){return{itemId:null!=this.inventoryItemId&&""!=this.inventoryItemId?parseInt(this.inventoryItemId):"",loading:!1,items:[]}},mounted:function(){console.log("Component mounted."),""!==this.itemId?this.getItems({inventory_item_id:this.itemId,header:this.pHeader}):this.items=[]},methods:{itemWasSelected:function(t){var e,a=this;return(e=r().mark((function e(){var n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(s=(n=a).items.filter((function(e){return e.inventory_item_id==t}))).length&&(s=s[0]),n.$emit("itemWasSelected",s);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(n,r){var s=e.apply(t,a);function i(t){o(s,n,r,i,l,"next",t)}function l(t){o(s,n,r,i,l,"throw",t)}i(void 0)}))})()},remoteMethod:function(t){""!==t?this.getItems({number:t,header:this.pHeader}):this.items=[]},getItems:function(t){var e=this;e.loading=!0,axios.get(e.url.ajax_get_item,{params:t}).then((function(t){var a=t.data.data;e.loading=!1,e.items=a.items}))}}};var c=a(51900);const d=(0,c.Z)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"รหัสวัตถุดิบ","remote-method":t.remoteMethod,loading:t.loading},on:{change:t.itemWasSelected},model:{value:t.itemId,callback:function(e){t.itemId=e},expression:"itemId"}},t._l(t.items,(function(t,e){return a("el-option",{key:parseInt(t.inventory_item_id),attrs:{label:t.display,value:parseInt(t.inventory_item_id)}})})),1)],1)}),[],!1,null,null,null).exports;function u(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function f(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){u(s,n,r,i,o,"next",t)}function o(t){u(s,n,r,i,o,"throw",t)}i(void 0)}))}}var v,h;const m={props:["header","leaf","leafProportion","url","transBtn","transDate","pRefresh","data"],computed:{ingredientsCount:function(){if(this.ingredients&&this.ingredients.length){var t=this.ingredients.filter((function(t){return 0==t.is_deleted}));return parseFloat(t.length)}return 0},totalIngredientProp:function(){var t=0;return this.ingredients.forEach((function(e,a){0==e.is_deleted&&(t=parseFloat(t)+parseFloat(e.ingredient_proportions))})),t},totalQuantityUsed:function(){var t=0;return this.ingredients.forEach((function(e,a){0==e.is_deleted&&(t=parseFloat(t)+parseFloat(e.quantity_used))})),t}},watch:{leafProportion:(h=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.ingredients&&this.ingredients.length&&this.changeIngredientProportions([]);case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)}),ingredients:(v=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$emit("syncIngredients",e);case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return v.apply(this,arguments)})},data:function(){return{loading:!1,leafFormulaProportion:this.leaf.leaf_proportion,ingredients:this.leaf.leaf_dtl}},mounted:function(){console.log("LeafIngredient: Component mounted.")},methods:{addNewLine:function(){var t=this;return f(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).ingredients.length,e.next=4,_.clone(a.data.ingredient_new_line);case 4:s=e.sent,a.$set(a.ingredients,n,s);case 6:case"end":return e.stop()}}),e)})))()},deleteAll:function(){var t=this;return f(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.ingredients.forEach(function(){var t=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.is_deleted=!0;case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))()},selectInventoryItemId:function(t){return f(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.item_list.findIndex((function(e){return e.value==t.inventory_item_id})),a=t.item_list[a],t.item_code=a.item_number,t.item_desc=a.item_desc;case 4:case"end":return e.stop()}}),e)})))()},changeIngredientProportions:function(t){var e=arguments,a=this;return f(r().mark((function n(){var s,i,o,l,c;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s=!(e.length>1&&void 0!==e[1])||e[1],i=a,s?i.ingredients.length&&i.ingredients.forEach(function(){var t=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.changeIngredientProportions(e,!1);case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()):(o=0,l=parseFloat(i.leafProportion),c=parseFloat(t.ingredient_proportions),parseFloat(l)&&parseFloat(c)&&(o=l/100*100*(c/100),o=parseFloat(o)),console.log("else",t),t.quantity_used=o);case 3:case"end":return n.stop()}}),n)})))()},remoteMethod:function(t,e,a){var n=this;return f(r().mark((function s(){var i,o;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e[a]=[],i=n,(o=_.clone(e)).item_list=[],""!==t&&n.getData({header:i.header,number:t,line:o,type:a},e,a);case 5:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return f(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:(i=n).loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;i.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()}}};function p(t){return function(t){if(Array.isArray(t))return g(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return g(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function b(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function w(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){b(s,n,r,i,o,"next",t)}function o(t){b(s,n,r,i,o,"throw",t)}i(void 0)}))}}var x,C;const y={components:{LeafIngredient:(0,c.Z)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("h3",{staticClass:"text-navy"},[t._v("\n            รายการวัตถุดิบทั้งหมด: "+t._s(t.ingredientsCount)+"\n\n            "),a("button",{class:t.transBtn.delete.class+" btn-sm tw-w-25 pull-right  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.deleteAll(e)}}},[a("i",{class:t.transBtn.delete.icon}),t._v("\n                ลบทั้งหมด\n            ")]),t._v(" "),a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25 pull-right mr-2  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("table",{staticClass:"table mb-5 table-hover table-bordered"},[a("thead",[a("tr",[a("th",{attrs:{width:"25%"}},[t._v("\n                    รหัสวัตถุดิบ\n                ")]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[t._v("\n                    เกรดใบยา\n                ")]),t._v(" "),t.header.can.leaf_formulas.ingredient.add_lot_number?[t._m(0)]:t._e(),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("th",{attrs:{width:"2%"}})],2)]),t._v(" "),a("tbody",[t._l(t.ingredients,(function(e,n){return t.ingredients.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",[a("td",[[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",placeholder:"รหัสวัตถุดิบ","remote-method":function(a){return t.remoteMethod(a,e,"item_list")},disabled:!t.header.can.edit,loading:t.loading},on:{change:function(a){return t.selectInventoryItemId(e)}},model:{value:e.inventory_item_id,callback:function(a){t.$set(e,"inventory_item_id",a)},expression:"ingredient.inventory_item_id"}},t._l(e.item_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)]],2),t._v(" "),a("td",[t._v("\n                        "+t._s(e.item_desc)+"\n                    ")]),t._v(" "),t.header.can.leaf_formulas.ingredient.add_lot_number?[a("td",[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",disabled:!e.inventory_item_id||!t.leaf.leaf_proportion||!t.header.can.edit,remote:"",placeholder:"Lot Number","remote-method":function(a){return t.remoteMethod(a,e,"lot_list")},loading:t.loading},model:{value:e.lot_number,callback:function(a){t.$set(e,"lot_number",a)},expression:"ingredient.lot_number"}},t._l(e.lot_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1)]:t._e(),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.ingredient_proportions,expression:"ingredient.ingredient_proportions",modifiers:{number:!0}}],staticClass:"form-control text-right",attrs:{type:"number",disabled:!e.inventory_item_id||!t.leaf.leaf_proportion||!t.header.can.edit},domProps:{value:e.ingredient_proportions},on:{change:function(a){return t.changeIngredientProportions(e,!1)},input:function(a){a.target.composing||t.$set(e,"ingredient_proportions",t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),a("td",{staticClass:"text-right",attrs:{title:e.uom}},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.quantity_used,expression:"ingredient.quantity_used",modifiers:{number:!0}}],staticClass:"form-control text-right",attrs:{type:"number",disabled:!0},domProps:{value:e.quantity_used},on:{input:function(a){a.target.composing||t.$set(e,"quantity_used",t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),a("td",{staticClass:"text-center align-middle"},[a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})])])],2)])]:t._e()})),t._v(" "),a("tr",[a("th",{staticClass:"text-right",attrs:{colspan:t.header.can.leaf_formulas.ingredient.add_lot_number?3:2}},[t._v("\n                    รวม\n                ")]),t._v(" "),a("th",{staticClass:"text-right"},[t._v(t._s(t.totalIngredientProp))]),t._v(" "),a("th",{staticClass:"text-right"},[t._v(t._s(t.totalQuantityUsed))]),t._v(" "),a("th")])],2)])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-center",attrs:{width:"13%"}},[a("div",[t._v("Lot")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-center",attrs:{width:"13%"}},[a("div",[t._v("สัดส่วน %")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-center",attrs:{width:"12%"}},[a("div",[t._v("ปริมาณที่ใช้ (กก.)")])])}],!1,null,null,null).exports},props:["header","url","transBtn","transDate","pRefresh","data","leafFormulas","tabs"],computed:{totalProportion:function(){var t=_.sumBy(this.lines,(function(t){if(!t.is_deleted)return parseInt(t.leaf_proportion)}));return parseFloat(t)}},watch:{pRefresh:(C=w(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("refresh");case 1:case"end":return t.stop()}}),t)}))),function(t,e){return C.apply(this,arguments)}),leafFormulas:(x=w(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("watch: Leaf",e),this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return x.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],tab:this.tabs}},mounted:function(){console.log("Leaf Formula: Component mounted.")},methods:{syncIngredients:function(t,e,a){e.input_ingredients=t,this.checkHasChange=!0},addNewLine:function(){var t=this;return w(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(a=t).lines.length,s=JSON.parse(JSON.stringify(a.data.leaf_new_line)),a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.leaf_formula_line,"has_change",a.lines.length),a.header.can.edit&&a.remoteMethod(" ",a.lines[n]);case 7:case"end":return e.stop()}}),e)})))()},selectLeaf:function(t){var e=this;return w(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!((n=e).lines.filter((function(e){return e.leaf_formula==t.leaf_formula&&0==e.is_deleted})).length>1)){a.next=8;break}return t.leaf_formula="",t.formulaline_id="",t.line_no="",t.leaf_formula_desc="",a.abrupt("return");case 8:s=t.leaf_list.findIndex((function(e){return e.value==t.leaf_formula})),s=t.leaf_list[s],t.formulaline_id="",t.line_no="",t.leaf_formula_desc="",s&&(t.leaf_formula_desc=s.leaf_formula_desc,t.formulaline_id=s.formulaline_id,t.line_no=s.line_no),n.setHasChange();case 15:case"end":return a.stop()}}),a)})))()},changeLeafProportion:function(){this.setHasChange()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e){if(""!==t){var a=this.lines.filter((function(t){return 0==t.is_deleted})),n=p(new Set(a.map((function(t){return t.leaf_formula}))));this.getLeafInput({number:t,header:this.header,type:"leaf_formula",except:n},e)}else e.leaf_list=[]},getLeafInput:function(t,e){var a=this;a.loading.leaf_formula=!0,e.leaf_list=[],axios.get(a.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;a.loading.leaf_formula=!1,e.leaf_list=n.leaf_list}))},getLeafFormulas:function(){var t=this;return w(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,n={header:t.header,type:"leaf_formula_line"},a.loading.page=!0,axios.get(a.url.ajax_get_data,{params:n}).then((function(t){var e=t.data.data;a.$set(a,"lines",e.leaf_formula_lines),a.loading.page=!1}));case 4:case"end":return e.stop()}}),e)})))()},deleteline:function(t){var e=this;return w(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e,t.is_new_row?t.is_deleted=!0:([],s={header:n.header,type:"casings",leaf_formula:t.leaf_formula},axios.get(n.url.ajax_get_data,{params:s}).then(function(){var e=w(r().mark((function e(a){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.data.data,!n.casings.length){e.next=9;break}return e.next=5,helperAlert.showProgressConfirm("ต้องการลบข้อมูล Casing ที่ผูกกับ Leaf Formula: "+t.leaf_formula+" หรือไม่ ?");case 5:confirm=e.sent,confirm&&(t.is_deleted=!0),e.next=10;break;case 9:t.is_deleted=!0;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return a.stop()}}),a)})))()}}};const k=(0,c.Z)(y,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-right"},[a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{staticStyle:{"background-color":"rgb(252, 252, 252)"}},[a("td",[e.leaf_formula?[a("a",{attrs:{"data-toggle":"collapse","data-parent":"#accordion",href:"#collapse_"+n},on:{click:function(t){e.is_collapse=!e.is_collapse}}},[e.is_collapse?a("i",{staticClass:"fa fa-caret-down"}):a("i",{staticClass:"fa fa-caret-right"})])]:t._e()],2),t._v(" "),a("td",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"Leaf Formula","remote-method":function(a){return t.remoteMethod(a,e)},disabled:!t.header.can.edit,loading:t.loading.leaf_formula},on:{change:function(a){return t.selectLeaf(e)}},model:{value:e.leaf_formula,callback:function(a){t.$set(e,"leaf_formula",a)},expression:"line.leaf_formula"}},t._l(e.leaf_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("td",[t._v("\n                        "+t._s(e.leaf_formula_desc)+"\n                    ")]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.leaf_proportion,expression:"line.leaf_proportion",modifiers:{number:!0}}],staticClass:"form-control text-right",attrs:{type:"number"},domProps:{value:e.leaf_proportion},on:{change:t.changeLeafProportion,input:function(a){a.target.composing||t.$set(e,"leaf_proportion",t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),a("td",[a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(a){return a.preventDefault(),t.deleteline(e)}}},[a("i",{class:t.transBtn.delete.icon})])])])]),t._v(" "),e.is_deleted?t._e():a("tr",{directives:[{name:"show",rawName:"v-show",value:e.is_collapse,expression:"line.is_collapse"}]},[a("td",{attrs:{colspan:"2"}}),t._v(" "),a("td",{attrs:{colspan:"3"}},[a("div",{staticClass:"collapse",attrs:{id:"collapse_"+n}},[a("leaf-ingredient",{attrs:{leaf:e,url:t.url,leafProportion:e.leaf_proportion,transBtn:t.transBtn,transDate:t.transDate,data:t.data,header:t.header},on:{syncIngredients:function(a){for(var r=arguments.length,s=Array(r);r--;)s[r]=arguments[r];return t.syncIngredients.apply(void 0,s.concat([e],[n]))}}})],1)])])]:t._e()}))],2),t._v(" "),t.lines.length?a("tfoot",[a("tr",{},[t._m(1),t._v(" "),a("th",{staticClass:"text-right"},[a("h4",[t._v(t._s(t._f("number2Digit")(t.totalProportion)))])]),t._v(" "),a("th")])]):t._e()]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"2%"}}),t._v(" "),a("th",{attrs:{width:"15%"}},[a("div",[t._v("Leaf Formula")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"10%"}},[a("div",[t._v("สัดส่วน %")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"5%"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-right",attrs:{colspan:"3"}},[a("h4",[t._v("รวม")])])}],!1,null,null,null).exports;function D(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function N(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){D(s,n,r,i,o,"next",t)}function o(t){D(s,n,r,i,o,"throw",t)}i(void 0)}))}}var I;const B={props:["header","url","transBtn","transDate","data","casings","tabs"],computed:{},watch:{casings:(I=N(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return I.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],tab:this.tabs}},mounted:function(){console.log("Casings: Component mounted.")},methods:{syncIngredients:function(t,e){e.input_ingredients=t,this.checkHasChange=!0},addNewLine:function(){var t=this;return N(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).lines.length,e.next=4,_.clone(a.data.new_line);case 4:s=e.sent,a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.casings,"has_change",a.lines.length),a.header.can.edit&&(a.remoteMethod(" ",a.lines[n],"casing_leaf_formula_list"),a.remoteMethod(" ",a.lines[n],"casing_list"));case 9:case"end":return e.stop()}}),e)})))()},avalidateDup:function(t){return N(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.leaf_formula&&t.casing_id;case 1:case"end":return e.stop()}}),e)})))()},selectLeaf:function(t){var e=this;return N(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.leaf_formula_desc="",!(n.lines.filter((function(e){if(t.casing_id)return e.leaf_formula==t.leaf_formula&&0==e.is_deleted})).length>1)){a.next=6;break}return t.leaf_formula="",a.abrupt("return");case 6:s=t.casing_leaf_formula_list.findIndex((function(e){return e.value==t.leaf_formula})),(s=t.casing_leaf_formula_list[s])&&(t.leaf_formula_desc=s.leaf_formula_desc),n.setHasChange();case 10:case"end":return a.stop()}}),a)})))()},selectCasing:function(t){var e=this;return N(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.casing_no="",t.casing_desc="",t.casing_items=[],!(n.lines.filter((function(e){if(t.leaf_formula)return e.casing_id==t.casing_id&&0==e.is_deleted})).length>1)){a.next=8;break}return t.casing_id="",a.abrupt("return");case 8:s=t.casing_list.findIndex((function(e){return e.value==t.casing_id})),(s=t.casing_list[s])&&(t.casing_no=s.casing_no,t.casing_desc=s.casing_desc,t.casing_items=s.casing_items),n.setHasChange();case 12:case"end":return a.stop()}}),a)})))()},changeLeafProportion:function(){this.setHasChange()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e,a){var n=this;return N(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e[a]=[],(i=_.clone(e)).casing_leaf_formula_list=[],i.casing_list=[],""!==t&&n.getData({number:t,header:n.header,line:i,type:a},e,a);case 5:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return N(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e.loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;e.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()}}};var S=a(93379),F=a.n(S),A=a(96203),P={insert:"head",singleton:!1};F()(A.Z,P);A.Z.locals;const L=(0,c.Z)(B,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-right"},[a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"Leaf Formula","remote-method":function(a){return t.remoteMethod(a,e,"casing_leaf_formula_list")},disabled:!t.header.can.edit||!e.is_new_row,loading:e.loading},on:{change:function(a){return t.selectLeaf(e)}},model:{value:e.leaf_formula,callback:function(a){t.$set(e,"leaf_formula",a)},expression:"line.leaf_formula"}},t._l(e.casing_leaf_formula_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("td",[t._v("\n                            "+t._s(e.leaf_formula_desc)+"\n                        ")]),t._v(" "),a("td",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"","remote-method":function(a){return t.remoteMethod(a,e,"casing_list")},disabled:!t.header.can.edit||!e.is_new_row,loading:e.loading},on:{change:function(a){return t.selectCasing(e)}},model:{value:e.casing_id,callback:function(a){t.$set(e,"casing_id",a)},expression:"line.casing_id"}},t._l(e.casing_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("td",[t._v("\n                            "+t._s(e.casing_desc)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right align-middle"},[a("button",{class:t.transBtn.detail.class+" btn-xs mb-0",on:{click:function(t){t.preventDefault(),e.is_collapse=!e.is_collapse}}},[a("i",{class:t.transBtn.detail.icon}),t._v("\n                                "+t._s(t.transBtn.detail.text)+"\n                            ")]),t._v(" "),a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})])])])]),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_collapse&&e.casing_items.length&&!e.is_deleted?a("tr",[a("td",{attrs:{colspan:"2"}}),t._v(" "),a("td",{attrs:{colspan:"3"}},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"15%"}},[t._v("รหัสวัตถุดิบ")]),t._v(" "),a("th",[t._v("รายละเอียดวัตถุดิบ")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"20%"}},[t._v("ปริมาณที่ใช้")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"5%"}},[t._v("หน่วย")])])]),t._v(" "),t._l(e.casing_items,(function(e){return a("tr",[a("td",[t._v(t._s(e.item_code))]),t._v(" "),a("td",[t._v(t._s(e.item_desc))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number3Digit")(e.quantity_used)))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(e.uom_name))])])}))],2)])]):t._e()])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"15%"}},[a("div",[t._v("Leaf Formula")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:"10%"}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{attrs:{width:"15%"}},[a("div",[t._v("Casing No.")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"15%"}})])])}],!1,null,"8f6e7810",null).exports;function T(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return O(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function E(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function H(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){E(s,n,r,i,o,"next",t)}function o(t){E(s,n,r,i,o,"throw",t)}i(void 0)}))}}var M;const j={props:["header","url","transBtn","transDate","data","flavors","tabs"],computed:{},watch:{flavors:(M=H(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return M.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],tab:this.tabs}},mounted:function(){console.log("Flavor: Component mounted.")},methods:{syncIngredients:function(t,e){e.input_ingredients=t,this.checkHasChange=!0},addNewLine:function(){var t=this;return H(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).lines.length,e.next=4,_.clone(a.data.new_line);case 4:s=e.sent,a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.casings,"has_change",a.lines.length),a.header.can.edit&&a.remoteMethod(" ",a.lines[n],"flavor_list");case 9:case"end":return e.stop()}}),e)})))()},selectFlavor:function(t){var e=this;return H(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.flavor_no="",t.flavor_desc="",t.flavor_items=[],!(n.lines.filter((function(e){return e.flavor_id==t.flavor_id&&0==e.is_deleted})).length>1)){a.next=8;break}return t.flavor_id="",a.abrupt("return");case 8:s=t.flavor_list.findIndex((function(e){return e.value==t.flavor_id})),(s=t.flavor_list[s])&&(t.flavor_no=s.flavor_no,t.flavor_desc=s.flavor_desc,t.flavor_items=s.flavor_items),n.setHasChange();case 12:case"end":return a.stop()}}),a)})))()},changeLeafProportion:function(){this.setHasChange()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e,a){var n=this;return H(r().mark((function s(){var i,o,l,c;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e[a]=[],i=n,(o=_.clone(e)).flavor_list=[],l=i.lines.filter((function(t){return 0==t.is_deleted})),c=T(new Set(l.map((function(t){return t.flavor_id})))),""!==t&&n.getData({number:t,header:n.header,line:o,type:a,except:c},e,a);case 7:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return H(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e.loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;e.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()}}};var q=a(29650),U={insert:"head",singleton:!1};F()(q.Z,U);q.Z.locals;const Z=(0,c.Z)(j,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-right"},[a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"","remote-method":function(a){return t.remoteMethod(a,e,"flavor_list")},disabled:!t.header.can.edit||!e.is_new_row,loading:e.loading},on:{change:function(a){return t.selectFlavor(e)},click:function(a){return t.remoteMethod(a,e,"flavor_list")}},model:{value:e.flavor_id,callback:function(a){t.$set(e,"flavor_id",a)},expression:"line.flavor_id"}},t._l(e.flavor_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("td",[t._v("\n                            "+t._s(e.flavor_desc)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right align-middle"},[a("button",{class:t.transBtn.detail.class+" btn-xs mb-0",on:{click:function(t){t.preventDefault(),e.is_collapse=!e.is_collapse}}},[a("i",{class:t.transBtn.detail.icon}),t._v("\n                                "+t._s(t.transBtn.detail.text)+"\n                            ")]),t._v(" "),a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})])])])]),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_collapse&&e.flavor_items.length&&!e.is_deleted?a("tr",[a("td",{attrs:{colspan:"1"}}),t._v(" "),a("td",{attrs:{colspan:"2"}},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"15%"}},[t._v("รหัสวัตถุดิบ")]),t._v(" "),a("th",[t._v("รายละเอียดวัตถุดิบ")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"20%"}},[t._v("ปริมาณที่ใช้")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"5%"}},[t._v("หน่วย")])])]),t._v(" "),t._l(e.flavor_items,(function(e){return a("tr",[a("td",[t._v(t._s(e.item_code))]),t._v(" "),a("td",[t._v(t._s(e.item_desc))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number3Digit")(e.quantity_used)))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(e.uom_name))])])}))],2)])]):t._e()])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"15%"}},[a("div",[t._v("Flavor No.")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"15%"}})])])}],!1,null,"360ddc9f",null).exports;function z(t){return function(t){if(Array.isArray(t))return J(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return J(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return J(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function R(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function G(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){R(s,n,r,i,o,"next",t)}function o(t){R(s,n,r,i,o,"throw",t)}i(void 0)}))}}var W,Q;const V={props:["header","url","transBtn","transDate","data","cigarettes","cigarDtl","tabs"],computed:{},watch:{cigarettes:(Q=G(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return Q.apply(this,arguments)}),cigarDtl:(W=G(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lineCigarDtl=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return W.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],lineCigarDtl:[],tab:this.tabs}},mounted:function(){console.log("Cigarettes: Component mounted.")},methods:{addNewLine:function(){var t=this;return G(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).lines.length,e.next=4,_.clone(a.data.new_line);case 4:s=e.sent,a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.casings,"has_change",a.lines.length),a.header.can.edit&&a.remoteMethod(" ",a.lines[n],"cigar_list");case 9:case"end":return e.stop()}}),e)})))()},selectCigarItemId:function(t){var e=this;return G(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.cigar_organization_code="",t.cigar_organization_id="",t.cigar_item_code="",t.cigar_item_desc="",!(n.lines.filter((function(e){return e.cigar_item_id==t.cigar_item_id&&0==e.is_deleted})).length>1)){a.next=9;break}return t.cigar_item_id="",a.abrupt("return");case 9:s=t.cigar_list.findIndex((function(e){return e.value==t.cigar_item_id})),(s=t.cigar_list[s])&&(t.cigar_organization_code=s.cigar_organization_code,t.cigar_organization_id=s.cigar_organization_id,t.cigar_item_code=s.cigar_item_code,t.cigar_item_desc=s.cigar_item_desc),n.setHasChange();case 13:case"end":return a.stop()}}),a)})))()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e,a){var n=this;return G(r().mark((function s(){var i,o,l,c;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e[a]=[],o=i.lines.filter((function(t){return 0==t.is_deleted})),l=z(new Set(o.map((function(t){return t.cigar_item_id})))),(c=_.clone(e)).cigar_list=[],""!==t&&n.getData({number:t,header:n.header,line:c,type:a,except:l},e,a);case 7:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return G(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e.loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;e.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()}}};var K=a(18845),X={insert:"head",singleton:!1};F()(K.Z,X);K.Z.locals;const Y=(0,c.Z)(V,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-7 b-r"},[a("h3",{staticClass:"no-margins text-center text-navy"},[t._v("\n                รายการบุหรี่\n\n                "),t.header?[t.header.can.cigarettes.multi_cigarettes?a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25 mb-0 btn-outline pull-right",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                        เพิ่มรายการ\n                    ")]):t._e()]:t._e()],2),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"","remote-method":function(a){return t.remoteMethod(a,e,"cigar_list")},disabled:!t.header.can.edit,loading:e.loading},on:{change:function(a){return t.selectCigarItemId(e)}},model:{value:e.cigar_item_id,callback:function(a){t.$set(e,"cigar_item_id",a)},expression:"line.cigar_item_id"}},t._l(e.cigar_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("td",[t._v("\n                                    "+t._s(e.cigar_item_desc)+"\n                                ")]),t._v(" "),a("td",{staticClass:"text-right align-middle"},[a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})])])])])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])]),t._v(" "),a("div",{staticClass:"col-5"},[a("h3",{staticClass:"no-margins text-center text-navy"},[t._v("\n                รายการวัตถุห่อมวน\n            ")]),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(1),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lineCigarDtl,(function(e,n,r){return t.lineCigarDtl.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",{staticClass:"text-center"},[t._v(t._s(e.cigar_line_no=n+1))]),t._v(" "),a("td",[a("el-input",{attrs:{type:"textarea",name:"note",disabled:!t.header.can.edit,rows:"1",maxlength:"240","show-word-limit":""},model:{value:e.cigar_description,callback:function(a){t.$set(e,"cigar_description",a)},expression:"cigarDtl.cigar_description"}})],1)])])]:t._e()}))],2)])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"40%"}},[a("div",[t._v("รหัสบุหรี่")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"10%"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"10%"}},[a("div",[t._v("ลำดับ")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียดวัตถุห่อมวน")])])])])}],!1,null,"748055f6",null).exports;function tt(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}var et,at;const nt={props:["header","url","transBtn","transDate","cigaretteAll","tabs"],computed:{},watch:{cigaretteAll:(et=r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)})),at=function(){var t=this,e=arguments;return new Promise((function(a,n){var r=et.apply(t,e);function s(t){tt(r,a,n,s,i,"next",t)}function i(t){tt(r,a,n,s,i,"throw",t)}s(void 0)}))},function(t,e){return at.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[]}},mounted:function(){console.log("Cigarette All: Component mounted.")},methods:{}};const rt=(0,c.Z)(nt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",[t._v("\n                           "+t._s(e.item_number)+"\n                        ")]),t._v(" "),a("td",[t._v("\n                            "+t._s(e.item_description)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.lot_number)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.qty)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-center"},[t._v("\n                            "+t._s(e.uom)+"\n                        ")])])])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{width:"15%"}},[a("div",[t._v("รหัสวัตถุดิบxx")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"5%"}},[a("div",[t._v("Lot")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"10%"}},[a("div",[t._v("ปริมาณที่ใช้")])]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"5%"}},[a("div",[t._v("หน่วย")])])])])}],!1,null,"f32cec92",null).exports;function st(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function it(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){st(s,n,r,i,o,"next",t)}function o(t){st(s,n,r,i,o,"throw",t)}i(void 0)}))}}var ot;const lt={props:["header","transBtn","transDate","url","countOpen"],data:function(){return{loading:!1,transactionDateFormat:"",blendNo:"",requestHeaders:[]}},mounted:function(){},computed:{},watch:{countOpen:(ot=it(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openModal();case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return ot.apply(this,arguments)})},methods:{setdate:function(t){var e=this;return it(r().mark((function a(){var n;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,a.next=3,i()(t).format(n.transDate["js-format"]);case 3:n.transactionDateFormat=a.sent;case 4:case"end":return a.stop()}}),a)})))()},openModal:function(){$("#modal_search").modal("show")},search:function(t){var e=this;e.loading=!0,axios.get(e.url.index,{params:t}).then((function(t){var a=t.data.data;e.loading=!1,e.requestHeaders=a.data}))},selectRow:function(t){var e=this;return it(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:$("#modal_search").modal("hide"),e.requestHeaders=[],e.$emit("selectRow",t);case 3:case"end":return a.stop()}}),a)})))()},searchForm:function(){var t=this;return it(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.search({blend_no:t.blendNo,action:"search",formula_type_code:t.header.formula_type_code});case 1:case"end":return e.stop()}}),e)})))()}}};function ct(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function dt(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){ct(s,n,r,i,o,"next",t)}function o(t){ct(s,n,r,i,o,"throw",t)}i(void 0)}))}}const ut={components:{SearchItem:d,TabLeafFormula:k,Casing:L,Flavor:Z,Cigarette:Y,CigaretteAll:rt,modalSearch:(0,c.Z)(lt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("div",{staticClass:"modal inmodal fade",attrs:{id:"modal_search",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg",staticStyle:{width:"90%","max-width":"950px"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[t._m(0),t._v(" "),a("h4",{staticClass:"modal-title"},[t._v("ค้นหา"+t._s(t.menu.menu_title))]),t._v(" "),a("small",{staticClass:"font-bold"},[t._v("\n                         \n                    ")])]),t._v(" "),a("div",{staticClass:"modal-body text-left"},[a("div",{staticClass:"row col-12"},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-4 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ยาเส้นปรุง Blend No. :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.blendNo,expression:"blendNo"}],staticClass:"form-control",attrs:{autocomplete:"off",id:"lb-2",type:"text",name:"blend_no"},domProps:{value:t.blendNo},on:{input:function(e){e.target.composing||(t.blendNo=e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"form-group text-right  pr-2 mb-0 col-lg-5 col-md-10 col-sm-12 col-xs-12"},[a("label",{staticClass:" tw-font-bold tw-uppercase mt-2 mb-1"},[t._v(" ")]),t._v(" "),a("div",{staticClass:"text-left"},[a("button",{class:t.transBtn.search.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:t.searchForm}},[a("i",{class:t.transBtn.search.icon}),t._v("\n                                    "+t._s(t.transBtn.search.text)+"\n                                ")])])])]),t._v(" "),a("div",{staticClass:"ibox-content table-responsive m-t mb-3"},[a("table",{staticClass:"table table-hover"},[t._m(1),t._v(" "),a("tbody",t._l(t.requestHeaders,(function(e,n){return a("tr",[a("td",{staticClass:"text-center"},[t._v(t._s(e.formula_type))]),t._v(" "),a("td",[t._v(t._s(e.blend_no))]),t._v(" "),a("td",{staticClass:"text-center"},[t._v(t._s(e.formula_status))]),t._v(" "),a("td",{staticClass:"text-center"},[t._v(t._s(e.formula_approval_date_format))]),t._v(" "),a("td",{staticClass:"text-right"},[a("button",{class:t.transBtn.detail.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(a){return t.selectRow(e)}}},[a("i",{class:t.transBtn.detail.icon}),t._v("\n                                            "+t._s(t.transBtn.detail.text)+"\n                                        ")])])])})),0)])])]),t._v(" "),t._m(2)])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),a("span",{staticClass:"sr-only"},[t._v("Close")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"text-center",attrs:{width:"90px"}},[t._v("ประเภทสูตร")]),t._v(" "),a("th",{staticClass:"text-left",attrs:{width:""}},[t._v("ยาเส้นปรุง Blend No.")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"90px"}},[t._v("สถานะ")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"90px"}},[t._v("วันที่อนุมัติ")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"150px"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-white",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])}],!1,null,null,null).exports},props:["pUrl"],computed:{},watch:{},data:function(){return{url:this.pUrl,data:!1,header:!1,profile:!1,uomDesc:"",transBtn:{},transDate:{},isActive:!1,lines:[],originalData:[],originalDtlData:[],leafFormulas:[],casings:[],flavors:[],cigarettes:[],cigarDtl:[],cigaretteAll:[],leafFormulaHasChange:!1,loading:{page:!1,before_mount:!1},firstLoad:!0,countOpenModal:0,selTabName:"tab1",tabs:{leaf_formula_line:{loading:!1,refreshCount:1,has_change:!1},casings:{loading:!1,refreshCount:1,has_change:!1},flavors:{loading:!1,refreshCount:1,has_change:!1},cigarettes:{loading:!1,refreshCount:1,has_change:!1},cigarette_all:{loading:!1,refreshCount:1,has_change:!1}},rules:{name:[{required:!0,message:"Please input Activity name",trigger:"blur"},{min:3,max:5,message:"Length should be 3 to 5",trigger:"blur"}]},ruleForm:{name:""}}},beforeMount:function(){console.log("beforeMount"),this.getInfo()},mounted:function(){console.log("Component mounted.")},methods:{show:function(t){var e=this;return dt(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:console.log("show header",t),e.loading.before_mount=!1,e.getInfo(t.formula_id);case 3:case"end":return a.stop()}}),a)})))()},setdate:function(t,e){var a=this;return dt(r().mark((function n(){var s;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=a,n.next=3,i()(t).format(s.transDate["js-format"]);case 3:s.header[e]=n.sent,s.getLines();case 5:case"end":return n.stop()}}),n)})))()},changeStatus:function(){var t=this;return dt(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"INACTIVE"==t.header.formula_status.toUpperCase()?t.isActive=!0:t.isActive=!1,t.header.can.edit=1==t.isActive,t.header.can.edit=!0;case 3:case"end":return e.stop()}}),e)})))()},getInfo:function(){var t=arguments,e=this;return dt(r().mark((function a(){var n,s,i,o;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:"",i={lookup_code:(s=e).header.lookup_code,formula_id:n},o=!1,s.loading.page=!0,s.loading.before_mount=!0,a.next=8,axios.get(s.url.index,{params:i}).then((function(t){"S"==(o=t.data.data).status&&(o=o.info),s.loading.page=!1}));case 8:if(!o){a.next=18;break}return s.data=o.data,s.header=o.header,s.profile=o.profile,s.transBtn=o.transBtn,s.transDate=o.transDate,s.url=o.url,s.header.formula_id&&(s.uomDesc=s.header.uom_name),a.next=18,s.resetData();case 18:s.loading.before_mount=!1,console.log("info success"),s.header.formula_id&&s.changeTab(s.selTabName,s.selTabName,!1),s.changeStatus();case 22:case"end":return a.stop()}}),a)})))()},getLines:function(){var t=arguments;return dt(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!(t.length>0&&void 0!==t[0])||t[0],t.length>1&&void 0!==t[1]?t[1]:"search",e.abrupt("return");case 8:e.sent;case 9:case"end":return e.stop()}}),e)})))()},changeTab:function(t,e){var a=arguments,n=this;return dt(r().mark((function s(){var i,o,l,c;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!(a.length>2&&void 0!==a[2])||a[2],o=n,!0,l="","tab1"==t?l="leaf_formula_line":"tab2"==t?l="casings":"tab3"==t?l="flavors":"tab4"==t?l="cigarettes":"tab5"==t&&(l="cigarette_all"),!1,(t==e||"tab5"==e||!i)&&o.header.formula_id){r.next=17;break}return r.next=9,o.compareData(e);case 9:if(r.sent){r.next=17;break}return r.next=13,helperAlert.showProgressConfirm("ต้องการบันทึกข้อมูลที่แก้ไขหรือไม่ ?");case 13:if(!r.sent){r.next=17;break}return r.next=17,o.save(!1);case 17:return o.selTabName=t,r.next=20,o.resetData();case 20:c={header:o.header,type:l},o.tabs[l].loading=!0,o.tabs[l].has_change=!1,axios.get(o.url.ajax_get_data,{params:c}).then((function(t){var e=t.data.data;"leaf_formula_line"==l&&(o.originalData=JSON.parse(JSON.stringify(e.leaf_formula_lines)),o.leafFormulas=e.leaf_formula_lines),"casings"==l&&(o.originalData=JSON.parse(JSON.stringify(e.casings)),o.casings=e.casings),"flavors"==l&&(o.originalData=JSON.parse(JSON.stringify(e.flavors)),o.flavors=e.flavors),"cigarettes"==l&&(o.originalData=JSON.parse(JSON.stringify(e.cigarettes)),o.originalDtlData=JSON.parse(JSON.stringify(e.cigar_dtl)),o.cigarettes=e.cigarettes,o.cigarDtl=e.cigar_dtl),"cigarette_all"==l&&(o.cigaretteAll=e[l]),o.tabs[l].loading=!1}));case 24:case"end":return r.stop()}}),s)})))()},resetData:function(){var t=this;return dt(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t).originalData=[],a.originalDtlData=[],a.leafFormulas=[],a.casings=[],a.flavors=[],a.cigarettes=[],a.cigarDtl=[],a.cigaretteAll=[];case 9:case"end":return e.stop()}}),e)})))()},compareData:function(t){var e=this;return dt(r().mark((function a(){var n,s,i;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,s=!1,i="","tab1"==t?i="leaf_formula_line":"tab2"==t?i="casings":"tab3"==t?i="flavors":"tab4"==t?i="cigarettes":"tab5"==t&&(i="cigarette_all"),a.next=6,axios.post(n.url.ajax_compare_data,{header:n.header,original_data:n.originalData,original_dtl_data:n.originalDtlData,type:i,leaf_formulas:n.leafFormulas,casings:n.casings,flavors:n.flavors,cigarettes:n.cigarettes,cigar_dtl:n.cigarDtl}).then((function(t){var e=t.data.data;s=e.is_equal})).catch((function(t){var e=t.response.data;swal({title:"Error !",text:e.message,type:"error",showConfirmButton:!0})})).then((function(){n.loading.page=!1}));case 6:return a.abrupt("return",s);case 7:case"end":return a.stop()}}),a)})))()},save:function(){var t=arguments,e=this;return dt(r().mark((function a(){var n,s,i,o,l,c;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=!(t.length>0&&void 0!==t[0])||t[0],i=!0,o=!0,l="","ACTIVE"!=(s=e).header.formula_status.toUpperCase()||"tab1"!=s.selTabName){a.next=12;break}if(c=0,s.leafFormulas.forEach(function(){var t=dt(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.is_deleted&&(c=parseFloat(e.leaf_proportion)+parseFloat(c));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),100!=parseFloat(c)&&(l="Leaf Formula: ยอดรวมสัดส่วน % มากกว่าหรือน้อยกว่า 100",helperAlert.showGenericFailureDialog(l),o=!1),s.leafFormulas.forEach(function(){var t=dt(r().mark((function t(e,a){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.is_deleted&&(n=0,e.leaf_dtl.forEach((function(t){n=parseFloat(n)+parseFloat(t.ingredient_proportions)})),100!=parseFloat(n)&&(l="ยอดรวมสัดส่วน % ของวัตถุดิบ มากกว่าหรือน้อยกว่า 100",helperAlert.showGenericFailureDialog(l),o=!1));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),o){a.next=12;break}return a.abrupt("return");case 12:if(!n){a.next=25;break}if(s.header.blend_no){a.next=16;break}return helperAlert.showGenericFailureDialog("โปรดระบุยาเส้นปรุง Blend No."),a.abrupt("return");case 16:if(s.header.flavour_code){a.next=19;break}return helperAlert.showGenericFailureDialog("โปรดระบุรสชาติ"),a.abrupt("return");case 19:if(s.header.quantity){a.next=22;break}return helperAlert.showGenericFailureDialog("โปรดระบุปริมาณ"),a.abrupt("return");case 22:return a.next=24,helperAlert.showProgressConfirm("กรุณายืนยัน บันทึกสูตรผลิต");case 24:i=a.sent;case 25:if(!i){a.next=29;break}return s.loading.page=!0,a.next=29,axios.post(s.url.ajax_store,{header:s.header,leaf_formulas:s.leafFormulas,casings:s.casings,flavors:s.flavors,cigarettes:s.cigarettes,cigar_dtl:s.cigarDtl}).then((function(t){var e=t.data.data;"S"==e.status&&(s.hasChange=!1,swal({title:"&nbsp;",text:"บันทึกข้อมูลสำเร็จ",type:"success",html:!0}),setTimeout(dt(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.getInfo(e.header.formula_id);case 2:case"end":return t.stop()}}),t)}))),500)),"S"!=e.status&&swal({title:"Error !",text:e.msg,type:"error",showConfirmButton:!0})})).catch((function(t){var e=t.response.data;swal({title:"Error !",text:e.message,type:"error",showConfirmButton:!0})})).then((function(){s.loading.page=!1}));case 29:case"end":return a.stop()}}),a)})))()},selectBlendNo:function(t){var e=this;return dt(r().mark((function t(){var a,n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=e).uomDesc="",a.header.description="",a.header.formula_no="",a.header.product_item_code="",a.header.uom="",n=a.data.blend_no_list.findIndex((function(t){return t.value==a.header.blend_no})),(n=a.data.blend_no_list[n])?(a.header.description=n.description,a.header.formula_no=n.formula_no,a.header.product_item_code=n.product_item_code,a.header.uom=n.uom,a.uomDesc=n.uom_name,a.header.formula_id||(a.header.quantity=100)):a.header.formula_id||(a.header.quantity=""),a.header.blend_no&&a.changeTab("tab1","tab1",!1);case 10:case"end":return t.stop()}}),t)})))()},selectFlavour:function(){var t=this;return dt(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t).header.flavour="",a.header.formula_organization_code="",a.header.organization_code="",a.header.department="",n=a.data.flavour_list.findIndex((function(t){return t.value==a.header.flavour_code})),(n=a.data.flavour_list[n])&&(a.header.flavour=n.flavour,a.header.formula_organization_code=n.formula_organization_code,a.header.organization_code=n.organization_code,a.header.department=n.department);case 8:case"end":return e.stop()}}),e)})))()}}};const ft=(0,c.Z)(ut,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[t.loading.before_mount?t._e():a("div",[a("modal-search",{attrs:{transDate:t.transDate,header:t.header,transBtn:t.transBtn,url:t.url,countOpen:t.countOpenModal},on:{selectRow:t.show}}),t._v(" "),a("div",{staticClass:"ibox float-e-margins"},[a("div",{staticClass:"ibox-content pb-1",staticStyle:{"border-bottom":"0px"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-3"}),t._v(" "),a("div",{staticClass:"col-9 text-right"},[a("button",{class:t.transBtn.create.class+" btn-lg tw-w-25",on:{click:function(e){return e.preventDefault(),t.getInfo()}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                        "+t._s(t.transBtn.create.text)+"\n                    ")]),t._v(" "),a("button",{class:t.transBtn.search.class+" btn-lg tw-w-25 mr-2",on:{click:function(e){e.preventDefault(),t.countOpenModal+=1}}},[a("i",{class:t.transBtn.search.icon}),t._v("\n                        "+t._s(t.transBtn.search.text)+"\n                    ")]),t._v(" "),a("button",{class:t.transBtn.save.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.save()}}},[a("i",{class:t.transBtn.save.icon}),t._v("\n                        "+t._s(t.transBtn.save.text)+"\n                    ")]),t._v(" "),a("button",{class:t.transBtn.copy.class+" btn-lg tw-w-25",attrs:{type:"button"}},[a("i",{class:t.transBtn.copy.icon}),t._v("\n                        "+t._s(t.transBtn.copy.text)+"สูตร\n                    ")]),t._v(" "),a("button",{staticClass:"btn btn-default",attrs:{"data-toggle":"modal","data-target":"#historyModal"}},[a("i",{staticClass:"fa fa-file-text-o"}),t._v(" ประวัติแก้ไข")])])])]),t._v(" "),a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-8 b-r"},[a("dl",{staticClass:"row mb-0"},[a("div",{staticClass:"col-sm-3 text-sm-right"},[a("dt",[t._v("ผู้บันทึก:")])]),t._v(" "),a("div",{staticClass:"col-sm-4 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t._v("\n                                "+t._s(t.header.user_name)+"\n                            ")])])]),t._v(" "),a("dl",{staticClass:"row mb-1"},[a("div",{staticClass:"col-sm-3 text-sm-right"},[a("dt",[t._v("วันที่สร้าง:")])]),t._v(" "),a("div",{staticClass:"col-sm-4 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t._v("\n                                "+t._s(t.header.formula_creation_date_format)+"\n                            ")])]),t._v(" "),a("div",{staticClass:"col-sm-2 text-sm-right"},[a("dt",[t._v("วันที่แก้ไขล่าสุด:")])]),t._v(" "),a("div",{staticClass:"col-sm-3 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t._v("\n                                "+t._s(t.header.formula_last_update_date_format)+"\n                            ")])])]),t._v(" "),a("div",{staticClass:"hr-line-dashed m-t-sm m-b-sm hidden-sm hidden-xs"}),t._v(" "),a("div",{staticClass:"form-group mb-2 mt-3 row"},[a("label",{staticClass:"col-lg-3 font-weight-bold col-form-label required text-right"},[t._v("\n                            ยาเส้นปรุง Blend No.\n                        ")]),t._v(" "),a("div",{staticClass:"col-lg-4"},[a("el-select",{staticClass:"required",staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"blend_no",disabled:""!=t.header.formula_id,clearable:"",filterable:""},on:{change:function(e){return t.selectBlendNo("blend_no")}},model:{value:t.header.blend_no,callback:function(e){t.$set(t.header,"blend_no",e)},expression:"header.blend_no"}},t._l(t.data.blend_no_list,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("label",{staticClass:"col-lg-2 font-weight-bold col-form-label text-right "},[t._v("\n                            ประเภทสูตร\n                        ")]),t._v(" "),a("div",{staticClass:"col-lg-3"},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"formula_type_code",disabled:""!=t.header.formula_id},model:{value:t.header.formula_type_code,callback:function(e){t.$set(t.header,"formula_type_code",e)},expression:"header.formula_type_code"}},t._l(t.data.formula_type,(function(t,e){return a("el-option",{key:String(t.lookup_code),attrs:{label:t.description,value:String(t.lookup_code)}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group mb-2 row"},[a("label",{staticClass:"col-lg-3 font-weight-bold col-form-label text-right required"},[t._v("\n                            รสชาติ\n                        ")]),t._v(" "),a("div",{staticClass:"col-lg-4"},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"flavour_code",disabled:!t.header.can.edit,clearable:"",filterable:""},on:{change:function(e){return t.selectFlavour()}},model:{value:t.header.flavour_code,callback:function(e){t.$set(t.header,"flavour_code",e)},expression:"header.flavour_code"}},t._l(t.data.flavour_list,(function(t){return a("el-option",{key:String(t.value),attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("label",{staticClass:"col-lg-2 font-weight-bold col-form-label text-right required"},[t._v("\n                            ปริมาณ\n                        ")]),t._v(" "),a("div",{staticClass:"col-lg-3"},[a("div",{staticClass:"input-group "},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.header.quantity,expression:"header.quantity",modifiers:{number:!0}}],staticClass:"form-control text-right ",attrs:{type:"number",disabled:!t.header.can.edit},domProps:{value:t.header.quantity},on:{input:function(e){e.target.composing||t.$set(t.header,"quantity",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("div",{staticClass:"input-group-append",attrs:{title:t.header.uom}},[a("span",{staticClass:"input-group-addon"},[t._v("\n                                        "+t._s(t.uomDesc)+"\n                                    ")])])])])]),t._v(" "),a("div",{staticClass:"form-group mb-2 row"},[a("label",{staticClass:"col-lg-3 font-weight-bold col-form-label text-right"},[t._v("\n                            รายละเอียด\n                        ")]),t._v(" "),a("div",{staticClass:"col-lg-4"},[a("el-input",{attrs:{type:"textarea",name:"note",disabled:!t.header.can.edit,rows:"2",maxlength:"240","show-word-limit":""},model:{value:t.header.description,callback:function(e){t.$set(t.header,"description",e)},expression:"header.description"}})],1),t._v(" "),a("label",{staticClass:"col-lg-2 font-weight-bold col-form-label text-right"},[t._v("\n                            หมายเหตุ\n                        ")]),t._v(" "),a("div",{staticClass:"col-lg-3"},[a("el-input",{attrs:{type:"textarea",name:"note",disabled:!t.header.can.edit,rows:"2",maxlength:"240","show-word-limit":""},model:{value:t.header.comments,callback:function(e){t.$set(t.header,"comments",e)},expression:"header.comments"}})],1)])]),t._v(" "),a("div",{staticClass:"col-lg-4"},[a("dl",{staticClass:"row mb-2"},[a("div",{staticClass:"col-sm-4 text-sm-right"},[a("dt",{attrs:{title:""}},[t._v("สถานะ")])]),t._v(" "),a("div",{staticClass:"col-sm-7 text-sm-left"},[a("dd",{staticClass:"mb-1"},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"formula_status"},on:{change:t.changeStatus},model:{value:t.header.formula_status,callback:function(e){t.$set(t.header,"formula_status",e)},expression:"header.formula_status"}},t._l(t.data.status_list,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1)])]),t._v(" "),a("dl",{staticClass:"row mb-2"},[a("div",{staticClass:"col-sm-4 pt-2 text-sm-right"},[a("dt",{attrs:{title:""}},[t._v("วันที่อนุมัติ")])]),t._v(" "),a("div",{staticClass:"col-sm-7 text-sm-left"},[a("dd",{staticClass:"mb-1"},[a("div",[a("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{placeholder:"โปรดเลือกวันที่",disabled:!t.header.can.edit,value:t.header.formula_approval_date_format,format:t.transDate["js-format"]},on:{dateWasSelected:function(e){for(var a=arguments.length,n=Array(a);a--;)n[a]=arguments[a];return t.setdate.apply(void 0,n.concat(["formula_approval_date_format"]))}}})],1)])])]),t._v(" "),a("dl",{staticClass:"row mb-2"},[a("div",{staticClass:"col-sm-4 pt-2 text-sm-right"},[a("dt",{attrs:{title:""}},[t._v("วันที่เริ่มใช้")])]),t._v(" "),a("div",{staticClass:"col-sm-7 text-sm-left"},[a("dd",{staticClass:"mb-1"},[a("div",[a("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{placeholder:"โปรดเลือกวันที่",disabled:!t.header.can.edit,value:t.header.formula_start_date_format,format:t.transDate["js-format"]},on:{dateWasSelected:function(e){for(var a=arguments.length,n=Array(a);a--;)n[a]=arguments[a];return t.setdate.apply(void 0,n.concat(["formula_start_date_format"]))}}})],1)])])])])])])]),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.header.blend_no?a("div",{staticClass:"ibox float-e-margins"},[a("div",{staticClass:"ibox-content"},[a("div",{staticClass:"tabs-container"},[a("ul",{staticClass:"nav nav-tabs",attrs:{role:"tablist"}},[a("li",[a("a",{class:"tab1"==t.selTabName?"nav-link active":"nav-link",on:{click:function(e){return t.changeTab("tab1",t.selTabName)}}},[t._v("\n                            Leaf Formula\n                        ")])]),t._v(" "),a("li",[(t.header.formula_id,a("a",{class:"tab2"==t.selTabName?"nav-link active":"nav-link",on:{click:function(e){return t.changeTab("tab2",t.selTabName)}}},[t._v("\n                            Casing\n                        ")]))]),t._v(" "),a("li",[(t.header.formula_id,a("a",{class:"tab3"==t.selTabName?"nav-link active":"nav-link",on:{click:function(e){return t.changeTab("tab3",t.selTabName)}}},[t._v("\n                            Flavor\n                        ")]))]),t._v(" "),a("li",[(t.header.formula_id,a("a",{class:"tab4"==t.selTabName?"nav-link active":"nav-link",on:{click:function(e){return t.changeTab("tab4",t.selTabName)}}},[t._v("\n                            บุหรี่\n                        ")]))]),t._v(" "),a("li",[(t.header.formula_id,a("a",{class:"tab5"==t.selTabName?"nav-link active":"nav-link",on:{click:function(e){return t.changeTab("tab5",t.selTabName)}}},[t._v("\n                            ทั้งหมด\n                        ")]))])]),t._v(" "),a("div",{staticClass:"tab-content"},[a("div",{class:"tab1"==t.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tabs.leaf_formula_line.loading,expression:"tabs.leaf_formula_line.loading"}],staticClass:"panel-body pt-3 "},["tab1"==t.selTabName?a("tab-leaf-formula",{attrs:{header:t.header,url:t.url,transBtn:t.transBtn,transDate:t.transDate,data:t.data.tabs.leaf_formula_line,leafFormulas:t.leafFormulas,pRefresh:t.tabs.leaf_formula_line.refreshCount,tabs:t.tabs}}):t._e()],1)]),t._v(" "),a("div",{class:"tab2"==t.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tabs.casings.loading,expression:"tabs.casings.loading"}],staticClass:"panel-body pt-3"},["tab2"==t.selTabName&&t.header.formula_id?a("casing",{attrs:{header:t.header,url:t.url,transBtn:t.transBtn,transDate:t.transDate,data:t.data.tabs.casings,casings:t.casings,tabs:t.tabs}}):t._e()],1)]),t._v(" "),a("div",{class:"tab3"==t.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tabs.flavors.loading,expression:"tabs.flavors.loading"}],staticClass:"panel-body pt-3"},["tab3"==t.selTabName&&t.header?a("flavor",{attrs:{header:t.header,url:t.url,transBtn:t.transBtn,transDate:t.transDate,data:t.data.tabs.flavors,flavors:t.flavors,tabs:t.tabs}}):t._e()],1)]),t._v(" "),a("div",{class:"tab4"==t.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tabs.cigarettes.loading,expression:"tabs.cigarettes.loading"}],staticClass:"panel-body pt-3"},["tab4"==t.selTabName&&t.header&&t.header.formula_id?a("cigarette",{attrs:{header:t.header,url:t.url,transBtn:t.transBtn,transDate:t.transDate,data:t.data.tabs.cigarettes,cigarettes:t.cigarettes,cigarDtl:t.cigarDtl,tabs:t.tabs}}):t._e()],1)]),t._v(" "),a("div",{class:"tab5"==t.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tabs.cigarette_all.loading,expression:"tabs.cigarette_all.loading"}],staticClass:"panel-body pt-3"},["tab5"==t.selTabName&&t.header&&t.header.formula_id?a("cigarette-all",{attrs:{transBtn:t.transBtn,transDate:t.transDate,cigaretteAll:t.cigaretteAll,tabs:t.tabs}}):t._e()],1)])])])])]):t._e()])],1)])}),[],!1,null,null,null).exports}}]);