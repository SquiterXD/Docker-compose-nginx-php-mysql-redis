(self.webpackChunk=self.webpackChunk||[]).push([[1659],{91659:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>o});var i=l(87757),a=l.n(i);function r(e,t,l,i,a,r,n){try{var s=e[r](n),o=s.value}catch(e){return void l(e)}s.done?t(o):Promise.resolve(o).then(i,a)}function n(e){return function(){var t=this,l=arguments;return new Promise((function(i,a){var n=e.apply(t,l);function s(e){r(n,i,a,s,o,"next",e)}function o(e){r(n,i,a,s,o,"throw",e)}s(void 0)}))}}const s={components:{},props:["workingHour","workingHoliday","productTypes","defaultInput","searchInput","budgetYears","biWeeklyDetails","dateFormat","btnTrans","url"],data:function(){return{budget_year:this.defaultInput.current_year,month:this.defaultInput.current_month,bi_weekly:this.defaultInput.current_biweekly,working_hour:this.defaultInput.working_hour,month_lists:[],bi_weekly_lists:[],bi_weekly_detail:"",loading:!1,valid:!1,m_loading:!1,b_loading:!1,errors:{budget_year:!1,month:!1,bi_weekly:!1}}},mounted:function(){this.budget_year&&this.getMonth(),this.budget_year&&this.month&&this.bi_weekly&&(this.getMonth(),this.getBiWeeklySeq()),this.getBiWeeklyDetail()},computed:{monthLists:function(){return this.month_lists},biWeeklyLists:function(){return this.bi_weekly_lists}},watch:{errors:{handler:function(e){e.budget_year?this.setError("budget_year"):this.resetError("budget_year"),e.month?this.setError("month"):this.resetError("month"),e.bi_weekly?this.setError("bi_weekly"):this.resetError("bi_weekly")},deep:!0}},methods:{openModal:function(){$("#modal-overtimes").modal("show")},getMonth:function(){this.month_lists=this.searchInput.months},getBiWeeklySeq:function(){var e=this;e.bi_weekly_lists=e.searchInput.bi_weekly.filter((function(t){return t.period_num==e.month}))},getBiWeeklyDetail:function(){var e=this;""!=e.biWeekly&&null!=e.biWeekly||(e.biWeeklyDetail=""),e.biWeeklyDetails.filter((function(t){if(t.thai_year==e.budget_year&&t.period_num==e.month&&t.biweekly==e.bi_weekly)return e.bi_weekly_detail=t.thai_combine_date}))},submit:function(){var e=this;return n(a().mark((function t(){var l,i,r,n,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=$("#overtimes-create-form"),i=l.serialize(),r=!0,n="",e.errors.budget_year=!1,e.errors.month=!1,e.errors.bi_weekly=!1,$(l).find("div[id='budget_year']").html(""),$(l).find("div[id='el_explode_month']").html(""),$(l).find("div[id='el_explode_bi_weekly']").html(""),""==e.budget_year&&(e.errors.budget_year=!0,r=!1,n="กรุณาเลือกปีงบประมาณ",$(l).find("div[id='el_explode_budget_year']").html(n)),""==e.month&&(e.errors.month=!0,r=!1,n="กรุณาเลือกเดือน",$(l).find("div[id='el_explode_month']").html(n)),""==e.bi_weekly&&(e.errors.bi_weekly=!0,r=!1,n="กรุณาเลือกปักษ์",$(l).find("div[id='el_explode_bi_weekly']").html(n)),r){t.next=15;break}return t.abrupt("return");case 15:return e.loading=!0,t.next=18,e.createOverTimesPlan(i);case 18:"S"==(s=t.sent).status?(swal({title:"สร้างประมาณการค่าใช้จ่ายล่วงเวลา",text:'<span style="font-size: 16px; text-align: left;"> ทำการสร้างข้อมูลประมาณการค่าใช้จ่ายล่วงเวลาประจำปักษ์เรียบร้อยแล้ว </span>',type:"success",html:!0}),window.setTimeout((function(){window.location.href=s.redirectPath}),2e3)):swal({title:"มีข้อผิดพลาด",text:'<span style="font-size: 16px; text-align: left;">'+s.msg+"</span>",type:"warning",html:!0});case 20:case"end":return t.stop()}}),t)})))()},createOverTimesPlan:function(e){var t=this;return n(a().mark((function l(){var i,r;return a().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return i=[],r=t,l.next=4,axios.post(r.url.create_plan_p10,e).then((function(e){i=e.data})).catch((function(e){var t=e.response.data;swal({title:"มีข้อผิดพลาด",text:t.message,type:"error"})})).then((function(){t.loading=!1}));case 4:return l.abrupt("return",i);case 5:case"end":return l.stop()}}),l)})))()}}};const o=(0,l(51900).Z)(s,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("span",[l("button",{class:e.btnTrans.create.class+" btn-lg tw-w-25",on:{click:function(t){return t.preventDefault(),e.openModal()}}},[l("i",{class:e.btnTrans.create.icon}),e._v(" "+e._s(e.btnTrans.create.text)+"\n    ")]),e._v(" "),l("div",{staticClass:"modal fade",attrs:{id:"modal-overtimes",role:"dialog"}},[l("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[l("div",{staticClass:"modal-content"},[e._m(0),e._v(" "),l("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"modal-body text-left"},[l("form",{attrs:{id:"overtimes-create-form"}},[l("div",{staticClass:"row col-12 m-0"},[l("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[l("label",{staticClass:" tw-font-bold tw-uppercase mb-1"},[e._v(" ปีงบประมาณ ")]),e._v(" "),l("div",{staticClass:"input-group "},[l("input",{attrs:{type:"hidden",name:"budget_year"},domProps:{value:e.budget_year}}),e._v(" "),l("el-select",{ref:"budget_year",attrs:{size:"medium",placeholder:"ปีงบประมาณ",filterable:"","popper-append-to-body":!1},on:{change:e.getMonth},model:{value:e.budget_year,callback:function(t){e.budget_year=t},expression:"budget_year"}},e._l(e.budgetYears,(function(e,t){return l("el-option",{key:t,attrs:{label:e.thai_year,value:e.thai_year}})})),1)],1),e._v(" "),l("div",{staticClass:"error_msg text-left",attrs:{id:"el_explode_budget_year"}})]),e._v(" "),l("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[l("label",{staticClass:" tw-font-bold tw-uppercase mb-1"},[e._v(" เดือน ")]),e._v(" "),l("div",{},[l("input",{attrs:{type:"hidden",name:"month"},domProps:{value:e.month}}),e._v(" "),e.budget_year?l("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.m_loading,expression:"m_loading"}],ref:"month",attrs:{size:"medium",placeholder:"เดือน",filterable:"","popper-append-to-body":!1},on:{change:e.getBiWeeklySeq},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}},e._l(e.monthLists,(function(e,t){return l("el-option",{key:t,attrs:{label:e.thai_month,value:e.period_num}})})),1):l("el-select",{ref:"month",attrs:{size:"medium",placeholder:"เดือน",disabled:""},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}},e._l(e.monthLists,(function(e,t){return l("el-option",{key:t,attrs:{label:e.thai_month,value:e.period_num}})})),1)],1),e._v(" "),l("div",{staticClass:"error_msg text-left",attrs:{id:"el_explode_month"}})]),e._v(" "),l("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[l("label",{staticClass:" tw-font-bold tw-uppercase mb-1"},[e._v(" ปักษ์ ")]),e._v(" "),l("div",{},[l("input",{attrs:{type:"hidden",name:"bi_weekly"},domProps:{value:e.bi_weekly}}),e._v(" "),e.month?l("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.b_loading,expression:"b_loading"}],ref:"bi_weekly",attrs:{clearable:"",size:"medium",placeholder:"ปักษ์",filterable:"","popper-append-to-body":!1},on:{change:e.getBiWeeklyDetail},model:{value:e.bi_weekly,callback:function(t){e.bi_weekly=t},expression:"bi_weekly"}},e._l(e.biWeeklyLists,(function(e,t){return l("el-option",{key:t,attrs:{label:e.biweekly,value:e.biweekly}})})),1):l("el-select",{ref:"bi_weekly",attrs:{clearable:"",size:"medium",placeholder:"ปักษ์",disabled:""},model:{value:e.bi_weekly,callback:function(t){e.bi_weekly=t},expression:"bi_weekly"}},e._l(e.biWeeklyLists,(function(e,t){return l("el-option",{key:t,attrs:{label:e.biweekly,value:e.biweekly}})})),1)],1),e._v(" "),l("div",{staticClass:"error_msg text-left",attrs:{id:"el_explode_bi_weekly"}})]),e._v(" "),l("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-3 col-sm-4 col-xs-4 mt-2"},[l("input",{attrs:{type:"hidden",name:"working_hour"},domProps:{value:e.working_hour}}),e._v(" "),l("label",{staticClass:" tw-font-bold tw-uppercase mb-1"},[e._v(" ชั่วโมงทำงานเริ่มต้น :")]),e._v(" "),l("el-select",{attrs:{size:"medium",placeholder:"ชั่วโมงทำงานเริ่มต้น",filterable:"","popper-append-to-body":!1},model:{value:e.working_hour,callback:function(t){e.working_hour=t},expression:"working_hour"}},e._l(e.workingHoliday,(function(e,t){return l("el-option",{key:t,attrs:{label:e.meaning,value:e.lookup_code}})})),1)],1),e._v(" "),l("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-12 col-md-12 col-sm-12 col-xs-12"},[e._m(1),e._v(" "),l("div",{staticClass:"text-right"},[l("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(t){return t.preventDefault(),e.submit()}}},[l("i",{staticClass:"fa fa-plus"}),e._v(" สร้าง\n                                    ")]),e._v(" "),e._m(2)])])])])])])])])])}),[function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"modal-header"},[l("h3",{staticClass:"modal-title text-left",staticStyle:{"font-size":"22px","font-weight":"400"}},[e._v("\n                        สร้างประมาณการค่าใช้จ่ายล่วงเวลา\n                    ")]),e._v(" "),l("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[l("span",{attrs:{"aria-hidden":"true"}},[e._v("×")]),l("span",{staticClass:"sr-only"},[e._v("Close")])])])},function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("label",{staticClass:" tw-font-bold tw-uppercase mt-1"},[e._v(" "),l("br")])},function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("button",{staticClass:"btn btn-sm btn-danger",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[l("i",{staticClass:"fa fa-times"}),e._v(" ยกเลิก\n                                    ")])}],!1,null,null,null).exports}}]);