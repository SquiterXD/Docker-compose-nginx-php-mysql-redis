(self.webpackChunk=self.webpackChunk||[]).push([[9582],{99582:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>u});var o=s(30381),i=s.n(o);function r(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,o=new Array(e);s<e;s++)o[s]=t[s];return o}function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,o)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){l(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const p={props:["sampleDate","sampleTime","repeatFlag","repeatTimeHour","repeatTimeMin","repeatQty","qmGroups","processQmGroups","siloQmGroups","locators","qmGroupValue","qmGroupTypeValue","locatorValue","optSelectionTypeValue","selectedOptValue","processBatchs","siloBatchs"],data:function(){var t=this;return{qmGroup:this.qmGroupValue,qmGroupType:this.qmGroupTypeValue,locator:this.locatorValue,optSelectionType:this.optSelectionTypeValue?this.optSelectionTypeValue:"CHECKLIST",searchOptKeyword:"",opts:[],selectedOpts:[],selectedOpt:this.selectedOptValue,qmGroupOptions:this.qmGroups,locatorOptions:this.getLocatorOptionsInQmGroup(this.qmGroupValue),moisturePoints:this.getMoisturePoints(this.locators,this.qmGroupValue,this.locatorValue),batchItems:[],processBatchItems:this.processBatchs.filter((function(t){return!!t.batch_id})).map((function(e){return c(c({},e),{},{locator_desc:t.getLocatorDescByMoisturePoint(t.locators,e.moisture_point),opt_desc:t.getOptDesc(e.batch_id),blend_date_formatted:i()(e.blend_start_date).format("d/M/y"),blend_time:i()(e.blend_start_date).format("hh:mm"),blend_meridiem:i()(e.blend_start_date).format("A"),selected:!1})})),siloBatchItems:this.siloBatchs.filter((function(t){return!!t.batch_id})).map((function(e){return c(c({},e),{},{locator_desc:t.getLocatorDescByMoisturePoint(t.locators,e.moisture_point),opt_desc:t.getOptDesc(e.batch_id),blend_date_formatted:i()(e.blend_start_date).format("d/M/y"),blend_time:i()(e.blend_start_date).format("hh:mm"),blend_meridiem:i()(e.blend_start_date).format("A"),selected:!1})}))}},mounted:function(){},methods:{getLocatorOptionsInQmGroup:function(t){return"ALL"==t?[{inventory_location_id:"ALL",location_full_desc:"เลือกทั้งหมด"}]:[{inventory_location_id:"ALL",location_full_desc:"เลือกทั้งหมด"}].concat(r(this.locators.filter((function(e){return e.qm_group==t}))))},getLocatorDescByMoisturePoint:function(t,e){var s="";if(e){var o=t.find((function(t){return t.moisture_point==e}));s=o?o.locator_desc:""}return s},getOptDesc:function(t){var e="",s=t.split("_");return s.length>1&&(e=s[1]),e},onQmGroupWasSelected:function(t){this.locatorOptions=this.getLocatorOptionsInQmGroup(t),this.qmGroup=t,this.qmGroupType=this.getQmGroupType(t),this.batchItems=[],this.selectedOpts=this.batchItems.filter((function(t){return t.selected})),this.locator="ALL",this.moisturePoints=this.getMoisturePoints(this.locators,this.qmGroup,this.locator),this.selectedOpt=null,this.selectedOpts=this.batchItems.filter((function(t){return t.selected}))},onLocatorWasSelected:function(t){this.locator=t,this.moisturePoints=this.getMoisturePoints(this.locators,this.qmGroup,this.locator),this.batchItems=this.getBatchItems(this.qmGroup,this.searchOptKeyword),this.selectedOpt=null,this.selectedOpts=this.batchItems.filter((function(t){return t.selected}))},getQmGroupType:function(t){var e="";return this.processQmGroups.find((function(e){return e.qm_group_value==t}))&&(e="PROCESS"),this.siloQmGroups.find((function(e){return e.qm_group_value==t}))&&(e="SILO"),e},getMoisturePoints:function(t,e,s){var o=t.map((function(t){return t.moisture_point}));return e&&"ALL"!=e&&(o=t.filter((function(t){return t.qm_group==e})).map((function(t){return t.moisture_point})),e&&s&&"ALL"!=s&&(o=t.filter((function(t){return t.qm_group==e&&t.inventory_location_id==s})).map((function(t){return t.moisture_point})))),o},onGetBatchItems:function(){this.moisturePoints=this.getMoisturePoints(this.locators,this.qmGroup,this.locator),this.batchItems=[],this.batchItems=this.getBatchItems(this.qmGroup,this.searchOptKeyword),this.selectedOpt=null,this.selectedOpts=this.batchItems.filter((function(t){return t.selected}))},getBatchItems:function(t,e){var s=this,o=[];if(t&&("CHECKLIST"==this.optSelectionType||"SELECT"==this.optSelectionType)){var i=this.processQmGroups.find((function(e){return e.qm_group_value==t})),r=this.siloQmGroups.find((function(e){return e.qm_group_value==t}));i&&(o=e?this.processBatchItems.filter((function(t){return s.moisturePoints.includes(t.moisture_point)&&(t.batch_id.includes(e)||t.moisture_point.includes(e))})).map((function(t){return c(c({},t),{},{selected:!1})})):this.processBatchItems.filter((function(t){return s.moisturePoints.includes(t.moisture_point)})).map((function(t){return c(c({},t),{},{selected:!1})}))),r&&(o=e?this.siloBatchItems.filter((function(t){return s.moisturePoints.includes(t.moisture_point)&&(t.batch_id.includes(e)||t.moisture_point.includes(e))})).map((function(t){return c(c({},t),{},{selected:!1})})):this.siloBatchItems.filter((function(t){return s.moisturePoints.includes(t.moisture_point)})).map((function(t){return c(c({},t),{},{selected:!1})})))}return o},onOptSelectionTypeChanged:function(t){this.batchItems=[],this.searchOptKeyword="",this.selectedOpt=null,this.selectedOpts=this.batchItems.filter((function(t){return t.selected}))},onOptChecked:function(t){this.selectedOpt=null,this.selectedOpts=this.batchItems.filter((function(t){return t.selected}))},onSelectedOptWasSelected:function(t){console.log("this.selectedOpt : ",this.selectedOpt)}}};const u=(0,s(51900).Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4"},[s("div",{staticClass:"row form-group"},[s("label",{staticClass:"col-md-4 col-form-label required"},[t._v("  กลุ่มงาน ")]),t._v(" "),s("div",{staticClass:"col-md-8"},[s("qm-el-select",{attrs:{name:"qm_group",id:"input_qm_group",placeholder:"เลือก กลุ่มงาน","option-key":"qm_group_value","option-value":"qm_group_value","option-label":"qm_group_label","select-options":t.qmGroupOptions,value:t.qmGroup,filterable:!0},on:{onSelected:t.onQmGroupWasSelected}})],1)]),t._v(" "),s("div",{staticClass:"row form-group"},[s("label",{staticClass:"col-md-4 col-form-label required"},[t._v(" จุดตรวจสอบ")]),t._v(" "),s("div",{staticClass:"col-md-8"},[s("qm-el-select",{attrs:{name:"locator_id",id:"input_locator_id",placeholder:"เลือก จุดตรวจสอบ","option-key":"inventory_location_id","option-value":"inventory_location_id","option-label":"location_full_desc","select-options":t.locatorOptions,value:t.locator,filterable:!0},on:{onSelected:t.onLocatorWasSelected}})],1)]),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"row form-group"},[s("div",{staticClass:"col-md-12"},[s("label",{staticClass:"required"},[t._v("วัน/เวลา ที่เก็บตัวอย่าง")]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-8"},[s("qm-datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",attrs:{name:"sample_date",id:"input_sample_date",placeholder:"โปรดเลือกวันที่เก็บตัวอย่าง",value:t.sampleDate}})],1),t._v(" "),s("div",{staticClass:"col-md-4"},[s("qm-timepicker",{attrs:{name:"sample_time",id:"input_sample_time",value:t.sampleTime}})],1)])])]),t._v(" "),s("div",{staticClass:"row form-group"},[s("div",{staticClass:"col-md-12"},[s("qm-input-group-repeat",{attrs:{"repeat-flag-value":t.repeatFlag,"repeat-time-hour-value":t.repeatTimeHour,"repeat-time-min-value":t.repeatTimeMin,"repeat-qty-value":t.repeatQty}})],1)])]),t._v(" "),s("div",{staticClass:"col-md-8"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"},[s("div",{staticClass:"ibox"},[s("div",{staticClass:"ibox-content tw-p-2"},[s("div",{staticClass:"form-check tw-my-1 tw-text-xs"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.optSelectionType,expression:"optSelectionType"}],staticClass:"form-check-input",attrs:{type:"radio",name:"opt_selection_type",value:"CHECKLIST",id:"opt_selection_checklist"},domProps:{checked:t._q(t.optSelectionType,"CHECKLIST")},on:{change:[function(e){t.optSelectionType="CHECKLIST"},function(e){return t.onOptSelectionTypeChanged(e)}]}}),t._v(" "),s("label",{staticClass:"form-check-label",attrs:{for:"opt_selection_type1"}},[t._v("\n                                ค้นหาและเลือกรายการตราชุด\n                            ")])]),t._v(" "),s("div",{staticClass:"form-check tw-my-1 tw-text-xs"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.optSelectionType,expression:"optSelectionType"}],staticClass:"form-check-input",attrs:{type:"radio",name:"opt_selection_type",value:"AUTO",id:"opt_selection_auto"},domProps:{checked:t._q(t.optSelectionType,"AUTO")},on:{change:[function(e){t.optSelectionType="AUTO"},function(e){return t.onOptSelectionTypeChanged(e)}]}}),t._v(" "),s("label",{staticClass:"form-check-label",attrs:{for:"opt_selection_type2"}},[t._v("\n                                ระบบระบุตราชุดให้\n                            ")])]),t._v(" "),s("div",{staticClass:"form-check tw-my-1 tw-text-xs"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.optSelectionType,expression:"optSelectionType"}],staticClass:"form-check-input",attrs:{type:"radio",name:"opt_selection_type",value:"SELECT",id:"opt_selection_select"},domProps:{checked:t._q(t.optSelectionType,"SELECT")},on:{change:[function(e){t.optSelectionType="SELECT"},function(e){return t.onOptSelectionTypeChanged(e)}]}}),t._v(" "),s("label",{staticClass:"form-check-label",attrs:{for:"opt_selection_type3"}},[t._v("\n                                กำหนดตราชุด\n                            ")])]),t._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.qmGroupType,expression:"qmGroupType"}],attrs:{type:"hidden",name:"qm_group_type"},domProps:{value:t.qmGroupType},on:{input:function(e){e.target.composing||(t.qmGroupType=e.target.value)}}})])])])]),t._v(" "),s("div",{staticClass:"col-9"},[s("div",{staticClass:"tw-w-full"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-12"},[s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-group-prepend"},[s("button",{staticClass:"btn btn-sm btn-outline btn-white tw-w-full",attrs:{type:"button",disabled:!t.qmGroup||"CHECKLIST"!=t.optSelectionType&&"SELECT"!=t.optSelectionType},on:{click:function(e){return t.onGetBatchItems()}}},[s("i",{staticClass:"fa fa-search"}),t._v(" ค้นหา\n                                    ")])]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchOptKeyword,expression:"searchOptKeyword"}],staticClass:"form-control input-sm",attrs:{type:"text",disabled:!t.qmGroup||"CHECKLIST"!=t.optSelectionType&&"SELECT"!=t.optSelectionType,placeholder:"ค้นหาจาก ตราชุด, หัววัดความชื้น "},domProps:{value:t.searchOptKeyword},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.onGetBatchItems(e))},input:function(e){e.target.composing||(t.searchOptKeyword=e.target.value)}}})])])]),t._v(" "),"CHECKLIST"==t.optSelectionType?s("div",{staticClass:"row"},[t._m(0),t._v(" "),s("div",{staticClass:"col-md-6"},[s("label",{staticClass:"col-form-label tw-w-full text-right"},[t._v(" จำนวน "+t._s(t.selectedOpts?t.selectedOpts.length:"-")+" รายการ ")])])]):t._e()]),t._v(" "),s("div",{staticClass:"table-responsive",staticStyle:{"max-height":"300px"}},[s("table",{staticClass:"table table-bordered",staticStyle:{"min-width":"650px"}},[t._m(1),t._v(" "),t.batchItems.length>0?s("tbody",[t._l(t.batchItems,(function(e,o){return[s("tr",{key:o},[s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs"},["CHECKLIST"==t.optSelectionType?s("div",{staticClass:"form-check tw-pl-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"batchItem.selected"}],staticClass:"tw-mt-1",attrs:{type:"checkbox",name:"opts[]"},domProps:{value:e.opt_id,checked:Array.isArray(e.selected)?t._i(e.selected,e.opt_id)>-1:e.selected},on:{change:[function(s){var o=e.selected,i=s.target,r=!!i.checked;if(Array.isArray(o)){var n=e.opt_id,a=t._i(o,n);i.checked?a<0&&t.$set(e,"selected",o.concat([n])):a>-1&&t.$set(e,"selected",o.slice(0,a).concat(o.slice(a+1)))}else t.$set(e,"selected",r)},t.onOptChecked]}})]):t._e(),t._v(" "),"SELECT"==t.optSelectionType?s("div",{staticClass:"form-check tw-pl-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedOpt,expression:"selectedOpt"}],staticClass:"tw-mt-1",attrs:{type:"radio",name:"selected_opt",id:"input_selected_opt"},domProps:{value:e.opt_id,checked:t._q(t.selectedOpt,e.opt_id)},on:{change:[function(s){t.selectedOpt=e.opt_id},function(e){return t.onSelectedOptWasSelected()}]}})]):t._e()]),t._v(" "),s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40"},[t._v("\n                                        "+t._s(e.locator_desc)+"\n                                    ")]),t._v(" "),s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs"},[t._v("\n                                        "+t._s(e.opt_desc)+"\n                                    ")]),t._v(" "),s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden"},[t._v("\n                                        "+t._s(e.blend_date_formatted)+"\n                                    ")]),t._v(" "),s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden"},[t._v("\n                                        "+t._s(e.blend_meridiem)+"\n                                    ")]),t._v(" "),s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden"},[t._v("\n                                        "+t._s(e.blend_time)+"\n                                    ")]),t._v(" "),s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden"},[t._v("\n                                        "+t._s(t.qmGroup)+"\n                                    ")]),t._v(" "),s("td",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden"},[t._v("\n                                        "+t._s(e.moisture_point)+"\n                                    ")])])]}))],2):s("tbody",[t._m(2)])])])])])])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-md-6"},[s("label",{staticClass:"col-form-label tw-w-full"},[t._v(" เลือกรายการตราชุดยาเส้น ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs",staticStyle:{"z-index":"auto"},attrs:{width:"5%"}}),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs",staticStyle:{"z-index":"auto"},attrs:{width:"20%"}},[t._v("\n                                    จุดตรวจสอบ\n                                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs",staticStyle:{"z-index":"auto"},attrs:{width:"10%"}},[t._v("\n                                    ตราชุด\n                                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"10%"}},[t._v("\n                                    วันที่\n                                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"5%"}},[t._v("\n                                    รอบ\n                                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"8%"}},[t._v("\n                                    เริ่มเวลา\n                                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"12%"}},[t._v("\n                                    กลุ่มงาน\n                                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-bg-opacity-40 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"12%"}},[t._v("\n                                    หัววัดความชื้น\n                                ")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{attrs:{colspan:"7"}},[s("h2",{staticClass:"p-5 text-center text-muted"},[t._v(" ไม่พบข้อมูล ")])])])}],!1,null,null,null).exports}}]);