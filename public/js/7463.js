(self.webpackChunk=self.webpackChunk||[]).push([[7463],{8917:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var a=n(23645),s=n.n(a)()((function(t){return t[1]}));s.push([t.id,"tr.duplicate_test_id>td{border:4px solid #ed5565!important}",""]);const i=s},97463:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>_});var a=n(87757),s=n.n(a);function i(t,e,n,a,s,i,l){try{var o=t[i](l),r=o.value}catch(t){return void n(t)}o.done?e(r):Promise.resolve(r).then(a,s)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(a,s){var l=t.apply(e,n);function o(t){i(l,a,s,o,r,"next",t)}function r(t){i(l,a,s,o,r,"throw",t)}o(void 0)}))}}var o;const r={props:["url","btnTrans","pTestType","pTestList","pRequest","pSpecifications","pResultSeverityCode"],data:function(){return{specifications:null!=this.pSpecifications&&""!=this.pSpecifications?this.pSpecifications:[],loading:!1,delTestIdArr:[]}},watch:{specifications:(o=l(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},mounted:function(){this.setOptionalInd(),this.setDuplicateTestId()},methods:{checkMinMaxVal:function(t,e){},setOptionalInd:function(){this.specifications.forEach((function(t){"Y"==t.optional_ind?t.optional_ind=!0:t.optional_ind=!1}))},setDuplicateTestId:function(){this.specifications.forEach((function(t){t.is_duplicate_test_id=!1}))},addLine:function(){var t=Object.keys(this.specifications).length;this.$set(this.specifications,t,{seq:null,test_code:null,test_id:null,test_unit:null,min_value:null,max_value:null,optional_ind:null,is_duplicate_test_id:!1,test_unit_desc:null})},delLine:function(t,e){var n=this;""!=t.seq&&n.delTestIdArr.push(t.test_id),n.$delete(n.specifications,e)},changeTest:function(t,e){var n=this;return l(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.is_duplicate_test_id=!1,a=n.pTestList.filter((function(e){return e.test_code==t.test_code})),t.test_unit=a[0].test_unit_code,t.test_id=a[0].test_id,t.test_unit_desc=a[0].test_unit,t.test_desc=a[0].test_desc,n.specifications.filter((function(t){return t.test_id==a[0].test_id})).length>1&&(t.is_duplicate_test_id=!0);case 8:case"end":return e.stop()}}),e)})))()},submitSearch:function(){5==this.pRequest.test_type&&$("#fromSearch").append('<input type="hidden" name="search_flag " value="true" />'),$("#fromSearch").submit()},save:function(){var t=this;swal({html:!0,title:"Save Trasaction ?",text:'<h2 class="m-t-sm m-b-lg"><span style="font-size: 18px"> ต้องการบันทึกรายการหรือไม่ </span></h2>',showCancelButton:!0,confirmButtonText:"บันทึก",cancelButtonText:"ยกเลิก",confirmButtonClass:"btn btn-primary",cancelButtonClass:"btn btn-white",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var e=l(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}t.loading=!0,axios.post(t.url.qm_api_settings_specifications_store,{specifications:t.specifications,test_type:t.pTestType,search_request:t.pRequest,del_test_id_arr:t.delTestIdArr}).then(function(t){"S"==t.data.data.status&&(swal({title:"บันทึกรายการสำเร็จ",text:'<span style="font-size: 16px; text-align: left;"> ทำการบันทึกรายการเรียบร้อย </span>',type:"success",html:!0}),location.reload()),"E"==t.data.data.status&&swal({title:"มีข้อผิดพลาด",text:'<span style="font-size: 16px; text-align: left;">'+t.data.data.msg+"</span>",type:"warning",html:!0})}.bind(this)).catch(function(t){}.bind(this)).then(function(){t.loading=!1}.bind(this)),e.next=6;break;case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}())}},computed:{canSave:function(){var t=!0;return this.specifications.forEach(function(){var e=l(s().mark((function e(n,a){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"ตัวอักษร"!=n.data_type&&(parseFloat(n.min_value)>parseFloat(n.max_value)&&(t=!1),parseFloat(n.max_value)<parseFloat(n.min_value)&&(t=!1));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),t}}};var c=n(93379),u=n.n(c),d=n(8917),p={insert:"head",singleton:!1};u()(d.Z,p);d.Z.locals;const _=(0,n(51900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"row form-group justify-content-center clearfix tw-my-6 text-center"},[n("div",{staticClass:"col-lg-6 col-md-6"},[n("button",{staticClass:"btn btn-lg btn-white tw-w-32 tw-ml-4",attrs:{type:"button"},on:{click:t.submitSearch}},[n("i",{staticClass:"fa fa-search"}),t._v(" ค้นหา\n            ")]),t._v(" "),n("a",{staticClass:"btn btn-lg tw-bg-gray-100 tw-bg-opacity-60 btn-white tw-w-32 tw-ml-4",attrs:{type:"button",href:t.url.qm_settings_specifications_index}},[n("i",{staticClass:"fa fa-times"}),t._v(" ล้าง\n            ")])])]),t._v(" "),n("hr",{staticClass:"tw-my-10"}),t._v(" "),n("div",{staticClass:"table-responsive"},[n("table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table text-nowrap table-hover table-bordered"},[n("thead",[n("tr",[n("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("\n                                    \n                                    \n                        ชื่อการทดสอบ/ความผิดปกติ*\n                                    \n                                    \n                    ")]),t._v(" "),n("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("Optimal")]),t._v(" "),n("th",{staticClass:"text-center align-middle",attrs:{colspan:"2"}},[t._v("ค่าควบคุม")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),n("th",{staticClass:"text-center align-middle",attrs:{colspan:t.pResultSeverityCode.length}},[t._v("ระดับความรุนแรง (Lower Level) *")]),t._v(" "),n("th",{staticClass:"text-center align-middle",attrs:{colspan:t.pResultSeverityCode.length}},[t._v("ระดับความรุนแรง (Upper Level) *")]),t._v(" "),n("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("Optional")])]),t._v(" "),n("tr",[n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px","max-width":"120px"}},[t._v("\n                        Min*\n                    ")]),t._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px","max-width":"120px"}},[t._v("\n                        Max*\n                    ")]),t._v(" "),t._l(t.pResultSeverityCode,(function(e,a){return[n("th",{staticClass:"text-center"},[t._v("      "+t._s(e.meaning)+"      ")])]})),t._v(" "),t._l(t.pResultSeverityCode,(function(e,a){return[n("th",{staticClass:"text-center"},[t._v("      "+t._s(e.meaning)+"      ")])]}))],2)]),t._v(" "),n("tbody",[t._l(t.specifications,(function(e,a){return t.specifications.length>0?n("tr",{attrs:{data:a}},[n("td",{staticClass:"align-middle"},[n("div",{staticStyle:{display:"flex"}},[n("div",{staticStyle:{width:"100%"}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.test_desc,placement:"top-start"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",disabled:null!=e.seq,placeholder:""},on:{change:function(n){return t.changeTest(e,a)}},model:{value:e.test_code,callback:function(n){t.$set(e,"test_code",n)},expression:"specification.test_code"}},[e.spec_id?n("el-option",{attrs:{label:e.test_desc,value:e.test_code}}):t._e(),t._v(" "),t._l(t.pTestList,(function(t,e){return n("el-option",{key:e,attrs:{label:t.test_desc,value:t.test_code}})}))],2)],1)],1),t._v(" "),n("button",{staticClass:"btn btn-outline btn-danger ml-2",attrs:{type:"button",title:"ลบรายการ"},on:{click:function(n){return n.preventDefault(),t.delLine(e,a)}}},[n("i",{class:t.btnTrans.delete.icon})])]),t._v(" "),e.is_duplicate_test_id?n("div",[n("span",{staticClass:"form-text m-b-none text-danger"},[t._v("\n                                ชื่อการทดสอบ/ความผิดปกติซ้ำ\n                            ")])]):t._e()]),t._v(" "),n("td",{staticStyle:{"min-width":"100px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.optimal_value,expression:"specification.optimal_value"}],staticClass:"form-control text-right",attrs:{type:"number"},domProps:{value:e.optimal_value},on:{input:function(n){n.target.composing||t.$set(e,"optimal_value",n.target.value)}}})]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.min_value,expression:"specification.min_value"}],staticClass:"form-control text-right",attrs:{disabled:"ตัวอักษร"==e.data_type,type:"number"},domProps:{value:e.min_value},on:{input:function(n){n.target.composing||t.$set(e,"min_value",n.target.value)}}}),t._v(" "),"ตัวอักษร"!=e.data_type?[parseFloat(e.min_value)>parseFloat(e.max_value)?n("span",{staticClass:" m-b-none text-danger small"},[t._v("\n                                ค่า Min มากกว่า ค่า Max\n                            ")]):t._e()]:t._e()],2),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.max_value,expression:"specification.max_value"}],staticClass:"form-control text-right",attrs:{disabled:"ตัวอักษร"==e.data_type,type:"number"},domProps:{value:e.max_value},on:{change:function(n){return t.checkMinMaxVal(e,"max_value")},input:function(n){n.target.composing||t.$set(e,"max_value",n.target.value)}}}),t._v(" "),"ตัวอักษร"!=e.data_type?[parseFloat(e.max_value)<parseFloat(e.min_value)?n("span",{staticClass:" m-b-none text-danger small"},[t._v("\n                                ค่า Max น้อยกว่า ค่า Min\n                            ")]):t._e()]:t._e()],2),t._v(" "),n("td",{staticClass:"text-center align-middle"},[t._v(t._s(e.test_unit))]),t._v(" "),n("td",{staticClass:"text-center align-middle"},[t._v(t._s(e.test_unit_desc))]),t._v(" "),t._l(t.pResultSeverityCode,(function(a,s){return[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e["low_level_"+a.meaning.toLowerCase()],expression:"specification['low_level_' + resSevCode.meaning.toLowerCase()]"}],staticClass:"form-control text-right",style:"border-color: "+a.tag,attrs:{type:"number"},domProps:{value:e["low_level_"+a.meaning.toLowerCase()]},on:{input:function(n){n.target.composing||t.$set(e,"low_level_"+a.meaning.toLowerCase(),n.target.value)}}})])]})),t._v(" "),t._l(t.pResultSeverityCode,(function(a,s){return[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e["high_level_"+a.meaning.toLowerCase()],expression:"specification['high_level_' + resSevCode.meaning.toLowerCase()]"}],staticClass:"form-control text-right",style:"border-color: "+a.tag,attrs:{type:"number"},domProps:{value:e["high_level_"+a.meaning.toLowerCase()]},on:{input:function(n){n.target.composing||t.$set(e,"high_level_"+a.meaning.toLowerCase(),n.target.value)}}})])]})),t._v(" "),n("td",{staticClass:"text-center align-middle"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.optional_ind,expression:"specification.optional_ind"}],attrs:{type:"checkbox",value:"Y"},domProps:{checked:Array.isArray(e.optional_ind)?t._i(e.optional_ind,"Y")>-1:e.optional_ind},on:{change:function(n){var a=e.optional_ind,s=n.target,i=!!s.checked;if(Array.isArray(a)){var l=t._i(a,"Y");s.checked?l<0&&t.$set(e,"optional_ind",a.concat(["Y"])):l>-1&&t.$set(e,"optional_ind",a.slice(0,l).concat(a.slice(l+1)))}else t.$set(e,"optional_ind",i)}}})])],2):t._e()})),t._v(" "),0==t.specifications.length?n("tr",{staticClass:"text-center w-100"},[n("td",{attrs:{colspan:"13"}},[t._v("ไม่มีข้อมูล")])]):t._e()],2)])]),t._v(" "),n("div",{staticClass:"row form-group justify-content-center clearfix tw-my-6 text-center"},[n("div",{staticClass:"col-lg-6 col-md-6"},[n("button",{staticClass:"btn btn-lg btn-primary tw-w-32",attrs:{type:"button"},on:{click:t.addLine}},[n("i",{staticClass:"fa fa-plus"}),t._v(" เพิ่มรายการ\n                ")]),t._v(" "),n("button",{staticClass:"btn btn-lg btn-primary tw-w-32",attrs:{disabled:!t.canSave,type:"button"},on:{click:t.save}},[n("i",{staticClass:"fa fa-plus"}),t._v(" บันทึก\n                ")]),t._v(" "),n("a",{staticClass:"btn btn-lg tw-bg-gray-100 tw-bg-opacity-60 btn-white tw-w-32",attrs:{type:"button",href:t.url.qm_settings_specifications_index}},[n("i",{staticClass:"fa fa-times"}),t._v(" ยกเลิก\n                ")])])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("หน่วย"),n("br"),t._v("การทดสอบ*")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("รายละเอียดหน่วย"),n("br"),t._v("การทดสอบ*")])}],!1,null,null,null).exports}}]);