(self.webpackChunk=self.webpackChunk||[]).push([[6307],{5741:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(23645),i=n.n(a)()((function(e){return e[1]}));i.push([e.id,".v--modal-overlay[data-v-9697875e]{z-index:2000;padding-top:3rem;padding-bottom:3rem}",""]);const s=i},57343:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(23645),i=n.n(a)()((function(e){return e[1]}));i.push([e.id,".v--modal-overlay[data-v-54015d9a]{z-index:2000;padding-top:3rem;padding-bottom:3rem}",""]);const s=i},56307:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>j});var a=n(87757),i=n.n(a),s=n(7398),r=n.n(s),o=(n(19371),n(30381)),l=n.n(o);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u={props:["salePlans"],data:function(){return{salePlanItems:this.salePlans.map((function(e){return d(d({},e),{},{quantity:Number(parseFloat(e.quantity)).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}),quantity_m:Number(parseFloat(e.quantity)/1e3).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}),amount:Number(parseFloat(e.amount)).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}),amount_t:Number(parseFloat(e.amount)/1e3).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}),amount_m:Number(parseFloat(e.amount)/1e6).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3})})}))}},computed:{},methods:{}};var m=n(51900);const h=(0,m.Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-bordered table-sticky mb-0",staticStyle:{"min-width":"1000px"}},[e._m(0),e._v(" "),e.salePlanItems.length>0?n("tbody",[e._l(e.salePlanItems,(function(t,a){return[n("tr",{key:""+a},[n("td",{staticClass:"text-center freeze-col",staticStyle:{"min-width":"480px","max-width":"480px"},attrs:{width:"30%"}},[n("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[n("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"200px","max-width":"200px"}},[e._v("\n                                "+e._s(t.item_code)+"\n                            ")]),e._v(" "),n("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"260px","max-width":"260px","border-left":"1px solid #ddd"}},[e._v("\n                                "+e._s(t.item_description)+" \n                            ")])])]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"440px"},attrs:{width:"40%"}},[e._v(" "+e._s(t.quantity)+" ")]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"220px"},attrs:{width:"30%"}},[e._v(" "+e._s(t.quantity_m)+" ")])])]}))],2):n("tbody",[e._m(1)])])])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",{staticClass:"text-center freeze-col",staticStyle:{"min-width":"480px","max-width":"480px"},attrs:{width:"30%"}},[n("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[n("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"200px","max-width":"200px"}},[e._v("\n                            รหัสสินค้า\n                        ")]),e._v(" "),n("div",{staticClass:"text-center tw-inline-block tw-py-4",staticStyle:{"min-width":"260px","max-width":"260px","border-left":"1px solid #ddd"}},[e._v("\n                            ตราบุหรี่ \n                        ")])])]),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"440px"},attrs:{width:"40%"}},[e._v(" ประมาณการจำหน่าย(พันมวน) ")]),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"220px"},attrs:{width:"30%"}},[e._v(" ประมาณจำหน่าย(ล้านมวน)  ")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("td",{attrs:{colspan:"4"}},[n("h2",{staticClass:"p-5 text-center text-muted"},[e._v(" ไม่พบข้อมูล ")])])])}],!1,null,null,null).exports;var _=n(80455);function v(e,t,n,a,i,s,r){try{var o=e[s](r),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(a,i)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var s=e.apply(t,n);function r(e){v(s,a,i,r,o,"next",e)}function o(e){v(s,a,i,r,o,"throw",e)}r(void 0)}))}}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const w={props:["planHeader","planLines","uomCodes"],components:{VueNumeric:n.n(_)()},watch:{planHeader:function(e){this.planHeaderData=e}},data:function(){var e=this;return{planHeaderData:this.planHeader,planLineItems:this.planLines.map((function(t){return b(b({},t),{},{product_require_qty_m:Number(parseFloat(t.product_require_qty)/1e3),weekly_used_m:Number(parseFloat(t.weekly_used)/1e6),remaining_m:Number(parseFloat(t.remaining)/1e6),monthly_used_m:Number(parseFloat(t.monthly_used)/1e6),ingredient_require_qty:Number(t.total_onhand)>Number(t.monthly_used)?0:Number(parseFloat(t.ingredient_require_qty)),ingredient_request_qty:t.ingredient_request_qty?Number(Math.ceil(parseFloat(t.ingredient_request_qty))):Number(t.total_onhand)>Number(t.monthly_used)?0:Number(Math.ceil(parseFloat(t.ingredient_require_qty))),converted_ingredient_request_qty:t.ingredient_request_qty?Number(parseFloat(t.ingredient_request_qty)*parseFloat(t.product_uom_qty)):0,ingredient_request_uom_desc:e.getUomCodeDescription(e.uomCodes,t.ingredient_request_uom)})})).sort((function(e,t){return(""+e.inv_item_number).localeCompare(t.inv_item_number)}))}},mounted:function(){this.planLineItems.forEach((function(e){e.converted_ingredient_request_qty=e.ingredient_request_qty?Number(parseFloat(e.ingredient_request_qty)*parseFloat(e.product_uom_qty)):0})),this.emitPlanLineChanged()},computed:{},methods:{onSubInventoryOnhandValueChanged:function(e){var t=this;return y(i().mark((function n(){var a,s,r,o,l,c,d,p,u,m,h;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.onhand_01?e.onhand_01:0,s=e.onhand_02?e.onhand_02:0,r=e.onhand_03?e.onhand_03:0,o=e.onhand_04?e.onhand_04:0,l=e.onhand_05?e.onhand_05:0,c=e.onhand_06?e.onhand_06:0,d=e.onhand_07?e.onhand_07:0,p=e.onhand_08?e.onhand_08:0,u=e.onhand_09?e.onhand_09:0,m=e.onhand_10?e.onhand_10:0,h=a+s+r+o+l+c+d+p+u+m,e.total_onhand=h,n.next=14,t.getRemainingDate(t.planHeaderData,e);case 14:t.$emit("onPlanLineChanged",{planLineItems:t.planLineItems});case 15:case"end":return n.stop()}}),n)})))()},onIngredientReqestQtyValueChanged:function(e){e.converted_ingredient_request_qty=e.ingredient_request_qty?Number(parseFloat(e.ingredient_request_qty)*parseFloat(e.product_uom_qty)):0,this.$emit("onPlanLineChanged",{planLineItems:this.planLineItems})},getUomCodeDescription:function(e,t){var n=e.find((function(e){return e.uom_code==t}));return n?n.unit_of_measure:""},getRemainingDate:function(e,t){return y(i().mark((function n(){var a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={period_year:e.year,period_name:e.period,plan_header:JSON.stringify(e),monthly_used:t.monthly_used,total_onhand:t.total_onhand},n.next=3,axios.get("/ajax/pm/plans/monthly/get-remaining-date-txt",{params:a}).then((function(e){var n=e.data.data;"success"==n.status?t.remaining_date=n.remaining_date:swal("เกิดข้อผิดพลาด",'ไม่สามารถดึงข้อมูล "พอใช้ถึงเดือน" | '.concat(n.message),"error")})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด",'ไม่สามารถดึงข้อมูล "พอใช้ถึงเดือน" | '.concat(e.message),"error")}));case 3:case"end":return n.stop()}}),n)})))()},emitPlanLineChanged:function(){this.$emit("onPlanLineChanged",{planLineItems:this.planLineItems})}}};const x=(0,m.Z)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-bordered table-sticky mb-0",staticStyle:{"min-width":"2200px"}},[n("thead",[n("tr",[e._m(0),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"83px"}},[e._v(" ประมาณจำหน่าย(ล้านมวน)  ")]),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("(ซองบุหรี่) --\x3e (ประมาณการจำหน่าย(ล้านมวน)*1,000,000)/ซอง(20)"),n("br"),e._v("(กระดาษพันก้นกรอง) --\x3e ประมาณการจำหน่าย(ล้านมวน)*1,000,000")]),e._v(" "),n("span",[e._v(" ความต้องการต่อเดือน ")])])],1),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("(ซองบุหรี่) --\x3e ยอดคงคลังรวม / ความต้องการต่อเดือน"),n("br"),e._v("(กระดาษพันก้นกรอง) --\x3e ยอดคงคลังรวม (Bobbin) / (ความต้องการต่อเดือน/(จำนวนชิ้น/Bobbin))")]),e._v(" "),n("span",[e._v(" จำนวนพอใช้ได้อีก (เดือน) ")])])],1),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" พอใช้ถึงเดือน ")]),e._v(" "),e.planLineItems.length>0?[e.planLineItems[0].subinventory_01?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_01)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_02?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_02)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_03?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_03)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_04?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_04)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_05?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_05)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_06?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_06)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_07?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_07)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_08?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_08)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_09?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_09)+" ")]):e._e(),e._v(" "),e.planLineItems[0].subinventory_10?n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(e.planLineItems[0].subinventory_10)+" ")]):e._e()]:e._e(),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[e._v(" ยอดคงคลังรวม ")]),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"83px"}},[e._v(" หน่วยนับ(จัดเก็บ) ")]),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("(ซองบุหรี่) --\x3e (ความต้องการต่อเดือน-ยอดคงคลังรวม)/(จำนวนชิ้น/ROL)"),n("br"),e._v("(กระดาษพันก้นกรอง) --\x3e (ความต้องการต่อเดือน/(จำนวนชิ้น/Bobbin)-ยอดคงคลังรวม)/(Bobbin/ROL)")]),e._v(" "),n("span",[e._v(" จำนวนที่ต้องผลิต ")])])],1),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"160px"}},[e._v(" จำนวนที่ควรผลิต ")]),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"83px"}},[e._v(" หน่วยนับ(ผลิต) ")]),e._v(" "),n("th",{staticClass:"text-center",staticStyle:{"min-width":"124px"}},[n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("(ซองบุหรี่) --\x3e จำนวนที่ควรผลิต * (จำนวนชิ้น/ROL)"),n("br"),e._v("(กระดาษพันก้นกรอง) --\x3e จำนวนที่ควรผลิต * (จำนวนชิ้น/ROL)")]),e._v(" "),n("span",[e._v(" แปลงหน่วย(ชิ้น) ")])])],1)],2)]),e._v(" "),e.planLineItems.length>0?n("tbody",[e._l(e.planLineItems,(function(t,a){return[n("tr",{key:""+a,style:{backgroundColor:Number(t.total_onhand)>Number(t.monthly_used)?"#FDF5EF":t.ingredient_request_uom?"":"#FFEEEE"}},[n("td",{staticClass:"freeze-col text-center"},[n("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"},style:{minWidth:"580px",backgroundColor:Number(t.total_onhand)>Number(t.monthly_used)?"#FDF5EF":t.ingredient_request_uom?"":"#FFEEEE"}},[n("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4 tw-pr-2",staticStyle:{"min-width":"120px","max-width":"120px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-height":"51px"}},[e._v("\n                                "+e._s(t.product_item_desc)+" \n                            ")]),e._v(" "),n("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4 tw-px-2",staticStyle:{"min-width":"130px","max-width":"130px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-height":"51px","border-left":"1px solid #ddd"}},[e._v("\n                                "+e._s(t.inv_item_number)+"\n                            ")]),e._v(" "),n("div",{staticClass:"text-left tw-inline-block tw-align-top tw-py-4 tw-pl-2",staticStyle:{"min-width":"300px","max-width":"300px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-height":"51px","border-left":"1px solid #ddd"}},[e._v("\n                                "+e._s(t.inv_item_desc)+"\n                            ")])])]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"83px"}},[e._v(" "+e._s(t.product_require_qty_m?Number(t.product_require_qty_m).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}):"0.000")+" ")]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(t.monthly_used?Number(t.monthly_used).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" ")]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(t.remaining?Number(t.remaining).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" ")]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(t.remaining_date)+" ")]),e._v(" "),e.planLineItems[0].subinventory_01?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_01_"+a,name:"onhand_01_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_01,callback:function(n){e.$set(t,"onhand_01",n)},expression:"planLineItem.onhand_01"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_01?Number(t.onhand_01).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_02?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_02_"+a,name:"onhand_02_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_02,callback:function(n){e.$set(t,"onhand_02",n)},expression:"planLineItem.onhand_02"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_02?Number(t.onhand_02).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_03?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_03_"+a,name:"onhand_03_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_03,callback:function(n){e.$set(t,"onhand_03",n)},expression:"planLineItem.onhand_03"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_03?Number(t.onhand_03).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_04?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_04_"+a,name:"onhand_04_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_04,callback:function(n){e.$set(t,"onhand_04",n)},expression:"planLineItem.onhand_04"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_04?Number(t.onhand_04).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_05?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_05_"+a,name:"onhand_05_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_05,callback:function(n){e.$set(t,"onhand_05",n)},expression:"planLineItem.onhand_05"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_05?Number(t.onhand_05).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_06?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_06_"+a,name:"onhand_06_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_06,callback:function(n){e.$set(t,"onhand_06",n)},expression:"planLineItem.onhand_06"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_06?Number(t.onhand_06).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_07?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_07_"+a,name:"onhand_07_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_07,callback:function(n){e.$set(t,"onhand_07",n)},expression:"planLineItem.onhand_07"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_07?Number(t.onhand_07).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_08?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_08_"+a,name:"onhand_08_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_08,callback:function(n){e.$set(t,"onhand_08",n)},expression:"planLineItem.onhand_08"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_08?Number(t.onhand_08).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_09?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_09_"+a,name:"onhand_09_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_09,callback:function(n){e.$set(t,"onhand_09",n)},expression:"planLineItem.onhand_09"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_09?Number(t.onhand_09).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),e.planLineItems[0].subinventory_10?n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_onhand_10_"+a,name:"onhand_10_"+a},on:{change:function(n){return e.onSubInventoryOnhandValueChanged(t)}},model:{value:t.onhand_10,callback:function(n){e.$set(t,"onhand_10",n)},expression:"planLineItem.onhand_10"}})],1):n("div",[e._v("\n                            "+e._s(t.onhand_10?Number(t.onhand_10).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" \n                        ")])]):e._e(),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},[e._v(" "+e._s(t.total_onhand?Number(t.total_onhand).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+" ")]),e._v(" "),n("td",{staticClass:"text-center",staticStyle:{"min-width":"83px"}},[e._v(" "+e._s(t.ingredient_request_uom_desc)+" ")]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"120px"}},[e._v(" \n                        "+e._s(t.ingredient_require_qty?Number(t.ingredient_require_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00")+" \n                    ")]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"160px"}},["1"==e.planHeaderData.status?n("div",[n("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:0,minus:!1,id:"input_ingredient_request_qty_"+a,name:"ingredient_request_qty_"+a},on:{change:function(n){return e.onIngredientReqestQtyValueChanged(t)}},model:{value:t.ingredient_request_qty,callback:function(n){e.$set(t,"ingredient_request_qty",n)},expression:"planLineItem.ingredient_request_qty"}})],1):n("div",[e._v("\n                            "+e._s(t.ingredient_request_qty?Number(t.ingredient_request_qty).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0}):"0")+"\n                        ")])]),e._v(" "),n("td",{staticClass:"text-center",staticStyle:{"min-width":"83px"}},[e._v(" "+e._s(t.onhand_uom)+" ")]),e._v(" "),n("td",{staticClass:"text-right",staticStyle:{"min-width":"124px"}},[e._v("  "+e._s(t.converted_ingredient_request_qty?Number(t.converted_ingredient_request_qty).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}):"0.000"))])])]}))],2):n("tbody",[e._m(1)])])])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("th",{staticClass:"text-center freeze-col",staticStyle:{"min-width":"580px"}},[n("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[n("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-8",staticStyle:{"min-width":"120px","max-width":"120px"}},[e._v("\n                            ตราบุหรี่  \n                        ")]),e._v(" "),n("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-8",staticStyle:{"min-width":"130px","max-width":"130px","border-left":"1px solid #ddd"}},[n("span",[e._v(" รหัสสินค้าสำเร็จรูป ")])]),e._v(" "),n("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-8",staticStyle:{"min-width":"300px","max-width":"300px","border-left":"1px solid #ddd"}},[e._v("\n                            รายละเอียด\n                        ")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("td",{attrs:{colspan:"20"}},[n("h2",{staticClass:"p-5 text-center text-muted"},[e._v(" ไม่พบข้อมูล ")])])])}],!1,null,null,null).exports;function P(e,t,n,a,i,s,r){try{var o=e[s](r),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(a,i)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var s=e.apply(t,n);function r(e){P(s,a,i,r,o,"next",e)}function o(e){P(s,a,i,r,o,"throw",e)}r(void 0)}))}}const L={props:["modalName","modalWidth","modalHeight","planHeader","periodYears","periodYearValue","periodNames","periodNameValue","printTypes","printTypeValue","saleTypes","saleTypeValue","sourceVersions","sourceVersionValue","monthlyPlanVersions","monthlyPlanVersionValue"],components:{Loading:r()},watch:{planHeader:function(e){this.planHeaderData=e},periodYears:function(e){this.periodYearOptions=e},periodYearValue:function(e){this.periodYear=e,this.periodYearLabel=this.getPeriodYearLabel(this.periodYearOptions,e)},periodNames:function(e){this.periodNameOptions=e},periodNameValue:function(e){this.periodName=this.periodNameValue,this.periodNameLabel=this.getPeriodNameLabel(this.periodNameOptions,this.periodName)},printTypeValue:function(e){this.printType=e},saleTypeValue:function(e){this.saleType=e},sourceVersionValue:function(e){this.sourceVersion=e},sourceVersions:function(e){this.sourceVersionOptions=e},monthlyPlanVersionValue:function(e){this.monthlyPlanVersion=e},monthlyPlanVersions:function(e){this.monthlyPlanVersionOptions=e}},data:function(){return{isLoading:!1,width:this.modalWidth,planHeaderData:this.planHeader,periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),periodYearOptions:this.periodYears,periodName:this.periodNameValue,periodNameLabel:this.periodNameValue,periodNameOptions:this.periodNames,printType:this.printTypeValue,saleType:this.saleTypeValue,sourceVersion:this.sourceVersionValue,sourceVersionOptions:this.sourceVersions,monthlyPlanVersion:this.monthlyPlanVersionValue,monthlyPlanVersionOptions:this.monthlyPlanVersions}},created:function(){this.handleResize()},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},onYearlyPlanChanged:function(e){this.periodYear=e,this.periodYearLabel=this.getPeriodYearLabel(this.periodYearOptions,this.periodYear),this.periodName=null,this.periodNameLabel="",this.sourceVersion=null,this.sourceVersionOptions=[],this.monthlyPlanVersion=null,this.monthlyPlanVersionOptions=[],this.getPeriodNames(e)},getPeriodYearLabel:function(e,t){var n=e.find((function(e){return e.period_year_value==t}));return n?n.period_year_label:""},getPeriodNameLabel:function(e,t){var n=e.find((function(e){return e.period_name_value==t}));return n?n.period_name_label:""},onPeriodNameChanged:function(e){var t=this;return C(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.periodName=e,t.periodNameLabel=t.getPeriodNameLabel(t.periodNameOptions,t.periodName),!(t.periodYear&&t.periodName&&t.printType&&t.saleType)){n.next=6;break}return n.next=5,t.getSourceVersions(t.periodYear,t.periodName,t.printType,t.saleType);case 5:t.sourceVersion&&t.getMonthlyPlanData(t.periodYear,t.periodName,t.printType,t.saleType,t.sourceVersion,null);case 6:case"end":return n.stop()}}),n)})))()},onSourceVersionChanged:function(e){this.sourceVersion=e},onPrintTypeChanged:function(e){this.printType=e,this.periodYear&&this.periodName&&this.printType&&this.saleType&&this.sourceVersion&&this.getMonthlyPlanData(this.periodYear,this.periodName,this.printType,this.saleType,this.sourceVersion,null)},onSaleTypeChanged:function(e){this.saleType=e,this.periodYear&&this.periodName&&this.printType&&this.saleType&&this.sourceVersion&&this.getMonthlyPlanData(this.periodYear,this.periodName,this.printType,this.saleType,this.sourceVersion,null)},onMonthlyPlanVersionChanged:function(e){this.monthlyPlanVersion=e},getPeriodNames:function(e){var t=this;return C(i().mark((function n(){var a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.isLoading=!0,a={period_year:e},t.periodNameOptions=[],n.next=5,axios.get("/ajax/pm/plans/monthly/get-months",{params:a}).then((function(e){var t=e.data.data;return t.period_names?JSON.parse(t.period_names):[]})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ปี ".concat(t.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 5:t.periodNameOptions=n.sent,t.isLoading=!1;case 7:case"end":return n.stop()}}),n)})))()},getMonthlyPlanData:function(e,t,n,a,s,r){var o=this;return C(i().mark((function l(){var c;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o.isLoading=!0,o.monthlyPlanVersion=null,o.monthlyPlanVersionOptions=[],c={period_year:e,period_name:t,print_type:n,sale_type:a,source_version:s,version:r},i.next=6,axios.get("/ajax/pm/plans/monthly/get-info",{params:c}).then((function(e){var t=e.data.data;return o.monthlyPlanVersionOptions=t.versions?JSON.parse(t.versions):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","".concat(e.message),"error")}));case 6:o.monthlyPlanVersion=o.monthlyPlanVersionOptions.length>0?o.monthlyPlanVersionOptions[0].version:null,o.isLoading=!1;case 8:case"end":return i.stop()}}),l)})))()},getSourceVersions:function(e,t,n,a){var s=this;return C(i().mark((function r(){var o;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s.isLoading=!0,s.sourceVersion=null,s.sourceVersionOptions=[],o={period_year:e,period_name:t,print_type:n,sale_type:a},i.next=6,axios.get("/ajax/pm/plans/monthly/get-source-versions",{params:o}).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(t.message),"error"):(s.sourceVersion=t.source_version?t.source_version:null,s.sourceVersionOptions=t.source_versions?JSON.parse(t.source_versions):[],s.sourceVersionOptions.length<=0&&swal("ไม่พบข้อมูล","ไม่พบข้อมูลแผนจากฝ่ายขาย","error")),t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(e.message),"error")}));case 6:s.isLoading=!1;case 7:case"end":return i.stop()}}),r)})))()},onSearchPlanVersion:function(){this.$modal.hide(this.modalName),this.$emit("onSearchPlanVersion",{period_year:this.periodYear,period_name:this.periodName,print_type:this.printType,sale_type:this.saleType,source_version:this.sourceVersion,source_versions:this.sourceVersionOptions,version:this.monthlyPlanVersion})}}};var V=n(93379),S=n.n(V),N=n(57343),T={insert:"head",singleton:!1};S()(N.Z,T);N.Z.locals;const Y=(0,m.Z)(L,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{position:"fixed","z-index":"100"}},[n("modal",{attrs:{name:e.modalName,width:e.width,scrollable:!0,height:e.modalHeight,shiftX:.4,shiftY:.3}},[n("div",{staticClass:"p-4"},[n("h4",[e._v(" ค้นหาแผนผลิตสิ่งพิมพ์รายเดือน ")]),e._v(" "),n("hr"),e._v(" "),n("div",{staticClass:"row form-group"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ระบบการพิมพ์ ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"print_type",id:"input_print_type","select-options":e.printTypes,"option-key":"print_type_value","option-value":"print_type_value","option-label":"print_type_label",value:e.printType,filterable:!0},on:{onSelected:e.onPrintTypeChanged}})],1)]),e._v(" "),n("div",{staticClass:"row form-group"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ประเภทแผน ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"sale_type",id:"sale_type","select-options":e.saleTypes,"option-key":"value","option-value":"value","option-label":"description",value:e.saleType,filterable:!0},on:{onSelected:e.onSaleTypeChanged}})],1)]),e._v(" "),n("div",{staticClass:"row form-group"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" แผนประมาณการ "),n("br"),e._v(" จำหน่ายประจำปี ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":e.periodYearOptions,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:e.periodYear,filterable:!0},on:{onSelected:e.onYearlyPlanChanged}})],1)]),e._v(" "),n("div",{staticClass:"row form-group"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ประจำเดือน ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"period_name",id:"input_period_name","select-options":e.periodNameOptions,"option-key":"period_name_value","option-value":"period_name_value","option-label":"period_name_label",value:e.periodName,filterable:!0},on:{onSelected:e.onPeriodNameChanged}})],1)]),e._v(" "),n("div",{staticClass:"row form-group"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" เวอร์ชั่น ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"monthly_plan_version",id:"input_monthly_plan_version","select-options":e.monthlyPlanVersionOptions,"option-key":"version","option-value":"version","option-label":"version",value:e.monthlyPlanVersion,filterable:!0},on:{onSelected:e.onMonthlyPlanVersionChanged}})],1)]),e._v(" "),n("div",{staticClass:"text-right tw-mt-8"},[n("button",{staticClass:"btn btn-primary tw-w-32",attrs:{type:"button",disabled:!e.periodYear||!e.periodName||!e.monthlyPlanVersion},on:{click:e.onSearchPlanVersion}},[e._v(" \n                    เลือก \n                ")]),e._v(" "),n("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(t){return e.$modal.hide(e.modalName)}}},[e._v(" \n                    ยกเลิก \n                ")])])])]),e._v(" "),n("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}})],1)}),[],!1,null,"54015d9a",null).exports;const k={props:["modalName","modalWidth","modalHeight","periodYearValue","periodNameValue","printTypeValue","saleTypeValue","sourceVersionValue","monthlyPlanVersionValue","salesForecasts","uomCodes"],components:{Loading:r()},watch:{periodYearValue:function(e){this.periodYear=e},periodNameValue:function(e){this.periodName=e},printTypeValue:function(e){this.printType=e},saleTypeValue:function(e){this.saleType=e},sourceVersionValue:function(e){this.sourceVersion=e},monthlyPlanVersionValue:function(e){this.monthlyPlanVersion=e},salesForecasts:function(e){this.salesForecastItems=e,this.biweeklyInfo=this.getBiweeklyInfo(e)}},data:function(){return{isLoading:!1,width:this.modalWidth,periodYear:this.periodYearValue,periodName:this.periodNameValue,printType:this.printTypeValue,saleType:this.saleTypeValue,sourceVersion:this.sourceVersionValue,monthlyPlanVersion:this.monthlyPlanVersionValue,salesForecastItems:this.salesForecasts.length>0?this.salesForecasts:[],biweeklyInfo:this.salesForecasts.length>0?this.getBiweeklyInfo(this.salesForecasts):[]}},created:function(){this.handleResize()},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},getUomCodeDescription:function(e,t){var n=e.find((function(e){return e.uom_code==t}));return n?n.unit_of_measure:""},getBiweeklyInfo:function(e){var t=[];return e.length>0&&(t=[{biweekly_no:e?e[0].biweekly_0_no:"-",start_date:e?this.formatDateTh(e[0].biweekly_0_start_date):"-",end_date:e?this.formatDateTh(e[0].biweekly_0_end_date):"-"},{biweekly_no:e?e[0].biweekly_1_no:"-",start_date:e?this.formatDateTh(e[0].biweekly_1_start_date):"-",end_date:e?this.formatDateTh(e[0].biweekly_1_end_date):"-"}]),t},formatDateTh:function(e){return e?l()(e).add(543,"years").format("DD/MM/YYYY"):""}}};var O=n(5741),D={insert:"head",singleton:!1};S()(O.Z,D);O.Z.locals;const I=(0,m.Z)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{position:"fixed","z-index":"100"}},[n("modal",{attrs:{name:e.modalName,width:e.width,scrollable:!0,height:e.modalHeight,shiftX:.3,shiftY:.3}},[n("div",{staticClass:"p-4"},[n("h4",[e._v(" รายละเอียดแผนรายปักษ์จากฝ่ายขาย ")]),e._v(" "),n("hr"),e._v(" "),n("div",{staticClass:"table-responsive",staticStyle:{"max-height":"400px"}},[n("table",{staticClass:"table table-bordered mb-0"},[n("thead",[n("tr",[n("th",{staticClass:"text-center",attrs:{width:"15%"}},[e._v(" รหัสสินค้า ")]),e._v(" "),n("th",{staticClass:"text-center",attrs:{width:"30%"}},[e._v(" ตราบุหรี่ ")]),e._v(" "),n("th",{staticClass:"text-center",attrs:{width:"20%"}},[e.biweeklyInfo.length>0?n("div",[e._v(" ปักษ์ที่ "+e._s(e.biweeklyInfo[0].biweekly_no)+" ")]):e._e(),e._v(" "),e.biweeklyInfo.length>0?n("div",[e._v(" "+e._s(e.biweeklyInfo[0].start_date)+" - "+e._s(e.biweeklyInfo[0].end_date)+" ")]):e._e()]),e._v(" "),n("th",{staticClass:"text-center",attrs:{width:"20%"}},[e.biweeklyInfo.length>0?n("div",[e._v(" ปักษ์ที่ "+e._s(e.biweeklyInfo[1].biweekly_no)+" ")]):e._e(),e._v(" "),e.biweeklyInfo.length>0?n("div",[e._v(" "+e._s(e.biweeklyInfo[1].start_date)+" - "+e._s(e.biweeklyInfo[1].end_date)+" ")]):e._e()]),e._v(" "),n("th",{staticClass:"text-center",attrs:{width:"10%"}},[e._v(" หน่วย ")])])]),e._v(" "),e.salesForecastItems.length>0?n("tbody",[e._l(e.salesForecastItems,(function(t,a){return[n("tr",{key:""+a},[n("td",{staticClass:"text-center",attrs:{width:"15%"}},[e._v("  \n                                    "+e._s(t.item_code)+"\n                                ")]),e._v(" "),n("td",{staticClass:"text-left",attrs:{width:"30%"}},[e._v("  \n                                    "+e._s(t.item_description)+"\n                                ")]),e._v(" "),n("td",{staticClass:"text-left",attrs:{width:"20%"}},[n("div",[n("span",{staticClass:"pull-right"},[e._v(" "+e._s(Number(t.biweekly_0_quantity).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}))+" ")])])]),e._v(" "),n("td",{staticClass:"text-left",attrs:{width:"20%"}},[n("div",[n("span",{staticClass:"pull-right"},[e._v(" "+e._s(Number(t.biweekly_1_quantity).toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}))+" ")])])]),e._v(" "),n("td",{staticClass:"text-center",attrs:{width:"10%"}},[e._v("  \n                                    "+e._s(e.getUomCodeDescription(e.uomCodes,t.uom))+"\n                                ")])])]}))],2):n("tbody",[n("tr",[n("td",{attrs:{colspan:"20"}},[n("h2",{staticClass:"p-5 text-center text-muted"},[e._v(" ไม่พบข้อมูล ")])])])])])])])]),e._v(" "),n("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}})],1)}),[],!1,null,"9697875e",null).exports;function F(e,t,n,a,i,s,r){try{var o=e[s](r),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(a,i)}function q(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var s=e.apply(t,n);function r(e){F(s,a,i,r,o,"next",e)}function o(e){F(s,a,i,r,o,"throw",e)}r(void 0)}))}}const H={components:{Loading:r(),TableSalePlans:h,TablePlanLines:x,ModalSearchPlan:Y,ModalSalesForecast:I},props:["periodYears","periodYearValue","periodNameValue","invItems","planStatuses","printTypes","printTypeValue","saleTypes","saleTypeValue","sourceVersionValue","uomCodes"],mounted:function(){var e=this;this.periodYearValue&&this.getPeriodNames(this.periodYearValue).then((function(t){e.periodNameValue&&e.printTypeValue&&e.saleTypeValue&&e.sourceVersionValue&&(e.getSalesForecasts(e.periodYearValue,e.periodNameValue,e.printTypeValue,e.saleTypeValue,e.sourceVersionValue),e.periodNameLabel=e.getPeriodNameLabel(e.periodNames,e.periodNameValue),e.getSourceVersions(e.periodYearValue,e.periodNameValue,e.printTypeValue,e.saleTypeValue).then((function(t){e.getMonthlyPlanData(e.periodYearValue,e.periodNameValue,e.printTypeValue,e.saleTypeValue,e.sourceVersionValue,null)})))}))},data:function(){return{periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),periodName:this.periodNameValue,periodNameLabel:"",printType:this.printTypeValue?this.printTypeValue:this.printTypes.length>0?this.printTypes[0].print_type_value:null,printTypeLabel:this.printTypeValue?this.getPrintTypeLabel(this.printTypes,this.printTypeValue):this.printTypes.length>0?this.printTypes[0].print_type_label:null,saleType:this.saleTypeValue?this.saleTypeValue:this.saleTypes.length>0?this.saleTypes[0].value:null,saleTypeLabel:this.saleTypeValue?this.getSaleTypeLabel(this.saleTypes,this.saleTypeValue):this.saleTypes.length>0?this.saleTypes[0].description:null,sourceVersion:this.sourceVersionValue?this.sourceVersionValue:null,sourceVersions:[],periodNames:[],monthlyPlanHeader:null,monthlyPlanVersion:null,monthlyPlanLines:[],monthlyPlanVersions:[],salePlans:[],salesForecasts:[],isNewlyCreate:!1,foundInvalidPlanLine:!1,isShowSalePlans:!0,isSaved:!1,isLoading:!1}},computed:{},methods:{setUrlParams:function(){var e=new URLSearchParams(window.location.search);e.set("period_year",this.periodYear?this.periodYear:""),e.set("period_name",this.periodName?this.periodName:""),e.set("print_type",this.printType?this.printType:""),e.set("sale_type",this.saleType?this.saleType:""),e.set("source_version",this.sourceVersion?this.sourceVersion:""),window.history.replaceState(null,null,"?"+e.toString())},onToggleShowSalePlan:function(){this.isShowSalePlans=!this.isShowSalePlans},onYearlyPlanChanged:function(e){this.periodYear=e,this.periodYearLabel=this.getPeriodYearLabel(this.periodYears,this.periodYear),this.setUrlParams(),this.periodName=null,this.periodNameLabel="",this.periodNames=[],this.sourceVersion=null,this.sourceVersions=[],this.monthlyPlanHeader=null,this.monthlyPlanVersion=null,this.monthlyPlanVersions=[],this.monthlyPlanLines=[],this.salePlans=[],this.getPeriodNames(e)},onPeriodNameChanged:function(e){var t=this;return q(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.periodName=e,t.periodNameLabel=t.getPeriodNameLabel(t.periodNames,t.periodName),t.setUrlParams(),!(t.periodYear&&t.periodName&&t.printType&&t.saleType)){n.next=7;break}return n.next=6,t.getSourceVersions(t.periodYear,t.periodName,t.printType,t.saleType);case 6:t.sourceVersion&&t.getMonthlyPlanData(t.periodYear,t.periodName,t.printType,t.saleType,t.sourceVersion,null);case 7:t.getSalesForecasts(t.periodYear,t.periodName,t.printType,t.saleType,t.sourceVersion);case 8:case"end":return n.stop()}}),n)})))()},onSourceVersionChanged:function(e){this.sourceVersion=e,this.setUrlParams(),0==this.monthlyPlanLines.length&&(this.salePlans=[])},onPrintTypeChanged:function(e){this.printType=e,this.printTypeLabel=this.getPrintTypeLabel(this.printTypes,this.printType),this.setUrlParams(),this.periodYear&&this.periodName&&this.printType&&this.saleType&&this.sourceVersion&&this.getMonthlyPlanData(this.periodYear,this.periodName,this.printType,this.saleType,this.sourceVersion,null)},onSaleTypeChanged:function(e){this.saleType=e,this.saleTypeLabel=this.getSaleTypeLabel(this.saleTypes,this.saleType),this.setUrlParams(),this.periodYear&&this.periodName&&this.printType&&this.saleType&&this.sourceVersion&&this.getMonthlyPlanData(this.periodYear,this.periodName,this.printType,this.saleType,this.sourceVersion,null)},onSearchPlanVersion:function(e){this.periodYear=e.period_year,this.periodYearLabel=this.getPeriodYearLabel(this.periodYears,this.periodYear),this.periodName=e.period_name,this.periodNameLabel=this.getPeriodNameLabel(this.periodNames,this.periodName),this.printType=e.print_type,this.printTypeLabel=this.getPrintTypeLabel(this.printTypes,this.printType),this.saleType=e.sale_type,this.saleTypeLabel=this.getPrintTypeLabel(this.saleTypes,this.saleType),this.sourceVersion=e.source_version,this.sourceVersions=e.source_versions,this.getPeriodNames(this.periodYear),this.periodYear&&this.periodName&&this.printType&&this.saleType&&this.sourceVersion&&this.getMonthlyPlanData(this.periodYear,this.periodName,this.printType,this.saleType,this.sourceVersion,e.version)},getPeriodYearLabel:function(e,t){var n=e.find((function(e){return e.period_year_value==t}));return n?n.period_year_label:""},getPeriodNameLabel:function(e,t){var n=e.find((function(e){return e.period_name_value==t}));return n?n.period_name_label:""},getPrintTypeLabel:function(e,t){var n=e.find((function(e){return e.print_type_value==t}));return n?n.print_type_label:""},getSaleTypeLabel:function(e,t){var n=e.find((function(e){return e.value==t}));return n?n.description:""},getPeriodNames:function(e){var t=this;return q(i().mark((function n(){var a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.isLoading=!0,a={period_year:e},n.next=4,axios.get("/ajax/pm/plans/monthly/get-months",{params:a}).then((function(e){var t=e.data.data;return t.period_names?JSON.parse(t.period_names):[]})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ข้อมูลปี ".concat(t.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 4:t.periodNames=n.sent,t.isLoading=!1;case 6:case"end":return n.stop()}}),n)})))()},getMonthlyPlanData:function(e,t,n,a,s,r){var o=this;return q(i().mark((function l(){var c,d;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o.isLoading=!0,o.monthlyPlanHeader=null,o.monthlyPlanVersion=r,o.monthlyPlanVersions=[],o.monthlyPlanLines=[],o.salePlans=[],c={period_year:e,period_name:t,print_type:n,sale_type:a,source_version:s,version:r},i.next=9,axios.get("/ajax/pm/plans/monthly/get-info",{params:c}).then((function(e){var t=e.data.data;return o.monthlyPlanHeader=t.plan_header?JSON.parse(t.plan_header):null,o.monthlyPlanVersions=t.versions?JSON.parse(t.versions):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ข้อมูลการวางแผนผลิตสิ่งพิมพ์รายเดือน ".concat(o.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 9:if(!o.monthlyPlanHeader){i.next=21;break}if(o.monthlyPlanVersion=o.monthlyPlanHeader.version,!(o.sourceVersions.length>0)){i.next=19;break}return d=o.sourceVersions.find((function(e){return e.version==o.monthlyPlanHeader.source_version})),o.sourceVersion=d?d.version:o.sourceVersions[0].version,i.next=16,o.onGetSalePlans();case 16:return i.next=18,o.onGetMonthlyPlanLines();case 18:o.setUrlParams();case 19:i.next=22;break;case 21:o.monthlyPlanVersion=null;case 22:o.isLoading=!1;case 23:case"end":return i.stop()}}),l)})))()},getSourceVersions:function(e,t,n,a){var s=this;return q(i().mark((function r(){var o;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s.isLoading=!0,s.sourceVersion=null,s.sourceVersions=[],o={period_year:e,period_name:t,print_type:n,sale_type:a},i.next=6,axios.get("/ajax/pm/plans/monthly/get-source-versions",{params:o}).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(t.message),"error"):(s.sourceVersion=t.source_version?t.source_version:null,s.sourceVersions=t.source_versions?JSON.parse(t.source_versions):[],s.sourceVersions.length<=0&&(swal("ไม่พบข้อมูล","ไม่พบข้อมูลรายละเอียดแผนบุหรี่จากฝ่ายขาย","error"),s.salePlans=[],s.monthlyPlanLines=[])),t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(e.message),"error")}));case 6:s.isLoading=!1;case 7:case"end":return i.stop()}}),r)})))()},getPlanStatusDesc:function(e){var t="-";if(e){var n=this.planStatuses.find((function(t){return t.lookup_code==e}));t=n?n.description:"-"}return t},formatDateTh:function(e){return e?l()(e).add(543,"years").format("DD/MM/YYYY"):""},onGetSalePlans:function(){var e=this;return q(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,n={period_year:e.periodYear,period_name:e.periodName,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion},t.next=4,axios.get("/ajax/pm/plans/monthly/get-sale-plans",{params:n}).then((function(t){var n=t.data.data;if("success"==n.status){if(n.sale_plans){var a=JSON.parse(n.sale_plans);a.length<=0?swal("ไม่พบข้อมูล","ไม่พบข้อมูลรายละเอียดแผนบุหรี่จากฝ่ายขาย ".concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(n.message),"info"):e.salePlans=a}}else swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรายละเอียดแผนบุหรี่จากฝ่ายขาย ".concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(n.message),"error")})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ข้อมูลรายละเอียดแผนบุหรี่จากฝ่ายขาย ".concat(e.periodYearLabel," ไม่ถูกต้อง | ").concat(t.message),"error")}));case 4:e.isLoading=!1,e.isShowSalePlans=!0;case 6:case"end":return t.stop()}}),t)})))()},getSalesForecasts:function(e,t,n,a,s){var r=this;return q(i().mark((function o(){var l;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r.isLoading=!0,r.salesItems=[],r.salesForecasts=[],l={period_year:e,period_name:t,print_type:n,sale_type:a,source_version:s},i.next=6,axios.get("/ajax/pm/plans/monthly/get-sales-forecasts",{params:l}).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(t.message),"error"):r.salesForecasts=t.sales_forecasts?JSON.parse(t.sales_forecasts):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(e.message),"error")}));case 6:r.isLoading=!1;case 7:case"end":return i.stop()}}),o)})))()},onGetMonthlyPlanLines:function(){var e=this;return q(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,n={period_year:e.periodYear,period_name:e.periodName,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.monthlyPlanVersion},t.next=4,axios.get("/ajax/pm/plans/monthly/get-lines",{params:n}).then((function(t){var n=t.data.data;if("success"==n.status){if(e.monthlyPlanHeader=n.plan_header?JSON.parse(n.plan_header):[],e.monthlyPlanLines=n.plan_lines?JSON.parse(n.plan_lines):[],e.monthlyPlanVersion=e.monthlyPlanHeader.version,e.monthlyPlanVersions=n.versions?JSON.parse(n.versions):[],e.monthlyPlanLines.length>0){e.foundInvalidPlanLine=!!e.monthlyPlanLines.find((function(e){return!e.ingredient_request_uom}));var a=e.monthlyPlanLines.filter((function(e){return!e.ingredient_request_uom})).map((function(e){return e.inv_item_number}));e.foundInvalidPlanLine&&swal("เกิดข้อผิดพลาด","ตรวจพบรายการที่มีข้อมูลไม่สมบูรณ์ [ รหัสสินค้าสำเร็จรูป : ".concat(a.join()," ]"),"error")}}else swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล รายละเอียดแผนประมาณการจำหน่ายรายเดือน ".concat(e.periodYearLabel," | ").concat(n.message),"error");return n})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล รายละเอียดแผนประมาณการจำหน่ายรายเดือน ".concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},onGenerateMonthlyPlanLines:function(){var e=this;return q(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.monthlyPlanLines.length>0?swal({title:"",text:"ต้องการคำนวณปริมาณการผลิต ใหม่อีกครั้ง ?",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(t){t&&(e.monthlyPlanLines=[],e.generateMonthlyPlanLines())})):e.generateMonthlyPlanLines();case 1:case"end":return t.stop()}}),t)})))()},generateMonthlyPlanLines:function(){var e=this;return q(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,n={period_year:e.periodYear,period_name:e.periodName,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.monthlyPlanVersion},t.next=4,axios.post("/ajax/pm/plans/monthly/generate-lines",n).then((function(t){var n=t.data.data;if("success"==n.status){if(e.monthlyPlanHeader=n.plan_header?JSON.parse(n.plan_header):[],e.monthlyPlanLines=n.plan_lines?JSON.parse(n.plan_lines):[],e.monthlyPlanVersion=e.monthlyPlanHeader.version,e.monthlyPlanVersions=n.versions?JSON.parse(n.versions):[],e.isNewlyCreate=n.is_newly_create,e.monthlyPlanLines.length>0){e.foundInvalidPlanLine=!!e.monthlyPlanLines.find((function(e){return!e.ingredient_request_uom}));var a=e.monthlyPlanLines.filter((function(e){return!e.ingredient_request_uom})).map((function(e){return e.inv_item_number}));e.foundInvalidPlanLine&&swal("เกิดข้อผิดพลาด","ตรวจพบรายการที่มีข้อมูลไม่สมบูรณ์ [ รหัสสินค้าสำเร็จรูป : ".concat(a.join()," ]"),"error")}}else swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล รายละเอียดแผนประมาณการจำหน่ายรายเดือน ".concat(e.periodYearLabel," | ").concat(n.message),"error");return n})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูล รายละเอียดแผนประมาณการจำหน่ายรายเดือน ".concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},onPlanLineChanged:function(e){this.monthlyPlanLines=e.planLineItems},onSaveMonthlyPlan:function(){var e=this;return q(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={period_year:e.periodYear,period_name:e.periodName,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.monthlyPlanVersion,plan_header:JSON.stringify(e.monthlyPlanHeader),plan_lines:JSON.stringify(e.monthlyPlanLines)},e.isLoading=!0,t.next=4,axios.post("/ajax/pm/plans/monthly/store-lines",n).then((function(t){var n=t.data.data,a=n.message,i=n.plan_header?JSON.parse(n.plan_header):null;return"success"==n.status&&(e.monthlyPlanHeader=i,e.monthlyPlanVersion=i.version,e.monthlyPlanVersions=n.versions?JSON.parse(n.versions):[],e.isNewlyCreate=!1,e.isSaved=!0,swal("Success","บันทึก ข้อมูลวางแผนผลิตสิ่งพิมพ์รายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," version : ").concat(e.monthlyPlanVersion),"success")),"error"==n.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถบันทึก ข้อมูลวางแผนผลิตสิ่งพิมพ์รายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(a),"error"),n})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถบันทึก ข้อมูลวางแผนผลิตสิ่งพิมพ์รายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},onSubmitMonthlyPlan:function(){var e=this;return q(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={period_year:e.periodYear,period_name:e.periodName,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.monthlyPlanVersion,plan_header:JSON.stringify(e.monthlyPlanHeader),plan_lines:JSON.stringify(e.monthlyPlanLines)},e.isLoading=!0,t.next=4,axios.post("/ajax/pm/plans/monthly/store-lines",n).then((function(e){var t=e.data.data;return"error"==t.status&&console.log(t.message),t})).catch((function(e){console.log(e)}));case 4:return t.next=6,axios.post("/ajax/pm/plans/monthly/submit-plan",n).then((function(t){var n=t.data.data,a=n.message;return"success"==n.status&&(e.monthlyPlanHeader=n.plan_header?JSON.parse(n.plan_header):null,e.monthlyPlanVersions=n.versions?JSON.parse(n.versions):[],swal("Success","ยืนยันแผนรายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel),"success")),"error"==n.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถยืนยันแผนรายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(a),"error"),n})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถยืนยันแผนรายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 6:e.isLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},onCreateNewMonthlyPlanVersion:function(){var e=this;return q(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:swal({title:"",text:"ต้องการสร้าง แผนผลิตสิ่งพิมพ์รายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," เวอร์ชั่นใหม่ ?"),showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(t){t&&(e.salePlans=[],e.monthlyPlanLines=[],e.createNewPlanVersion())}));case 1:case"end":return t.stop()}}),t)})))()},isAllowSelectSourceVersion:function(e,t){var n=!1;return e?0==t.length&&(n=!0):n=!0,n},isAllowCreateNewPlanVersion:function(e){var t=!0;return 0==e.length&&(t=!1),e.filter((function(e){return 1==e.status})).length>0&&(t=!1),t},createNewPlanVersion:function(){var e=this;return q(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={period_year:e.periodYear,period_name:e.periodName,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion},e.isLoading=!0,t.next=4,axios.post("/ajax/pm/plans/monthly/add-new-header",n).then((function(t){var n=t.data.data,a=n.message;return"success"==n.status&&(e.monthlyPlanHeader=n.plan_header?JSON.parse(n.plan_header):null,e.monthlyPlanVersion=n.version,e.monthlyPlanVersions=n.versions?JSON.parse(n.versions):[],swal("Success","สร้างข้อมูลวางแผนผลิตสิ่งพิมพ์รายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," version : ").concat(e.monthlyPlanVersion," )"),"success")),"error"==n.status&&swal("เกิดข้อผิดพลาด","สร้างข้อมูลวางแผนผลิตสิ่งพิมพ์รายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(a),"error"),n})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","สร้างข้อมูลวางแผนผลิตสิ่งพิมพ์รายเดือน : ".concat(e.periodNameLabel," ปี : ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()}}};const j=(0,m.Z)(H,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ibox"},[n("div",{staticClass:"ibox-content",staticStyle:{"min-height":"600px"}},[n("div",{staticClass:"tw-mb-4"},[n("div",{staticClass:"text-right tw-mb-2"},[n("button",{staticClass:"btn btn-inline-block btn-sm btn-success tw-w-32",attrs:{disabled:!e.isAllowCreateNewPlanVersion(e.monthlyPlanVersions)},on:{click:e.onCreateNewMonthlyPlanVersion}},[n("i",{staticClass:"fa fa-plus tw-mr-1"}),e._v(" สร้าง \n                ")]),e._v(" "),n("button",{staticClass:"btn btn-inline-block btn-sm btn-primary tw-w-32",attrs:{disabled:!e.periodYear||!e.periodName||0==e.monthlyPlanLines.length||!e.monthlyPlanHeader||"1"!=e.monthlyPlanHeader.status},on:{click:e.onSaveMonthlyPlan}},[n("i",{staticClass:"fa fa-save tw-mr-1"}),e._v(" บันทึก \n                ")]),e._v(" "),n("button",{staticClass:"btn btn-inline-block btn-sm btn-white tw-w-32",on:{click:function(t){return e.$modal.show("modal-search-plan")}}},[n("i",{staticClass:"fa fa-search tw-mr-1"}),e._v(" ค้นหา \n                ")]),e._v(" "),n("button",{staticClass:"btn btn-inline-block btn-sm btn-warning tw-w-40",attrs:{disabled:!e.monthlyPlanHeader||"1"!=e.monthlyPlanHeader.status||0==e.monthlyPlanLines.length||e.isNewlyCreate||e.foundInvalidPlanLine||!e.isSaved},on:{click:e.onSubmitMonthlyPlan}},[n("i",{staticClass:"fa fa-check-square tw-mr-1"}),e._v(" ยืนยันแผนรายเดือน \n                ")])]),e._v(" "),n("div",{staticClass:"text-right"},[n("button",{staticClass:"btn btn-inline-block btn-sm btn-info tw-w-72",attrs:{disabled:!e.periodYear||!e.periodName||!e.sourceVersion},on:{click:function(t){return e.$modal.show("modal-sales-forecast")}}},[n("i",{staticClass:"fa fa-list tw-mr-1"}),e._v(" รายละเอียดแผนรายปักษ์จากฝ่ายขาย\n                ")]),e._v(" "),n("button",{staticClass:"btn btn-inline-block btn-sm hover:tw-text-white tw-text-white tw-bg-purple-500 tw-border-purple-500 tw-w-72",attrs:{disabled:!e.periodYear||!e.periodName||!e.sourceVersion||e.salePlans.length>0||e.monthlyPlanLines.length>0},on:{click:e.onGetSalePlans}},[n("i",{staticClass:"fa fa-list tw-mr-1"}),e._v(" รายละเอียดแผนประมาณการจำหน่ายรายเดือน \n                ")]),e._v(" "),n("button",{staticClass:"btn btn-inline-block btn-sm btn-info tw-w-52",attrs:{disabled:!e.periodYear||!e.periodName||!e.sourceVersion||e.salePlans.length<=0||!!e.monthlyPlanHeader&&"1"!=e.monthlyPlanHeader.status},on:{click:e.onGenerateMonthlyPlanLines}},[n("i",{staticClass:"fa fa-calculator tw-mr-1"}),e._v(" คำนวณปริมาณการผลิต \n                ")])])]),e._v(" "),n("hr"),e._v(" "),n("div",[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-6"},[n("div",{staticClass:"row form-group"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ระบบการพิมพ์ ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"print_type",id:"input_print_type","select-options":e.printTypes,"option-key":"print_type_value","option-value":"print_type_value","option-label":"print_type_label",value:e.printType,filterable:!0},on:{onSelected:e.onPrintTypeChanged}})],1)]),e._v(" "),n("div",{staticClass:"row form-group"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ประเภทแผน ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"sale_type",id:"sale_type","select-options":e.saleTypes,"option-key":"value","option-value":"value","option-label":"description",value:e.saleType,filterable:!0},on:{onSelected:e.onSaleTypeChanged}})],1)]),e._v(" "),n("div",{staticClass:"row form-group"},[e._m(0),e._v(" "),n("div",{staticClass:"col-md-8"},[n("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":e.periodYears,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:e.periodYear,filterable:!0},on:{onSelected:e.onYearlyPlanChanged}})],1)]),e._v(" "),n("div",{staticClass:"row form-group"},[e._m(1),e._v(" "),n("div",{staticClass:"col-md-3"},[n("pm-el-select",{attrs:{name:"period_name",id:"input_period_name","select-options":e.periodNames,"option-key":"period_name_value","option-value":"period_name_value","option-label":"period_name_label",value:e.periodName,filterable:!0},on:{onSelected:e.onPeriodNameChanged}})],1),e._v(" "),n("label",{staticClass:"col-md-2 col-form-label tw-font-bold"},[e._v(" ครั้งที่ ")]),e._v(" "),n("div",{staticClass:"col-md-3"},[e.isAllowSelectSourceVersion(e.monthlyPlanHeader,e.monthlyPlanLines)?n("pm-el-select",{attrs:{name:"source_version",id:"source_version","select-options":e.sourceVersions,"option-key":"version","option-value":"version","option-label":"version",value:e.sourceVersion,filterable:!0},on:{onSelected:e.onSourceVersionChanged}}):e._e(),e._v(" "),e.isAllowSelectSourceVersion(e.monthlyPlanHeader,e.monthlyPlanLines)?e._e():n("p",{staticClass:"col-form-label"},[e._v(" "+e._s(e.sourceVersion)+" ")])],1)])]),e._v(" "),n("div",{staticClass:"col-md-6"},[n("div",{staticClass:"row form-group tw-mb-0"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" เวอร์ชั่น ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[e.monthlyPlanHeader?n("p",{staticClass:"col-form-label"},[e._v(" "+e._s(e.monthlyPlanHeader.version?e.monthlyPlanHeader.version:"-")+" ")]):e._e(),e._v(" "),e.monthlyPlanHeader?e._e():n("p",{staticClass:"col-form-label"},[e._v(" - ")])])]),e._v(" "),n("div",{staticClass:"row form-group tw-mb-0"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" สถานะ ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[e.monthlyPlanHeader?n("p",{staticClass:"col-form-label"},[e._v(" "+e._s(e.getPlanStatusDesc(e.monthlyPlanHeader.status))+" ")]):e._e(),e._v(" "),e.monthlyPlanHeader?e._e():n("p",{staticClass:"col-form-label"},[e._v(" - ")])])]),e._v(" "),n("div",{staticClass:"row form-group tw-mb-0"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ผู้บันทึก ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[e.monthlyPlanHeader?n("p",{staticClass:"col-form-label"},[e._v(" \n                                "+e._s(e.monthlyPlanHeader.attribute11?e.monthlyPlanHeader.attribute11:"-")+"\n                            ")]):e._e(),e._v(" "),e.monthlyPlanHeader?e._e():n("p",{staticClass:"col-form-label"},[e._v(" - ")])])]),e._v(" "),n("div",{staticClass:"row form-group tw-mb-0"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" วันที่สร้าง ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[e.monthlyPlanHeader?n("p",{staticClass:"col-form-label"},[e._v(" \n                                "+e._s(e.monthlyPlanHeader.request_date?e.formatDateTh(e.monthlyPlanHeader.request_date):"")+"\n                            ")]):e._e(),e._v(" "),e.monthlyPlanHeader?e._e():n("p",{staticClass:"col-form-label"},[e._v(" - ")])])]),e._v(" "),n("div",{staticClass:"row form-group tw-mb-0"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" วันที่แก้ไขล่าสุด ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[e.monthlyPlanHeader?n("p",{staticClass:"col-form-label"},[e._v(" \n                                "+e._s(e.monthlyPlanHeader.last_update_date?e.formatDateTh(e.monthlyPlanHeader.last_update_date):"")+"\n                            ")]):e._e(),e._v(" "),e.monthlyPlanHeader?e._e():n("p",{staticClass:"col-form-label"},[e._v(" - ")])])]),e._v(" "),n("div",{staticClass:"row form-group tw-mb-0"},[n("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" วันที่ยืนยันล่าสุด ")]),e._v(" "),n("div",{staticClass:"col-md-8"},[e.monthlyPlanHeader?n("p",{staticClass:"col-form-label"},[e._v(" \n                                "+e._s(e.monthlyPlanHeader.approved_date?e.formatDateTh(e.monthlyPlanHeader.approved_date):"")+"\n                            ")]):e._e(),e._v(" "),e.monthlyPlanHeader?e._e():n("p",{staticClass:"col-form-label"},[e._v(" - ")])])])])])]),e._v(" "),e.salePlans.length>0?n("hr"):e._e(),e._v(" "),e.salePlans.length>0?n("div",{staticClass:"tw-m-8"},[n("button",{staticClass:"btn btn-lg btn-white btn-outline text-left tw-w-full tw-pt-3 tw-pb-4",attrs:{type:"button"},on:{click:e.onToggleShowSalePlan}},[n("span",{staticClass:"tw-text-lg tw-font-bold"},[e._v(" รายละเอียดแผนบุหรี่จากฝ่ายขาย ")]),e._v(" "),e.isShowSalePlans?n("span",{staticClass:"fa fa-caret-down fa-2x pull-right"}):e._e(),e._v(" "),e.isShowSalePlans?e._e():n("span",{staticClass:"fa fa-caret-left fa-2x pull-right"})]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowSalePlans,expression:"isShowSalePlans"}],staticClass:"row"},[n("div",{staticClass:"col-12"},[n("table-sale-plans",{attrs:{"sale-plans":e.salePlans}})],1)])]):e._e(),e._v(" "),e.monthlyPlanLines.length>0?n("hr"):e._e(),e._v(" "),e.monthlyPlanLines.length>0?n("div",{staticClass:"tw-m-8"},[n("h3",[e._v(" รายละเอียดแผนประมาณการจำหน่ายรายเดือน ")]),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-12"},[n("table-plan-lines",{attrs:{"plan-header":e.monthlyPlanHeader,"plan-lines":e.monthlyPlanLines,"uom-codes":e.uomCodes},on:{onPlanLineChanged:e.onPlanLineChanged}})],1)])]):e._e()]),e._v(" "),n("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}}),e._v(" "),n("modal-sales-forecast",{attrs:{"modal-name":"modal-sales-forecast","modal-width":"960","modal-height":"auto","period-year-value":e.periodYear,"period-name-value":e.periodName,"print-type-value":e.printType,"sale-type-value":e.saleType,"source-version-value":e.sourceVersion,"monthly-plan-version-value":e.monthlyPlanVersion,"sales-forecasts":e.salesForecasts,"uom-codes":e.uomCodes}}),e._v(" "),n("modal-search-plan",{attrs:{"modal-name":"modal-search-plan","modal-width":"640","modal-height":"auto","period-years":e.periodYears,"period-year-value":e.periodYear,"period-names":e.periodNames,"period-name-value":e.periodName,"print-types":e.printTypes,"print-type-value":e.printType,"sale-types":e.saleTypes,"sale-type-value":e.saleType,"source-versions":e.sourceVersions,"source-version-value":e.sourceVersion,"monthly-plan-version-value":e.monthlyPlanVersion,"monthly-plan-versions":e.monthlyPlanVersions},on:{onSearchPlanVersion:e.onSearchPlanVersion}})],1)}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" แผนประมาณการ "),n("br"),e._v(" จำหน่ายประจำปี ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" แผนประมาณการ "),n("br"),e._v(" จำหน่ายประจำเดือน ")])}],!1,null,null,null).exports}}]);