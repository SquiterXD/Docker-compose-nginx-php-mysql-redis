(self.webpackChunk=self.webpackChunk||[]).push([[4132],{14132:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>A});var n=a(87757),s=a.n(n);function r(t,e,a,n,s,r,i){try{var l=t[r](i),o=l.value}catch(t){return void a(t)}l.done?e(o):Promise.resolve(o).then(n,s)}function i(t){return function(){var e=this,a=arguments;return new Promise((function(n,s){var i=t.apply(e,a);function l(t){r(i,n,s,l,o,"next",t)}function o(t){r(i,n,s,l,o,"throw",t)}l(void 0)}))}}var l,o;const c={props:["btnTrans","url","createInput"],data:function(){return{loading:!1,loadingVerNo:!1,yearList:this.createInput.year_list,budgetYear:this.createInput.def_period_year,periodNo:this.createInput.def_period_no,versionNo:""}},mounted:function(){},computed:{},watch:{budgetYear:(o=i(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.periodNo="";case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)}),periodNo:(l=i(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.versionNo="",e&&this.getDetail();case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},methods:{openModal:function(){var t=this;return i(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDetail();case 2:$("#modal_create").modal("show");case 3:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;t.loading=!0,axios.post(t.url.ajax_store,{period_no:t.periodNo,version_no:t.versionNo}).then((function(t){window.location.href=t.data.data.redirect_page})).catch((function(t){})).then((function(){t.loading=!1}))},searchForm:function(){var t=this;return i(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t).loading=!0,e.next=4,axios.get(a.url.ajax_adjusts_search_create,{params:{budget_year:a.budget_year,biweekly:a.biweekly,approved_status:a.status}}).then((function(t){a.html=t.data.data.html})).catch((function(t){a.html="";var e=t.response.data;alert(e.message)})).then((function(){a.loading=!1}));case 4:case"end":return e.stop()}}),e)})))()},getDetail:function(){var t=this;return i(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t).budgetYear||a.periodNo){e.next=3;break}return e.abrupt("return");case 3:a.loadingVerNo=!0,axios.get(a.url.ajax_modal_create_details,{params:{period_no:a.periodNo}}).then((function(t){var e=t.data.data;a.versionNo=e.version_no,a.loadingVerNo=!1}));case 5:case"end":return e.stop()}}),e)})))()}}};var u=a(51900);const d=(0,u.Z)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("button",{class:t.btnTrans.create.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:t.openModal}},[a("i",{class:t.btnTrans.create.icon}),t._v("\n        "+t._s(t.btnTrans.create.text)+"\n    ")]),t._v(" "),a("div",{staticClass:"modal inmodal fade",attrs:{id:"modal_create",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modal-content"},[t._m(0),t._v(" "),a("div",{staticClass:"modal-body text-left"},[a("div",{staticClass:"row col-12"},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ปีงบประมาณ :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{attrs:{size:"large",placeholder:"ปีงบประมาณ",clearable:"",filterable:"","popper-append-to-body":!1},model:{value:t.budgetYear,callback:function(e){t.budgetYear=e},expression:"budgetYear"}},t._l(t.yearList,(function(t,e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-4 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ประมาณการใช้แสตมป์เดือน :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{attrs:{size:"large",placeholder:"เดือน",clearable:"",filterable:"","popper-append-to-body":!1},model:{value:t.periodNo,callback:function(e){t.periodNo=e},expression:"periodNo"}},t._l(t.yearList[t.budgetYear],(function(t,e){return a("el-option",{key:t.period_no,attrs:{label:t.thai_month,value:t.period_no}})})),1)],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingVerNo,expression:"loadingVerNo"}],staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ครั้งที่ :")]),t._v(" "),a("div",{},[a("el-input",{attrs:{value:t.versionNo,size:"large",readonly:!0}})],1)])])]),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-white",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")]),t._v(" "),a("button",{class:t.btnTrans.create.class+" btn-lg tw-w-25",attrs:{type:"button",disabled:!t.periodNo},on:{click:function(e){return e.preventDefault(),t.submit()}}},[a("i",{class:t.btnTrans.create.icon}),t._v("\n                        "+t._s(t.btnTrans.create.text)+"\n                    ")])])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),a("span",{staticClass:"sr-only"},[t._v("Close")])]),t._v(" "),a("h4",{staticClass:"modal-title"},[t._v("สร้างประมาณการจัดซื้อแสตมป์รายตรา")]),t._v(" "),a("small",{staticClass:"font-bold"},[t._v("\n                         \n                    ")])])}],!1,null,null,null).exports;function p(t,e,a,n,s,r,i){try{var l=t[r](i),o=l.value}catch(t){return void a(t)}l.done?e(o):Promise.resolve(o).then(n,s)}function _(t){return function(){var e=this,a=arguments;return new Promise((function(n,s){var r=t.apply(e,a);function i(t){p(r,n,s,i,l,"next",t)}function l(t){p(r,n,s,i,l,"throw",t)}i(void 0)}))}}var m,v;const h={props:["budgetYears","monthList","pBiweekly","search","productTypes","btnTrans","url"],data:function(){return{budget_year:this.search?this.search.budget_year:"",biweekly:this.search?String(this.search.biweekly):"",month:"",status:"Active",statusLists:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}],biWeeklyLists:[],loading:!1,b_loading:!1,html:""}},mounted:function(){this.budget_year&&this.getBiWeekly()},computed:{},watch:{errors:{handler:function(t){t.budget_year?this.setError("budget_year"):this.resetError("budget_year"),t.biweekly?this.setError("biweekly"):this.resetError("biweekly")},deep:!0},budget_year:(v=_(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.month="";case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return v.apply(this,arguments)}),month:(m=_(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.biweekly="";case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return m.apply(this,arguments)})},methods:{openModal:function(){$("#modal_search").modal("show")},searchForm:function(){var t=this;return _(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t).loading=!0,e.next=4,axios.get(a.url.ajax_search,{params:{budget_year:a.budget_year,biweekly:a.biweekly,thai_month:a.month}}).then((function(t){a.html=t.data.data.html})).catch((function(t){a.html="";var e=t.response.data;alert(e.message)})).then((function(){a.loading=!1}));case 4:case"end":return e.stop()}}),e)})))()},getBiWeekly:function(){var t=this;this.search||(this.biweekly="",this.month="",this.times=""),this.biWeeklyLists=this.pBiweekly.filter((function(e){return e.period_year_thai.indexOf(t.budget_year)>-1}))}}};const f=(0,u.Z)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("button",{class:t.btnTrans.search.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:t.openModal}},[a("i",{class:t.btnTrans.search.icon}),t._v("\n        "+t._s(t.btnTrans.search.text)+"\n    ")]),t._v(" "),a("div",{staticClass:"modal inmodal fade",attrs:{id:"modal_search",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg",staticStyle:{width:"90%","max-width":"950px"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modal-content"},[t._m(0),t._v(" "),a("div",{staticClass:"modal-body text-left"},[a("div",{staticClass:"row col-12"},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ปีงบประมาณ :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("input",{attrs:{type:"hidden",name:"search[budget_year]"},domProps:{value:t.budget_year}}),t._v(" "),a("el-select",{attrs:{size:"large",placeholder:"ปีงบประมาณ",clearable:"",filterable:"","popper-append-to-body":!1},model:{value:t.budget_year,callback:function(e){t.budget_year=e},expression:"budget_year"}},t._l(t.budgetYears,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})})),1),t._v(" "),a("div",{staticClass:"error_msg text-left",attrs:{id:"el_explode_budget_year"}})],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" เดือน :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("input",{attrs:{type:"hidden"},domProps:{value:t.month}}),t._v(" "),a("el-select",{attrs:{size:"large",placeholder:"เดือน",clearable:"",filterable:"","popper-append-to-body":!1},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}},t._l(t.monthList[t.budget_year],(function(t,e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),t._v(" "),a("div",{staticClass:"error_msg text-left",attrs:{id:"el_explode_month"}})],1)]),t._v(" "),a("div",{staticClass:"form-group text-right  pr-2 mb-0 col-lg-2 col-md-10 col-sm-12 col-xs-12"},[a("label",{staticClass:" tw-font-bold tw-uppercase mt-2"},[t._v(" ")]),t._v(" "),a("div",{staticClass:"text-left"},[a("button",{class:t.btnTrans.search.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:t.searchForm}},[a("i",{class:t.btnTrans.search.icon}),t._v("\n                                    "+t._s(t.btnTrans.search.text)+"\n                                ")])])])]),t._v(" "),a("div",{domProps:{innerHTML:t._s(t.html)}})]),t._v(" "),t._m(1)])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),a("span",{staticClass:"sr-only"},[t._v("Close")])]),t._v(" "),a("h4",{staticClass:"modal-title"},[t._v("ค้นหาประมาณการจัดซื้อแสตมป์รายเดือน")]),t._v(" "),a("small",{staticClass:"font-bold"},[t._v("\n                         \n                    ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-white",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])}],!1,null,null,null).exports;var b=a(30381),g=a.n(b);function y(t,e,a,n,s,r,i){try{var l=t[r](i),o=l.value}catch(t){return void a(t)}l.done?e(o):Promise.resolve(o).then(n,s)}function x(t){return function(){var e=this,a=arguments;return new Promise((function(n,s){var r=t.apply(e,a);function i(t){y(r,n,s,i,l,"next",t)}function l(t){y(r,n,s,i,l,"throw",t)}i(void 0)}))}}const w={props:["header","btnTrans","canEdit","url"],data:function(){return{statusLists:[{value:"Approve",label:"Approve"},{value:"Inactive",label:"Inactive"}],oldNote:this.adjustData?this.adjustData.note:"",note:this.adjustData?this.adjustData.note:"",loading:!1,status_flag:!1,header_p08:this.header,canApprove:this.header.can.approve}},methods:{updateNoteForm:function(){var t=this;return x(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,swal({title:"อัพเดทหมายเหตุ",text:"ยืนยันอัพเดทหมายเหตุ ?",html:!0,showCancelButton:!0,confirmButtonText:a.btnTrans.ok.text,cancelButtonText:a.btnTrans.cancel.text,confirmButtonClass:a.btnTrans.ok.class+" btn-lg tw-w-25",cancelButtonClass:a.btnTrans.cancel.class+" btn-lg tw-w-25",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var t=x(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&a.update();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))()},update:function(){var t=this;return x(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,(a=t).loading=!0,e.next=5,axios.patch(a.url.ajax_update_note).then((function(t){"S"==t.data.data.status&&(!0,swal({title:"อัพเดทหมายเหตุ",text:'<span style="font-size: 16px; text-align: left;"> อัพเดทหมายเหตุเรียบร้อย </span>',type:"success",html:!0}),a.oldNote=a.note),"S"!=t.data.data.status&&swal({title:"Error !",text:t.data.data.msg,type:"error",showConfirmButton:!0})})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){a.loading=!1}));case 5:case"end":return e.stop()}}),e)})))()},dateOrderFrom:function(t){this.header_p08.approved_date=t?g()(t).format("DD-MM-YYYY"):""},editStatus:function(){this.status_flag=!0},cancleStatus:function(){this.status_flag=!1},saveStatus:function(){var t=this;return x(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t).loading=!0,e.next=4,axios.post(a.url.ajax_update_status,{header:a.header_p08}).then((function(t){"S"==t.data.data.status&&(swal({title:"อัพเดทประมาณการจัดซื้อแสตมป์รายเดือน",text:'<span style="font-size: 16px; text-align: left;"> อัพเดทประมาณการจัดซื้อแสตมป์รายเดือนเรียบร้อย </span>',type:"success",html:!0}),a.header_p08=t.data.data.header,a.status_flag=!1,a.canApprove=a.header_p08.can.approve),"S"!=t.data.data.status&&swal({title:"Error !",text:t.data.data.msg,type:"error",showConfirmButton:!0})})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){a.loading=!1}));case 4:case"end":return e.stop()}}),e)})))()}},watch:{},computed:{showSaveNote:function(){return this.note!=this.oldNote}}};const C=(0,u.Z)(w,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("form",{attrs:{id:"production-plan-form",action:""}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-8 b-r"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-3"},[a("dl",{staticClass:"row mb-0"},[t._m(0),t._v(" "),a("div",{staticClass:"col-sm-5 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header&&t.header.pp_period?a("div",[t._v("\n                                        "+t._s(t.header.pp_period.period_year_thai)+"\n                                    ")]):t._e()])])])]),t._v(" "),a("div",{staticClass:"col-lg-3"},[a("dl",{staticClass:"row mb-0"},[t._m(1),t._v(" "),a("div",{staticClass:"col-sm-7 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header&&t.header.pp_period?a("div",[t._v("\n                                        "+t._s(t.header.pp_period.thai_month)+"\n                                    ")]):t._e()])])])]),t._v(" "),a("div",{staticClass:"col-lg-2"},[a("dl",{staticClass:"row mb-0"},[t._m(2),t._v(" "),a("div",{staticClass:"col-sm-5 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header?a("div",[t._v("\n                                        "+t._s(t.header.version_no)+"\n                                    ")]):t._e()])])])]),t._v(" "),a("div",{staticClass:"col-lg-4"},[a("dl",{staticClass:"row mb-0"},[t._m(3),t._v(" "),a("div",{staticClass:"col-sm-4 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header?a("div",[t._v("\n                                        "+t._s(t.header.approved_no)+"\n                                    ")]):t._e()])])])])])]),t._v(" "),a("div",{staticClass:"col-4"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-12"},[a("dl",{staticClass:"row mb-0"},[t._m(4),t._v(" "),a("div",{staticClass:"col-sm-6 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header?a("div",[t._v("\n                                        "+t._s(t.header.creation_date_format)+"\n                                    ")]):t._e()])])]),t._v(" "),a("dl",{staticClass:"row mb-0"},[t._m(5),t._v(" "),a("div",{staticClass:"col-sm-6 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header?a("div",[t._v("\n                                        "+t._s(t.header.last_update_date_format)+"\n                                    ")]):t._e()])])]),t._v(" "),a("dl",{staticClass:"row mb-0"},[t._m(6),t._v(" "),a("div",{staticClass:"col-sm-6 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header_p08?a("div",[t.status_flag?t._e():a("span",{domProps:{innerHTML:t._s(t.header_p08.status_lable_html)}}),t._v(" "),t.canApprove?[t.status_flag?t._e():a("button",{staticClass:"btn btn-xs btn-primary",attrs:{type:"button"},on:{click:function(e){return t.editStatus()}}},[a("i",{staticClass:"fa fa-pencil-square"})]),t._v(" "),t.status_flag?a("el-select",{attrs:{size:"small",placeholder:"สถานะ",filterable:""},model:{value:t.header_p08.approved_status,callback:function(e){t.$set(t.header_p08,"approved_status",e)},expression:"header_p08.approved_status"}},t._l(t.statusLists,(function(t){return a("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1):t._e(),t._v(" "),a("div",{staticClass:"text-right mt-2"},[t.status_flag?a("button",{staticClass:"btn btn-xs btn-success",attrs:{type:"button"},on:{click:function(e){return t.saveStatus()}}},[a("i",{staticClass:"fa fa-check-square"})]):t._e(),t._v(" "),t.status_flag?a("button",{staticClass:"btn btn-xs btn-danger",attrs:{type:"button"},on:{click:function(e){return t.cancleStatus()}}},[a("i",{staticClass:"fa fa-times"})]):t._e()])]:t._e()],2):t._e()])])]),t._v(" "),a("dl",{staticClass:"row mb-0"},[t._m(7),t._v(" "),a("div",{staticClass:"col-sm-6 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header?a("div",[t._v("\n                                        "+t._s(t.header.updated_by?t.header.updated_by.name:"-")+"\n                                    ")]):t._e()])])]),t._v(" "),a("dl",{staticClass:"row mb-0"},[t._m(8),t._v(" "),a("div",{staticClass:"col-sm-6 text-sm-left"},[a("dd",{staticClass:"mb-1"},[t.header_p08?a("div",[t.status_flag?t._e():a("span",[t._v(" "+t._s(t.header_p08.approved_at_format)+" ")]),t._v(" "),t.status_flag?a("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2 approve_date",staticStyle:{width:"100%"},attrs:{id:"approved_at",placeholder:"โปรดเลือกวันที่",value:t.header_p08.approve_date_format,format:"DD/MM/YYYY"},on:{dateWasSelected:t.dateOrderFrom},model:{value:t.header_p08.approved_at_format,callback:function(e){t.$set(t.header_p08,"approved_at_format",e)},expression:" header_p08.approved_at_format"}}):t._e()],1):t._e()])])])])])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-7 pl-0 text-sm-right pl-0 pr-0"},[a("dt",[t._v("ปีงบประมาณ:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-5 pl-0 text-sm-right pl-0 pr-0"},[a("dt",[t._v("ประจำเดือน:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-7 pl-0 text-sm-right pl-0 pr-0"},[a("dt",[t._v("ครั้งที่:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-8 pl-0 text-sm-right pl-0 pr-0"},[a("dt",[t._v("ครั้งที่อนุมัติ:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-6 text-sm-right"},[a("dt",[t._v("วันที่สร้าง:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-6 text-sm-right"},[a("dt",{attrs:{title:""}},[t._v("วันที่แก้ไขล่าสุด:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-6 text-sm-right"},[a("dt",[t._v("สถานะ:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-6 text-sm-right"},[a("dt",[t._v("ผู้บันทึก:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-6 text-sm-right"},[a("dt",[t._v("วันที่อนุมัติ:")])])}],!1,null,null,null).exports;function k(t,e,a,n,s,r,i){try{var l=t[r](i),o=l.value}catch(t){return void a(t)}l.done?e(o):Promise.resolve(o).then(n,s)}const I={props:["pHeader","inventoryItemId","url"],computed:{},watch:{},data:function(){return{itemId:null!=this.inventoryItemId&&""!=this.inventoryItemId?parseInt(this.inventoryItemId):"",loading:!1,items:[]}},mounted:function(){console.log("Component mounted."),""!==this.itemId?this.getItems({inventory_item_id:this.itemId,header:this.pHeader}):this.items=[]},methods:{itemWasSelected:function(t){var e,a=this;return(e=s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=(n=a).items.filter((function(e){return e.inventory_item_id==t}))).length&&(r=r[0]),n.$emit("itemWasSelected",r);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(n,s){var r=e.apply(t,a);function i(t){k(r,n,s,i,l,"next",t)}function l(t){k(r,n,s,i,l,"throw",t)}i(void 0)}))})()},remoteMethod:function(t){""!==t?this.getItems({number:t,header:this.pHeader}):this.items=[]},getItems:function(t){var e=this;e.loading=!0,axios.get(e.url.ajax_get_item,{params:t}).then((function(t){var a=t.data.data;e.loading=!1,e.items=a.items}))}}};const N=(0,u.Z)(I,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"รหัสวัตถุดิบ","remote-method":t.remoteMethod,loading:t.loading},on:{change:t.itemWasSelected},model:{value:t.itemId,callback:function(e){t.itemId=e},expression:"itemId"}},t._l(t.items,(function(t,e){return a("el-option",{key:parseInt(t.inventory_item_id),attrs:{label:t.display,value:parseInt(t.inventory_item_id)}})})),1)],1)}),[],!1,null,null,null).exports;var q=a(80455),D=a.n(q);function T(t,e,a,n,s,r,i){try{var l=t[r](i),o=l.value}catch(t){return void a(t)}l.done?e(o):Promise.resolve(o).then(n,s)}const S={components:{VueNumeric:D()},props:["stamp","index","lineWeeklyQty","changeData","approve"],data:function(){return{}},mounted:function(){},watch:{},methods:{decimal:function(t){return Number(t).toLocaleString(void 0,{minimumFractionDigits:2})},formatNumber:function(t){return Number(t).toLocaleString(void 0)},changeReceiveQty:function(){var t=this,e=Number(t.stamp.weekly_receive_qty)/Number(t.stamp.unit_price_per_roll);t.stamp.receive_roll_qty=e.toFixed(2);var a=t.stamp.weekly_receive_qty*Number(t.stamp.unit_price);t.stamp.receipt_amount=a.toFixed(2),Vue.set(t.lineWeeklyQty,t.stamp.plan_date,Number(t.stamp.weekly_receive_qty)),t.changeInput(t.index,t.stamp)},changeInput:function(t,e){var a,n=this;return(a=s().mark((function a(){var r;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.weekly_receive_qty=parseFloat(e.weekly_receive_qty).toFixed(0),e.receive_roll_qty=parseFloat(e.receive_roll_qty).toFixed(3),console.log("changeInput",e.weekly_receive_qty,e.receive_roll_qty),Object.keys(n.changeData).length,r=JSON.parse(JSON.stringify(e)),n.$set(n.changeData,t,r),console.log("changeInput",Object.keys(n.changeData).length);case 7:case"end":return a.stop()}}),a)})),function(){var t=this,e=arguments;return new Promise((function(n,s){var r=a.apply(t,e);function i(t){T(r,n,s,i,l,"next",t)}function l(t){T(r,n,s,i,l,"throw",t)}i(void 0)}))})()}}};const O=(0,u.Z)(S,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"text-right"},[t.approve?a("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",minus:!1},on:{change:function(e){return t.changeReceiveQty()},blur:function(e){return t.changeReceiveQty()}},model:{value:t.stamp.weekly_receive_qty,callback:function(e){t.$set(t.stamp,"weekly_receive_qty",e)},expression:"stamp.weekly_receive_qty"}}):a("div",{staticStyle:{width:"100%"}},[t._v(" "+t._s(t.decimal(t.stamp.weekly_receive_qty))+" ")])],1)}),[],!1,null,null,null).exports;function B(t,e,a,n,s,r,i){try{var l=t[r](i),o=l.value}catch(t){return void a(t)}l.done?e(o):Promise.resolve(o).then(n,s)}const j={components:{VueNumeric:D()},props:["stamp","index","lineRollQty","changeData","approve"],data:function(){return{}},mounted:function(){},watch:{},methods:{decimal:function(t){return Number(t).toLocaleString(void 0,{minimumFractionDigits:2})},formatNumber:function(t){return Number(t).toLocaleString(void 0)},changeReceiveQty:function(){var t=this,e=Number(t.stamp.receive_roll_qty)*Number(t.stamp.unit_price_per_roll);t.stamp.weekly_receive_qty=e.toFixed(2);var a=t.stamp.weekly_receive_qty*Number(t.stamp.unit_price);t.stamp.receipt_amount=a.toFixed(2),Vue.set(t.lineRollQty,t.stamp.plan_date,Number(t.stamp.receive_roll_qty)),t.changeInput(t.index,t.stamp)},changeInput:function(t,e){var a,n=this;return(a=s().mark((function a(){var r;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.weekly_receive_qty=parseFloat(e.weekly_receive_qty).toFixed(0),e.receive_roll_qty=parseFloat(e.receive_roll_qty).toFixed(3),console.log("changeInput",e.weekly_receive_qty,e.receive_roll_qty),Object.keys(n.changeData).length,r=JSON.parse(JSON.stringify(e)),n.$set(n.changeData,t,r),console.log("changeInput",Object.keys(n.changeData).length);case 7:case"end":return a.stop()}}),a)})),function(){var t=this,e=arguments;return new Promise((function(n,s){var r=a.apply(t,e);function i(t){B(r,n,s,i,l,"next",t)}function l(t){B(r,n,s,i,l,"throw",t)}i(void 0)}))})()}}};function E(t,e,a,n,s,r,i){try{var l=t[r](i),o=l.value}catch(t){return void a(t)}l.done?e(o):Promise.resolve(o).then(n,s)}function L(t){return function(){var e=this,a=arguments;return new Promise((function(n,s){var r=t.apply(e,a);function i(t){E(r,n,s,i,l,"next",t)}function l(t){E(r,n,s,i,l,"throw",t)}i(void 0)}))}}var Q,z,F,Y,M;const W={components:{ModalCreate:d,ModalSearch:f,HeaderDetail:C,SearchItem:N,ReceiveWeekly:O,ReceiveRoll:(0,u.Z)(j,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"text-right"},[t.approve?a("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:2,minus:!1},on:{change:function(e){return t.changeReceiveQty()},blur:function(e){return t.changeReceiveQty()}},model:{value:t.stamp.receive_roll_qty,callback:function(e){t.$set(t.stamp,"receive_roll_qty",e)},expression:"stamp.receive_roll_qty"}}):a("div",{staticStyle:{width:"100%"}},[t._v(" "+t._s(t.decimal(t.stamp.receive_roll_qty))+" ")])],1)}),[],!1,null,null,null).exports},props:["header","btn_trans","url","create_input","search_input","adjustData","modalCreateInput","modalSearchInput","colorCode","tabs","pDateFormat","productTypes","ppBiWeekly","workingHour","omBiweeklyList","calTypes","calTypeDefault"],data:function(){return{btnTrans:this.btn_trans,createInput:this.create_input,clickSelTabName:"tab1",loading:!1,tab1Input:{stamp_code:"",cigarettes_code:""},tab3Input:{stamp_code:""},dailyList:[],changeData:{},canEdit:!0,tab2Html:"",tab3Html:"",holidayColor:"#c0c4cc",publicHolidayColor:"#878788",canApprove:!1,lineRollQty:{},lineWeeklyQty:{},onhandQuantity:{},balanceQuantity:{},balanceOnhandWeekly:{},balanceOnhandRoll:{}}},mounted:function(){var t=this;return L(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=t.header&&""!=t.header&&(t.canEdit="INACTIVE"==t.header.approved_status.toUpperCase(),t.canApprove="INACTIVE"==t.header.approved_status.toUpperCase());case 1:case"end":return e.stop()}}),e)})))()},computed:{calBalanceStampMonthly:function(){var t=this;t.dailyList.filter((function(e,a){var n,s,r=0,i=0;g()(e.plan_date).format("YYYY-MM-DD");if(n=Number(e.onhand_qty)+Number(e.weekly_receive_qty)-Number(e.total_daily_qty),Vue.set(t.balanceQuantity,e.plan_date,Number(i)),a>0){var l=t.onhandQuantity[t.dailyList[a].plan_date]?t.onhandQuantity[t.dailyList[a].plan_date]:e.onhand_qty;r=Number(l)+Number(t.dailyList[a-1].weekly_receive_qty),Vue.set(t.onhandQuantity,e.plan_date,Number(r))}else Vue.set(t.onhandQuantity,e.plan_date,Number(n));s=0==a?Number(e.onhand_qty)-Number(e.total_daily_qty):Number(t.onhandQuantity[e.plan_date])-Number(e.total_daily_qty),console.log(e.plan_date),console.log(s),s>=0&&(i=0==a?Number(e.onhand_qty)/Number(e.total_daily_qty):Number(t.onhandQuantity[e.plan_date])/Number(e.total_daily_qty),i=0==e.total_daily_qty?0:Math.floor(i),console.log(i+"-----"+e.total_daily_qty),Vue.set(t.balanceQuantity,e.plan_date,Number(i)))}))},calBalanceOnhand:function(){var t=this,e=g()().format("YYYY-MM-DD");t.dailyList.filter((function(a,n){var s=0,r=0,i=0,l=0;g()(a.plan_date).format("YYYY-MM-DD")>=e?(s=t.onhandQuantity[a.plan_date]?t.onhandQuantity[a.plan_date]:a.onhand_qty,r=t.lineWeeklyQty[a.plan_date]?t.lineWeeklyQty[a.plan_date]:a.weekly_receive_qty,i=Number(s)+Number(r)-Number(a.total_daily_qty),l=(l=s/a.unit_price_per_roll)||0,Vue.set(t.balanceOnhandWeekly,a.plan_date,Number(i)),Vue.set(t.balanceOnhandRoll,a.plan_date,Number(l).toFixed(2))):(l=(l=(i=Number(a.onhand_qty)+Number(a.weekly_receive_qty)-Number(a.total_daily_qty))/Number(a.unit_price_per_roll))||0,Vue.set(t.balanceOnhandWeekly,a.plan_date,Number(i)),Vue.set(t.balanceOnhandRoll,a.plan_date,Number(l).toFixed(2)))}))}},watch:{clickSelTabName:(M=L(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getEstData();case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return M.apply(this,arguments)}),"tab1Input.stamp_code":(Y=L(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.tab1Input.cigarettes_code="",this.dailyList=[];case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return Y.apply(this,arguments)}),"tab1Input.cigarettes_code":(F=L(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case 1:case"end":return t.stop()}}),t)}))),function(t,e){return F.apply(this,arguments)}),"tab3Input.stamp_code":(z=L(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return z.apply(this,arguments)}),dailyList:(Q=L(s().mark((function t(e,a){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.length>0&&e.forEach((function(t){var e=t.weekly_receive_qty?t.weekly_receive_qty:0,a=t.receive_roll_qty?t.receive_roll_qty:0;t.weekly_receive_qty=parseFloat(e).toFixed(0),t.receive_roll_qty=parseFloat(a).toFixed(3)}));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return Q.apply(this,arguments)}),calBalanceStampMonthly:function(t){return t},calBalanceOnhand:function(t){return t}},methods:{addLine:function(){var t=this;return L(s().mark((function e(){var a,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,n=JSON.parse(JSON.stringify(a.adjBiweeklyData[a.productType][a.adjustData.current_biweekly])),r=Object.keys(n).length,(n=n[Object.keys(n)[0]]).is_new_line=!0,n.stamp_desc="",n.item_id="",n.item_code="",n.item_description="",n.curr_onhnad_qty="",n.def_planning_qty="",n.def_bal_sale_day="",n.def_forcast_qty="",n.def_bal_onhand_qty="",n.def_ending_sale_day="",n.bal_sale_day="",n.forcast_qty="",n.bal_onhand_qty="",n.ending_sale_day="",t.$set(a.adjBiweeklyData[a.productType][a.adjustData.current_biweekly],"new-"+r,n),t.remoteMethod(" ",a.adjBiweeklyData[a.productType][a.adjustData.current_biweekly]["new-"+r]);case 21:case"end":return e.stop()}}),e)})))()},changeInput:function(t,e){var a=this;return L(s().mark((function n(){var r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.weekly_receive_qty=parseFloat(e.weekly_receive_qty).toFixed(0),e.receive_roll_qty=parseFloat(e.receive_roll_qty).toFixed(3),console.log("changeInput",e.weekly_receive_qty,e.receive_roll_qty),Object.keys(a.changeData).length,r=JSON.parse(JSON.stringify(e)),a.$set(a.changeData,t,r),console.log("changeInput",Object.keys(a.changeData).length);case 7:case"end":return n.stop()}}),n)})))()},getEstData:function(){var t=arguments,e=this;return L(s().mark((function a(){var n,r,i,l;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.length>0&&void 0!==t[0]&&t[0],r=e,0==Object.keys(r.lineWeeklyQty).length&&0==Object.keys(r.lineRollQty).length){a.next=5;break}return swal({title:"บันทึกการเปลี่ยนแปลงข้อมูล",text:'<span style="font-size: 16px; text-align: left;"> กรุณาทำการบันทึกการเปลี่ยนแปลงให้เรียบร้อย </span>',type:"warning",html:!0}),a.abrupt("return");case 5:if(r.dailyList=[],r.changeData={},n){a.next=10;break}if(r.header){a.next=10;break}return a.abrupt("return");case 10:if(i="","tab1"!=r.clickSelTabName){a.next=15;break}if(i=r.tab1Input.stamp_code,r.tab1Input.stamp_code||r.tab1Input.cigarettes_code){a.next=15;break}return a.abrupt("return");case 15:if("tab3"!=r.clickSelTabName){a.next=19;break}if(i=r.tab3Input.stamp_code,r.tab3Input.stamp_code){a.next=19;break}return a.abrupt("return");case 19:return r.loading=!0,l={monthly_id:r.header.monthly_id,stamp_code:i,cigarettes_code:r.tab1Input.cigarettes_code,tab:r.clickSelTabName},a.next=23,axios.get(r.url.ajax_est_data,{params:l}).then((function(t){var e=t.data.data;"tab1"==r.clickSelTabName&&(r.dailyList=e.daily_list),"tab2"==r.clickSelTabName&&(r.tab2Html=e.tab2_html),"tab3"==r.clickSelTabName&&(r.tab3Html=e.tab3_html)})).catch((function(t){console.log("error");var e=t.response.data;alert(e.message)})).then((function(){r.loading=!1}));case 23:return a.abrupt("return");case 24:case"end":return a.stop()}}),a)})))()},saveChangeInput:function(){var t=this;return L(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t,0!=Object.keys(a.changeData).length){e.next=4;break}return swal({title:"อัพเดทแผนการผลิต",text:'<span style="font-size: 16px; text-align: left;"> ไม่พบข้อูลการอัพเดท </span>',type:"warning",html:!0}),e.abrupt("return");case 4:swal({html:!0,title:"อัพเดทแผนการผลิต ?",text:'<h2 class="m-t-sm m-b-lg"><span style="font-size: 18px"> คุณต้องการอัพเดทประมาณการจัดซื้อแสตมป์รายตรา ? </span></h2>',showCancelButton:!0,confirmButtonText:a.btn_trans.ok.text,cancelButtonText:a.btn_trans.cancel.text,confirmButtonClass:a.btn_trans.ok.class+" btn-lg tw-w-25",cancelButtonClass:a.btn_trans.cancel.class+" btn-lg tw-w-25",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var t=L(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=3;break}return t.next=3,axios.patch(a.url.ajax_update,{lines:a.changeData}).then((function(t){"S"==t.data.data.status&&(swal({title:"อัพเดทแผนการผลิต",text:'<span style="font-size: 16px; text-align: left;"> อัพเดทแผนประมาณการจัดซื้อแสตมป์รายตราสำเร็จ </span>',type:"success",html:!0}),a.lineWeeklyQty={},a.lineRollQty={},a.getEstData(!0)),t.data.data.status})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))()},updateEst:function(){var t=this;return L(s().mark((function e(){var a,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="",(r=(a=t).header.stamp_items_group[a.tab1Input.stamp_code].find((function(t){return t.cigarettes_code===a.tab1Input.cigarettes_code})))&&(n=r.stamp_id),swal({html:!0,title:"อัพเดทประมาณการ ?",text:'<h2 class="m-t-sm m-b-lg"><span style="font-size: 18px"> คุณต้องการอัพเดทประมาณการ ? </span></h2>',showCancelButton:!0,confirmButtonText:a.btn_trans.ok.text,cancelButtonText:a.btn_trans.cancel.text,confirmButtonClass:a.btn_trans.ok.class+" btn-lg tw-w-25",cancelButtonClass:a.btn_trans.cancel.class+" btn-lg tw-w-25",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var t=L(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=3;break}return t.next=3,axios.patch(a.url.ajax_update_est,{stamp_id:n}).then((function(t){"S"==t.data.data.status&&(swal({title:"อัพเดทแผนการผลิต",text:'<span style="font-size: 16px; text-align: left;"> อัพเดทประมาณการสำเร็จ </span>',type:"success",html:!0}),a.lineWeeklyQty={},a.lineRollQty={},a.getEstData(!0)),t.data.data.status})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))()},duplicate:function(){var t=this;return L(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t,0==Object.keys(a.lineWeeklyQty).length&&0==Object.keys(a.lineRollQty).length){e.next=4;break}return swal({title:"บันทึกการเปลี่ยนแปลงข้อมูล",text:'<span style="font-size: 16px; text-align: left;"> กรุณาทำการบันทึกการเปลี่ยนแปลงให้เรียบร้อย </span>',type:"warning",html:!0}),e.abrupt("return");case 4:swal({html:!0,title:"คัดลอกแผน ?",text:'<h2 class="m-t-sm m-b-lg"><span style="font-size: 18px"> คุณต้องการคัดลอกแผน ? </span></h2>',showCancelButton:!0,confirmButtonText:a.btn_trans.ok.text,cancelButtonText:a.btn_trans.cancel.text,confirmButtonClass:a.btn_trans.ok.class+" btn-lg tw-w-25",cancelButtonClass:a.btn_trans.cancel.class+" btn-lg tw-w-25",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var t=L(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=3;break}return t.next=3,axios.patch(a.url.ajax_duplicate,{}).then((function(t){"S"==t.data.data.status&&(swal({title:"อัพเดทแผนการผลิต",text:'<span style="font-size: 16px; text-align: left;"> คัดลอกแผนสำเร็จ </span>',type:"success",html:!0}),window.location.href=t.data.data.redirect_page),t.data.data.status})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))()},selectItem:function(t){var e=this;return L(s().mark((function a(){var n,r;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=t.item_list.findIndex((function(e){return e.inventory_item_id==t.item_id})),n=t.item_list[n],t.stamp=n.stamp,t.stamp_desc=n.stamp_desc,t.item_code=n.item_code,t.item_description=n.item_description,t.organization_id=n.organization_id,t.inventory_item_id=n.inventory_item_id,console.log("selectItem",t.item_list,"xx1",n,"xx",t.item_id,t.item_code,t),Object.keys(e.addLineData).length,r=JSON.parse(JSON.stringify(t)),e.$set(e.addLineData,"add-"+r.item_id,r);case 12:case"end":return a.stop()}}),a)})))()},remoteMethod:function(t,e){var a=this;return L(s().mark((function n(){var r,i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("remoteMethod"),i={number:t,product_main_id:(r=a).adjustData.product_main_id,product_type:r.productType},axios.get(r.url.ajax_search_item,{params:i}).then((function(t){var a=t.data.data;e.item_list=a.item_list}));case 4:case"end":return n.stop()}}),n)})))()},delLine:function(t,e){var a=this;a.$delete(a.adjBiweeklyData[a.productType][a.adjustData.current_biweekly],e),a.$delete(a.changeData,"case3-"+t.item_id),a.$delete(a.addLineData,"add-"+t.item_id)},checkApprove:function(){var t=this;return L(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t).canApprove){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,axios.get(a.url.ajax_check_approve).then((function(t){"S"==t.data.data.status?swal({html:!0,title:"อนุมัติประมาณการจัดซื้อแสตมป์รายเดือน",text:'<h2 class="m-t-sm m-b-lg"><span style="font-size: 18px"> คุณต้องการอนุมัติประมาณการจัดซื้อแสตมป์รายเดือน ? </span></h2>',showCancelButton:!0,confirmButtonText:a.btn_trans.ok.text,cancelButtonText:a.btn_trans.cancel.text,confirmButtonClass:a.btn_trans.ok.class+" btn-lg tw-w-25",cancelButtonClass:a.btn_trans.cancel.class+" btn-lg tw-w-25",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var t=L(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&a.approve();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):swal({title:"อนุมัตปรับประมาณการผลิตประจำปักษ์",text:t.data.data.msg,html:!0,showCancelButton:!0,confirmButtonText:a.btn_trans.ok.text,cancelButtonText:a.btn_trans.cancel.text,confirmButtonClass:a.btn_trans.ok.class+" btn-lg tw-w-25",cancelButtonClass:a.btn_trans.cancel.class+" btn-lg tw-w-25",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var t=L(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&(console.log("Approve"),a.approve());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){}));case 5:case"end":return e.stop()}}),e)})))()},approve:function(){var t=this;return L(s().mark((function e(){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,e.next=3,axios.patch(a.url.ajax_approve).then((function(t){"S"==t.data.data.status&&(swal({title:"อนุมัติประมาณการจัดซื้อแสตมป์รายเดือน",text:'<span style="font-size: 16px; text-align: left;"> อนุมัติประมาณการจัดซื้อแสตมป์รายเดือนเรียบร้อย </span>',type:"success",html:!0}),a.canEdit=!1,a.canApprove=!1,a.header=t.data.data.header,window.location.href=t.data.data.redirect_page),"S"!=t.data.data.status&&swal({title:"Error !",text:t.data.data.msg,type:"error",showConfirmButton:!0})})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){}));case 3:case"end":return e.stop()}}),e)})))()}}};const A=(0,u.Z)(W,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"ibox float-e-margins mb-2"},[a("div",{staticClass:"col-12 text-right mt-1"},[a("button",{class:t.btn_trans.copy.class+" btn-lg tw-w-25",attrs:{type:"button",disabled:""==t.header.monthly_id||null==t.header.monthly_id},on:{click:function(e){return e.preventDefault(),t.duplicate()}}},[a("i",{class:t.btn_trans.copy.icon}),t._v("\n                "+t._s(t.btn_trans.copy.text)+"แผน\n            ")]),t._v(" "),t.canApprove?a("button",{class:t.btn_trans.approve.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.checkApprove()}}},[a("i",{class:t.btn_trans.approve.icon}),t._v("\n                "+t._s(t.btn_trans.approve.text)+"\n            ")]):t._e(),t._v(" "),a("modal-search",{attrs:{btnTrans:t.btnTrans,url:t.url,budgetYears:t.search_input.budget_years,monthList:t.search_input.month_list,search:[]}}),t._v(" "),a("modal-create",{staticClass:"pr-2",attrs:{btnTrans:t.btnTrans,url:t.url,createInput:t.createInput}}),t._v(" "),a("button",{class:t.btn_trans.save.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.saveChangeInput()}}},[a("i",{class:t.btn_trans.save.icon}),t._v("\n                "+t._s(t.btn_trans.save.text)+"\n            ")])],1)]),t._v(" "),a("div",{staticClass:"card border-primary mb-3 mt-3"},[a("div",{staticClass:"card-body"},[a("header-detail",{attrs:{header:t.header,url:t.url}})],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"tabs-container mb-3"},[a("ul",{staticClass:"nav nav-tabs",attrs:{role:"tablist"}},[a("li",[a("a",{staticClass:"nav-link active",attrs:{"data-toggle":"tab",href:"#tab1"},on:{click:function(e){t.clickSelTabName="tab1"}}},[t._v("\n                    ประมาณการจัดซื้อแสตมป์รายตรา\n                ")])]),t._v(" "),a("li",[a("a",{staticClass:"nav-link ",attrs:{"data-toggle":"tab",href:"#tab2"},on:{click:function(e){t.clickSelTabName="tab2"}}},[t._v("\n                    รวมประมาณการจัดซื้อแสตมป์รายตรา\n                ")])]),t._v(" "),a("li",[a("a",{staticClass:"nav-link ",attrs:{"data-toggle":"tab",href:"#tab3"},on:{click:function(e){t.clickSelTabName="tab3"}}},[t._v("\n                    ประมาณการจัดซื้อแสตมป์ตามกลุ่มราคา\n                ")])])]),t._v(" "),a("div",{staticClass:"tab-content"},[a("div",{staticClass:"tab-pane active",attrs:{role:"tabpanel",id:"tab1"}},[t.header?a("div",{staticClass:"panel-body "},[a("div",{staticClass:"row"},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" รหัสแสตมป์ :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"large",placeholder:"รหัสแสตมป์",clearable:"",filterable:""},model:{value:t.tab1Input.stamp_code,callback:function(e){t.$set(t.tab1Input,"stamp_code",e)},expression:"tab1Input.stamp_code"}},t._l(t.header.stamp_items_group,(function(t,e){return a("el-option",{key:e,attrs:{label:e+": "+t[0].stamp_description,value:e}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-7 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v("  ")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-input",{attrs:{size:"large",disabled:"",readonly:!0,value:t.tab1Input.stamp_code?t.header.stamp_items_group[t.tab1Input.stamp_code][0].stamp_description:""}})],1)])]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" รหัสบุหรี่ :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"large",placeholder:"รหัสบุหรี่",clearable:"",filterable:""},model:{value:t.tab1Input.cigarettes_code,callback:function(e){t.$set(t.tab1Input,"cigarettes_code",e)},expression:"tab1Input.cigarettes_code"}},t._l(t.header.stamp_items_group[t.tab1Input.stamp_code],(function(t,e){return a("el-option",{key:t.cigarettes_code,attrs:{label:t.cigarettes_code+": "+t.cigarettes_description,value:t.cigarettes_code}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ตราบุหรี่")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-input",{attrs:{size:"large",disabled:"",readonly:!0,value:function(){if(!t.tab1Input.stamp_code)return"";if(!t.tab1Input.cigarettes_code)return"";var e=t.header.stamp_items_group[t.tab1Input.stamp_code].find((function(e){return e.cigarettes_code===t.tab1Input.cigarettes_code}));return e?e.cigarettes_description:void 0}()}})],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0  col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ม้วนละ :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-input",{staticClass:"text-right",attrs:{size:"large",disabled:"",readonly:!0,value:function(){if(!t.tab1Input.stamp_code)return"";if(!t.tab1Input.cigarettes_code)return"";var e=t.header.stamp_items_group[t.tab1Input.stamp_code].find((function(e){return e.cigarettes_code===t.tab1Input.cigarettes_code}));return e?e.unit_price_per_roll:void 0}()}})],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ราคาต่อดวง :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-input",{staticClass:"text-right",attrs:{size:"large",disabled:"",readonly:!0,value:function(){if(!t.tab1Input.stamp_code)return"";if(!t.tab1Input.cigarettes_code)return"";var e=t.header.stamp_items_group[t.tab1Input.stamp_code].find((function(e){return e.cigarettes_code===t.tab1Input.cigarettes_code}));return e?e.unit_price:void 0}()}})],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ")]),t._v(" "),a("button",{class:t.btnTrans.search.class+" btn-lg tw-w-25 btn-block",attrs:{type:"button",disabled:""==t.tab1Input.stamp_code||""==t.tab1Input.cigarettes_code},on:{click:function(e){return t.getEstData()}}},[a("i",{class:t.btnTrans.search.icon}),t._v("\n                                แสดงผล\n                            ")])])]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 offset-10 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("button",{class:t.btnTrans.save.class+" btn-lg tw-w-25 btn-block",attrs:{type:"button",disabled:!t.canApprove||""==t.tab1Input.stamp_code||""==t.tab1Input.cigarettes_code},on:{click:function(e){return t.updateEst()}}},[a("i",{class:t.btnTrans.save.icon}),t._v("\n                                อัพเดทประมาณการ\n                            ")])])]),t._v(" "),a("div",{staticClass:"hr-line-dashed mt-3"}),t._v(" "),a("div",{staticClass:"table-responsive m-t"},[a("table",{staticClass:"table text-nowrap table-bordered table-hover"},[t._m(0),t._v(" "),a("tbody",[t._l(t.dailyList,(function(e,n){return[a("tr",{style:"P"==e.holiday_flag?"background-color: "+t.publicHolidayColor:"Y"==e.holiday_flag?"background-color: "+t.holidayColor:""},[a("td",{staticClass:"text-center"},[t._v(" "+t._s(e.plan_date_thai))]),t._v(" "),a("td",{staticClass:"text-right"},[t.onhandQuantity[e.plan_date]&&0!=n?[t._v("\n                                        "+t._s(t._f("number0Digit")(t.onhandQuantity[e.plan_date]))+"\n                                    ")]:[t._v("\n                                        "+t._s(t._f("number0Digit")(e.onhand_qty))+"\n                                    ")]],2),t._v(" "),a("td",{staticClass:"text-right"},[a("receive-weekly",{staticStyle:{width:"130px"},attrs:{stamp:e,index:n,"line-weekly-qty":t.lineWeeklyQty,approve:t.canApprove,"change-data":t.changeData}})],1),t._v(" "),a("td",{staticClass:"text-right"},[a("receive-roll",{staticStyle:{width:"130px"},attrs:{stamp:e,index:n,"line-roll-qty":t.lineRollQty,approve:t.canApprove,"change-data":t.changeData}})],1),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number3Digit")(e.receipt_amount)))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number0Digit")(e.total_daily_qty)))]),t._v(" "),a("td",{staticClass:"text-right"},[t.balanceOnhandWeekly[e.plan_date]<0?[a("span",{staticClass:"text-danger"},[t._v(" "+t._s(t._f("number0Digit")(t.balanceOnhandWeekly[e.plan_date]))+" ")])]:[t._v("\n                                        "+t._s(t._f("number0Digit")(t.balanceOnhandWeekly[e.plan_date]))+"\n                                    ")]],2),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number2Digit")(t.balanceOnhandRoll[e.plan_date])))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number2Digit")(t.balanceQuantity[e.plan_date])))])])]}))],2)])])]):t._e()]),t._v(" "),a("div",{staticClass:"tab-pane ",attrs:{role:"tabpanel",id:"tab2"}},[a("div",{staticClass:"panel-body "},[a("div",{staticClass:"table-responsive m-t"},[a("div",{domProps:{innerHTML:t._s(t.tab2Html)}})])])]),t._v(" "),a("div",{staticClass:"tab-pane ",attrs:{role:"tabpanel",id:"tab3"}},[a("div",{staticClass:"panel-body "},[a("div",{staticClass:"row "},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" รหัสแสตมป์ :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"large",placeholder:"รหัสแสตมป์",clearable:"",filterable:""},model:{value:t.tab3Input.stamp_code,callback:function(e){t.$set(t.tab3Input,"stamp_code",e)},expression:"tab3Input.stamp_code"}},t._l(t.header.stamp_summary,(function(t,e){return a("el-option",{key:e,attrs:{label:e+": "+t[0].stamp_description,value:e}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v("  ")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-input",{attrs:{disabled:"",size:"large",readonly:!0,value:t.tab3Input.stamp_code?t.header.stamp_summary[t.tab3Input.stamp_code][0].stamp_description:""}})],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ม้วนละ :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-input",{staticClass:"text-right",attrs:{size:"large",disabled:"",readonly:!0,value:t.tab3Input.stamp_code?t.header.stamp_summary[t.tab3Input.stamp_code][0].unit_price_per_roll:""}})],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ราคาต่อดวง :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-input",{staticClass:"text-right",attrs:{size:"large",disabled:"",readonly:!0,value:t.tab3Input.stamp_code?t.header.stamp_summary[t.tab3Input.stamp_code][0].unit_price:""}})],1)]),t._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-2 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ")]),t._v(" "),a("button",{class:t.btnTrans.search.class+" btn-lg tw-w-25 btn-block",attrs:{type:"button"},on:{click:function(e){return t.getEstData()}}},[a("i",{class:t.btnTrans.search.icon}),t._v("\n                                แสดงผล\n                            ")])])]),t._v(" "),a("div",{staticClass:"hr-line-dashed mt-5"}),t._v(" "),a("div",{staticClass:"table-responsive m-t"},[a("div",{domProps:{innerHTML:t._s(t.tab3Html)}})])])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("วันที่")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("คงคลังเช้า (ดวง)")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{colspan:"3"}},[t._v("รับเข้า")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("ประมาณการใช้(ดวง)")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{colspan:"2"}},[t._v("คงคลังเย็น")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{rowspan:"2"}},[t._v("พอใช้(วัน)")])]),t._v(" "),a("tr",[a("th",{staticClass:"text-center"},[t._v("ดวง")]),t._v(" "),a("th",{staticClass:"text-center"},[t._v("ม้วน")]),t._v(" "),a("th",{staticClass:"text-center"},[t._v("จำนวนเงิน")]),t._v(" "),a("th",{staticClass:"text-center"},[t._v("ดวง")]),t._v(" "),a("th",{staticClass:"text-center"},[t._v("ม้วน")])])])}],!1,null,null,null).exports}}]);