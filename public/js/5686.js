(self.webpackChunk=self.webpackChunk||[]).push([[5686],{29040:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var n=i(23645),a=i.n(n)()((function(e){return e[1]}));a.push([e.id,".vld-overlay,.vld-shown{overflow:hidden}.vld-overlay{bottom:0;left:0;position:absolute;right:0;top:0;align-items:center;display:none;justify-content:center;z-index:9999}.vld-overlay.is-active{display:flex}.vld-overlay.is-full-page{z-index:9999;position:fixed}.vld-overlay .vld-background{bottom:0;left:0;position:absolute;right:0;top:0;background:#fff;opacity:.5}.vld-overlay .vld-icon,.vld-parent{position:relative}",""]);const r=a},84152:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var n=i(23645),a=i.n(n)()((function(e){return e[1]}));a.push([e.id,".v--modal-overlay[data-v-539644dc]{z-index:2000;padding-top:3rem;padding-bottom:3rem}",""]);const r=a},5686:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>P});var n=i(87757),a=i.n(n),r=i(7398),s=i.n(r),o=(i(2223),i(30381),i(80455)),l=i.n(o);function c(e,t,i,n,a,r,s){try{var o=e[r](s),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const h={components:{Loading:s(),VueNumeric:l()},props:["planHeader","planLines","uomCodes"],watch:{planHeader:function(e){this.planHeaderData=e},planLines:function(e){var t=this;this.planLineItems=e.map((function(e){return d(d({},e),{},{period_name_remain_qty:t.calPeriodNameRemainQty(e.period_name_request,e.period_name_qty,e.product_qty),uom_desc:t.getUomCodeDescription(t.uomCodes,e.uom)})})).sort((function(e,t){return e.inv_item_number<t.inv_item_number?-1:e.inv_item_number>t.inv_item_number?1:0}))}},data:function(){var e=this;return{planHeaderData:this.planHeader,planLineItems:this.planLines.map((function(t){return d(d({},t),{},{period_name_remain_qty:e.calPeriodNameRemainQty(t.period_name_request,t.period_name_qty,t.product_qty),uom_desc:e.getUomCodeDescription(e.uomCodes,t.uom)})})).sort((function(e,t){return e.inv_item_number<t.inv_item_number?-1:e.inv_item_number>t.inv_item_number?1:0})),isLoading:!1}},mounted:function(){this.emitPlanLineChanged()},computed:{},methods:{calPeriodNameRemainQty:function(e,t,i){return(t?parseFloat(Math.round(100*t)/100):0)-(i?parseFloat(Math.round(100*i)/100):0)},getUomCodeDescription:function(e,t){var i=e.find((function(e){return e.uom_code==t}));return i?i.unit_of_measure:""},onProductQtyValueChanged:function(e){e.period_name_remain_qty=this.calPeriodNameRemainQty(e.period_name_request,e.period_name_qty,e.product_qty),this.emitPlanLineChanged()},onSubmitOpenOrderBiweeklyPlan:function(){var e,t=this;return(e=a().mark((function e(){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={period_year:t.planHeaderData.period_year,period_name:t.planHeaderData.period_name,biweekly:t.planHeaderData.biweekly,version:t.planHeaderData.version,plan_header:JSON.stringify(t.planHeaderData),plan_lines:JSON.stringify(t.planLines)},t.isLoading=!0,e.next=4,axios.post("/ajax/pm/plans/biweekly/submit-open-order",i).then((function(e){var i=e.data.data,n=i.message;if("success"==i.status){i.plan_header&&JSON.parse(i.plan_header);var a=i.plan_lines?JSON.parse(i.plan_lines):null;a&&(t.planLineItems=a.map((function(e){return d(d({},e),{},{period_name_remain_qty:t.calPeriodNameRemainQty(e.period_name_request,e.period_name_qty,e.product_qty),uom_desc:t.getUomCodeDescription(t.uomCodes,e.uom)})})).sort((function(e,t){return e.inv_item_number<t.inv_item_number?-1:e.inv_item_number>t.inv_item_number?1:0}))),swal("Success","เปิดคำสั่งผลิตสำเร็จ","success")}return"error"==i.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถเปิดคำสั่งผลิต | ".concat(n),"error"),i})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ไม่สามารถเปิดคำสั่งผลิต | ".concat(e.message),"error")}));case 4:t.isLoading=!1;case 5:case"end":return e.stop()}}),e)})),function(){var t=this,i=arguments;return new Promise((function(n,a){var r=e.apply(t,i);function s(e){c(r,n,a,s,o,"next",e)}function o(e){c(r,n,a,s,o,"throw",e)}s(void 0)}))})()},getRequestNumber:function(e){return Number(0==e.product_qty)&&this.isOrderOpened(this.planLineItems)?"ไม่ผลิต":e.request_number},isOrderOpened:function(e){return!!e.find((function(e){return!!e.request_number}))},emitPlanLineChanged:function(){this.$emit("onPlanLineChanged",{planLineItems:this.planLineItems})}}};var m=i(51900);const y=(0,m.Z)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[3==e.planHeaderData.status?i("div",{staticClass:"text-right tw-mb-2"},[i("button",{staticClass:"btn btn-inline-block btn-sm btn-success tw-w-40",attrs:{disabled:e.isOrderOpened(e.planLineItems)},on:{click:e.onSubmitOpenOrderBiweeklyPlan}},[i("i",{staticClass:"fa fa-check-o tw-mr-1"}),e._v(" เปิดคำสั่งผลิต \n        ")])]):e._e(),e._v(" "),i("div",{staticClass:"table-responsive"},[i("table",{staticClass:"table table-bordered table-sticky mb-0",staticStyle:{"min-width":"1400px"}},[e._m(0),e._v(" "),e.planLineItems.length>0?i("tbody",[e._l(e.planLineItems,(function(t,n){return[i("tr",{key:""+n,style:{backgroundColor:0==parseInt(t.product_qty)?"#FDF5EF":""}},[i("td",{staticClass:"freeze-col",staticStyle:{"min-width":"700px"}},[i("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"},style:{backgroundColor:0==parseInt(t.product_qty)?"#FDF5EF":""}},[i("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4 tw-pr-2",staticStyle:{"min-width":"140px","max-width":"140px"}},[e._v("\n                                    "+e._s(t.product_item_desc?t.product_item_desc:"-")+" \n                                ")]),e._v(" "),i("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4 tw-px-2",staticStyle:{"min-width":"120px","max-width":"120px","border-left":"1px solid #ddd"}},[e._v("\n                                    "+e._s(t.inv_item_type?t.inv_item_type:"-")+"\n                                ")]),e._v(" "),i("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4 tw-px-2",staticStyle:{"min-width":"120px","max-width":"120px","border-left":"1px solid #ddd"}},[e._v("\n                                    "+e._s(t.inv_item_number?t.inv_item_number:"-")+"\n                                ")]),e._v(" "),i("div",{staticClass:"text-left tw-inline-block tw-align-top tw-py-4 tw-px-2",staticStyle:{"min-width":"280px","max-width":"280px","border-left":"1px solid #ddd"}},[e._v("\n                                    "+e._s(t.inv_item_desc?t.inv_item_desc:"-")+"\n                                ")])])]),e._v(" "),i("td",{staticClass:"text-right",staticStyle:{"min-width":"160px"}},["1"==e.planHeaderData.status?i("div",[i("vue-numeric",{staticClass:"form-control input-sm text-right",attrs:{separator:",",precision:2,minus:!1,id:"input_product_qty_"+n,name:"product_qty_"+n,placeholder:""},on:{change:function(i){return e.onProductQtyValueChanged(t)}},model:{value:t.product_qty,callback:function(i){e.$set(t,"product_qty",i)},expression:"planLineItem.product_qty"}})],1):i("div",[e._v("\n                                "+e._s(t.product_qty?Number(t.product_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00")+"\n                            ")])]),e._v(" "),i("td",{staticClass:"text-right",staticStyle:{"min-width":"130px","max-width":"130px"}},[e._v(" "+e._s(t.period_name_request?Number(t.period_name_request).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00")+" ")]),e._v(" "),i("td",{staticClass:"text-right",staticStyle:{"min-width":"130px","max-width":"130px"}},[e._v(" "+e._s(t.period_name_remain_qty?Number(t.period_name_remain_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00")+" ")]),e._v(" "),i("td",{staticClass:"text-center",staticStyle:{"min-width":"130px","max-width":"130px"}},[e._v(" "+e._s(t.uom_desc)+" ")]),e._v(" "),i("td",{staticClass:"text-center",staticStyle:{"min-width":"130px","max-width":"130px"}},[e._v(" "+e._s(e.getRequestNumber(t))+" ")]),e._v(" "),i("td",{staticClass:"text-right",staticStyle:{"min-width":"200px","max-width":"200px"}},[e._v(" "+e._s(t.estimate_qty?Number(t.estimate_qty).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:4}):"0.00")+" ")])])]}))],2):i("tbody",[e._m(1)])])]),e._v(" "),i("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}})],1)}),[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("thead",[i("tr",[i("th",{staticClass:"freeze-col",staticStyle:{height:"50px","min-width":"700px"}},[i("div",{staticClass:"freeze-col-content",staticStyle:{padding:"0px"}},[i("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4",staticStyle:{"min-width":"140px","max-width":"140px"}},[e._v("\n                                ตราบุหรี่ \n                            ")]),e._v(" "),i("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4",staticStyle:{"min-width":"120px","max-width":"120px","border-left":"1px solid #ddd"}},[e._v("\n                                ประเภทสิ่งพิมพ์\n                            ")]),e._v(" "),i("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4",staticStyle:{"min-width":"120px","max-width":"120px","border-left":"1px solid #ddd"}},[e._v("\n                                รหัสสินค้าสำเร็จรูป\n                            ")]),e._v(" "),i("div",{staticClass:"text-center tw-inline-block tw-align-top tw-py-4",staticStyle:{"min-width":"280px","max-width":"280px","border-left":"1px solid #ddd"}},[e._v("\n                                รายละเอียด\n                            ")])])]),e._v(" "),i("th",{staticClass:"text-center",staticStyle:{height:"50px","min-width":"160px"}},[e._v(" สั่งผลิต(ม้วนใหญ่) ")]),e._v(" "),i("th",{staticClass:"text-center",staticStyle:{height:"50px","min-width":"130px","max-width":"130px"}},[e._v(" คำสั่งทั้งเดือน ")]),e._v(" "),i("th",{staticClass:"text-center",staticStyle:{height:"50px","min-width":"130px","max-width":"130px"}},[e._v(" เหลือที่ต้องผลิต ")]),e._v(" "),i("th",{staticClass:"text-center",staticStyle:{height:"50px","min-width":"130px","max-width":"130px"}},[e._v(" หน่วย (ผลิต) ")]),e._v(" "),i("th",{staticClass:"text-center",staticStyle:{height:"50px","min-width":"130px","max-width":"130px"}},[e._v(" เลขคำสั่งผลิต ")]),e._v(" "),i("th",{staticClass:"text-center",staticStyle:{height:"50px","min-width":"200px","max-width":"200px"}},[e._v(" ประมาณการผลิตจากฝ่ายวางแผน ")])])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("tr",[i("td",{attrs:{colspan:"10"}},[i("h2",{staticClass:"p-5 text-center text-muted"},[e._v(" ไม่พบข้อมูล ")])])])}],!1,null,null,null).exports;function b(e,t,i,n,a,r,s){try{var o=e[r](s),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function v(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var r=e.apply(t,i);function s(e){b(r,n,a,s,o,"next",e)}function o(e){b(r,n,a,s,o,"throw",e)}s(void 0)}))}}const w={props:["modalName","modalWidth","modalHeight","planHeader","periodYears","periodYearValue","periodNames","periodNameValue","biweeklys","biweeklyValue","printTypes","printTypeValue","saleTypes","saleTypeValue","sourceVersions","sourceVersionValue","biweeklyPlanVersions","biweeklyPlanVersionValue"],components:{Loading:s()},watch:{planHeader:function(e){this.planHeaderData=e},periodYears:function(e){this.periodYearOptions=e},periodYearValue:function(e){this.periodYear=this.periodYearValue,this.periodYearLabel=this.getPeriodYearLabel(this.periodYearOptions,this.periodYear)},periodNames:function(e){this.periodNameOptions=e},periodNameValue:function(e){this.periodName=this.periodNameValue,this.periodNameLabel=this.getPeriodNameLabel(this.periodNameOptions,this.periodName)},biweeklys:function(e){this.biweeklyOptions=e},biweeklyValue:function(e){this.biweekly=this.biweeklyValue},printTypeValue:function(e){this.printType=e},saleTypeValue:function(e){this.saleType=e},sourceVersionValue:function(e){this.sourceVersion=e},sourceVersions:function(e){this.sourceVersionOptions=e},biweeklyPlanVersionValue:function(e){this.biweeklyPlanVersion=e},biweeklyPlanVersions:function(e){this.biweeklyPlanVersionOptions=e}},data:function(){return{is_loading:!1,width:this.modalWidth,planHeaderData:this.planHeader,periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),periodYearOptions:this.periodYears,periodName:this.periodNameValue,periodNameOptions:this.periodNames,biweekly:this.biweeklyValue,biweeklyOptions:this.biweeklys,printType:this.printTypeValue,saleType:this.saleTypeValue,sourceVersion:this.sourceVersionValue,sourceVersionOptions:this.sourceVersions,biweeklyPlanVersion:this.biweeklyPlanVersionValue,biweeklyPlanVersionOptions:this.biweeklyPlanVersions}},created:function(){this.handleResize()},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},onYearlyPlanChanged:function(e){this.periodYear=e,this.periodYearLabel=this.getPeriodYearLabel(this.periodYearOptions,this.periodYear),this.periodName=null,this.periodNameLabel="",this.periodNameOptions=[],this.biweeklyOptions=[],this.sourceVersion=null,this.sourceVersions=[],this.biweeklyPlanVersion=null,this.biweeklyPlanVersionOptions=[],this.getPeriodNames(e)},onPeriodNameChanged:function(e){var t=this;return v(a().mark((function i(){return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.periodName=e,t.periodNameLabel=t.getPeriodNameLabel(t.periodNameOptions,t.periodName),t.biweeklyPlanVersion=null,t.biweeklyPlanVersionOptions=[],t.biweeklyOptions=[],i.next=7,t.getSourceVersions(t.periodYear,t.periodName,t.printType,t.saleType);case 7:t.getBiweekOfPlans(t.periodYear,e);case 8:case"end":return i.stop()}}),i)})))()},onBiweekOfPlanChanged:function(e){var t=this;return v(a().mark((function i(){return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t.biweekly=e,t.periodYear&&t.periodName&&t.biweekly&&t.printType&&t.saleType&&t.sourceVersion&&t.getBiweeklyPlanData(t.periodYear,t.periodName,t.biweekly,t.printType,t.saleType,t.sourceVersion,null);case 2:case"end":return i.stop()}}),i)})))()},onSourceVersionChanged:function(e){this.sourceVersion=e},onPrintTypeChanged:function(e){this.printType=e,this.periodYear&&this.periodName&&this.biweekly&&this.printType&&this.saleType&&this.sourceVersion&&this.getBiweeklyPlanData(this.periodYear,this.periodName,this.biweekly,this.printType,this.saleType,this.sourceVersion,null)},onSaleTypeChanged:function(e){this.saleType=e,this.periodYear&&this.periodName&&this.biweekly&&this.printType&&this.saleType&&this.sourceVersion&&this.getBiweeklyPlanData(this.periodYear,this.periodName,this.biweekly,this.printType,this.saleType,this.sourceVersion,null)},onBiweeklyPlanVersionChanged:function(e){this.biweeklyPlanVersion=e},getPeriodYearLabel:function(e,t){var i=e.find((function(e){return e.period_year_value==t}));return i?i.period_year_label:""},getPeriodNameLabel:function(e,t){var i=e.find((function(e){return e.period_name_value==t}));return i?i.period_name_label:""},getPeriodNames:function(e){var t=this;return v(a().mark((function i(){var n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.is_loading=!0,t.biweeklyPlanVersion=null,t.biweeklyPlanVersionOptions=[],n={period_year:e},i.next=6,axios.get("/ajax/pm/plans/biweekly/get-months",{params:n}).then((function(e){var t=e.data.data;return t.period_names?JSON.parse(t.period_names):[]})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ปี ".concat(t.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 6:t.periodNameOptions=i.sent,t.is_loading=!1;case 8:case"end":return i.stop()}}),i)})))()},getBiweekOfPlans:function(e,t){var i=this;return v(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i.is_loading=!0,r={period_year:e,period_name:t},n.next=4,axios.get("/ajax/pm/plans/biweekly/get-biweeks",{params:r}).then((function(e){var t=e.data.data;return t.biweeklys?JSON.parse(t.biweeklys):[]})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ปี ".concat(i.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 4:i.biweeklyOptions=n.sent,i.is_loading=!1;case 6:case"end":return n.stop()}}),n)})))()},getBiweeklyPlanData:function(e,t,i,n,r,s,o){var l=this;return v(a().mark((function c(){var p;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l.is_loading=!0,p={period_year:e,period_name:t,biweekly:i,print_type:n,sale_type:r,source_version:s,version:o},a.next=4,axios.get("/ajax/pm/plans/biweekly/get-info",{params:p}).then((function(e){var t=e.data.data;return l.biweeklyPlanVersionOptions=t.versions?JSON.parse(t.versions):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","".concat(e.message),"error")}));case 4:l.biweeklyPlanVersion=l.biweeklyPlanVersionOptions.length>0?l.biweeklyPlanVersionOptions[0].version:null,l.is_loading=!1;case 6:case"end":return a.stop()}}),c)})))()},getSourceVersions:function(e,t,i,n){var r=this;return v(a().mark((function s(){var o;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r.isLoading=!0,r.sourceVersion=null,r.sourceVersionOptions=[],o={period_year:e,period_name:t,print_type:i,sale_type:n},a.next=6,axios.get("/ajax/pm/plans/biweekly/get-source-versions",{params:o}).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(t.message),"error"):(r.sourceVersion=t.source_version?t.source_version:null,r.sourceVersionOptions=t.source_versions?JSON.parse(t.source_versions):[],r.sourceVersionOptions.length<=0&&swal("ไม่พบข้อมูล","ไม่พบข้อมูลแผนรายเดือนที่ยืนยันแล้ว","error")),t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(e.message),"error")}));case 6:r.isLoading=!1;case 7:case"end":return a.stop()}}),s)})))()},onSearchPlanVersion:function(){this.$modal.hide(this.modalName),this.$emit("onSearchPlanVersion",{period_year:this.periodYear,period_name:this.periodName,biweekly:this.biweekly,print_type:this.printType,sale_type:this.saleType,source_version:this.sourceVersion,source_versions:this.sourceVersionOptions,version:this.biweeklyPlanVersion})}}};i(65619);const f=(0,m.Z)(w,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{position:"fixed","z-index":"100"}},[i("modal",{attrs:{name:e.modalName,width:e.width,scrollable:!0,height:e.modalHeight,shiftX:.3,shiftY:.3}},[i("div",{staticClass:"p-4"},[i("h4",[e._v(" ค้นหาแผนผลิตสิ่งพิมพ์รายปักษ์ ")]),e._v(" "),i("hr"),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ระบบการพิมพ์ ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"print_type",id:"input_print_type","select-options":e.printTypes,"option-key":"print_type_value","option-value":"print_type_value","option-label":"print_type_label",value:e.printType,filterable:!0},on:{onSelected:e.onPrintTypeChanged}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ประเภทแผน ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"sale_type",id:"sale_type","select-options":e.saleTypes,"option-key":"value","option-value":"value","option-label":"description",value:e.saleType,filterable:!0},on:{onSelected:e.onSaleTypeChanged}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" แผนประมาณการ "),i("br"),e._v(" จำหน่ายประจำปี ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":e.periodYearOptions,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:e.periodYear,filterable:!0},on:{onSelected:e.onYearlyPlanChanged}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ประจำเดือน ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"period_name",id:"input_period_name","select-options":e.periodNameOptions,"option-key":"period_name_value","option-value":"period_name_value","option-label":"period_name_label",value:e.periodName,filterable:!0},on:{onSelected:e.onPeriodNameChanged}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ปักษ์ ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"biweekly",id:"input_biweekly","select-options":e.biweeklyOptions,"option-key":"biweekly_value","option-value":"biweekly_value","option-label":"biweekly_label",value:e.biweekly,filterable:!0},on:{onSelected:e.onBiweekOfPlanChanged}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" เวอร์ชั่น ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"monthly_plan_version",id:"input_monthly_plan_version","select-options":e.biweeklyPlanVersionOptions,"option-key":"version","option-value":"version","option-label":"version",value:e.biweeklyPlanVersion,filterable:!0},on:{onSelected:e.onBiweeklyPlanVersionChanged}})],1)]),e._v(" "),i("div",{staticClass:"text-right tw-mt-8"},[i("button",{staticClass:"btn btn-primary tw-w-32",attrs:{type:"button",disabled:!(e.periodYear&&e.periodName&&e.biweekly&&e.biweeklyPlanVersion)},on:{click:e.onSearchPlanVersion}},[e._v(" \n                    เลือก \n                ")]),e._v(" "),i("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(t){return e.$modal.hide(e.modalName)}}},[e._v(" \n                    ยกเลิก \n                ")])])])]),e._v(" "),i("loading",{attrs:{active:e.is_loading,"is-full-page":!0},on:{"update:active":function(t){e.is_loading=t}}})],1)}),[],!1,null,"539644dc",null).exports;function _(e,t,i,n,a,r,s){try{var o=e[r](s),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function g(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var r=e.apply(t,i);function s(e){_(r,n,a,s,o,"next",e)}function o(e){_(r,n,a,s,o,"throw",e)}s(void 0)}))}}const k={components:{Loading:s(),TablePlanLines:y,ModalSearchPlan:f},props:["periodYears","periodYearValue","periodNameValue","biweeklyValue","planStatuses","printTypes","printTypeValue","saleTypes","saleTypeValue","sourceVersionValue","uomCodes"],mounted:function(){var e=this;this.periodYearValue&&this.getPeriodNames(this.periodYearValue).then((function(t){e.periodNameValue&&(e.periodNameLabel=e.getPeriodNameLabel(e.periodNames,e.periodNameValue),e.getBiweekOfPlans(e.periodYearValue,e.periodNameValue).then((function(t){e.biweeklyValue&&e.printTypeValue&&e.saleTypeValue&&e.sourceVersionValue&&e.getSourceVersions(e.periodYearValue,e.periodNameValue,e.printTypeValue,e.saleTypeValue).then((function(t){e.getBiweeklyPlanData(e.periodYearValue,e.periodNameValue,e.biweeklyValue,e.printTypeValue,e.saleTypeValue,e.sourceVersionValue,null)}))})))}))},data:function(){return{periodYear:this.periodYearValue,periodYearLabel:this.getPeriodYearLabel(this.periodYears,this.periodYearValue),periodName:this.periodNameValue,periodNameLabel:"",biweekly:this.biweeklyValue,printType:this.printTypeValue?this.printTypeValue:this.printTypes.length>0?this.printTypes[0].print_type_value:null,printTypeLabel:this.printTypeValue?this.getPrintTypeLabel(this.printTypes,this.printTypeValue):this.printTypes.length>0?this.printTypes[0].print_type_label:null,saleType:this.saleTypeValue?this.saleTypeValue:this.saleTypes.length>0?this.saleTypes[0].value:null,saleTypeLabel:this.saleTypeValue?this.getPrintTypeLabel(this.saleTypes,this.saleTypeValue):this.saleTypes.length>0?this.saleTypes[0].description:null,sourceVersion:this.sourceVersionValue?this.sourceVersionValue:null,sourceVersions:[],periodNames:[],biweeklys:[],biweeklyPlanHeader:null,biweeklyPlanVersion:null,biweeklyPlanLines:[],biweeklyPlanVersions:[],isNewlyCreate:!1,isLoading:!1}},computed:{},methods:{setUrlParams:function(){var e=new URLSearchParams(window.location.search);e.set("period_year",this.periodYear?this.periodYear:""),e.set("period_name",this.periodName?this.periodName:""),e.set("biweekly",this.biweekly?this.biweekly:""),e.set("print_type",this.printType?this.printType:""),e.set("sale_type",this.saleType?this.saleType:""),e.set("source_version",this.sourceVersion?this.sourceVersion:""),window.history.replaceState(null,null,"?"+e.toString())},onYearlyPlanChanged:function(e){this.periodYear=e,this.periodYearLabel=this.getPeriodYearLabel(this.periodYears,this.periodYear),this.setUrlParams(),this.periodName=null,this.periodNameLabel="",this.periodNames=[],this.biweekly=null,this.biweeklys=[],this.sourceVersion=null,this.sourceVersions=[],this.biweeklyPlanHeader=null,this.biweeklyPlanVersion=null,this.biweeklyPlanVersions=[],this.biweeklyPlanLines=[],this.getPeriodNames(this.periodYear)},onPeriodNameChanged:function(e){var t=this;return g(a().mark((function i(){return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.periodName=e,t.periodNameLabel=t.getPeriodNameLabel(t.periodNames,t.periodName),t.setUrlParams(),t.biweekly=null,t.biweeklys=[],t.biweeklyPlanHeader=null,t.biweeklyPlanVersion=null,t.biweeklyPlanVersions=[],t.biweeklyPlanLines=[],i.next=11,t.getSourceVersions(t.periodYear,t.periodName,t.printType,t.saleType);case 11:t.getBiweekOfPlans(t.periodYear,t.periodName);case 12:case"end":return i.stop()}}),i)})))()},onBiweekOfPlanChanged:function(e){var t=this;return g(a().mark((function i(){return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t.biweekly=e,t.setUrlParams(),t.biweeklyPlanVersion=null,t.biweeklyPlanVersions=[],t.periodYear&&t.periodName&&t.biweekly&&t.printType&&t.saleType&&t.sourceVersion&&t.getBiweeklyPlanData(t.periodYear,t.periodName,t.biweekly,t.printType,t.saleType,t.sourceVersion,null);case 5:case"end":return i.stop()}}),i)})))()},onSourceVersionChanged:function(e){this.sourceVersion=e,this.setUrlParams()},onPrintTypeChanged:function(e){this.printType=e,this.printTypeLabel=this.getPrintTypeLabel(this.printTypes,this.printType),this.setUrlParams(),this.periodYear&&this.periodName&&this.biweekly&&this.printType&&this.saleType&&this.sourceVersion&&this.getBiweeklyPlanData(this.periodYear,this.periodName,this.biweekly,this.printType,this.saleType,this.sourceVersion,null)},onSaleTypeChanged:function(e){this.saleType=e,this.saleTypeLabel=this.getSaleTypeLabel(this.saleTypes,this.saleType),this.setUrlParams(),this.periodYear&&this.periodName&&this.biweekly&&this.printType&&this.saleType&&this.sourceVersion&&this.getBiweeklyPlanData(this.periodYear,this.periodName,this.biweekly,this.printType,this.saleType,this.sourceVersion,null)},onSearchPlanVersion:function(e){this.periodYear=e.period_year,this.periodYearLabel=this.getPeriodYearLabel(this.periodYears,this.periodYear),this.periodName=e.period_name,this.periodNameLabel=this.getPeriodNameLabel(this.periodNames,this.periodName),this.biweekly=e.biweekly,this.biweeklyPlanVersion=e.version,this.printType=e.print_type,this.printTypeLabel=this.getPrintTypeLabel(this.printTypes,this.printType),this.saleType=e.sale_type,this.saleTypeLabel=this.getPrintTypeLabel(this.saleTypes,this.saleType),this.sourceVersion=e.source_version,this.sourceVersions=e.source_versions,this.biweeklyPlanLines=[],this.getPeriodNames(this.periodYear),this.getBiweekOfPlans(this.periodYear,this.periodName),this.periodYear&&this.periodName&&this.biweekly&&this.printType&&this.saleType&&this.sourceVersion&&this.getBiweeklyPlanData(this.periodYear,this.periodName,this.biweekly,this.printType,this.saleType,this.sourceVersion,this.biweeklyPlanVersion)},getPeriodYearLabel:function(e,t){var i=e.find((function(e){return e.period_year_value==t}));return i?i.period_year_label:""},getPeriodNameLabel:function(e,t){var i=e.find((function(e){return e.period_name_value==t}));return i?i.period_name_label:""},getPrintTypeLabel:function(e,t){var i=e.find((function(e){return e.print_type_value==t}));return i?i.print_type_label:""},getSaleTypeLabel:function(e,t){var i=e.find((function(e){return e.value==t}));return i?i.description:""},getPeriodNames:function(e){var t=this;return g(a().mark((function i(){var n;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t.isLoading=!0,n={period_year:e},i.next=4,axios.get("/ajax/pm/plans/biweekly/get-months",{params:n}).then((function(e){var t=e.data.data;return t.period_names?JSON.parse(t.period_names):[]})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ปี ".concat(t.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 4:t.periodNames=i.sent,t.isLoading=!1;case 6:case"end":return i.stop()}}),i)})))()},getBiweekOfPlans:function(e,t){var i=this;return g(a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i.isLoading=!0,r={period_year:e,period_name:t},n.next=4,axios.get("/ajax/pm/plans/biweekly/get-biweeks",{params:r}).then((function(e){var t=e.data.data;return t.biweeklys?JSON.parse(t.biweeklys):[]})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","เดือน : ".concat(i.periodNameLabel," ปี ").concat(i.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 4:i.biweeklys=n.sent,i.isLoading=!1;case 6:case"end":return n.stop()}}),n)})))()},getBiweeklyPlanData:function(e,t,i,n,r,s,o){var l=this;return g(a().mark((function c(){var p,d;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l.isLoading=!0,l.biweeklyPlanHeader=null,l.biweeklyPlanVersion=o,l.biweeklyPlanVersions=[],l.biweeklyPlanLines=[],p={period_year:e,period_name:t,biweekly:i,print_type:n,sale_type:r,source_version:s,version:o},a.next=8,axios.get("/ajax/pm/plans/biweekly/get-info",{params:p}).then((function(e){var t=e.data.data;return l.biweeklyPlanHeader=t.plan_header?JSON.parse(t.plan_header):null,l.biweeklyPlanVersions=t.versions?JSON.parse(t.versions):[],t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ปักษ์ : ".concat(l.biweekly," เดือน : ").concat(l.periodNameLabel," ปี ").concat(l.periodYearLabel," ไม่ถูกต้อง | ").concat(e.message),"error")}));case 8:if(!l.biweeklyPlanHeader){a.next=18;break}if(l.biweeklyPlanVersion=l.biweeklyPlanHeader.version,!(l.sourceVersions.length>0)){a.next=16;break}return d=l.sourceVersions.find((function(e){return e.source_version==l.biweeklyPlanHeader.source_version})),l.sourceVersion=d?d.source_version:l.sourceVersions[0].source_version,a.next=15,l.onGetBiweeklyPlanLines();case 15:l.setUrlParams();case 16:a.next=19;break;case 18:l.biweeklyPlanVersion=null;case 19:l.isLoading=!1;case 20:case"end":return a.stop()}}),c)})))()},getSourceVersions:function(e,t,i,n){var r=this;return g(a().mark((function s(){var o;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r.isLoading=!0,r.sourceVersion=null,r.sourceVersions=[],o={period_year:e,period_name:t,print_type:i,sale_type:n},a.next=6,axios.get("/ajax/pm/plans/biweekly/get-source-versions",{params:o}).then((function(e){var t=e.data.data;return"error"==t.status?swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(t.message),"error"):(r.sourceVersion=t.source_version?t.source_version:null,r.sourceVersions=t.source_versions?JSON.parse(t.source_versions):[],r.sourceVersions.length<=0&&swal("ไม่พบข้อมูล","ไม่พบข้อมูลแผนรายเดือนที่ยืนยันแล้ว ","error")),t})).catch((function(e){console.log(e),swal("เกิดข้อผิดพลาด","ข้อมูลไม่ถูกต้อง | ".concat(e.message),"error")}));case 6:r.isLoading=!1;case 7:case"end":return a.stop()}}),s)})))()},getPlanStatusDesc:function(e){var t="-";if(e){var i=this.planStatuses.find((function(t){return t.lookup_code==e}));t=i?i.description:"-"}return t},onGetBiweeklyPlanLines:function(){var e=this;return g(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,i={period_year:e.periodYear,period_name:e.periodName,biweekly:e.biweekly,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.biweeklyPlanVersion},t.next=4,axios.get("/ajax/pm/plans/biweekly/get-lines",{params:i}).then((function(t){var i=t.data.data;return"success"==i.status?(e.biweeklyPlanHeader=i.plan_header?JSON.parse(i.plan_header):[],e.biweeklyPlanLines=i.plan_lines?JSON.parse(i.plan_lines):[],e.biweeklyPlanVersion=e.biweeklyPlanHeader.version,e.biweeklyPlanVersions=i.versions?JSON.parse(i.versions):[]):swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(i.message),"error"),i})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},onGenerateBiweeklyPlanLines:function(){var e=this;return g(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.biweeklyPlanLines.length>0?swal({title:"",text:"ต้องการเรียกข้อมูลจากแผน ใหม่อีกครั้ง ?",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(t){t&&(e.biweeklyPlanLines=[],e.generateBiweeklyPlanLines())})):e.generateBiweeklyPlanLines();case 1:case"end":return t.stop()}}),t)})))()},generateBiweeklyPlanLines:function(){var e=this;return g(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,i={period_year:e.periodYear,period_name:e.periodName,biweekly:e.biweekly,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.biweeklyPlanVersion},t.next=4,axios.post("/ajax/pm/plans/biweekly/generate-lines",i).then((function(t){var i=t.data.data;return"success"==i.status?(e.biweeklyPlanHeader=i.plan_header?JSON.parse(i.plan_header):[],e.biweeklyPlanLines=i.plan_lines?JSON.parse(i.plan_lines):[],e.biweeklyPlanVersion=e.biweeklyPlanHeader.version,e.biweeklyPlanVersions=i.versions?JSON.parse(i.versions):[],e.isNewlyCreate=i.is_newly_create):swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(i.message),"error"),i})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},onPlanLineChanged:function(e){this.biweeklyPlanLines=e.planLineItems},onSaveBiweeklyPlan:function(){var e=this;return g(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={period_year:e.periodYear,period_name:e.periodName,biweekly:e.biweekly,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.biweeklyPlanVersion,plan_header:JSON.stringify(e.biweeklyPlanHeader),plan_lines:JSON.stringify(e.biweeklyPlanLines)},e.isLoading=!0,t.next=4,axios.post("/ajax/pm/plans/biweekly/store-lines",i).then((function(t){var i=t.data.data,n=i.message,a=i.plan_header?JSON.parse(i.plan_header):null;return"success"==i.status&&(e.biweeklyPlanHeader=a,e.biweeklyPlanVersion=a.version,e.biweeklyPlanVersions=i.versions?JSON.parse(i.versions):[],e.isNewlyCreate=!1,swal("Success","บันทึกข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," version : ").concat(e.biweeklyPlanVersion),"success")),"error"==i.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถบันทึกข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(n),"error"),i})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถบันทึกข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},onSubmitApprovalBiweeklyPlan:function(){var e=this;return g(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={period_year:e.periodYear,period_name:e.periodName,biweekly:e.biweekly,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion,version:e.biweeklyPlanVersion,plan_header:JSON.stringify(e.biweeklyPlanHeader),plan_lines:JSON.stringify(e.biweeklyPlanLines)},e.isLoading=!0,t.next=4,axios.post("/ajax/pm/plans/biweekly/store-lines",i).then((function(e){var t=e.data.data;return"error"==t.status&&console.log(t.message),t})).catch((function(e){console.log(e)}));case 4:return t.next=6,axios.post("/ajax/pm/plans/biweekly/submit-approval",i).then((function(t){var i=t.data.data,n=i.message;return"success"==i.status&&(e.biweeklyPlanHeader=i.plan_header?JSON.parse(i.plan_header):null,e.biweeklyPlanVersions=i.versions?JSON.parse(i.versions):[],swal("Success","ส่งข้อมูลแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel),"success")),"error"==i.status&&swal("เกิดข้อผิดพลาด","ไม่สามารถส่งข้อมูลแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(n),"error"),i})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","ไม่สามารถส่งข้อมูลแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 6:e.isLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},onCreateNewBiweeklyPlanVersion:function(){var e=this;return g(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:swal({title:"",text:"ต้องการสร้าง แผนผลิตสิ่งพิมพ์รายปักษ์ แผนประมาณการจำหน่ายประจำปี : ".concat(e.periodYearLabel," เวอร์ชั่นใหม่ ?"),showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(t){t&&(e.biweeklyPlanLines=[],e.createNewPlanVersion())}));case 1:case"end":return t.stop()}}),t)})))()},isAllowSelectSourceVersion:function(e,t){var i=!1;return e?0==t.length&&(i=!0):i=!0,i},isAllowCreateNewPlanVersion:function(e){var t=!0;return 0==e.length&&(t=!1),e.filter((function(e){return 1==e.status||2==e.status})).length>0&&(t=!1),t},createNewPlanVersion:function(){var e=this;return g(a().mark((function t(){var i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={period_year:e.periodYear,period_name:e.periodName,biweekly:e.biweekly,print_type:e.printType,sale_type:e.saleType,source_version:e.sourceVersion},e.isLoading=!0,t.next=4,axios.post("/ajax/pm/plans/biweekly/add-new-header",i).then((function(t){var i=t.data.data,n=i.message;return"success"==i.status&&(e.biweeklyPlanHeader=i.plan_header?JSON.parse(i.plan_header):null,e.biweeklyPlanVersion=i.version,e.biweeklyPlanVersions=i.versions?JSON.parse(i.versions):[],swal("Success","สร้างข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," version : ").concat(e.biweeklyPlanVersion," )"),"success")),"error"==i.status&&swal("เกิดข้อผิดพลาด","สร้างข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(n),"error"),i})).catch((function(t){console.log(t),swal("เกิดข้อผิดพลาด","สร้างข้อมูลการวางแผนผลิตสิ่งพิมพ์รายปักษ์ : ".concat(e.biweekly," เดือน : ").concat(e.periodNameLabel," ปี ").concat(e.periodYearLabel," ระบบการพิมพ์ ").concat(e.printTypeLabel," | ").concat(t.message),"error")}));case 4:e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()}}};const P=(0,m.Z)(k,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ibox"},[i("div",{staticClass:"ibox-content",staticStyle:{"min-height":"600px"}},[i("div",{staticClass:"tw-mb-4"},[i("div",{staticClass:"text-right tw-mb-2"},[i("button",{staticClass:"btn btn-inline-block btn-sm btn-success tw-w-40",attrs:{disabled:!e.isAllowCreateNewPlanVersion(e.biweeklyPlanVersions)},on:{click:e.onCreateNewBiweeklyPlanVersion}},[i("i",{staticClass:"fa fa-plus tw-mr-1"}),e._v(" สร้าง \n                ")]),e._v(" "),i("button",{staticClass:"btn btn-inline-block btn-sm btn-primary tw-w-40",attrs:{disabled:!(e.periodYear&&e.periodName&&e.biweekly&&0!=e.biweeklyPlanLines.length&&e.biweeklyPlanHeader&&"1"==e.biweeklyPlanHeader.status)},on:{click:e.onSaveBiweeklyPlan}},[i("i",{staticClass:"fa fa-save tw-mr-1"}),e._v(" บันทึก \n                ")]),e._v(" "),i("button",{staticClass:"btn btn-inline-block btn-sm btn-white tw-w-40",on:{click:function(t){return e.$modal.show("modal-search-plan")}}},[i("i",{staticClass:"fa fa-search tw-mr-1"}),e._v(" ค้นหา \n                ")])]),e._v(" "),i("div",{staticClass:"text-right"},[i("button",{staticClass:"btn btn-inline-block btn-sm btn-info tw-w-40",attrs:{disabled:!e.periodYear||!e.periodName||!e.biweekly||!!e.biweeklyPlanHeader&&"1"!=e.biweeklyPlanHeader.status},on:{click:e.onGenerateBiweeklyPlanLines}},[i("i",{staticClass:"fa fa-calculator tw-mr-1"}),e._v(" เรียกข้อมูลจากแผน \n                ")]),e._v(" "),i("button",{staticClass:"btn btn-inline-block btn-sm btn-warning tw-w-40",attrs:{disabled:!e.biweeklyPlanHeader||"1"!=e.biweeklyPlanHeader.status||0==e.biweeklyPlanLines.length||e.isNewlyCreate},on:{click:e.onSubmitApprovalBiweeklyPlan}},[i("i",{staticClass:"fa fa-check-square tw-mr-1"}),e._v(" ส่งอนุมัติ \n                ")]),e._v(" "),i("button",{staticClass:"btn btn-inline-block btn-sm btn-primary tw-w-40",attrs:{disabled:!e.biweeklyPlanHeader||"1"==e.biweeklyPlanHeader.status}},[i("i",{staticClass:"fa fa-print tw-mr-1"}),e._v(" พิมพ์รายงาน \n                ")])])]),e._v(" "),i("hr"),e._v(" "),i("div",[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ระบบการพิมพ์ ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"print_type",id:"input_print_type","select-options":e.printTypes,"option-key":"print_type_value","option-value":"print_type_value","option-label":"print_type_label",value:e.printType,filterable:!0}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ประเภทแผน ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"sale_type",id:"sale_type","select-options":e.saleTypes,"option-key":"value","option-value":"value","option-label":"description",value:e.saleType,filterable:!0},on:{onSelected:e.onSaleTypeChanged}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[e._m(0),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"period_year",id:"input_period_year","select-options":e.periodYears,"option-key":"period_year_value","option-value":"period_year_value","option-label":"period_year_label",value:e.periodYear,filterable:!0},on:{onSelected:e.onYearlyPlanChanged}})],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ประจำเดือน ")]),e._v(" "),i("div",{staticClass:"col-md-3"},[i("pm-el-select",{attrs:{name:"period_name",id:"input_period_name","select-options":e.periodNames,"option-key":"period_name_value","option-value":"period_name_value","option-label":"period_name_label",value:e.periodName,filterable:!0},on:{onSelected:e.onPeriodNameChanged}})],1),e._v(" "),i("label",{staticClass:"col-md-2 col-form-label tw-font-bold"},[e._v(" ครั้งที่ ")]),e._v(" "),i("div",{staticClass:"col-md-3"},[e.isAllowSelectSourceVersion(e.biweeklyPlanHeader,e.biweeklyPlanLines)?i("pm-el-select",{attrs:{name:"source_version",id:"source_version","select-options":e.sourceVersions,"option-key":"source_version","option-value":"source_version","option-label":"source_version",value:e.sourceVersion,filterable:!0},on:{onSelected:e.onSourceVersionChanged}}):e._e(),e._v(" "),e.isAllowSelectSourceVersion(e.biweeklyPlanHeader,e.biweeklyPlanLines)?e._e():i("p",{staticClass:"col-form-label"},[e._v(" "+e._s(e.sourceVersion)+" ")])],1)]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ปักษ์ ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[i("pm-el-select",{attrs:{name:"biweekly",id:"input_biweekly","select-options":e.biweeklys,"option-key":"biweekly_value","option-value":"biweekly_value","option-label":"biweekly_label",value:e.biweekly,filterable:!0},on:{onSelected:e.onBiweekOfPlanChanged}})],1)])]),e._v(" "),i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" ผู้อนุมัติ ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[e.biweeklyPlanHeader?i("p",{staticClass:"col-form-label"},[e._v(" "+e._s(e.biweeklyPlanHeader.attribute12?e.biweeklyPlanHeader.attribute12:"-")+" ")]):e._e(),e._v(" "),e.biweeklyPlanHeader?e._e():i("p",{staticClass:"col-form-label"},[e._v(" - ")])])]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" เวอร์ชั่น ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[e.biweeklyPlanHeader?i("p",{staticClass:"col-form-label"},[e._v(" "+e._s(e.biweeklyPlanHeader.version?e.biweeklyPlanHeader.version:"-")+" ")]):e._e(),e._v(" "),e.biweeklyPlanHeader?e._e():i("p",{staticClass:"col-form-label"},[e._v(" - ")])])]),e._v(" "),i("div",{staticClass:"row form-group"},[i("label",{staticClass:"col-md-4 col-form-label tw-font-bold"},[e._v(" สถานะ ")]),e._v(" "),i("div",{staticClass:"col-md-8"},[e.biweeklyPlanHeader?i("p",{staticClass:"col-form-label"},[e._v(" "+e._s(e.getPlanStatusDesc(e.biweeklyPlanHeader.status))+" ")]):e._e(),e._v(" "),e.biweeklyPlanHeader?e._e():i("p",{staticClass:"col-form-label"},[e._v(" - ")])])])])])]),e._v(" "),i("hr"),e._v(" "),e.biweeklyPlanLines.length>0?i("div",{staticClass:"tw-m-8"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-12"},[i("table-plan-lines",{attrs:{"plan-header":e.biweeklyPlanHeader,"plan-lines":e.biweeklyPlanLines,"uom-codes":e.uomCodes},on:{onPlanLineChanged:e.onPlanLineChanged}})],1)])]):e._e()]),e._v(" "),i("loading",{attrs:{active:e.isLoading,"is-full-page":!0},on:{"update:active":function(t){e.isLoading=t}}}),e._v(" "),i("modal-search-plan",{attrs:{"modal-name":"modal-search-plan","modal-width":"640","modal-height":"auto","period-years":e.periodYears,"period-year-value":e.periodYear,"period-names":e.periodNames,"period-name-value":e.periodName,biweeklys:e.biweeklys,"biweekly-value":e.biweekly,"print-types":e.printTypes,"print-type-value":e.printType,"sale-types":e.saleTypes,"sale-type-value":e.saleType,"source-versions":e.sourceVersions,"source-version-value":e.sourceVersion,"biweekly-plan-version-value":e.biweeklyPlanVersion,"biweekly-plan-versions":e.biweeklyPlanVersions},on:{onSearchPlanVersion:e.onSearchPlanVersion}})],1)}),[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("label",{staticClass:"col-md-4 col-form-label tw-font-bold tw-pt-0"},[e._v(" แผนประมาณการ "),i("br"),e._v(" จำหน่ายประจำปี ")])}],!1,null,null,null).exports},51900:(e,t,i)=>{"use strict";function n(e,t,i,n,a,r,s,o){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),n&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),s?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=l):a&&(l=o?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(e,t){return l.call(t),p(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}i.d(t,{Z:()=>n})},7398:function(e){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){},function(e,t,i){"use strict";i.r(t);var n="undefined"!=typeof window?window.HTMLElement:Object,a={mounted:function(){this.enforceFocus&&document.addEventListener("focusin",this.focusIn)},methods:{focusIn:function(e){if(this.isActive&&e.target!==this.$el&&!this.$el.contains(e.target)){var t=this.container?this.container:this.isFullPage?null:this.$el.parentElement;(this.isFullPage||t&&t.contains(e.target))&&(e.preventDefault(),this.$el.focus())}}},beforeDestroy:function(){document.removeEventListener("focusin",this.focusIn)}};function r(e,t,i,n,a,r,s,o){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),n&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),s?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=l):a&&(l=o?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(e,t){return l.call(t),p(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}var s=r({name:"spinner",props:{color:{type:String,default:"#000"},height:{type:Number,default:64},width:{type:Number,default:64}}},(function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",width:this.width,height:this.height,stroke:this.color}},[t("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[t("g",{attrs:{transform:"translate(1 1)","stroke-width":"2"}},[t("circle",{attrs:{"stroke-opacity":".25",cx:"18",cy:"18",r:"18"}}),t("path",{attrs:{d:"M36 18c0-9.94-8.06-18-18-18"}},[t("animateTransform",{attrs:{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.8s",repeatCount:"indefinite"}})],1)])])])}),[],!1,null,null,null).exports,o=r({name:"dots",props:{color:{type:String,default:"#000"},height:{type:Number,default:240},width:{type:Number,default:60}}},(function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:this.color,width:this.width,height:this.height}},[t("circle",{attrs:{cx:"15",cy:"15",r:"15"}},[t("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),t("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})]),t("circle",{attrs:{cx:"60",cy:"15",r:"9","fill-opacity":"0.3"}},[t("animate",{attrs:{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}}),t("animate",{attrs:{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"}})]),t("circle",{attrs:{cx:"105",cy:"15",r:"15"}},[t("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),t("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})])])}),[],!1,null,null,null).exports,l=r({name:"bars",props:{color:{type:String,default:"#000"},height:{type:Number,default:40},width:{type:Number,default:40}}},(function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",height:this.height,width:this.width,fill:this.color}},[t("rect",{attrs:{x:"0",y:"13",width:"4",height:"5"}},[t("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}}),t("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}})]),t("rect",{attrs:{x:"10",y:"13",width:"4",height:"5"}},[t("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}}),t("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}})]),t("rect",{attrs:{x:"20",y:"13",width:"4",height:"5"}},[t("animate",{attrs:{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}}),t("animate",{attrs:{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}})])])}),[],!1,null,null,null).exports,c=r({name:"vue-loading",mixins:[a],props:{active:Boolean,programmatic:Boolean,container:[Object,Function,n],isFullPage:{type:Boolean,default:!0},enforceFocus:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!1},transition:{type:String,default:"fade"},canCancel:Boolean,onCancel:{type:Function,default:function(){}},color:String,backgroundColor:String,blur:{type:String,default:"2px"},opacity:Number,width:Number,height:Number,zIndex:Number,loader:{type:String,default:"spinner"}},data:function(){return{isActive:this.active}},components:{Spinner:s,Dots:o,Bars:l},beforeMount:function(){this.programmatic&&(this.container?(this.isFullPage=!1,this.container.appendChild(this.$el)):document.body.appendChild(this.$el))},mounted:function(){this.programmatic&&(this.isActive=!0),document.addEventListener("keyup",this.keyPress)},methods:{cancel:function(){this.canCancel&&this.isActive&&(this.hide(),this.onCancel.apply(null,arguments))},hide:function(){var e=this;this.$emit("hide"),this.$emit("update:active",!1),this.programmatic&&(this.isActive=!1,setTimeout((function(){var t;e.$destroy(),void 0!==(t=e.$el).remove?t.remove():t.parentNode.removeChild(t)}),150))},disableScroll:function(){this.isFullPage&&this.lockScroll&&document.body.classList.add("vld-shown")},enableScroll:function(){this.isFullPage&&this.lockScroll&&document.body.classList.remove("vld-shown")},keyPress:function(e){27===e.keyCode&&this.cancel()}},watch:{active:function(e){this.isActive=e},isActive:function(e){e?this.disableScroll():this.enableScroll()}},computed:{bgStyle:function(){return{background:this.backgroundColor,opacity:this.opacity,backdropFilter:"blur(".concat(this.blur,")")}}},beforeDestroy:function(){document.removeEventListener("keyup",this.keyPress)}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:e.transition}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"isActive"}],staticClass:"vld-overlay is-active",class:{"is-full-page":e.isFullPage},style:{zIndex:e.zIndex},attrs:{tabindex:"0","aria-busy":e.isActive,"aria-label":"Loading"}},[i("div",{staticClass:"vld-background",style:e.bgStyle,on:{click:function(t){return t.preventDefault(),e.cancel(t)}}}),i("div",{staticClass:"vld-icon"},[e._t("before"),e._t("default",[i(e.loader,{tag:"component",attrs:{color:e.color,width:e.width,height:e.height}})]),e._t("after")],2)])])}),[],!1,null,null,null).exports,p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{show:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,r={programmatic:!0},s=Object.assign({},t,n,r),o=new(e.extend(c))({el:document.createElement("div"),propsData:s}),l=Object.assign({},i,a);return Object.keys(l).map((function(e){o.$slots[e]=l[e]})),o}}};i(0),c.install=function(e){var t=p(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{});e.$loading=t,e.prototype.$loading=t},t.default=c}]).default},2223:(e,t,i)=>{var n=i(29040);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,i(45346).Z)("22571fa1",n,!0,{})},65619:(e,t,i)=>{var n=i(84152);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,i(45346).Z)("60c6b412",n,!0,{})}}]);