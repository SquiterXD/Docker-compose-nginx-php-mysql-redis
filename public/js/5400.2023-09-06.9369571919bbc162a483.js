(self.webpackChunk=self.webpackChunk||[]).push([[5400],{85400:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>n});var i=a(20559),s=a(67791);const l={props:["btnTrans"],data:function(){return{policy:{mode:"edit"},vars:s.gR,funcs:s.sD}},components:{FormPolicyGroup:i.Z}};const n=(0,a(51900).Z)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("form-policy-group",{attrs:{policy:t.policy,vars:t.vars,setYearCE:t.funcs.setYearCE,"btn-trans":t.btnTrans}})],1)}),[],!1,null,null,null).exports},20559:(t,e,a)=>{"use strict";a.d(e,{Z:()=>h});var i=a(4510),s=a(14766);const l={name:"ir-components-lov-policy-set-header-id",data:function(){return{rows:[],loading:!1,result:parseInt(this.value)?parseInt(this.value):""}},props:["value","name","size"],methods:{getDataRows:function(t){var e=this;this.loading=!0,axios.get("/ir/ajax/lov/policy-set-header",{params:t}).then((function(t){var a=t.data;e.loading=!1,e.rows=a.data})).catch((function(t){swal("Error",t,"error")}))},change:function(t){this.$emit("changePolicyHeader",t)}},mounted:function(){this.getDataRows({policy_set_header_id:"",keyword:""})},watch:{value:function(t){this.result=parseInt(t)?parseInt(t):""}}};var n=a(51900);const r=(0,n.Z)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"el_field"},[a("el-select",{attrs:{placeholder:"กรมธรรม์ชุดที่",name:t.name,loading:t.loading,remote:"",clearable:!0,filterable:"",size:t.size},on:{change:t.change},model:{value:t.result,callback:function(e){t.result=e},expression:"result"}},t._l(t.rows,(function(t,e){return a("el-option",{key:e,attrs:{label:t.policy_set_number+" : "+t.policy_set_description,value:t.policy_set_header_id}})})),1)],1)}),[],!1,null,null,null).exports;var o=a(30381),c=a.n(o);function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){u(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function _(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return m(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}const f={name:"ir-form-policy-group",data:function(){return{data:{policy_set:[]},policyGroup:[],group_code:"",group_description:"",value:"",loading:!1,policyGroup_id:"",dataTable:{policy_list:[]},group_header_id:null,pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"Today",onClick:function(t){t.$emit("pick",new Date)}},{text:"Yesterday",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"A week ago",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},dialogVisible:!1,detail:{detailPolicyList:[]},policies:[],companies:[],showTable:!1,modalId:0,rules:{policy_set_header_id:[{required:!0,message:"กรุณาระบุกรมธรรม์",trigger:"change"}],company_code:[{required:!0,message:"กรุณาระบุบริษัทประกัน",trigger:"change"}],company_percent:[{required:!0,message:"กรุณาระบุสัดส่วน",trigger:"change"}],premium_rate:[{required:!0,message:"กรุณาระบุอัตราเบี้ย",trigger:"change"}],prepaid_insurance:[{required:!0,message:"กรุณาระบุเบี้ยประกันจ่ายล่วงหน้า",trigger:"change"}],year:[{required:!0,message:"กรุณาระบุปี",trigger:"change"}]},modalIndexActive:0,dateFormat:"DD/MM/YYYY",valid:!0,errors:[],modal_open:!1}},props:["policy","policyGroupHeader","headerLovUrl","groupLineUrl","vars","setYearCE","btnTrans"],methods:{getPolicyGroupDetail:function(){var t=this,e=window.location.href.split("/").pop();axios.get("/ir/ajax/policy-group/".concat(e)).then((function(a){var i=a.data;t.data.policy_set=[].concat(_(t.data.policy_set),_(i.data)),t.group_code=i.data.length>0?i.data[0].group_code:"",t.group_description=i.data.length>0?i.data[0].group_description:"",t.group_header_id=e,t.dataTable.policy_list=_(i.rows),null!=t.data.policy_set[0].policy_set_header_id&&""!=t.data.policy_set[0].policy_set_header_id||(t.valid=!1)})).catch((function(t){swal("Error",t,"error")}))},addRow:function(){var t=this;this.data.policy_set.push({policy_set_header_id:"",policy_set_description:"",group_header_id:"",flg:"add"}),this.$nextTick((function(){var e=t.$el.getElementsByClassName("endTable")[0];e&&e.scrollIntoView()}))},clickRemove:function(t,e){var a=this;if(e.group_header_id){var i={group_set_id:e.group_set_id,group_header_id:e.group_header_id};this.loading=!0,axios.delete("/ir/ajax/policy-group/group-sets",{params:i}).then((function(e){e.data;a.loading=!1,a.data.policy_set.splice(t,1),swal({title:"Success",text:"บันทึกสำเร็จ",type:"success"})})).catch((function(t){400===t.response.data.status?swal({title:"Warning",text:t.response.data.message,timer:3e3,type:"warning"}):swal({title:"Error",text:t.response.data.message,timer:3e3,type:"error"})}))}else this.data.policy_set.splice(t,1)},getPolicyGroupLov:function(t){var e=this;this.loading=!0,axios.get("".concat(this.headerLovUrl),{params:t}).then((function(t){var a=t.data;e.loading=!1,e.policyGroup=a.data}))},remoteMethod:function(t){""!==t?(parseInt(t),this.getPolicyGroupLov({group_header_id:t})):this.policyGroup=[]},handleAssign:function(){var t=this;this.$refs.assign.validate((function(e){if(!e)return!1;t.showTable=!0}))},handleCancel:function(){window.location.replace("/ir/settings/policy-group")},addDetailPolicyList:function(){this.detail.detailPolicyList.push({company_code:"",company_percent:"",user_policy_number:"",comments:"",flg:"add",default_diff_amount:!1})},clickRemoveDetailFlgAdd:function(t){this.detail.detailPolicyList.splice(t,1)},getPolicyLov:function(t){var e=this;this.loading=!0,axios.get("/ir/ajax/lov/policy-set-header",{params:t}).then((function(t){var a=t.data;e.loading=!1,e.policies=a.data}))},getCompanies:function(t){var e=this;axios.get("/ir/ajax/lov/companies",{params:t}).then((function(t){var a=t.data;e.loading=!1,e.companies=a.data}))},focusPolicies:function(t){this.getPolicyLov({policy_set_header_id:""})},savePolicyGroup:function(){var t=this;this.$refs.save_line.validate((function(e){var a=function(t){return 0===Object.keys(t).length};if(t.dataTable.policy_list.find((function(t){return t.group_dists_rows.some(a)})))swal({title:"Warning",text:"กรุณาเพิ่มรายละเอียดบริษัทประกัน!",type:"warning"});else{var i=[];t.dataTable.policy_list.map((function(t){var e=p(p({},t),{},{group_line_id:void 0===t.group_line_id?"":t.group_line_id,start_date:t.start_date,end_date:t.end_date});i.push(e)}));var s={data:{group_code:t.group_code,group_description:t.group_description,active_flag:t.policy.active_flag||"Y"===t.policy.active_flag?t.policy.active_flag="Y":t.policy.active_flag="N",program_code:"IRM0003",policy_sets_rows:t.data.policy_set.map((function(t){return{policy_set_header_id:t.policy_set_header_id,group_set_id:t.group_set_id}})),policy_lines_rows:i,group_header_id:t.group_header_id}};t.dataTable.policy_list.length>0?t.$refs.save_line.validate((function(e){e&&t.reqDate()&&axios.post("/ir/ajax/policy-group/save",s).then((function(e){e.data;t.loading=!1,swal({title:"Success",text:"บันทึกสำเร็จ",type:"success",showCancelButton:!1,showConfirmButton:!0},(function(t){window.location.href="/ir/settings/policy-group"}))})).catch((function(t){400===t.response.data.status?swal({title:"Warning",text:t.response.data.message,timer:3e3,type:"warning"}):swal({title:"Error",text:t.response.data.message,timer:3e3,type:"error"})}))})):axios.post("/ir/ajax/policy-group/save",s).then((function(e){e.data;t.loading=!1,swal({title:"Success",text:"บันทึกสำเร็จ",type:"success",showCancelButton:!1,showConfirmButton:!0},(function(t){window.location.href="/ir/settings/policy-group"}))})).catch((function(t){400===t.response.data.status?swal({title:"Warning",text:t.response.data.message,timer:3e3,type:"warning"}):swal({title:"Error",text:t.response.data.message,timer:3e3,type:"error"})}))}}))},clickModal:function(t,e){""==e.year?(this.modal_open=!1,this.$refs.save_line.validateField("policy_list."+t+".year"),swal({title:"Warning",text:"กรุณาใส่ข้อมูลปีงบประมาณ!",type:"warning"})):(this.modal_open=!0,this.dialogVisible=!0,this.modalId=t,this.modalIndexActive=t,Object.keys(e.group_dists_rows[0]).length>0?this.detail.detailPolicyList=JSON.parse(JSON.stringify(_(e.group_dists_rows[0]))):this.detail.detailPolicyList=[])},submitModal:function(){var t=this;this.detail.detailPolicyList.find((function(t){return t.default_diff_amount}))?this.$refs.modal.validate((function(e){var a,i;e&&(t.checkSumOverdue()||(a=t.detail.detailPolicyList.map((function(t){return t.company_code})),(i=a.some((function(t,e){return a.indexOf(t)!=e})))&&swal({title:"Warning",text:"บริษัทประกันห้ามซ้ำกัน!",type:"warning"}),i)||(t.dataTable.policy_list[t.modalIndexActive].group_dists_rows=JSON.parse(JSON.stringify([_(t.detail.detailPolicyList)])),t.dialogVisible=!1,t.savePolicyGroup()))})):swal({title:"Warning",text:"กรุณาระบุข้อมูลให้ครบ",type:"warning"})},getDateStart:function(t,e){var a=this;null===t?(a.dataTable.policy_list[e].start_date="",a.dataTable.policy_list[e].start_timer="",this.$refs.save_line.validateField("policy_list.".concat(e,".start_date"))):(a.dataTable.policy_list[e].start_date=c()(t).format(a.dateFormat),a.dataTable.policy_list[e].start_timer=c()(t).unix(),a.checkDateOverlap(c()(t).format(a.dateFormat),e),this.$refs.save_line.fields.find((function(t){return t.prop=="policy_list.".concat(e,".start_date")})).clearValidate())},getDateEnd:function(t,e){var a=this;null===t?(a.dataTable.policy_list[e].end_date="",a.dataTable.policy_list[e].end_timer="",this.$refs.save_line.validateField("policy_list.".concat(e,".end_date"))):(a.dataTable.policy_list[e].end_date=c()(t).format(a.dateFormat),a.dataTable.policy_list[e].end_timer=c()(t).unix(),a.checkDateOverlap(c()(t).format(a.dateFormat),e),this.$refs.save_line.fields.find((function(t){return t.prop=="policy_list.".concat(e,".end_date")})).clearValidate())},reqDate:function(){return!!this.checkCalculateDate()||(swal({title:"Warning",text:"ฟิลด์วันที่เริ่มต้นต้องน้อยกว่าหรือเท่ากับฟิลด์วันที่สิ้นสุด!",type:"warning"}),!1)},checkCalculateDate:function(){var t,e=null,a=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=y(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0,s=function(){};return{s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,n=!0,r=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){r=!0,l=t},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw l}}}}(this.dataTable.policy_list);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.start_timer<=i.end_timer)e=!0;else{if(i.start_timer>i.end_timer)return void(e=!1);e=!0}}}catch(t){a.e(t)}finally{a.f()}return e},checkDateOverlap:function(t,e){var a=this,i={data:{policy_lines_rows:a.dataTable.policy_list.map((function(t){return{start_date:t.start_date,end_date:t.end_date}})),date:t,index_number:e}};axios.post("/ir/ajax/policy-group/overlap-check",i).then((function(t){a.dataTable.policy_list[e].isOverlap=!1})).catch((function(t){a.dataTable.policy_list[e].isOverlap=!0,400===t.response.data.status?swal({title:"Warning",text:t.response.data.message,type:"warning"}):swal({title:"Error",text:t.response.data.message,type:"error"})}))},checkSumOverdue:function(){var t=0;return this.detail.detailPolicyList.map((function(e){t+=+e.company_percent})),t>100?(swal({title:"Warning",text:"สัดส่วนรวมกันต้องไม่เกิน 100%",type:"warning"}),!0):t<100?(swal({title:"Warning",text:"สัดส่วนรวมกันต้องได้ 100%",type:"warning"}),!0):100!==t&&void 0},handleCompanies:function(t,e){if(t)for(var a in this.companies){var i=this.companies[a];t===i.company_number&&(this.detail.detailPolicyList[e].company_id=i.company_id)}},handleAddRow:function(){var t=this;t.dataTable.policy_list.push({start_date:"",start_timer:"",end_date:"",end_timer:"",revenue_stamp:"",tax:"",premium_rate:0,prepaid_insurance:0,flg:"add",group_dists_rows:[{}],year:""}),t.$nextTick((function(){var e=t.$el.getElementsByClassName("endTableLines")[0];e&&e.scrollIntoView()}))},clickRemoveFlgAdd:function(t){this.dataTable.policy_list.splice(t,1)},setDate:function(t){var e="";if(t&&null!=t){var a=t?t.split("/"):t,i=+a[2]-543;e="".concat(a[0],"/").concat(a[1],"/").concat(i)}return e},receivedFullDate:function(t){},selectPolicy:function(t,e){this.valid=!0,this.data.policy_set[e].policy_set_header_id=t,this.checkDuplicatePolicyGroup(t,e)},remoteMethodPolicy:function(t){this.getPolicyLov({policy_set_header_id:"",keyword:t})},checkDuplicatePolicyGroup:function(t,e){var a=this,i={group_header_id:this.group_header_id};axios.get("/ir/ajax/policy-group/duplicate-check/".concat(t),{params:i}).then((function(t){for(var i=0;i<a.data.policy_set.length;i++){var s=JSON.parse(JSON.stringify(a.data.policy_set.map((function(t){return t.policy_set_header_id})))),l=a.data.policy_set[i].policy_set_header_id.toString();if(s.splice(i,1),s.includes(l))return swal({title:"Warning",text:"กรมธรรม์ห้ามซ้ำกันภายในกลุ่ม",type:"warning"}),void(a.data.policy_set[e].policy_set_header_id="")}})).catch((function(t){a.data.policy_set[e].policy_set_header_id="",400===t.response.data.status?swal({title:"Warning",text:t.response.data.message,type:"warning"}):swal({title:"Error",text:t.response.data.message,type:"error"}),null!=a.data.policy_set[0].policy_set_header_id&&""!=a.data.policy_set[0].policy_set_header_id||(a.valid=!1)}))},closeModal:function(){this.detail.detailPolicyList=[]},getValueYear:function(t,e){var a=this.vars.formatYear;t?(this.dataTable.policy_list[e].year=c()(t).format(a),this.$refs.save_line.fields.find((function(t){return t.prop=="policy_list."+e+".year"})).clearValidate()):(this.dataTable.policy_list[e].year="",this.dataTable.policy_list[e].start_date="",this.dataTable.policy_list[e].end_date="",this.$refs.save_line.validateField("policy_list."+e+".year")),this.checkYearDuplicate(this.dataTable.policy_list[e].year,e)},getDataInsuranceDate:function(t,e){var a=this,i={year:this.setYearCE("year",t),keyword:""};axios.get("/ir/ajax/lov/effective-date",{params:i}).then((function(t){var i=t.data.data;null===i?(a.dataTable.policy_list[e].start_date="",a.dataTable.policy_list[e].end_date="",a.$refs.save_line.validateField("policy_list."+e+".start_date"),a.$refs.save_line.validateField("policy_list."+e+".end_date")):(a.dataTable.policy_list[e].start_date=i.start_date_active,a.dataTable.policy_list[e].end_date=i.end_date_active,a.$refs.save_line.fields.find((function(t){return t.prop=="policy_list."+e+".start_date"})).clearValidate(),a.$refs.save_line.fields.find((function(t){return t.prop=="policy_list."+e+".end_date"})).clearValidate())})).catch((function(t){swal("Error",t,"error")}))},checkYearDuplicate:function(t,e){var a=this.dataTable.policy_list,i=this,s=a.map((function(t){return t.year}));s.some((function(t,e){if(t)return s.indexOf(t)!=e}))&&swal({title:"Warning",text:"ปีห้ามซ้ำ!",type:"warning"},(function(t){t&&(a[e].year="",i.$refs.save_line.validateField("policy_list."+e+".year"))}))},checkDefaultDiff:function(t,e){t.default_diff_amount&&this.detail.detailPolicyList.forEach((function(a,i){1!=a.default_diff_amount&&"Y"!=a.default_diff_amount||i!=e&&(t.default_diff_amount=!1,swal({title:"Warning",text:"มีการระบุบริษัทประกันอื่นเรียบร้อยแล้ว กรุณาตรวจสอบ",type:"warning"}))}))}},computed:{disabledField:function(){return"edit"===this.action}},mounted:function(){this.getPolicyGroupDetail(),this.getPolicyLov({policy_set_header_id:""}),this.getCompanies({company_id:"",company_name:""})},components:{dateInput:s.Z,currencyInput:i.Z,lovPolicyHeaderId:r}};const h=(0,n.Z)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"col-12"},[a("div",{staticClass:"row mt-2 mb-1"},[a("div",{staticClass:"col-xl-7 col-md-7 offset-md-3"},[a("div",{staticClass:"form-group row"},[a("div",{staticClass:"col-lg-3 col-md-3 alig-item-center"},[a("el-input",{attrs:{type:"text",name:"policy_set_number",disabled:!0,maxlength:100},model:{value:t.group_code,callback:function(e){t.group_code=e},expression:"group_code"}})],1),t._v(" "),a("div",{staticClass:"col-lg-5 col-md-5 alig-item-center"},[a("el-input",{attrs:{type:"text",name:"policy_set_number",maxlength:150},model:{value:t.group_description,callback:function(e){t.group_description=e},expression:"group_description"}})],1),t._v(" "),a("div",{staticClass:"col-lg-4 col-md-4 alig-item-center"},[a("button",{class:t.btnTrans.addList.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.addRow()}}},[a("i",{class:t.btnTrans.addList.icon}),t._v("\n                "+t._s(t.btnTrans.addList.text)+"ชุดกรมธรรม์\n              ")])])])])]),t._v(" "),a("el-form",{ref:"assign",staticClass:"form_table_line",attrs:{model:t.data}},[a("div",{staticClass:"col-8 offset-md-2"},[a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered center"},[a("thead",[a("tr",[a("th",{staticClass:"text-center",staticStyle:{width:"70px"}},[t._v("กรมธรรม์ชุดที่ (Policy No) "),a("span",{staticClass:"text-danger"},[t._v(" * ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"25px"}},[t._v("Action")])])]),t._v(" "),a("tbody",t._l(t.data.policy_set,(function(e,i){return a("tr",{key:i,class:[i==t.data.policy_set.length-1?"endTable":""]},[a("th",{staticClass:"el_field"},[a("el-form-item",{staticClass:"el-form-item-irm0003 pb-2",attrs:{prop:"policy_set."+i+".policy_set_header_id",rules:t.rules.policy_set_header_id}},[a("lov-policy-header-id",{attrs:{value:e.policy_set_header_id},on:{changePolicyHeader:function(e){for(var a=arguments.length,s=Array(a);a--;)s[a]=arguments[a];return t.selectPolicy.apply(void 0,s.concat([i]))}},model:{value:e.policy_set_header_id,callback:function(a){t.$set(e,"policy_set_header_id",a)},expression:"policy.policy_set_header_id"}})],1)],1),t._v(" "),a("th",{staticClass:"el_field text-center"},[a("button",{class:t.btnTrans.delete.class+" btn-sm tw-w-25",staticStyle:{"margin-top":"6px"},attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),t.clickRemove(i,e)}}},[a("i",{class:t.btnTrans.delete.icon}),t._v("\n                      "+t._s(t.btnTrans.delete.text)+"\n                    ")])])])})),0)])])])]),t._v(" "),""!=t.data.policy_set?[a("div",{staticClass:"hr-line-dashed"}),t._v(" "),a("div",{staticClass:"col-12 pr-0 mb-2 text-right"},[t.valid?a("button",{class:t.btnTrans.assign.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.handleAssign()}}},[a("i",{class:t.btnTrans.assign.icon}),t._v("\n              "+t._s(t.btnTrans.assign.text)+"\n            ")]):t._e(),t._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:t.showTable,expression:"showTable"}],class:t.btnTrans.addList.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.handleAddRow()}}},[a("i",{class:t.btnTrans.addList.icon}),t._v("\n              "+t._s(t.btnTrans.addList.text)+"รายการ\n            ")])])]:t._e()],2),t._v(" "),a("el-form",{ref:"save_line",staticClass:"form_table_line",attrs:{model:t.dataTable,rules:t.rules}},[a("div",{staticClass:"col-12"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTable,expression:"showTable"}],staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table_style"},[a("thead",[a("tr",[a("th",{staticClass:"text-center",staticStyle:{width:"250px"}},[t._v("ปีงบประมาณ "),a("span",{staticClass:"text-danger"},[t._v(" * ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"150px"}},[t._v("อากรแสตมป์ (%)")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"150px"}},[t._v("ภาษี (%)")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"150px"}},[t._v("อัตราเบี้ย (%) "),a("span",{staticClass:"text-danger"},[t._v(" * ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"300px"}},[t._v("เบี้ยประกันจ่ายล่วงหน้า (%) "),a("span",{staticClass:"text-danger"},[t._v(" * ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"250px"}},[t._v("Management")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"100px"}},[t._v("Action")])])]),t._v(" "),a("tbody",[t._l(t.dataTable.policy_list,(function(e,i){return a("tr",{directives:[{name:"show",rawName:"v-show",value:t.dataTable.policy_list.length,expression:"dataTable.policy_list.length"}],key:i,class:[i==t.dataTable.policy_list.length-1?"endTableLines":""]},[a("th",{staticClass:"el_field",staticStyle:{width:"150px"}},[a("el-form-item",{staticClass:"el-input--small el-form-item-irm0003 pb-2",attrs:{prop:"policy_list."+i+".year",rules:t.rules.year}},[a("datepicker-th",{staticClass:"el-input__inner style_icon_calendar",staticStyle:{width:"100%","line-height":"30px"},attrs:{name:"year"+i,"p-type":"year",placeholder:"ปีงบประมาณ",format:t.vars.formatYear,inputClass:"input_date_small"},on:{dateWasSelected:function(e){for(var a=arguments.length,s=Array(a);a--;)s[a]=arguments[a];return t.getValueYear.apply(void 0,s.concat([i]))}},model:{value:e.year,callback:function(a){t.$set(e,"year",a)},expression:"policy_detail.year"}})],1)],1),t._v(" "),a("th",{staticClass:"text-right el_field currency_right"},[a("el-form-item",{staticClass:"currency_right el-form-item-irm0003 pb-2"},[a("currency-input",{staticClass:"currency_right",attrs:{placeholder:"อากรแสตมป์",disabled:!1,decimal:5,sizeSmall:!0},model:{value:e.revenue_stamp,callback:function(a){t.$set(e,"revenue_stamp",a)},expression:"policy_detail.revenue_stamp"}})],1)],1),t._v(" "),a("th",{staticClass:"el_field"},[a("el-form-item",{staticClass:"currency_right el-form-item-irm0003 pb-2"},[a("currency-input",{attrs:{placeholder:"ภาษี",sizeSmall:!0,disabled:!1},model:{value:e.tax,callback:function(a){t.$set(e,"tax",a)},expression:"policy_detail.tax"}})],1)],1),t._v(" "),a("th",{staticClass:"el_field"},[a("el-form-item",{staticClass:"currency_right el-form-item-irm0003 pb-2",attrs:{prop:"policy_list."+i+".premium_rate",rules:t.rules.premium_rate}},[a("currency-input",{attrs:{placeholder:"อัตราเบี้ย",disabled:!1,sizeSmall:!0,decimal:5},model:{value:e.premium_rate,callback:function(a){t.$set(e,"premium_rate",a)},expression:"policy_detail.premium_rate"}})],1)],1),t._v(" "),a("th",{staticClass:"el_field"},[a("el-form-item",{staticClass:"currency_right el-form-item-irm0003 pb-2",attrs:{prop:"policy_list."+i+".prepaid_insurance",rules:t.rules.prepaid_insurance}},[a("currency-input",{attrs:{placeholder:"เบี้ยประกันจ่ายล่วงหน้า",sizeSmall:!0,disabled:!1},model:{value:e.prepaid_insurance,callback:function(a){t.$set(e,"prepaid_insurance",a)},expression:"policy_detail.prepaid_insurance"}})],1)],1),t._v(" "),a("th",{staticClass:"text-center pb-2",staticStyle:{width:"120px"}},[a("button",{class:t.btnTrans.addList.class+" btn-sm tw-w-25",attrs:{type:"button","data-toggle":"modal","data-target":"#modal_detail"+i},on:{click:function(a){return t.clickModal(i,e)}}},[a("i",{class:t.btnTrans.addList.icon}),t._v("\n                        "+t._s(t.btnTrans.addList.text)+"รายละเอียด\n                      ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"120px"}},[void 0!==e.flg?a("el-form-item",{staticClass:"el-form-item-irm0003 pb-2"},[a("button",{class:t.btnTrans.delete.class+" btn-sm tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.clickRemoveFlgAdd(i)}}},[a("i",{class:t.btnTrans.delete.icon}),t._v("\n                        "+t._s(t.btnTrans.delete.text)+"\n                      ")])]):t._e()],1)])})),t._v(" "),a("tr",{directives:[{name:"show",rawName:"v-show",value:0===t.dataTable.policy_list.length,expression:"dataTable.policy_list.length === 0"}],staticClass:"text-center"},[a("td",{attrs:{colspan:"9"}},[t._v("ไม่มีข้อมูล")])])],2),t._v(" "),a("tfoot")])]),t._v(" "),t.showTable?a("div",{staticClass:"col-12 p-0 text-right"},[a("button",{class:t.btnTrans.save.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.savePolicyGroup()}}},[a("i",{class:t.btnTrans.save.icon}),t._v("\n                "+t._s(t.btnTrans.save.text)+"\n              ")]),t._v(" "),a("button",{class:t.btnTrans.cancel.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.handleCancel()}}},[a("i",{class:t.btnTrans.cancel.icon}),t._v("\n                "+t._s(t.btnTrans.cancel.text)+"\n              ")])]):t._e()])]),t._v(" "),this.modal_open?a("div",[a("div",{staticClass:"modal inmodal fade",attrs:{"data-backdrop":"static","data-keyboard":"false",id:"modal_detail"+t.modalId,tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-xl"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return t.closeModal()}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),a("span",{staticClass:"sr-only"},[t._v("Close")])]),t._v(" "),a("p",{staticClass:"modal-title text-left"})]),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"col-12 mb-3 text-right"},[a("button",{class:t.btnTrans.addList.class+" btn-lg tw-w-25",staticStyle:{height:"35px"},attrs:{type:"button"},on:{click:function(e){return t.addDetailPolicyList()}}},[a("i",{class:t.btnTrans.addList.icon}),t._v("\n                  "+t._s(t.btnTrans.addList.text)+"รายละเอียด\n                ")])]),t._v(" "),a("el-form",{ref:"modal",staticClass:"form_table_line",attrs:{model:t.detail}},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered table_style"},[a("thead",[a("tr",[a("th",{staticClass:"text-center",staticStyle:{width:"300px"}},[t._v("บริษัทประกัน "),a("span",{staticClass:"text-danger"},[t._v(" * ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"150px"}},[t._v("สัดส่วน(%) "),a("span",{staticClass:"text-danger"},[t._v(" * ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"150px"}},[t._v("เลขที่กรมธรรม์")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"150px"}},[t._v("เลขที่สลักหลัง")]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"150px"}},[t._v("ปัดเศษทศนิยมส่ง AP "),a("span",{staticClass:"text-danger"},[t._v(" * ")])]),t._v(" "),a("th",{staticClass:"text-center",staticStyle:{width:"100px"}},[t._v("Action")])])]),t._v(" "),a("tbody",[t._l(t.detail.detailPolicyList,(function(e,i){return a("tr",{key:i},[a("td",{staticClass:"el_field"},[a("el-form-item",{staticClass:"el-form-item-irm0003 pb-2 mt-4",attrs:{prop:"detailPolicyList."+i+".company_code",rules:t.rules.company_code}},[a("el-select",{staticClass:"w-100",attrs:{filterable:"",name:"policy_id",loading:t.loading,clearable:!0,remote:"","popper-append-to-body":!1},on:{change:function(e){for(var a=arguments.length,s=Array(a);a--;)s[a]=arguments[a];return t.handleCompanies.apply(void 0,s.concat([i]))}},model:{value:e.company_code,callback:function(a){t.$set(e,"company_code",a)},expression:"policy.company_code"}},t._l(t.companies,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_number+" : "+t.company_name,value:t.company_number}})})),1)],1)],1),t._v(" "),a("td",{staticClass:"el_field"},[a("el-form-item",{staticClass:"el-form-item-irm0003 pb-2 mt-4",attrs:{prop:"detailPolicyList."+i+".company_percent",rules:t.rules.company_percent}},[a("currency-input",{attrs:{placeholder:"สัดส่วน",disabled:!1},model:{value:e.company_percent,callback:function(a){t.$set(e,"company_percent",a)},expression:"policy.company_percent"}})],1)],1),t._v(" "),a("td",{staticClass:"el_field"},[a("el-input",{staticClass:"el-form-item-irm0003 pb-2",attrs:{maxlength:150},model:{value:e.user_policy_number,callback:function(a){t.$set(e,"user_policy_number",a)},expression:"policy.user_policy_number"}})],1),t._v(" "),a("td",{staticClass:"el_field"},[a("el-input",{staticClass:"el-form-item-irm0003 pb-2",attrs:{maxlength:1e3},model:{value:e.comments,callback:function(a){t.$set(e,"comments",a)},expression:"policy.comments"}})],1),t._v(" "),a("td",{staticClass:"el_field text-center"},[a("el-checkbox",{staticClass:"el-form-item-irm0003 pb-2 mt-3",attrs:{checked:"Y"==e.default_diff_amount},on:{change:function(a){return t.checkDefaultDiff(e,i)}},model:{value:e.default_diff_amount,callback:function(a){t.$set(e,"default_diff_amount",a)},expression:"policy.default_diff_amount"}})],1),t._v(" "),a("td",{staticClass:"el_field text-center"},[void 0!==e.flg?a("el-form-item",{staticClass:"el-form-item-irm0003 pb-2 mt-3"},[a("button",{class:t.btnTrans.delete.class+" btn-sm tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.clickRemoveDetailFlgAdd(i)}}},[a("i",{class:t.btnTrans.delete.icon}),t._v("\n                                  "+t._s(t.btnTrans.delete.text)+"\n                                ")])]):t._e()],1)])})),t._v(" "),a("tr",{directives:[{name:"show",rawName:"v-show",value:0===t.dataTable.policy_list.length,expression:"dataTable.policy_list.length === 0"}],staticClass:"text-center"},[a("td",{attrs:{colspan:"9"}},[t._v("ไม่มีข้อมูล")])])],2),t._v(" "),a("tfoot")])])])])],1),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{class:t.btnTrans.save.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.submitModal()}}},[a("i",{class:t.btnTrans.save.icon}),t._v("\n                "+t._s(t.btnTrans.save.text)+"\n              ")])])])])])]):t._e()],1)}),[],!1,null,null,null).exports}}]);