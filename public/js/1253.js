(self.webpackChunk=self.webpackChunk||[]).push([[1253],{50483:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>n});var a=s(23645),l=s.n(a)()((function(t){return t[1]}));l.push([t.id,".v--modal-overlay[data-v-61c295b8]{z-index:2000;padding-top:3rem;padding-bottom:3rem}",""]);const n=l},11253:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>D});var a=s(87757),l=s.n(a),n=s(80455),i=s.n(n),r=s(7398),c=s.n(r),o=(s(2223),s(30381)),u=s.n(o);function _(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function d(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?_(Object(s),!0).forEach((function(e){p(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function p(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function m(t,e,s,a,l,n,i){try{var r=t[n](i),c=r.value}catch(t){return void s(t)}r.done?e(c):Promise.resolve(c).then(a,l)}function v(t){return function(){var e=this,s=arguments;return new Promise((function(a,l){var n=t.apply(e,s);function i(t){m(n,a,l,i,r,"next",t)}function r(t){m(n,a,l,i,r,"throw",t)}i(void 0)}))}}const f={props:["modalName","modalWidth","modalHeight","sampleResultLine"],components:{Loading:c()},watch:{sampleResultLine:function(t){this.sampleResultLineData=t||null}},data:function(){return{isLoading:!1,width:this.modalWidth,sampleResultLineData:this.sampleResultLine?this.sampleResultLine:null}},created:function(){this.handleResize()},mounted:function(){},methods:{handleResize:function(){window.innerWidth<768?this.width="90%":window.innerWidth<992?this.width="80%":this.width=this.modalWidth},onDeleteResultLineImage:function(t){var e=this;return v(l().mark((function s(){var a;return l().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=d({},e.sampleResultLineData.uploadedImages[t]),s.next=3,e.deleteResultLineImage(e.sampleResultLineData,a);case 3:e.sampleResultLineData.uploadedImages.splice(t,1),e.$emit("onModalResultLineImageChanged",{sampleResultLine:e.sampleResultLineData});case 5:case"end":return s.stop()}}),s)})))()},deleteResultLineImage:function(t,e){var s=this;return v(l().mark((function a(){var n;return l().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n={sample_result_line:JSON.stringify(t),uploaded_image:JSON.stringify(e)},s.isLoading=!0,a.next=4,axios.post("/qm/ajax/finished-products/delete-result-quality-line-image",n).then((function(t){var s=t.data.data,a=s.message;return"success"==s.status&&swal("Success","ลบรูปภาพ: ".concat(e.attribute1),"success"),"error"==s.status&&swal("Error","ไม่สามารถ ลบรูปภาพ: ".concat(e.attribute1," | ").concat(a),"error"),s})).catch((function(t){console.log(t),swal("Error","ไม่สามารถ ลบรูปภาพ: ".concat(e.attribute1," | ").concat(t.message),"error")}));case 4:s.isLoading=!1;case 5:case"end":return a.stop()}}),a)})))()},formatDateTh:function(t){return t?u()(t).add(543,"years").format("DD/MM/YYYY"):""}}};s(83467);var h=s(51900);const w=(0,h.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"z-index":"100"}},[s("modal",{attrs:{name:t.modalName,width:t.width,scrollable:!0,height:t.modalHeight,shiftX:.3,shiftY:.3}},[s("div",{staticClass:"p-4 text-left"},[s("h3",{staticClass:"text-left"},[t._v(" ดูแนบรูปภาพ ")]),t._v(" "),s("hr",{staticClass:"tw-mt-1"}),t._v(" "),s("div",{staticStyle:{"min-height":"300px"}},t._l(t.sampleResultLineData.uploadedImages,(function(e,a){return s("div",{key:a,staticClass:"tw-py-2",staticStyle:{"border-bottom":"1px solid #f0f0f0"}},[s("a",{staticClass:"tw-inline-block",attrs:{href:"/qm/files/image/qm/finished-products/result-quality-line/"+e.file_name,target:"_blank"}},[s("span",{staticClass:"fa fa-picture-o tw-mr-1"}),t._v(" "+t._s(e.attribute1)+"\n                    ")]),t._v(" "),s("button",{staticClass:"btn btn-xs btn-outline tw-text-red-700 fa fa-times tw-pt-0",staticStyle:{"font-size":".9rem"},attrs:{type:"button"},on:{click:function(e){return t.onDeleteResultLineImage(a)}}})])})),0),t._v(" "),s("hr",{staticClass:"tw-mt-1"}),t._v(" "),s("div",{staticClass:"text-right"},[s("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(e){return t.$modal.hide(t.modalName)}}},[t._v(" \n                    ปิด \n                ")])])])]),t._v(" "),s("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}})],1)}),[],!1,null,"61c295b8",null).exports;function g(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);"Object"===s&&t.constructor&&(s=t.constructor.name);if("Map"===s||"Set"===s)return Array.from(t);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return x(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,a=new Array(e);s<e;s++)a[s]=t[s];return a}function y(t,e,s,a,l,n,i){try{var r=t[n](i),c=r.value}catch(t){return void s(t)}r.done?e(c):Promise.resolve(c).then(a,l)}function b(t){return function(){var e=this,s=arguments;return new Promise((function(a,l){var n=t.apply(e,s);function i(t){y(n,a,l,i,r,"next",t)}function r(t){y(n,a,l,i,r,"throw",t)}i(void 0)}))}}function C(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function k(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?C(Object(s),!0).forEach((function(e){R(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function R(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const L={props:["authUser","showType","listBrands","listTestServerityCodes","approvalData","approvalRole","sample","items","resultHeaderItems","resultItems","resultItemLines","attachments","defaultData"],components:{Loading:c(),VueNumeric:i(),ModalShowResultLineImages:w},data:function(){var t=this;return{sampleData:this.sample,specifications:this.items,sampleResultHeaders:this.resultHeaderItems.map((function(e){return k(k({},e),{},{selected_test_id:e.test_id,selected_test_code:e.test_code,selected_test_desc:e.test_desc,selected_test_unit:e.test_unit,selected_test_unit_desc:e.test_unit_desc,selected_optimal_value:e.optimal_value,selected_min_value:e.min_value,selected_max_value:e.max_value,result_status:"",severity_level:"",test_serverity_code:"",additional_line_flag:null,uploadedImages:[],result_value:"RESULT_BY"==e.test_code?t.authUser.name:e.result_value,images:[]})})).sort((function(t,e){return t.seq-e.seq})),sampleResults:this.resultItems.map((function(e){return{qm_process_seq:e.qm_process_seq,qm_process:e.qm_process,sample_qty:e.sample_qty,qc_unit_code:e.qc_unit_code,machine_description:e.machine_description,issue_not_found:t.checkIssueNotFoundValue(e,t.resultItemLines),show_input_issue_not_found:t.checkDisplayInputIssueNotFound(e,t.resultItemLines)}})).sort((function(t,e){return t.qm_process_seq-e.qm_process_seq})),sampleResultLines:this.resultItemLines.map((function(e){return k(k({},e),{},{seq_check_list:e.seq_check_list,check_list:e.check_list?e.check_list.trim():null,selected_test_id:e.test_id,selected_test_code:e.test_code,selected_test_desc:e.test_desc,selected_test_unit:e.test_unit,selected_test_unit_desc:e.test_unit_desc,selected_optimal_value:e.optimal_value,selected_min_value:e.min_value,selected_max_value:e.max_value,result_value:e.result_value?e.result_value:"N"==e.data_type_code?0:"",result_status:t.calResultStatus(k(k({},e),{},{selected_min_value:e.min_value,selected_max_value:e.max_value,result_value:e.result_value?e.result_value:"N"==e.data_type_code?0:""})),failed_status:t.calFailedStatus(k(k({},e),{},{selected_min_value:e.min_value,selected_max_value:e.max_value,result_value:e.result_value?e.result_value:"N"==e.data_type_code?0:""})),cannot_get_result_flag:e.cannot_get_result_flag,cannot_get_result_reason:e.cannot_get_result_reason,optimal_result_flag:e.optimal_result_flag,severity_level:t.calSeverityLevel(e),test_serverity_code:e.test_serverity_code?e.test_serverity_code.toUpperCase():null,test_type_code:e.test_type_code?e.test_type_code:null,test_attachment_id:e.test_attachment_id?e.test_attachment_id:null,test_image_path:e.test_image_path?e.test_image_path:null,test_file_name:e.test_file_name?e.test_file_name:null,additional_line_flag:e.additional_line_flag?e.additional_line_flag:null,uploadedImages:t.getUplodedImages(e),cause_of_defect:e.cause_of_defect,images:[]})})).filter((function(t,e,s){return"Y"!=t.show_header_flag})).sort((function(t,e){return t.seq_check_list-e.seq_check_list})),checkListItems:this.items.map((function(t){return{qm_process:t.qm_process?t.qm_process.trim():null,check_list:t.check_list?t.check_list.trim():null,seq_check_list:t.seq_check_list?t.seq_check_list.trim():null}})).filter((function(t,e,s){return e===s.findIndex((function(e){return e.qm_process===t.qm_process&&e.check_list===t.check_list}))})).sort((function(t,e){return t.seq_check_list-e.seq_check_list})),availableCheckListItems:[],checkListTestItems:this.items.map((function(t){return{qm_process:t.qm_process?t.qm_process.trim():null,check_list:t.check_list?t.check_list.trim():null,seq_check_list:t.seq_check_list?t.seq_check_list.trim():null,result_id:t.result_id,result_line_id:t.result_line_id,test_id:t.test_id,test_code:t.test_code,test_desc:t.test_desc,test_unit:t.test_unit,test_unit_desc:t.test_unit_desc,test_serverity_code:t.test_serverity_code?t.test_serverity_code.toUpperCase():null,optimal_value:t.optimal_value,min_value:t.min_value,max_value:t.max_value}})).filter((function(t,e,s){return e===s.findIndex((function(e){return e.qm_process===t.qm_process&&e.check_list===t.check_list&&e.test_id===t.test_id}))})).sort((function(t,e){return t.seq_check_list-e.seq_check_list})),availableCheckListTestItems:[],showedModalSampleResultLine:[],isLoading:!1}},mounted:function(){var t=this;this.sampleResultLines.forEach(function(){var e=b(l().mark((function e(s,a){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.test_serverity_code=s.test_serverity_code?s.test_serverity_code.toUpperCase():t.calTestSeverityCode(s),t.calResultStatus(s),t.calFailedStatus(s),t.calSeverityLevel(s);case 4:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}());this.sampleResultLines.find((function(t){return 1==t.cannot_get_result_flag}));this.availableCheckListItems=this.getAvailableCheckListItems(this.checkListItems),this.availableCheckListTestItems=this.getAvailableCheckListTestItems(this.checkListTestItems)},methods:{getTestData:function(t){var e=this.resultItems.find((function(e){return e.test_id==t.test_id}));return{test_id:e?e.test_id:"",test_code:e?e.test_code:"",test_desc:e?e.test_desc:"",test_unit:e?e.test_unit:"",optimal_value:e?e.optimal_value:"",min_value:e?e.min_value:"",max_value:e?e.max_value:""}},getUplodedImages:function(t){return this.attachments.filter((function(e){return e.attribute2==t.result_id}))},getOptimalValue:function(t,e){var s=t.find((function(t){return t.spec_id==e.spec_id&&t.test_id==e.test_id}));return s?s.optimal_value:""},getBrandLabel:function(t){var e="";if(t){var s=this.listBrands.find((function(e){return e.brand_value==t}));e=s?s.brand_label:""}return e},isAllowEdit:function(t,e){var s=!1;e&&("1"==e.level_code&&"10"==t.approval_status_code&&(s=!0));return s},onResultValueChanged:function(t,e,s){var a=this;this.calResultStatus(s),this.calSeverityLevel(s),"0"!=s.result_value&&(e.issue_not_found=!1),e.show_input_issue_not_found=this.checkDisplayInputIssueNotFound(e,this.sampleResultLines),this.$nextTick((function(){a.sampleResultLines.filter((function(t){return t.qm_process==s.qm_process&&t.check_list==s.check_list&&t.test_id!=s.test_id})).forEach(function(){var t=b(l().mark((function t(e,s){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:""!==e.result_value&&null!==e.result_value||(e.result_value="0",a.calResultStatus(e),a.calSeverityLevel(e));case 1:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}())}))},checkDisplayInputIssueNotFound:function(t,e){var s=!0;return e.filter((function(e){return t.qm_process==e.qm_process})).find((function(t){return 1==t.cannot_get_result_flag}))&&(s=!1),s},checkIssueNotFoundValue:function(t,e){var s=e.filter((function(e){return e.qm_process==t.qm_process})),a=s.filter((function(t){return"0"==t.result_value}));return s.length==a.length},calSeverityLevel:function(t){var e="";return t.result_value&&(e="NONE",t.high_level_minor&&parseFloat(t.result_value)>=parseFloat(t.high_level_minor)&&(e="MINOR"),t.high_level_major&&parseFloat(t.result_value)>=parseFloat(t.high_level_major)&&(e="MAJOR"),t.high_level_critical&&parseFloat(t.result_value)>=parseFloat(t.high_level_critical)&&(e="CRITICAL")),t.severity_level=e,e},calResultStatus:function(t){var e="";return t.selected_min_value&&t.selected_max_value&&""!==t.result_value&&null!==t.result_value&&(e=parseFloat(t.result_value)>=parseFloat(t.selected_min_value)&&parseFloat(t.result_value)<=parseFloat(t.selected_max_value)?"PASSED":"FAILED",this.calFailedStatus(t)),t.result_status=e,e},calFailedStatus:function(t){var e="";return t.selected_min_value&&t.selected_max_value&&""!==t.result_value&&null!==t.result_value&&(parseFloat(t.result_value)<parseFloat(t.selected_min_value)&&(e="UNDER"),parseFloat(t.result_value)>parseFloat(t.selected_max_value)&&(e="OVER")),t.failed_status=e,e},calTestSeverityCode:function(t){var e=this.checkListTestItems.find((function(e){return e.check_list==t.check_list&&e.test_id==t.test_id})),s=e?e.test_serverity_code:"";return t.test_serverity_code=s,s},getAvailableCheckListItems:function(t){var e=this;return t.filter((function(t){return!e.sampleResultLines.find((function(e){return e.qm_process==t.qm_process&&e.check_list==t.check_list&&1==e.optimal_result_flag}))}))},getAvailableCheckListTestItems:function(t){var e=this;return t.filter((function(t){return!e.sampleResultLines.find((function(e){return e.qm_process==t.qm_process&&e.check_list==t.check_list&&1==e.optimal_result_flag}))}))},onHeaderResultChanged:function(t,e){e.result_value=t},onIssueNotFouldCheckBoxChanged:function(t,e){var s=this;(e.issue_not_found=t,1==t)&&this.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process})).forEach((function(t){s.setOptimalResultLine(!0,t),s.calResultStatus(t),s.calSeverityLevel(t)}));this.availableCheckListItems=this.getAvailableCheckListItems(this.checkListItems),this.availableCheckListTestItems=this.getAvailableCheckListTestItems(this.checkListTestItems)},onOptimalResultCheckBoxChanged:function(t,e){var s=this,a=t;this.setOptimalResultLine(a,e);var n=null,i=null,r=null;1==a&&(n=!1,i="",r="0"),this.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process&&t.check_list==e.check_list})).forEach(function(){var t=b(l().mark((function t(e,c){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.optimal_result_flag=a,e.cannot_get_result_flag=null!==n?n:e.cannot_get_result_flag,e.cannot_get_result_reason=null!==i?i:e.cannot_get_result_reason,e.result_value=null!==r||""!==r?r:e.result_value,s.calResultStatus(e),s.calSeverityLevel(e);case 6:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}()),this.availableCheckListItems=this.getAvailableCheckListItems(this.checkListItems),this.availableCheckListTestItems=this.getAvailableCheckListTestItems(this.checkListTestItems)},setOptimalResultLine:function(t,e){var s=null,a=null,l=null;1==t&&(s=!1,a="",l="0"),e.optimal_result_flag=t,e.cannot_get_result_flag=null!==s?s:e.cannot_get_result_flag,e.cannot_get_result_reason=null!==a?a:e.cannot_get_result_reason,e.result_value=null!==l||""!==l?l:e.result_value,this.calResultStatus(e),this.calSeverityLevel(e)},onCannotGetResultCheckBoxChanged:function(t,e,s){var a=this,n=null,i=null,r=null;1==t?(i=!1,r="0"):n="";var c=this.sampleResultLines.filter((function(t){return t.qm_process==s.qm_process}));c.forEach(function(){var e=b(l().mark((function e(s,c){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.cannot_get_result_flag=t,s.cannot_get_result_reason=null!==n?n:s.cannot_get_result_reason,s.optimal_result_flag=null!==i?i:s.optimal_result_flag,s.result_value=null!==r||""!==r?r:s.result_value,a.calResultStatus(s),a.calSeverityLevel(s);case 6:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}()),e.show_input_issue_not_found=this.checkDisplayInputIssueNotFound(e,c)},onCannotGetResultReasonChanged:function(t,e){var s=e.cannot_get_result_reason;this.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process})).forEach(function(){var t=b(l().mark((function t(e,a){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.cannot_get_result_reason=s;case 1:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}())},onSelectedCheckListItem:function(t,e){e.check_list=t;var s=this.checkListTestItems.find((function(s){return s.qm_process==e.qm_process&&s.check_list==t}));this.onSelectedCheckListTestItem(s.test_id,e)},onSelectedCheckListTestItem:function(t,e){var s=this.checkListTestItems.find((function(s){return s.check_list==e.check_list&&s.test_id==t}));e.result_id=s.result_id,e.result_line_id=s.result_line_id,e.selected_test_id=s.test_id,e.selected_test_code=s.test_code,e.selected_test_desc=s.test_desc,e.selected_optimal_value=s.optimal_value,e.selected_min_value=s.min_value,e.selected_max_value=s.max_value,this.calResultStatus(e),this.calSeverityLevel(e),this.calTestSeverityCode(e)},onSelectedTestServerityCode:function(t,e){e.test_serverity_code=t},onAddNewResultLine:function(t){t.issue_not_found=!1;var e=k({},this.sampleResultLines.find((function(e){return e.qm_process==t.qm_process}))),s=this.availableCheckListItems.find((function(e){return e.qm_process==t.qm_process}));e.check_list=s?s.check_list:null,e.check_list_code=s?s.check_list_code:null,e.additional_line_flag="Y",e.result_value="",e.result_status=null,e.severity_level="",e.test_serverity_code="",e.optimal_result_flag=!1,e.cannot_get_result_flag=!1,e.cannot_get_result_reason="",e.uploadedImages=[],e.images=[];var a=this.availableCheckListTestItems.find((function(s){return s.qm_process==t.qm_process&&s.check_list==e.check_list&&s.test_id!=e.selected_test_id}));e.result_id=a?a.result_id:null,e.result_line_id=a?a.result_line_id:null,e.selected_test_id=a?a.test_id:null,e.selected_test_code=a?a.test_code:null,e.selected_test_desc=a?a.test_desc:null,e.selected_test_unit=a?a.test_unit:null,e.selected_test_unit_desc=a?a.test_unit_desc:null,e.selected_optimal_value=a?a.optimal_value:null,e.selected_min_value=a?a.min_value:null,e.selected_max_value=a?a.max_value:null,this.sampleResultLines.push(e)},onRemoveResultLine:function(t){var e=this.sampleResultLines.findIndex((function(e){return e==t}));e>0&&this.sampleResultLines.splice(e,1)},validateBeforeChooseImages:function(t,e,s){var a=this,l="finished_products_result_quality_line_image_".concat(e,"_").concat(s);"PASSED"==t.result_status?swal({title:"",text:"ค่าที่ตรวจสอบอยู่ในเกณฑ์มาตรฐาน ต้องการที่จะแนบรูปภาพใช่หรือไม่ ?",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},(function(t){t&&a.$refs[l][0].click()})):this.$refs[l][0].click()},validateImages:function(t,e){var s=this.defaultData.upload_max_file_size,a=1024*s*1024,l=g(t.target.files);l.filter((function(t){return t.size<a})).length<l.length?swal("Error","สามารถแนบรูป ได้ขนาดไม่เกิน ".concat(s," MB, กรุณาอัพโหลดใหม่อีกครั้ง"),"error"):l.length>1?(swal("Error","สามารถแนบรูป ได้ไม่เกิน ".concat(1," รูป"),"error"),e.images=l.slice(0,1)):e.images=l},onDeleteResultLineImage:function(t,e){t.images.splice(e,1)},onSubmitSampleResult:function(t){var e=this;return b(l().mark((function t(){var s,a,n,i,r,c,o,u,_,d,p,m,v,f,h,w,x,y;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e,!(a=e.validateBeforeSave(e.sampleData,e.sampleResultHeaders,e.sampleResultLines)).valid){t.next=50;break}return(n=new FormData).append("organization_code",e.sampleData.organization_code?e.sampleData.organization_code:""),n.append("oracle_sample_id",e.sampleData.oracle_sample_id?e.sampleData.oracle_sample_id:""),n.append("sample_no",e.sampleData.sample_no?e.sampleData.sample_no:""),n.append("sample_desc",e.sampleData.sample_desc?e.sampleData.sample_desc:""),n.append("inventory_item_id",e.sampleData.inventory_item_id?e.sampleData.inventory_item_id:""),n.append("item_number",e.sampleData.item_number?e.sampleData.item_number:""),n.append("item_desc",e.sampleData.item_desc?e.sampleData.item_desc:""),n.append("date_drawn",e.sampleData.date_drawn?e.sampleData.date_drawn:""),n.append("sample_disposition",e.sampleData.sample_disposition?e.sampleData.sample_disposition:""),n.append("sample_disposition_desc",e.sampleData.sample_disposition_desc?e.sampleData.sample_disposition_desc:""),n.append("sample_operation_status",e.sampleData.sample_operation_status?e.sampleData.sample_operation_status:""),n.append("sample_result_status",e.sampleData.sample_result_status?e.sampleData.sample_result_status:""),n.append("sample_id",e.sampleData.sample_id?e.sampleData.sample_id:""),n.append("department_code",e.sampleData.department_code?e.sampleData.department_code:""),n.append("qm_group",e.sampleData.qm_group?e.sampleData.qm_group:""),n.append("organization_id",e.sampleData.organization_id?e.sampleData.organization_id:""),n.append("subinventory_code",e.sampleData.subinventory_code?e.sampleData.subinventory_code:""),n.append("locator_id",e.sampleData.locator_id?e.sampleData.locator_id:""),n.append("sample_date",e.sampleData.sample_date?e.sampleData.sample_date:""),n.append("batch_id",e.sampleData.batch_id?e.sampleData.batch_id:""),n.append("qc_area",e.sampleData.qc_area?e.sampleData.qc_area:""),n.append("machine_set",e.sampleData.machine_set?e.sampleData.machine_set:""),n.append("program_code",e.sampleData.program_code?e.sampleData.program_code:""),i=[].concat(g(e.sampleResultHeaders),g(e.sampleResultLines)),r=i.map((function(t,e){var s={result_id:t.result_id,qm_process:t.qm_process,check_list:t.check_list,check_list_code:t.check_list_code,test_id:t.selected_test_id,test_code:t.selected_test_code,test_desc:t.selected_test_desc,optimal_value:t.selected_optimal_value,min_value:t.selected_min_value,max_value:t.selected_max_value,result_status:t.result_status,result_value:t.result_value,cannot_get_result_flag:1==t.cannot_get_result_flag?"Y":"N",cannot_get_result_reason:t.cannot_get_result_reason?t.cannot_get_result_reason:"",optimal_result_flag:1==t.optimal_result_flag?"Y":"N",test_serverity_code:t.test_serverity_code?t.test_serverity_code:"",show_header_flag:t.show_header_flag,additional_line_flag:t.additional_line_flag?t.additional_line_flag:null,images:""};return t.images.length>0&&(s.images=t.images.map((function(t,s){return n.append("image_".concat(e,"_").concat(s),t),"image_".concat(e,"_").concat(s)}))),s})),n.append("result_quality_lines",JSON.stringify(r)),e.isLoading=!0,c="success",o=e.sampleData.sample_disposition,u=e.sampleData.sample_disposition_desc,_=e.sampleData.sample_operation_status,d=e.sampleData.sample_operation_status_desc,p=e.sampleData.sample_result_status,m=e.sampleData.sample_result_status_desc,v=e.sampleData.severity_level_minor,f=e.sampleData.severity_level_major,h=e.sampleData.severity_level_critical,w=e.sampleData.test_serverity_code_minor,x=e.sampleData.test_serverity_code_major,y=e.sampleData.test_serverity_code_critical,t.next=46,axios.post("/qm/ajax/finished-products/result",n).then((function(t){var e=t.data.data,a=e.message,l=e.sample?JSON.parse(e.sample):null;return c=e.status,l&&(o=l.sample_disposition,u=l.sample_disposition_desc,_=l.sample_operation_status,d=l.sample_operation_status_desc,p=l.sample_result_status,m=l.sample_result_status_desc,v=l.severity_level_minor,f=l.severity_level_major,h=l.severity_level_critical,w=l.test_serverity_code_minor,x=l.test_serverity_code_major,y=l.test_serverity_code_critical),"success"==e.status&&swal("Success","บันทึกลงผลการตรวจสอบคุณภาพกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no," )"),"success"),"error"==e.status&&swal("Error","บันทึกลงผลการตรวจสอบคุณภาพกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no,") | ").concat(a),"error"),e})).catch((function(t){console.log(t),c="error",swal("Error","บันทึกลงผลการตรวจสอบคุณภาพกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(e.sampleData.sample_no,") | ").concat(t.message),"error")}));case 46:e.isLoading=!1,e.$emit("onSampleResultSubmitted",{status:c,sample_no:e.sampleData.sample_no,sample_disposition:o,sample_disposition_desc:u,sample_operation_status:_,sample_operation_status_desc:d,sample_result_status:p,sample_result_status_desc:m,severity_level_minor:v,severity_level_major:f,severity_level_critical:h,test_serverity_code_minor:w,test_serverity_code_major:x,test_serverity_code_critical:y}),t.next=51;break;case 50:swal("เกิดข้อผิดพลาด","".concat(a.message),"error");case 51:case"end":return t.stop()}}),t)})))()},validateBeforeSave:function(t,e,s){var a={valid:!0,message:""},l=e.find((function(t){return"Y"==t.brand_flag}));l&&(l.result_value||(a.valid=!1,a.message='กรุณากรอกข้อมูล "'.concat(l.selected_test_desc,'"'))),s.filter((function(t){return!t.check_list||!t.test_id||""===t.result_value||null===t.result_value})).length>0&&(a.valid=!1,a.message='กรุณากรอกข้อมูล "ผลการตรวจสอบ" ให้ครบถ้วน');var n=s.filter((function(t){return 1==t.cannot_get_result_flag&&!t.cannot_get_result_reason})),i=s.map((function(t){return t.selected_test_id})),r=i.filter((function(t,e){return e!==i.indexOf(t)}));return n.length>0&&(a.valid=!1,a.message='กรุณากรอกข้อมูล "เหตุผลที่ไม่สามารถเก็บข้อมูลได้" ให้ครบถ้วน'),r.length>0&&(a.valid=!1,a.message='พบข้อมูล "การตรวจสอบ/ความผิดปกติ" ซ้ำ กรุณาตรวจสอบอีกครั้ง'),a},onSubmitCauseOfDefect:function(t){var e=this;return b(l().mark((function t(){var s,a,n,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e,(a=new FormData).append("organization_code",e.sampleData.organization_code?e.sampleData.organization_code:""),a.append("oracle_sample_id",e.sampleData.oracle_sample_id?e.sampleData.oracle_sample_id:""),a.append("sample_no",e.sampleData.sample_no?e.sampleData.sample_no:""),n=[].concat(g(e.sampleResultHeaders),g(e.sampleResultLines)),i=n.map((function(t,e){return{result_id:t.result_id,test_id:t.selected_test_id,test_code:t.selected_test_code,test_desc:t.selected_test_desc,optimal_value:t.selected_optimal_value,cause_of_defect:t.cause_of_defect?t.cause_of_defect:""}})),a.append("result_quality_lines",JSON.stringify(i)),e.isLoading=!0,"success",t.next=12,axios.post("/qm/ajax/finished-products/defect",a).then((function(t){var e=t.data.data,a=e.message;e.sample&&JSON.parse(e.sample);return e.status,"success"==e.status&&swal("Success","บันทึกสาเหตุความผิดปกติกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no," )"),"success"),"error"==e.status&&swal("Error","บันทึกสาเหตุความผิดปกติกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(s.sampleData.sample_no,") | ").concat(a),"error"),e})).catch((function(t){console.log(t),"error",swal("Error","บันทึกสาเหตุความผิดปกติกลุ่มผลิตภัณฑ์สำเร็จรูป (เลขที่การตรวจสอบ\t: ".concat(e.sampleData.sample_no,") | ").concat(t.message),"error")}));case 12:e.isLoading=!1;case 13:case"end":return t.stop()}}),t)})))()},onDeleteResultLineUplodedImage:function(t,e){var s=this;return b(l().mark((function a(){var n;return l().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=k({},t.uploadedImages[e]),swal({title:"",text:"ต้องการที่จะลบรูปภาพใช่หรือไม่ ?",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก",closeOnConfirm:!0},function(){var a=b(l().mark((function a(i){return l().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!i){a.next=5;break}return a.next=3,s.deleteResultLineUplodedImage(t,n);case 3:"success"==a.sent.status&&t.uploadedImages.splice(e,1);case 5:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}());case 2:case"end":return a.stop()}}),a)})))()},deleteResultLineUplodedImage:function(t,e){var s=this;return b(l().mark((function a(){var n,i;return l().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n={sample_result_line:JSON.stringify(t),uploaded_image:JSON.stringify(e)},s.isLoading=!0,a.next=4,axios.post("/qm/ajax/finished-products/delete-result-quality-line-image",n).then((function(t){var s=t.data.data,a=s.message;return"success"==s.status&&swal("Success","ลบรูปภาพ: ".concat(e.attribute1),"success"),"error"==s.status&&swal("Error","ไม่สามารถ ลบรูปภาพ: ".concat(e.attribute1," | ").concat(a),"error"),s})).catch((function(t){console.log(t),swal("Error","ไม่สามารถ ลบรูปภาพ: ".concat(e.attribute1," | ").concat(t.message),"error")}));case 4:return i=a.sent,s.isLoading=!1,a.abrupt("return",i);case 7:case"end":return a.stop()}}),a)})))()},onCancelSampleResult:function(t){this.$emit("onCancelSampleResult",t)},onShowModalSampleResultLineImages:function(t){this.showedModalSampleResultLine=t,window.scrollTo(0,150),this.$modal.show("modal-show-result-line-images")},onModalResultLineImageChanged:function(t){var e=this;return b(l().mark((function s(){var a;return l().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:a=t.sampleResultLine,e.sampleResultLines=e.sampleResultLines.map((function(t){var e=[];return e=a.result_line_id==t.result_line_id&&a.selected_test_id==t.selected_test_id?a.uploadedImages:t.uploadedImages,k(k({},t),{},{uploadedImages:e})}));case 2:case"end":return s.stop()}}),s)})))()}}};const D=(0,h.Z)(L,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tw-ml-5 tw-mr-20 tw-py-2"},[s("table",{staticClass:"table table-borderless-horizontal mb-0"},[s("thead",[s("tr",{staticClass:"tw-bg-opacity-40 tw-bg-blue-100"},[s("th",{staticClass:"tw-text-gray-600",staticStyle:{"z-index":"auto"},attrs:{width:"2%"}},[t._v("\n                    กระบวนการ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"10%"}},[t._v("\n                    รายการตรวจสอบ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600",staticStyle:{"z-index":"auto"},attrs:{width:"15%"}},[t._v("\n                    ข้อมูลการตรวจสอบ/ความผิดปกติ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{colspan:"2",width:"12%"}},[t._v("\n                    จำนวนที่พบ/ผลการตรวจสอบ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}},[t._v("\n                    ค่าOPTIMAL\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"5%"}},[t._v("\n                    อยู่ในช่วงควบคุม\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}},[t._v("\n                    ผลปกติ\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}},[t._v("\n                    ไม่สามารถลงผลการตรวจสอบได้\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"10%"}},[t._v("\n                    เหตุผลที่ไม่สามารถเก็บข้อมูลได้\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"4%"}}),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"6%"}},[t._v("\n                    ระดับความรุนแรงของความผิดปกติ (จำนวน)\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto"},attrs:{width:"6%"}},[t._v("\n                    ระดับความรุนแรงของความผิดปกติ (อาการ)\n                ")]),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto","min-width":"160px"},attrs:{width:"7%"}},["result"!=t.showType?s("span",[t._v(" รูปภาพ ")]):t._e()]),t._v(" "),"result"==t.showType?s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto","min-width":"100px"},attrs:{width:"7%"}},[t._v("\n                    แนบรูปภาพ\n                ")]):t._e(),t._v(" "),s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto","min-width":"100px"},attrs:{width:"7%"}},[t._v("\n                    รูปภาพตัวอย่าง\n                ")]),t._v(" "),"defect"==t.showType?s("th",{staticClass:"tw-text-gray-600 text-center tw-text-xs md:tw-table-cell tw-hidden",staticStyle:{"z-index":"auto","min-width":"200px"},attrs:{width:"10%"}},[t._v("\n                    สาเหตุ\n                ")]):t._e()])]),t._v(" "),t.sampleResults.length>0?s("tbody",[t._m(0),t._v(" "),t._l(t.sampleResultHeaders,(function(e,a){return s("tr",{key:"header_"+a},[s("td",{staticClass:"tw-text-xs md:tw-table-cell tw-text-blue-600 tw-font-bold tw-hidden"}),t._v(" "),s("td",{staticClass:"tw-text-xs"}),t._v(" "),s("td",{staticClass:"tw-text-xs"},[s("div",{staticClass:"tw-py-2"},[t._v("\n                        "+t._s(e.selected_test_desc)+"\n                    ")])]),t._v(" "),s("td",{attrs:{colspan:"2"}},["result"==t.showType&&"Y"!=e.read_only&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",["Y"==e.brand_flag?[s("div",{staticClass:"qm-el-select-required"},[s("qm-el-select",{attrs:{id:"input_header_result_value_"+a,name:"header_result_value_"+a,"option-key":"brand_value","option-value":"brand_value","option-label":"brand_label","select-options":t.listBrands,value:e.result_value,size:"small",clearable:!0,filterable:!0},on:{onSelected:function(s){return t.onHeaderResultChanged(s,e)}}})],1)]:e.test&&"Y"==e.test.time_flag?[s("qm-timepicker",{attrs:{id:"input_header_result_value_"+a,name:"header_result_value_"+a,value:e.result_value},on:{change:function(s){return t.onHeaderResultChanged(s,e)}}})]:"RESULT_BY"==e.selected_test_code?[s("div",{staticClass:"tw-py-2"},[t._v("\n                                "+t._s(t.authUser?t.authUser.name:"-")+"\n                            ")])]:"N"==e.data_type_code?[s("input",{directives:[{name:"model",rawName:"v-model",value:e.result_value,expression:"sampleResultHeader.result_value"}],staticClass:"form-control input-sm text-center",attrs:{id:"input_header_result_value_"+a,type:"number",name:"header_result_value_"+a,placeholder:""},domProps:{value:e.result_value},on:{input:function(s){s.target.composing||t.$set(e,"result_value",s.target.value)}}})]:[s("input",{directives:[{name:"model",rawName:"v-model",value:e.result_value,expression:"sampleResultHeader.result_value"}],staticClass:"form-control input-sm text-center",attrs:{id:"input_header_result_value_"+a,type:"text",name:"header_result_value_"+a,placeholder:""},domProps:{value:e.result_value},on:{input:function(s){s.target.composing||t.$set(e,"result_value",s.target.value)}}})]],2):s("div",{staticClass:"tw-px-2"},["Y"==e.brand_flag?[t._v("\n                            "+t._s(e.result_value?t.getBrandLabel(e.result_value):"-")+"\n                        ")]:[t._v("\n                            "+t._s(e.result_value)+"\n                        ")]],2)]),t._v(" "),s("td",{attrs:{colspan:"9"}})])})),t._v(" "),t._l(t.sampleResults,(function(e,a){return[s("tr",{key:""+a},[s("td",{staticClass:"tw-text-xs tw-bg-opacity-60 tw-bg-gray-200 tw-font-bold",attrs:{colspan:"16"}},[s("div",[t._v(" "+t._s(e.qm_process)+" : "+t._s(e.machine_description)+" จำนวนตัวอย่าง "+t._s(e.sample_qty)+" "+t._s(e.qc_unit_code)+"  ")])])]),t._v(" "),t._l(t.sampleResultLines.filter((function(t){return t.qm_process==e.qm_process})),(function(l,n){return s("tr",{key:a+"-"+n},[s("td",{staticClass:"tw-text-right tw-text-xs md:tw-table-cell tw-text-blue-600 tw-font-bold tw-hidden"},["Y"==l.additional_line_flag&&"result"==t.showType&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",{staticClass:"tw-pt-1"},[s("button",{staticClass:"btn btn-xs btn-danger",on:{click:function(e){return t.onRemoveResultLine(l)}}},[s("span",{staticClass:"fa fa-times"})])]):t._e()]),t._v(" "),s("td",{staticClass:"tw-text-xs"},["Y"==l.additional_line_flag&&"result"==t.showType&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",[s("qm-el-select",{attrs:{id:"input_check_list_"+a+"_"+n,name:"check_list["+a+"]["+n+"]","option-key":"check_list","option-value":"check_list","option-label":"check_list","select-options":t.availableCheckListItems.filter((function(t){return t.qm_process==l.qm_process})),value:l.check_list,size:"small",clearable:!1,filterable:!0},on:{onSelected:function(e){return t.onSelectedCheckListItem(e,l)}}})],1):s("div",{},[t._v("\n                            "+t._s(l.check_list)+"\n                            "),"Y"!=l.optional_ind?s("span",{staticClass:"tw-text-red-600"},[t._v(" * ")]):t._e()])]),t._v(" "),s("td",{staticClass:"tw-text-xs"},["result"==t.showType&&"Y"!=l.read_only&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",["Y"!=l.additional_line_flag?[s("qm-el-select",{attrs:{id:"input_test_id_"+a+"_"+n,name:"test_id["+a+"]["+n+"]","option-key":"test_id","option-value":"test_id","option-label":"test_desc","select-options":t.checkListTestItems.filter((function(t){return t.qm_process==l.qm_process&&t.check_list==l.check_list})),value:l.selected_test_id,size:"small",clearable:!1,filterable:!0},on:{onSelected:function(e){return t.onSelectedCheckListTestItem(e,l)}}})]:[s("qm-el-select",{attrs:{id:"input_test_id_"+a+"_"+n,name:"test_id["+a+"]["+n+"]","option-key":"test_id","option-value":"test_id","option-label":"test_desc","select-options":t.availableCheckListTestItems.filter((function(t){return t.qm_process==l.qm_process&&t.check_list==l.check_list})),value:l.selected_test_id,size:"small",clearable:!1,filterable:!0},on:{onSelected:function(e){return t.onSelectedCheckListTestItem(e,l)}}})]],2):s("div",[t._v("\n                            "+t._s(l.selected_test_desc)+"\n                        ")])]),t._v(" "),s("td",{staticClass:"text-center"},[t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",["result"!=t.showType||"Y"==l.read_only?[s("input",{staticClass:"form-control input-sm text-right tw-border-white",staticStyle:{"background-color":"#ffffff","max-width":"100px"},attrs:{type:"text",disabled:""},domProps:{value:l.result_value?l.result_value:"-"}})]:"N"==l.data_type_code?[s("input",{directives:[{name:"model",rawName:"v-model",value:l.result_value,expression:"sampleResultLine.result_value"}],staticClass:"form-control input-sm text-center",staticStyle:{"max-width":"100px"},attrs:{id:"input_result_value_"+a+"_"+n,name:"result_value_"+a+"_"+n,type:"number",disabled:l.optimal_result_flag||l.cannot_get_result_flag,placeholder:""},domProps:{value:l.result_value},on:{change:function(s){return t.onResultValueChanged(s,e,l)},input:function(e){e.target.composing||t.$set(l,"result_value",e.target.value)}}})]:[s("input",{directives:[{name:"model",rawName:"v-model",value:l.result_value,expression:"sampleResultLine.result_value"}],staticClass:"form-control input-sm text-center",staticStyle:{"max-width":"100px"},attrs:{id:"input_result_value_"+a+"_"+n,name:"result_value_"+a+"_"+n,type:"text",disabled:l.optimal_result_flag||l.cannot_get_result_flag,placeholder:""},domProps:{value:l.result_value},on:{change:function(s){return t.onResultValueChanged(s,e,l)},input:function(e){e.target.composing||t.$set(l,"result_value",e.target.value)}}})]],2):s("div",[t._v("\n                            "+t._s(l.result_value)+"\n                        ")])]),t._v(" "),s("td",{staticClass:"text-left tw-text-xs md:tw-table-cell tw-hidden"},[s("div",{},[t._v(" "+t._s(l.selected_test_unit_desc)+" ")])]),t._v(" "),s("td",{staticClass:"text-right tw-text-xs md:tw-table-cell tw-hidden"},[s("input",{staticClass:"form-control input-sm text-right tw-border-white",staticStyle:{"background-color":"#ffffff"},attrs:{type:"text",disabled:""},domProps:{value:l.selected_optimal_value}})]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["PASSED"==l.result_status?s("span",{staticClass:"fa fa-2x fa-check-circle tw-text-green-500"}):t._e(),t._v(" "),"FAILED"==l.result_status?s("span",{staticClass:"fa fa-2x fa-times tw-text-red-500"}):t._e(),t._v(" "),l.result_status?t._e():s("span",{staticClass:"fa fa-2x fa-minus"})]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["result"==t.showType&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",{staticClass:"tw-mt-2"},[s("qm-el-checkbox",{attrs:{value:l.optimal_result_flag,label:"",name:"optimal_result_flag_"+a,id:"optimal_result_flag_"+a,size:"medium"},on:{change:function(e){return t.onOptimalResultCheckBoxChanged(e,l)}}})],1):s("div",[l.optimal_result_flag?s("span",{staticClass:"fa fa-2x fa-check-circle tw-text-green-500"}):t._e()])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["result"==t.showType&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",{staticClass:"tw-mt-2"},[s("qm-el-checkbox",{attrs:{value:l.cannot_get_result_flag,label:"",name:"cannot_get_result_flag_"+a,id:"input_cannot_get_result_flag_"+a,size:"medium"},on:{change:function(s){return t.onCannotGetResultCheckBoxChanged(s,e,l)}}})],1):s("div",[l.cannot_get_result_flag?s("span",{staticClass:"fa fa-2x fa-check-circle tw-text-red-500"}):t._e()])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["result"==t.showType&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:l.cannot_get_result_reason,expression:"sampleResultLine.cannot_get_result_reason"}],staticClass:"form-control input-sm tw-text-xs text-left",style:{backgroundColor:l.cannot_get_result_flag?"#fffbe4":""},attrs:{type:"text",disabled:!l.cannot_get_result_flag,placeholder:"เหตุผลที่ไม่สามารถเก็บข้อมูล"},domProps:{value:l.cannot_get_result_reason},on:{blur:function(e){return t.onCannotGetResultReasonChanged(e,l)},input:function(e){e.target.composing||t.$set(l,"cannot_get_result_reason",e.target.value)}}})]):s("div",{staticClass:"tw-py-2"},[l.cannot_get_result_flag?s("span",[t._v("\n                                "+t._s(l.cannot_get_result_reason)+"\n                            ")]):t._e()])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs md:tw-table-cell tw-hidden"},["UNDER"==l.failed_status?s("span",{staticClass:"fa fa-2x fa-arrow-down tw-text-blue-500"}):"OVER"==l.failed_status?s("span",{staticClass:"fa fa-2x fa-arrow-up tw-text-red-500"}):t._e()]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},[l.severity_level?"NONE"==l.severity_level?s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")]):"MINOR"==l.severity_level?s("div",{staticClass:"tw-text-blue-500 tw-font-bold"},[t._v(" MINOR ")]):"MAJOR"==l.severity_level?s("div",{staticClass:"tw-text-yellow-500 tw-font-bold"},[t._v(" MAJOR ")]):"CRITICAL"==l.severity_level?s("div",{staticClass:"tw-text-red-700 tw-font-bold"},[t._v(" CRITICAL ")]):t._e():s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},["result"==t.showType&&"Y"!=l.read_only&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("div",[s("qm-el-select",{attrs:{id:"input_test_serverity_code_"+a+"_"+n,name:"test_serverity_code["+a+"]["+n+"]","option-key":"value","option-value":"value","option-label":"label","select-options":t.listTestServerityCodes,value:l.test_serverity_code,size:"small",clearable:!1,filterable:!0},on:{onSelected:function(e){return t.onSelectedTestServerityCode(e,l)}}})],1):s("div",[l.test_serverity_code?"NONE"==l.test_serverity_code?s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")]):"MINOR"==l.test_serverity_code?s("div",{staticClass:"tw-text-blue-500 tw-font-bold"},[t._v(" MINOR ")]):"MAJOR"==l.test_serverity_code?s("div",{staticClass:"tw-text-yellow-500 tw-font-bold"},[t._v(" MAJOR ")]):"CRITICAL"==l.test_serverity_code?s("div",{staticClass:"tw-text-red-700 tw-font-bold"},[t._v(" CRITICAL ")]):t._e():s("div",{staticClass:"tw-text-gray-500 tw-font-bold"},[t._v(" - ")])])]),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},t._l(l.uploadedImages,(function(e,a){return s("div",{key:a,staticClass:"tw-py-2 tw-block"},[s("a",{staticClass:"btn btn-outline btn-primary tw-py-2 tw-px-1 tw-inline-block",attrs:{href:"/qm/files/image/qm/finished-products/result-quality-line/"+e.file_name,target:"_blank"}},[s("span",{staticClass:"fa fa-picture-o tw-mr-1"}),t._v(" ดูแนบรูปภาพ\n                            ")]),t._v(" "),t.isAllowEdit(t.sampleData,t.approvalRole)?s("button",{staticClass:"btn btn-danger btn-outline tw-inline-block tw-text-red-700 tw-py-2 tw-px-2",attrs:{type:"button"},on:{click:function(e){return t.onDeleteResultLineUplodedImage(l,a)}}},[s("span",{staticClass:"fa fa-times"})]):t._e()])})),0),t._v(" "),"result"==t.showType?s("td",{staticClass:"text-center tw-text-xs"},[t.isAllowEdit(t.sampleData,t.approvalRole)?s("button",{staticClass:"btn btn-xs btn-outline btn-success tw-py-2",attrs:{type:"button"},on:{click:function(e){return t.validateBeforeChooseImages(l,a,n)}}},[s("i",{staticClass:"fa fa fa-upload tw-mr-1"}),t._v(" เลือกรูปภาพ\n                        ")]):t._e(),t._v(" "),s("div",{staticClass:"tw-hidden"},[s("div",{staticClass:"custom-file custom-file-th"},[s("input",{ref:"finished_products_result_quality_line_image_"+a+"_"+n,refInFor:!0,staticClass:"custom-file-input",attrs:{type:"file",accept:"image/jpeg,image/gif,image/png",id:"input_image_"+a+"_"+n,name:"image_"+a+"_"+n,"ref-label":"label_image_"+a+"_"+n,multiple:""},on:{change:function(e){return t.validateImages(e,l)}}})])]),t._v(" "),t._l(l.images,(function(e,a){return s("div",{key:a},[s("label",{staticClass:"tw-mt-2 tw-mb-1 tw-text-gray-500",staticStyle:{"max-width":"80px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v("\n                                "+t._s(e.name)+"\n                            ")]),t._v(" "),t.isAllowEdit(t.sampleData,t.approvalRole)?s("label",{staticClass:"tw-mb-1 tw-ml-2 tw-text-red-700 fa fa-times tw-cursor-pointer tw-inline-block",staticStyle:{overflow:"hidden"},on:{click:function(e){return t.onDeleteResultLineImage(l,a)}}}):t._e()])}))],2):t._e(),t._v(" "),s("td",{staticClass:"text-center tw-text-xs"},[l.test_attachment_id?s("a",{staticClass:"btn btn-xs btn-outline tw-w-20 tw-bg-opacity-20 tw-bg-purple-200 tw-border-purple-400 hover:tw-bg-purple-200 hover:tw-border-purple-400 tw-py-2",attrs:{href:"attachments/"+l.test_attachment_id+"/"+l.test_type_code+"/imageDefineTests",target:"_blank"}},[s("span",{staticClass:"fa fa-picture-o tw-mr-1"}),t._v(" ดูภาพ\n                        ")]):t._e(),t._v(" "),s("button",{staticClass:"btn btn-xs btn-outline btn-default tw-w-20 tw-bg-opacity-20 tw-py-2",attrs:{type:"button",disabled:!0}},[s("span",{staticClass:"fa fa-picture-o tw-mr-1"}),t._v(" ดูภาพ\n                        ")])]),t._v(" "),"defect"==t.showType?s("td",{staticClass:"text-left tw-text-xs",staticStyle:{"padding-right":"0px"}},["FAILED"==l.result_status?[s("input",{directives:[{name:"model",rawName:"v-model",value:l.cause_of_defect,expression:"sampleResultLine.cause_of_defect"}],staticClass:"form-control input-sm text-left",attrs:{type:"text",disabled:!t.isAllowEdit(t.sampleData,t.approvalRole),placeholder:"ระบุสาเหตุ"},domProps:{value:l.cause_of_defect},on:{input:function(e){e.target.composing||t.$set(l,"cause_of_defect",e.target.value)}}})]:[s("input",{staticClass:"form-control input-sm text-left",attrs:{type:"text",disabled:""}})]],2):t._e()])})),t._v(" "),"result"==t.showType&&e.show_input_issue_not_found&&t.isAllowEdit(t.sampleData,t.approvalRole)?s("tr",{key:a+"-issue_not_found"},[s("td"),t._v(" "),t._m(1,!0),t._v(" "),s("td",{staticClass:"qm_issue_not_found_checkbox"},[s("div",{staticClass:"tw-pt-2"},[s("qm-el-checkbox",{attrs:{value:e.issue_not_found,label:"",name:"issue_not_found_"+a,id:"input_issue_not_found_"+a,size:"medium",disabled:!t.isAllowEdit(t.sampleData,t.approvalRole)},on:{change:function(s){return t.onIssueNotFouldCheckBoxChanged(s,e)}}})],1)]),t._v(" "),s("td",{attrs:{colspan:"8"}})]):t._e(),t._v(" "),"result"!=t.showType||e.cannot_get_result_flag||e.issue_not_found?t._e():s("tr",{key:a+"-add_button"},[s("td"),t._v(" "),s("td",{attrs:{colspan:"15"}},[t.isAllowEdit(t.sampleData,t.approvalRole)?s("button",{staticClass:"btn btn-xs btn-primary",attrs:{disabled:e.cannot_get_result_flag&&e.issue_not_found},on:{click:function(s){return t.onAddNewResultLine(e)}}},[s("span",{staticClass:"fa fa-plus"})]):t._e()])])]})),t._v(" "),"result"!=t.showType&&"defect"!=t.showType||!t.isAllowEdit(t.sampleData,t.approvalRole)?t._e():s("tr",[s("td",{attrs:{colspan:"16"}},[s("div",{staticClass:"row justify-content-center clearfix tw-my-4"},[s("div",{staticClass:"col text-center"},["result"==t.showType?s("button",{staticClass:"btn btn-md btn-success tw-w-32",attrs:{type:"button"},on:{click:function(e){return t.onSubmitSampleResult(e)}}},[s("i",{staticClass:"fa fa-save"}),t._v(" บันทึก\n                            ")]):t._e(),t._v(" "),"defect"==t.showType?s("button",{staticClass:"btn btn-md btn-success tw-w-32",attrs:{type:"button"},on:{click:function(e){return t.onSubmitCauseOfDefect(e)}}},[s("i",{staticClass:"fa fa-save"}),t._v(" บันทึก\n                            ")]):t._e(),t._v(" "),s("button",{staticClass:"btn btn-md btn-danger tw-w-32 tw-ml-4",attrs:{type:"button"},on:{click:t.onCancelSampleResult}},[s("i",{staticClass:"fa fa-times"}),t._v(" ปิด\n                            ")])])])])])],2):s("tbody",[t._m(2)])]),t._v(" "),s("loading",{attrs:{active:t.isLoading,"is-full-page":!0},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),s("modal-show-result-line-images",{attrs:{"modal-name":"modal-show-result-line-images","modal-width":"640","modal-height":"auto","sample-result-line":t.showedModalSampleResultLine},on:{onModalResultLineImageChanged:t.onModalResultLineImageChanged}})],1)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticClass:"tw-text-xs tw-bg-opacity-60 tw-bg-gray-200 tw-font-bold",attrs:{colspan:"16"}},[s("div",[t._v(" ข้อมูลการตรวจสอบ ")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"tw-text-xs"},[s("div",{},[t._v(" ไม่พบความผิดปกติ ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{attrs:{colspan:"16"}},[s("h2",{staticClass:"p-5 text-center text-muted"},[t._v("ไม่พบข้อมูล")])])])}],!1,null,null,null).exports},83467:(t,e,s)=>{var a=s(50483);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);(0,s(45346).Z)("78e6a76d",a,!0,{})}}]);