(self.webpackChunk=self.webpackChunk||[]).push([[9918],{79918:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>u});var n=s(87757),a=s.n(n),i=s(30381),r=s.n(i);function c(t,e,s,n,a,i,r){try{var c=t[i](r),o=c.value}catch(t){return void s(t)}c.done?e(o):Promise.resolve(o).then(n,a)}function o(t){return function(){var e=this,s=arguments;return new Promise((function(n,a){var i=t.apply(e,s);function r(t){c(i,n,a,r,o,"next",t)}function o(t){c(i,n,a,r,o,"throw",t)}r(void 0)}))}}const l={props:["data","oldIput","trans_date","pRequest","url","trans_btn","profile","title"],computed:{secondaryUomList:function(){}},watch:{step:function(t,e){2==e&&1==t&&(this.input.machine_set=""),3==e&&2==t&&"M05"==this.organizationCode&&(this.step=1,this.resetData()),4==e&&3==t&&(this.input.item="",this.input.machine_set=""),5==e&&4==t&&(this.input.assignee="",this.input.tranfer_qty=""),5==e&&2==t&&(this.input.item="",this.input.machine_set="",this.input.assignee="",this.input.tranfer_qty=""),7==e&&1==t&&(this.input.item="",this.input.machine_set="",this.input.assignee="",this.input.tranfer_qty="")}},data:function(){return{header:this.pHeader,user:this.profile,loading:!1,itemDetail:!1,items:[],deleteItem:"",organizationCode:"",input:{return_date:"",item:"",machine_set:"",assignee:"",tranfer_qty:""},validate:{return_date:{msg:!1},item:{msg:!1},machine_set:{msg:!1},assignee:{msg:!1},tranfer_qty:{msg:!1}},step:1,newSession:!1,process:{1:{html:"",can_next_step:!1},2:{html:"",can_next_step:!1},3:{html:"",can_next_step:!1},4:{html:"",can_next_step:!1},5:{html:"",can_next_step:!1},6:{html:"",can_next_step:!1},7:{html:"",can_next_step:!1},8:{html:"",can_next_step:!1}}}},mounted:function(){this.scanQr(1)},methods:{summary:function(){var t=this;return o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.step=5,t.scanQr();case 2:case"end":return e.stop()}}),e)})))()},scanAssignee:function(){var t=this;return o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.step=6,t.scanQr();case 2:case"end":return e.stop()}}),e)})))()},store:function(){var t=this;return o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.step=7,t.scanQr();case 2:case"end":return e.stop()}}),e)})))()},deleteItemFunc:function(t){var e=this;return o(a().mark((function s(){return a().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e.step=8,e.deleteItem=t,e.scanQr();case 3:case"end":return s.stop()}}),s)})))()},setdate:function(t,e){var s=this;return o(a().mark((function n(){var i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=s,n.next=3,r()(t).format(i.trans_date["js-format"]);case 3:i.input[e]=n.sent;case 4:case"end":return n.stop()}}),n)})))()},validateInput:function(t){var e=this;switch(t){case"return_date":e.validate.return_date.msg=!1,""==e.input.return_date&&(e.validate.return_date.msg="กรุณาระบุ วันที่ทำรายการ");break;case"item":e.validate.item.msg=!1,""==e.input.item&&(e.validate.item.msg="กรุณาระบุ วัตถุดิบ");break;case"machine_set":e.validate.machine_set.msg=!1,""==e.input.machine_set&&(e.validate.machine_set.msg="กรุณาระบุ เครื่องจักร");break;case"assignee":e.validate.assignee.msg=!1,""==e.input.assignee&&(e.validate.assignee.msg="กรุณาระบุ ผู้คืน");break;case"tranfer_qty":e.validate.tranfer_qty.msg=!1,""==e.input.tranfer_qty&&(e.validate.tranfer_qty.msg="กรุณาระบุ จำนวนที่คืน")}},resetData:function(){var t=this;return o(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.newSession=!0,t.scanQr();case 2:case"end":return e.stop()}}),e)})))()},scanQr:function(){var t=arguments,e=this;return o(a().mark((function s(){var n,i;return a().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:0,(i=e).loading=!0,s.next=5,axios.get(i.url.ajax_detail,{params:{new_session:i.newSession,return_date:i.input.return_date,step:i.step,is_first_load:n,item:i.input.item,machine_set:i.input.machine_set,assignee:i.input.assignee,tranfer_qty:i.input.tranfer_qty,delete_item_id:i.deleteItem}}).then((function(t){var e=t.data.data;"S"==e.status&&(i.organizationCode=e.organization_code,1==i.step?"M05"==i.organizationCode&&e.return_date||e.machine?i.step=3:e.return_date&&(i.step=2):2==i.step?"M05"==i.organizationCode||e.machine?i.step=3:e.return_date&&(i.step=2):3==i.step?e.can_next_step?i.step=4:i.input.item="":4==i.step?(i.step=3,i.input.tranfer_qty=""):5==i.step||6==i.step||(7==i.step?(swal({title:"<br>รับโอนวัตถุดิบสำเร็จ",type:"success",html:!0}),i.newSession=!0):8==i.step&&(swal({title:"<br>ลบ Item สำเร็จ",type:"success",html:!0}),i.summary())),i.newSession&&(i.newSession=!1,i.step=1),i.process[i.step].can_next_step=e.can_next_step,i.process[i.step].html=e.html,i.itemDetail=e.item_detail,i.items=e.items,!i.input.return_date&&e.def_return_date&&1==i.step&&(i.input.return_date=e.def_return_date)),"S"!=t.data.data.status&&swal({title:"Error !",text:t.data.data.msg,type:"error",showConfirmButton:!0})})).catch((function(t){var e=t.response.data;alert(e.message)})).then((function(){i.loading=!1}));case 5:return s.abrupt("return");case 6:case"end":return s.stop()}}),s)})))()}}};const u=(0,s(51900).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"ibox float-e-margins"},[s("div",{staticClass:"ibox-content"},[s("div",{staticClass:"row"},[s("div",{staticClass:"form-group mb-0 col-lg-6 col-md-6 col-sm-12 col-xs-12 offset-md-3"},[s("h1",{staticClass:"font-bold p-3 text-center",attrs:{title:t.step}},[t._v(" "+t._s(t.title)+" ")]),t._v(" "),1==t.step?s("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanQr()}}},[s("div",{staticClass:"form-group  row",on:{mouseleave:function(e){return t.validateInput("return_date")}}},[t._m(0),t._v(" "),s("div",{staticClass:"col-sm-8"},[s("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{name:"input_date",id:"input_date",placeholder:"โปรดเลือกวันที่",value:t.input.return_date,format:t.trans_date["js-format"]},on:{blur:function(e){return t.validateInput("return_date")},dateWasSelected:function(e){for(var s=arguments.length,n=Array(s);s--;)n[s]=arguments[s];return t.setdate.apply(void 0,n.concat(["return_date"]))}}}),t._v(" "),s("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.return_date.msg?s("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.return_date.msg)+"\n                                    ")]):t._e()])],1)]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-success btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.scanQr()}}},[s("i",{staticClass:"fa fa-qrcode"}),t._v("\n                                ต่อไป\n                            ")])])]):t._e(),t._v(" "),2==t.step?s("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanQr()}}},[s("div",{domProps:{innerHTML:t._s(t.process[t.step].html)}}),t._v(" "),s("div",{staticClass:"hr-line-dashed"}),t._v(" "),s("div",{staticClass:"form-group  row"},[s("div",{staticClass:"col-sm-12"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.input.machine_set,expression:"input.machine_set"}],staticClass:"form-control",attrs:{placeholder:"สแกน QR Code เครื่องจักร",type:"text"},domProps:{value:t.input.machine_set},on:{blur:function(e){return t.validateInput("machine_set")},input:function(e){e.target.composing||t.$set(t.input,"machine_set",e.target.value)}}}),t._v(" "),s("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.machine_set.msg?s("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.machine_set.msg)+"\n                                    ")]):t._e()])],1)]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-danger btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){t.step=1}}},[s("i",{staticClass:"fa fa-times"}),t._v(" กลับ\n                            ")])])]):t._e(),t._v(" "),3==t.step?s("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanQr()}}},[s("div",{domProps:{innerHTML:t._s(t.process[t.step].html)}}),t._v(" "),s("div",{staticClass:"hr-line-dashed"}),t._v(" "),s("div",{staticClass:"form-group  row"},[s("div",{staticClass:"col-sm-12"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.input.item,expression:"input.item"}],staticClass:"form-control",attrs:{placeholder:"สแกน QR Code วัตถุดิบ",type:"text"},domProps:{value:t.input.item},on:{blur:function(e){return t.validateInput("item")},input:function(e){e.target.composing||t.$set(t.input,"item",e.target.value)}}}),t._v(" "),s("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.item.msg?s("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.item.msg)+"\n                                    ")]):t._e()])],1)]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-success btn-lg btn-block",attrs:{type:"button",disabled:0==t.items.length},on:{click:t.summary}},[s("i",{staticClass:"fa fa-qrcode"}),t._v("\n                                สรุปรายการคืน\n                            ")])]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-warning btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){t.step=2}}},[s("i",{staticClass:"fa fa-times"}),t._v(" กลับ\n                            ")])])]):t._e(),t._v(" "),4==t.step?s("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanQr()}}},[s("div",{domProps:{innerHTML:t._s(t.process[t.step].html)}}),t._v(" "),s("div",{staticClass:"hr-line-dashed"}),t._v(" "),t.process[t.step].can_next_step?s("div",{staticClass:"form-group row text-left mt-2 mb-2"},[t._m(1),t._v(" "),t.itemDetail?s("div",{staticClass:"col-9"},[s("h4",{staticClass:"text-muted no-margins"},[t._v(t._s(t.itemDetail.item_number)+": "+t._s(t.itemDetail.item_desc))])]):t._e()]):t._e(),t._v(" "),t.process[t.step].can_next_step?s("div",{staticClass:"form-group  row"},[t._m(2),t._v(" "),s("div",{staticClass:"col-lg-9"},[s("div",{staticClass:"input-group m-b"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.input.tranfer_qty,expression:"input.tranfer_qty"}],staticClass:"form-control text-right",attrs:{placeholder:"จำนวนที่คืน",step:"any",type:"number"},domProps:{value:t.input.tranfer_qty},on:{blur:function(e){return t.validateInput("tranfer_qty")},input:function(e){e.target.composing||t.$set(t.input,"tranfer_qty",e.target.value)}}}),t._v(" "),s("div",{staticClass:"input-group-append"},[s("span",{staticClass:"input-group-addon"},[t.itemDetail?s("span",[t._v("\n                                                "+t._s(t.itemDetail.uom.unit_of_measure)+"\n                                            ")]):s("span",[t._v("-")])])])]),t._v(" "),s("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.tranfer_qty.msg?s("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.tranfer_qty.msg)+"\n                                    ")]):t._e()])],1)]):t._e(),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-warning btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){t.step=3}}},[s("i",{staticClass:"fa fa-times"}),t._v(" กลับ\n                            ")])])]):t._e(),t._v(" "),5==t.step?s("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.scanQr()}}},[s("div",{domProps:{innerHTML:t._s(t.process[t.step].html)}}),t._v(" "),s("div",{staticClass:"hr-line-dashed"}),t._v(" "),s("table",{staticClass:"table table-bordered",staticStyle:{"font-size":"13px"}},[t._m(3),t._v(" "),s("tbody",[t._l(t.items,(function(e){return Object.keys(t.items).length?[s("tr",[s("td",[s("div",[s("span",{staticClass:"text-muted"},[t._v("วัตถุดิบ: ")]),t._v(" "+t._s(e.item_number)+"\n                                            ")]),t._v(" "),s("div",[s("span",{staticClass:"text-muted"},[t._v("รายละเอียด: ")]),t._v(" "+t._s(e.description)+"\n                                            ")])]),t._v(" "),s("td",{staticClass:"text-right"},[t._v("\n                                            "+t._s(e.tranfer_qty)),s("br"),t._v("\n                                            "+t._s(e.uom.unit_of_measure)+"\n                                        ")]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-default btn-sm",staticStyle:{color:"red"}},[s("i",{staticClass:"fa fa-trash",on:{click:function(s){return t.deleteItemFunc(e.inventory_item_id)}}})])])])]:[t._m(4)]}))],2)]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-success btn-lg btn-block",attrs:{disabled:!Object.keys(t.items).length,type:"button"},on:{click:t.scanAssignee}},[s("i",{staticClass:"fa fa-check"}),t._v(" ยืนยัน\n                            ")])]),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-warning btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){t.step=3}}},[s("i",{staticClass:"fa fa-times"}),t._v(" กลับ\n                            ")])])]):t._e(),t._v(" "),6==t.step||7==t.step?s("form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{submit:function(e){return e.preventDefault(),t.store(e)}}},[s("div",{domProps:{innerHTML:t._s(t.process[t.step].html)}}),t._v(" "),s("div",{staticClass:"hr-line-dashed"}),t._v(" "),t.process[t.step].can_next_step?s("div",{staticClass:"form-group  row"},[s("div",{staticClass:"col-sm-12"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.input.assignee,expression:"input.assignee"}],staticClass:"form-control",attrs:{placeholder:"สแกน QR Code ผู้คืน",type:"text"},domProps:{value:t.input.assignee},on:{blur:function(e){return t.validateInput("assignee")},input:function(e){e.target.composing||t.$set(t.input,"assignee",e.target.value)}}}),t._v(" "),s("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.validate.assignee.msg?s("div",{staticClass:"error_msg text-left"},[t._v("\n                                        "+t._s(t.validate.assignee.msg)+"\n                                    ")]):t._e()])],1)]):t._e(),t._v(" "),s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-warning btn-lg btn-block",attrs:{type:"button"},on:{click:function(e){t.step=5}}},[s("i",{staticClass:"fa fa-times"}),t._v(" กลับ\n                            ")])])]):t._e()])])])])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-4 text-right col-form-label"},[s("h3",{staticClass:"font-bold no-margins"},[t._v("วันที่ทำรายการ:")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-3 text-right"},[s("h3",{staticClass:"font-bold no-margins"},[t._v("รหัสวัตถุดิบ:")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-lg-3 text-right"},[s("h4",{staticClass:"font-bold no-margins pt-2"},[t._v("จำนวนที่คืน:")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("วัตถุดิบ ")]),t._v(" "),s("th",{staticClass:"text-right",attrs:{width:"15%"}},[t._v(" จำนวน ")]),t._v(" "),s("th",{staticClass:"text-center",attrs:{width:"3%"}},[s("i",{staticClass:"fa fa-cog"})])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{attrs:{colspan:"4"}},[s("h4",{attrs:{align:"center"}},[t._v(" NO DATA FOUND ")])])])}],!1,null,null,null).exports}}]);