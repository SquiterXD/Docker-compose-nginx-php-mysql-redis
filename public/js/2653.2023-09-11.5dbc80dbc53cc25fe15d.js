(self.webpackChunk=self.webpackChunk||[]).push([[2653],{8917:(t,e,s)=>{"use strict";s.d(e,{Z:()=>i});var a=s(23645),n=s.n(a)()((function(t){return t[1]}));n.push([t.id,"tr.duplicate_test_id>td{border:4px solid #ed5565!important}",""]);const i=n},82653:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>_});var a=s(87757),n=s.n(a);function i(t,e,s,a,n,i,l){try{var c=t[i](l),o=c.value}catch(t){return void s(t)}c.done?e(o):Promise.resolve(o).then(a,n)}function l(t){return function(){var e=this,s=arguments;return new Promise((function(a,n){var l=t.apply(e,s);function c(t){i(l,a,n,c,o,"next",t)}function o(t){i(l,a,n,c,o,"throw",t)}c(void 0)}))}}var c;const o={props:["url","btnTrans","pTestType","pTestList","pRequest","pSpecifications","pResultSeverityCode"],data:function(){return{specifications:null!=this.pSpecifications&&""!=this.pSpecifications?this.pSpecifications:[],loading:!1,delTestIdArr:[]}},watch:{specifications:(c=l(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},mounted:function(){this.setOptionalInd(),this.setDuplicateTestId()},methods:{checkMinMaxVal:function(t,e){},setOptionalInd:function(){this.specifications.forEach((function(t){"Y"==t.optional_ind?t.optional_ind=!0:t.optional_ind=!1}))},setDuplicateTestId:function(){this.specifications.forEach((function(t){t.is_duplicate_test_id=!1}))},addLine:function(){var t=Object.keys(this.specifications).length;this.$set(this.specifications,t,{seq:null,test_code:null,test_id:null,test_unit:null,min_value:null,max_value:null,optional_ind:null,is_duplicate_test_id:!1,test_unit_desc:null})},delLine:function(t,e){var s=this;""!=t.seq&&s.delTestIdArr.push(t.test_id),s.$delete(s.specifications,e)},changeTest:function(t,e){var s=this;return l(n().mark((function e(){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.is_duplicate_test_id=!1,a=s.pTestList.filter((function(e){return e.test_code==t.test_code})),t.test_unit=a[0].test_unit_code,t.test_id=a[0].test_id,t.test_unit_desc=a[0].test_unit,t.test_desc=a[0].test_desc,s.specifications.filter((function(t){return t.test_id==a[0].test_id})).length>1&&(t.is_duplicate_test_id=!0);case 8:case"end":return e.stop()}}),e)})))()},submitSearch:function(){5==this.pRequest.test_type&&$("#fromSearch").append('<input type="hidden" name="search_flag " value="true" />'),$("#fromSearch").submit()},save:function(){var t=this;swal({html:!0,title:"Save Trasaction ?",text:'<h2 class="m-t-sm m-b-lg"><span style="font-size: 18px"> ต้องการบันทึกรายการหรือไม่ </span></h2>',showCancelButton:!0,confirmButtonText:"บันทึก",cancelButtonText:"ยกเลิก",confirmButtonClass:"btn btn-primary",cancelButtonClass:"btn btn-white",closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){var e=l(n().mark((function e(s){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=5;break}t.loading=!0,axios.post(t.url.qm_api_settings_specifications_store,{specifications:t.specifications,test_type:t.pTestType,search_request:t.pRequest,del_test_id_arr:t.delTestIdArr}).then(function(t){"S"==t.data.data.status&&(swal({title:"บันทึกรายการสำเร็จ",text:'<span style="font-size: 16px; text-align: left;"> ทำการบันทึกรายการเรียบร้อย </span>',type:"success",html:!0}),location.reload()),"E"==t.data.data.status&&swal({title:"มีข้อผิดพลาด",text:'<span style="font-size: 16px; text-align: left;">'+t.data.data.msg+"</span>",type:"warning",html:!0})}.bind(this)).catch(function(t){}.bind(this)).then(function(){t.loading=!1}.bind(this)),e.next=6;break;case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}())}},computed:{canSave:function(){var t=!0;return this.specifications.forEach(function(){var e=l(n().mark((function e(s,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"ตัวอักษร"!=s.data_type&&(parseFloat(s.min_value)>parseFloat(s.max_value)&&(t=!1),parseFloat(s.max_value)<parseFloat(s.min_value)&&(t=!1));case 1:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}()),t}}};var r=s(93379),u=s.n(r),p=s(8917),d={insert:"head",singleton:!1};u()(p.Z,d);p.Z.locals;const _=(0,s(51900).Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"row form-group justify-content-center clearfix tw-my-6 text-center"},[s("div",{staticClass:"col-lg-6 col-md-6"},[s("button",{staticClass:"btn btn-lg btn-white tw-w-32 tw-ml-4",attrs:{type:"button"},on:{click:t.submitSearch}},[s("i",{staticClass:"fa fa-search"}),t._v(" ค้นหา\n            ")]),t._v(" "),s("a",{staticClass:"btn btn-lg tw-bg-gray-100 tw-bg-opacity-60 btn-white tw-w-32 tw-ml-4",attrs:{type:"button",href:t.url.qm_settings_specifications_index}},[s("i",{staticClass:"fa fa-times"}),t._v(" ล้าง\n            ")])])]),t._v(" "),s("hr",{staticClass:"tw-my-10"}),t._v(" "),s("div",{staticClass:"table-responsive"},[s("table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table text-nowrap table-hover table-bordered"},[s("thead",[s("tr",[s("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("\n                                    \n                                    \n                        ชื่อการทดสอบ/ความผิดปกติ*\n                                    \n                                    \n                    ")]),t._v(" "),1!=this.pRequest.test_type&&5!=this.pRequest.test_type?s("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("\n                        Optimal\n                    ")]):t._e(),t._v(" "),1==this.pRequest.test_type||5==this.pRequest.test_type?s("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("\n                        เกณฑ์พิจารณาผล\n                    ")]):t._e(),t._v(" "),s("th",{staticClass:"text-center align-middle",attrs:{colspan:"2"}},[t._v("ค่าควบคุม")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),2==this.pRequest.test_type?s("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("รายการตรวจสอบคุณภาพบุหรี่ *")]):t._e(),t._v(" "),2!=this.pRequest.test_type&&4!=this.pRequest.test_type?s("th",{staticClass:"text-center align-middle",attrs:{colspan:t.pResultSeverityCode.length}},[t._v("ระดับความรุนแรง (Lower Level) *")]):t._e(),t._v(" "),s("th",{staticClass:"text-center align-middle",attrs:{colspan:t.pResultSeverityCode.length}},[t._v("ระดับความรุนแรง (Upper Level) *")]),t._v(" "),s("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("Optional")])]),t._v(" "),s("tr",[s("th",{staticClass:"text-center",staticStyle:{"min-width":"120px","max-width":"120px"}},[t._v("\n                        Min*\n                    ")]),t._v(" "),s("th",{staticClass:"text-center",staticStyle:{"min-width":"120px","max-width":"120px"}},[t._v("\n                        Max*\n                    ")]),t._v(" "),t._l(t.pResultSeverityCode,(function(e,a){return 2!=t.pRequest.test_type&&4!=t.pRequest.test_type?[s("th",{staticClass:"text-center"},[t._v("\n                                  "+t._s(e.meaning)+"      \n                        ")])]:t._e()})),t._v(" "),t._l(t.pResultSeverityCode,(function(e,a){return[s("th",{staticClass:"text-center"},[t._v("\n                                  "+t._s(e.meaning)+"      \n                        ")])]}))],2)]),t._v(" "),s("tbody",[t._l(t.specifications,(function(e,a){return t.specifications.length>0?s("tr",{attrs:{data:a}},[s("td",{staticClass:"align-middle"},[s("div",{staticStyle:{display:"flex"}},[s("div",{staticStyle:{width:"100%"}},[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.test_desc,placement:"top-start"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",disabled:null!=e.seq,placeholder:""},on:{change:function(s){return t.changeTest(e,a)}},model:{value:e.test_code,callback:function(s){t.$set(e,"test_code",s)},expression:"specification.test_code"}},[e.spec_id?s("el-option",{attrs:{label:e.test_desc,value:e.test_code}}):t._e(),t._v(" "),t._l(t.pTestList,(function(t,e){return s("el-option",{key:e,attrs:{label:t.test_desc,value:t.test_code}})}))],2)],1)],1),t._v(" "),s("button",{staticClass:"btn btn-outline btn-danger ml-2",attrs:{type:"button",title:"ลบรายการ"},on:{click:function(s){return s.preventDefault(),t.delLine(e,a)}}},[s("i",{class:t.btnTrans.delete.icon})])]),t._v(" "),e.is_duplicate_test_id?s("div",[s("span",{staticClass:"form-text m-b-none text-danger"},[t._v("\n                                ชื่อการทดสอบ/ความผิดปกติซ้ำ\n                            ")])]):t._e()]),t._v(" "),1!=t.pRequest.test_type&&5!=t.pRequest.test_type?s("td",{staticStyle:{"min-width":"100px"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.optimal_value,expression:"specification.optimal_value"}],staticClass:"form-control text-right",attrs:{type:"number"},domProps:{value:e.optimal_value},on:{input:function(s){s.target.composing||t.$set(e,"optimal_value",s.target.value)}}})]):t._e(),t._v(" "),1==t.pRequest.test_type||5==t.pRequest.test_type?s("td",{staticClass:"text-center align-middle",staticStyle:{"min-width":"100px"}},[s("el-checkbox",{attrs:{checked:"Y"==e.evaluation_flag,size:"large"},model:{value:e.evaluation_flag,callback:function(s){t.$set(e,"evaluation_flag",s)},expression:"specification.evaluation_flag"}})],1):t._e(),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.min_value,expression:"specification.min_value"}],staticClass:"form-control text-right",attrs:{disabled:"ตัวอักษร"==e.data_type,type:"number"},domProps:{value:e.min_value},on:{input:function(s){s.target.composing||t.$set(e,"min_value",s.target.value)}}}),t._v(" "),"ตัวอักษร"!=e.data_type?[parseFloat(e.min_value)>parseFloat(e.max_value)?s("span",{staticClass:" m-b-none text-danger small"},[t._v("\n                                ค่า Min มากกว่า ค่า Max\n                            ")]):t._e()]:t._e()],2),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.max_value,expression:"specification.max_value"}],staticClass:"form-control text-right",attrs:{disabled:"ตัวอักษร"==e.data_type,type:"number"},domProps:{value:e.max_value},on:{change:function(s){return t.checkMinMaxVal(e,"max_value")},input:function(s){s.target.composing||t.$set(e,"max_value",s.target.value)}}}),t._v(" "),"ตัวอักษร"!=e.data_type?[parseFloat(e.max_value)<parseFloat(e.min_value)?s("span",{staticClass:" m-b-none text-danger small"},[t._v("\n                                ค่า Max น้อยกว่า ค่า Min\n                            ")]):t._e()]:t._e()],2),t._v(" "),s("td",{staticClass:"text-center align-middle"},[t._v(t._s(e.test_unit))]),t._v(" "),s("td",{staticClass:"text-center align-middle"},[t._v(t._s(e.test_unit_desc))]),t._v(" "),2==t.pRequest.test_type?s("td",{staticClass:"text-center align-middle"},[s("el-input",{attrs:{disabled:"",placeholder:"ไม่มีข้อมูล"},model:{value:e.check_list,callback:function(s){t.$set(e,"check_list",s)},expression:"specification.check_list"}})],1):t._e(),t._v(" "),t._l(t.pResultSeverityCode,(function(a,n){return 2!=t.pRequest.test_type&&4!=t.pRequest.test_type?[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e["low_level_"+a.meaning.toLowerCase()],expression:"specification['low_level_' + resSevCode.meaning.toLowerCase()]"}],staticClass:"form-control text-right",style:"border-color: "+a.tag,attrs:{type:"number"},domProps:{value:e["low_level_"+a.meaning.toLowerCase()]},on:{input:function(s){s.target.composing||t.$set(e,"low_level_"+a.meaning.toLowerCase(),s.target.value)}}})])]:t._e()})),t._v(" "),t._l(t.pResultSeverityCode,(function(a,n){return[s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e["high_level_"+a.meaning.toLowerCase()],expression:"specification['high_level_' + resSevCode.meaning.toLowerCase()]"}],staticClass:"form-control text-right",style:"border-color: "+a.tag,attrs:{type:"number"},domProps:{value:e["high_level_"+a.meaning.toLowerCase()]},on:{input:function(s){s.target.composing||t.$set(e,"high_level_"+a.meaning.toLowerCase(),s.target.value)}}})])]})),t._v(" "),s("td",{staticClass:"text-center align-middle"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.optional_ind,expression:"specification.optional_ind"}],attrs:{type:"checkbox",value:"Y"},domProps:{checked:Array.isArray(e.optional_ind)?t._i(e.optional_ind,"Y")>-1:e.optional_ind},on:{change:function(s){var a=e.optional_ind,n=s.target,i=!!n.checked;if(Array.isArray(a)){var l=t._i(a,"Y");n.checked?l<0&&t.$set(e,"optional_ind",a.concat(["Y"])):l>-1&&t.$set(e,"optional_ind",a.slice(0,l).concat(a.slice(l+1)))}else t.$set(e,"optional_ind",i)}}})])],2):t._e()})),t._v(" "),0==t.specifications.length?s("tr",{staticClass:"text-center w-100"},[s("td",{attrs:{colspan:"13"}},[t._v("ไม่มีข้อมูล")])]):t._e()],2)])]),t._v(" "),s("div",{staticClass:"row form-group justify-content-center clearfix tw-my-6 text-center"},[s("div",{staticClass:"col-lg-6 col-md-6"},[s("button",{staticClass:"btn btn-lg btn-primary tw-w-32",attrs:{type:"button"},on:{click:t.addLine}},[s("i",{staticClass:"fa fa-plus"}),t._v(" เพิ่มรายการ\n            ")]),t._v(" "),s("button",{staticClass:"btn btn-lg btn-primary tw-w-32",attrs:{disabled:!t.canSave,type:"button"},on:{click:t.save}},[s("i",{staticClass:"fa fa-plus"}),t._v(" บันทึก\n            ")]),t._v(" "),s("a",{staticClass:"btn btn-lg tw-bg-gray-100 tw-bg-opacity-60 btn-white tw-w-32",attrs:{type:"button",href:t.url.qm_settings_specifications_index}},[s("i",{staticClass:"fa fa-times"}),t._v(" ยกเลิก\n            ")])])])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("หน่วย"),s("br"),t._v("การทดสอบ*")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("th",{staticClass:"text-center align-middle",attrs:{rowspan:"2"}},[t._v("รายละเอียดหน่วย"),s("br"),t._v("การทดสอบ*")])}],!1,null,null,null).exports}}]);