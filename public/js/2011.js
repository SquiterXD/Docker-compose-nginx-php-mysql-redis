(self.webpackChunk=self.webpackChunk||[]).push([[2011],{82011:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var r=a(87757),n=a.n(r),i=a(30381),s=a.n(i);function o(e,t,a,r,n,i,s){try{var o=e[i](s),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(r,n)}const l={props:["pHeader","inventoryItemId","url"],computed:{},watch:{},data:function(){return{itemId:null!=this.inventoryItemId&&""!=this.inventoryItemId?parseInt(this.inventoryItemId):"",loading:!1,items:[]}},mounted:function(){console.log("Component mounted."),this.itemId,this.getItems({inventory_item_id:this.itemId,header:this.pHeader})},methods:{itemWasSelected:function(e){var t,a=this;return(t=n().mark((function t(){var r,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(i=(r=a).items.filter((function(t){return t.inventory_item_id==e}))).length&&(i=i[0]),r.$emit("itemWasSelected",i);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(r,n){var i=t.apply(e,a);function s(e){o(i,r,n,s,l,"next",e)}function l(e){o(i,r,n,s,l,"throw",e)}s(void 0)}))})()},remoteMethod:function(e){""!==e?this.getItems({number:e,header:this.pHeader}):this.items=[]},getItems:function(e){var t=this;t.loading=!0,axios.get(t.url.ajax_get_item,{params:e}).then((function(e){var a=e.data.data;t.loading=!1,t.items=a.items}))}}};var c=a(51900);const d=(0,c.Z)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"รหัสวัตถุดิบ","remote-method":e.remoteMethod,loading:e.loading},on:{change:e.itemWasSelected},model:{value:e.itemId,callback:function(t){e.itemId=t},expression:"itemId"}},e._l(e.items,(function(t,r){return a("el-option",{key:parseInt(t.inventory_item_id),attrs:{label:t.item_number,value:parseInt(t.inventory_item_id)}},[a("span",[e._v(e._s(t.display))])])})),1)],1)}),[],!1,null,null,null).exports;function u(e,t,a,r,n,i,s){try{var o=e[i](s),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(r,n)}function m(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var i=e.apply(t,a);function s(e){u(i,r,n,s,o,"next",e)}function o(e){u(i,r,n,s,o,"throw",e)}s(void 0)}))}}var v,h,f,p;const b={props:["header","transBtn","transDate","url","countOpenSearch","requestStatusList"],data:function(){return{loading:!1,getParamlLoading:!1,requestDateFmFormat:"",requestDateToFormat:"",requestNumber:"",requestHeaders:[],transDateFormat:{from_date:"",to_date:""},inputParams:{request_status_list:[],objective_code_list:[],request_header_id_list:[],inventory_item_id_list:[]},requestHeaderId:"",objectiveCode:"",requestStatus:"",inventoryItemId:""}},mounted:function(){},computed:{},watch:{countOpenSearch:(p=m(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openModal();case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)}),"transDateFormat.from_date":function(e){this.getParam()},"transDateFormat.to_date":function(e){this.getParam()},objectiveCode:(f=m(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getParam();case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)}),requestStatus:(h=m(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getParam();case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)}),inventoryItemId:(v=m(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getParam();case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},methods:{setdate:function(e){var t=arguments,a=this;return m(n().mark((function r(){var i,o,l;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=t.length>1&&void 0!==t[1]?t[1]:"",o=a,""!=i){r.next=8;break}return r.next=5,s()(e).format(o.transDate["js-format"]);case 5:o.transactionDateFormat=r.sent,r.next=13;break;case 8:return r.next=10,s()(e).format(o.transDate["js-format"]);case 10:"Invalid date"==(l=r.sent)&&(l=""),o.transDateFormat[i]=l;case 13:case"end":return r.stop()}}),r)})))()},openModal:function(){var e=this;return m(n().mark((function t(){var a,r,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return $("#modal_req_search").modal("show"),t.next=3,s()().format(e.transDate["js-format"]);case 3:a=t.sent,r=new Date,i=r.getFullYear(),a=a.replace(i,i+543),e.transDateFormat.from_date=a;case 8:case"end":return t.stop()}}),t)})))()},remoteMethod:function(e){""!==e?this.getWipRequest({wip_request_no:e,request_date_fm_format:this.requestDateFmFormat,request_date_to_format:this.requestDateToFormat,action:"search"}):this.requestHeaders=[]},getReqSearch:function(e){var t=this;t.loading=!0,axios.get(t.url.index,{params:e}).then((function(e){var a=e.data.data;t.loading=!1,t.requestHeaders=a.data}))},searchForm:function(){var e=this;return m(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.getReqSearch({from_transaction_date:e.transDateFormat.from_date,to_transaction_date:e.transDateFormat.to_date,request_status:e.requestStatus,objective_code:e.objectiveCode,attribute2:e.header.attribute2,request_header_id:e.requestHeaderId,action:"search"});case 1:case"end":return t.stop()}}),t)})))()},getParam:function(){var e=this;return m(n().mark((function t(){var a,r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=e).getParamlLoading=!0,r={action:"search_get_param",from_transaction_date:a.transDateFormat.from_date,to_transaction_date:a.transDateFormat.to_date,request_status:a.requestStatus,objective_code:a.objectiveCode,attribute2:a.header.attribute2},axios.get(a.url.index,{params:r}).then((function(e){var t=e.data.data;a.getParamlLoading=!1,a.inputParams.request_status_list=t.data.request_status_list,a.inputParams.objective_code_list=t.data.objective_code_list,a.inputParams.request_header_id_list=t.data.request_header_id_list,a.inputParams.inventory_item_id_list=t.data.inventory_item_id_list}));case 4:case"end":return t.stop()}}),t)})))()}}};function g(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function x(e,t,a,r,n,i,s){try{var o=e[i](s),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(r,n)}function w(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var i=e.apply(t,a);function s(e){x(i,r,n,s,o,"next",e)}function o(e){x(i,r,n,s,o,"throw",e)}s(void 0)}))}}const C={components:{SearchItem:d,modalSearch:(0,c.Z)(b,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("div",{staticClass:"modal inmodal fade",attrs:{id:"modal_req_search",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg",staticStyle:{width:"90%","max-width":"950px"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"modal-content"},[e._m(0),e._v(" "),a("div",{staticClass:"modal-body text-left"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.getParamlLoading,expression:"getParamlLoading"}],staticClass:"ibox"},[a("div",{staticClass:"row"},[a("div",{staticClass:"form-group pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[e._v("วันที่ :")]),e._v(" "),a("div",{staticClass:"input-group "},[a("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{placeholder:"โปรดเลือกวันที่",value:e.transDateFormat.from_date,format:e.transDate["js-format"]},on:{dateWasSelected:function(t){for(var a=arguments.length,r=Array(a);a--;)r[a]=arguments[a];return e.setdate.apply(void 0,r.concat(["from_date"]))}}})],1)]),e._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[e._v(" ")]),e._v(" "),a("div",{staticClass:"input-group "},[a("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{placeholder:"โปรดเลือกวันที่",value:e.transDateFormat.to_date,format:e.transDate["js-format"]},on:{dateWasSelected:function(t){for(var a=arguments.length,r=Array(a);a--;)r[a]=arguments[a];return e.setdate.apply(void 0,r.concat(["to_date"]))}}})],1)]),e._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[e._v(" วัตถุประสงค์ในการเบิก :")]),e._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"วัตถุประสงค์ในการเบิก",loading:e.getParamlLoading,"popper-append-to-body":!1},model:{value:e.objectiveCode,callback:function(t){e.objectiveCode=t},expression:"objectiveCode"}},e._l(e.inputParams.objective_code_list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[e._v(" สินค้าที่จะผลิต :")]),e._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"สินค้าที่จะผลิต",loading:e.getParamlLoading,"popper-append-to-body":!1},model:{value:e.inventoryItemId,callback:function(t){e.inventoryItemId=t},expression:"inventoryItemId"}},e._l(e.inputParams.inventory_item_id_list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)])]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"form-group pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[e._v("เลขที่ใบเบิก :")]),e._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"เลขที่เอกสาร",loading:e.getParamlLoading,"popper-append-to-body":!1},model:{value:e.requestHeaderId,callback:function(t){e.requestHeaderId=t},expression:"requestHeaderId"}},e._l(e.inputParams.request_header_id_list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group pr-2 mb-0 col-lg-3 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[e._v(" สถานะขอเบิก :")]),e._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"สถานะขอเบิก",loading:e.getParamlLoading,"popper-append-to-body":!1},model:{value:e.requestStatus,callback:function(t){e.requestStatus=t},expression:"requestStatus"}},e._l(e.inputParams.request_status_list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),e._v(" "),a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-6 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[e._v(" ")]),e._v(" "),a("div",{staticClass:"text-right"},[a("button",{class:e.transBtn.search.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:e.searchForm}},[a("i",{class:e.transBtn.search.icon}),e._v("\n                                        "+e._s(e.transBtn.search.text)+"\n                                    ")])])])])]),e._v(" "),a("div",{staticClass:"ibox-content table-responsive m-t mb-3"},[a("table",{staticClass:"table table-hover"},[e._m(1),e._v(" "),a("tbody",e._l(e.requestHeaders,(function(t,r){return a("tr",[a("td",{staticClass:"text-center"},[e._v(e._s(t.request_date_format))]),e._v(" "),a("td",[e._v(e._s(t.request_number))]),e._v(" "),a("td",{staticClass:"text-center"},[t.status?a("div",[e._v("\n                                            "+e._s(t.status.description)+"\n                                        ")]):e._e()]),e._v(" "),a("td",{staticClass:"text-right"},[a("a",{class:e.transBtn.detail.class+" btn-lg tw-w-25",attrs:{href:t.show_url}},[a("i",{class:e.transBtn.detail.icon}),e._v("\n                                            "+e._s(e.transBtn.detail.text)+"\n                                        ")])])])})),0)])])]),e._v(" "),e._m(2)])])])])}),[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")]),a("span",{staticClass:"sr-only"},[e._v("Close")])]),e._v(" "),a("h4",{staticClass:"modal-title"},[e._v("ค้นหาการขอเบิกวัตถุดิบนอกแผน")]),e._v(" "),a("small",{staticClass:"font-bold"},[e._v("\n                         \n                    ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",{staticClass:"text-center",attrs:{width:"200px"}},[e._v("วันที่ขอเบิก")]),e._v(" "),a("th",[e._v("เลขที่ใบเบิก")]),e._v(" "),a("th",{staticClass:"text-center",attrs:{width:"200px"}},[e._v("สถานะขอเบิก")]),e._v(" "),a("th",{staticClass:"text-center",attrs:{width:"150px"}})])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-white",attrs:{type:"button","data-dismiss":"modal"}},[e._v("Close")])])}],!1,null,null,null).exports},props:["pHeader","data","oldIput","transDate","pRequest","url","transBtn","profile"],computed:{labelAttr3Class:function(){var e=this,t="required";return 2==e.header.case&&1==e.header.objective_code&&("A12"!=e.header.organization.organization_code&&"M05"!=e.header.organization.organization_code&&"MG6"!=e.header.organization.organization_code||(t="")),t},labelItemClass:function(){var e=this,t="required";return 2==e.header.case&&1==e.header.objective_code&&"A12"==e.header.organization.organization_code&&(t=""),1==e.header.case&&e.isFmOtherProgram&&(t=""),t},labelReqQtyClass:function(){var e=this,t="required";return 2==e.header.case&&1==e.header.objective_code&&"A12"==e.header.organization.organization_code&&(t=""),1==e.header.case&&e.isFmOtherProgram&&(t=""),t},secondaryUomList:function(){var e=this;if(e.header.inventory_item_id){var t=e.data.item_list.filter((function(t){return t.inventory_item_id==e.header.inventory_item_id}));if(t.length)return e.header.attribute1||(e.header.attribute1=t[0].primary_uom_code),t[0].secondary_uom_list}return[]},workStepList:function(){var e=this;if(e.header.inventory_item_id){var t=e.data.item_list.filter((function(t){return t.inventory_item_id==e.header.inventory_item_id}));if(t.length)return console.log("workStepList",t[0]),e.header.work_step||e.header.request_header_id||(e.header.work_step=""),t[0].work_step_list}return[]}},watch:{},data:function(){return{header:this.pHeader,user:this.profile,countOpenSearch:0,selectProdItem:{},lines:[],lineAll:[],loading:{lines:!1},disabledInput:{blend_no:!1,inventory_item_id:!1},firstLoad:!0,linesTh:{},updateInput:{},validateFrom:{request_date_format:{is_valid:!0,message:""},attribute3:{is_valid:!0,message:""},inventory_item_id:{is_valid:!0,message:""},request_quantity:{is_valid:!0,message:""},send_date_format:{is_valid:!0,message:""}},searchParam:{},isFmOtherProgram:!1}},beforeMount:function(){console.log("beforeMount")},mounted:function(){console.log("Component mounted."),this.setData(),this.resetValidate()},methods:{setData:function(){var e=this;return w(n().mark((function t(){var a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=e).selectObjectiveCode(a.header.objective_code),a.selectInventoryItem("inventory_item_id"),null!=a.header.request_header_id&&""!=a.header.request_header_id&&a.getLines(!1,"show"),a.firstLoad=!1,a.isFmOtherProgram=""!=a.header.program_code&&"PMP0005"!=a.header.program_code;case 6:case"end":return t.stop()}}),t)})))()},indexPage:function(){location.href=this.url.material_requests_index},itemWasSelected:function(e,t){return w(n().mark((function a(){return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.inventory_item_id=e.inventory_item_id,t.item_classification_code=e.item_classification_code,t.item_desc=e.item_desc,t.item_number=e.item_number,t.organization_id=e.organization_id,t.secondary_qty=e.secondary_qty,t.secondary_uom=e.secondary_uom,t.secondary_uom_list=e.secondary_uom_list,t.tobacco_group_code=e.tobacco_group_code,t.tobacco_type_code=e.tobacco_type_code,t.transaction_quantity=e.transaction_quantity,t.transaction_uom=e.transaction_uom,t.transaction_uom_desc=e.transaction_uom_desc,console.log("itemWasSelected(item, line)",e,t);case 14:case"end":return a.stop()}}),a)})))()},setdate:function(e,t){var a=this;return w(n().mark((function r(){var i;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(i=a).resetValidate(t),r.next=4,s()(e).format(i.transDate["js-format"]);case 4:i.header[t]=r.sent;case 5:case"end":return r.stop()}}),r)})))()},changeRequestQuantity:function(){var e=this;return w(n().mark((function t(){var a,r,i,s,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=0,i=(a=e).header.inventory_item_id?a.header.request_quantity:0,t.next=5,a.resetValidate("request_quantity");case 5:if(a.header.inventory_item_id&&(s=a.data.item_list.filter((function(e){return e.inventory_item_id==a.header.inventory_item_id}))).length&&((s=(s=s[0].secondary_uom_list).filter((function(e){return e.from_uom_code==a.header.attribute1}))).length?(r=s[0].conversion_rate,i*=r):i*=1),!a.lineAll.length){t.next=21;break}t.t0=n().keys(a.lineAll);case 8:if((t.t1=t.t0()).done){t.next=21;break}if(o=t.t1.value,1!=a.header.attribute2){t.next=17;break}return a.header.request_quantity?a.lineAll[o].use_lose_qty=Math.ceil(a.lineAll[o].ratio_require_per_unit*i):a.lineAll[o].use_lose_qty=Math.ceil(a.lineAll[o].require_qty),t.next=14,_.round(Math.round(a.lineAll[o].use_lose_qty),-1);case 14:a.lineAll[o].use_lose_qty=t.sent,t.next=19;break;case 17:a.header.request_quantity?(a.lineAll[o].use_lose_qty=a.lineAll[o].ratio_require_per_unit*i,a.lineAll[o].use_lose_qty=a.lineAll[o].use_lose_qty.toFixed(5)):a.lineAll[o].use_lose_qty=a.lineAll[o].require_qty,a.lineAll[o].use_lose_qty=parseFloat(a.lineAll[o].use_lose_qty).toFixed(5);case 19:t.next=8;break;case 21:case"end":return t.stop()}}),t)})))()},selectTypeCode:function(){var e=this;return w(n().mark((function t(){var a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=e).lineAll.length&&(a.lines=[],"selectAll"==a.header.type_code?a.lines=a.lineAll.filter((function(e){return 1==e.is_selected})):"selectItemList"==a.header.type_code?(a.lines=a.lineAll,a.selectWorkStep()):"02"==a.header.ingredient_group?a.lines=a.lineAll.filter((function(e){return e.tobacco_ingrident_type==a.header.type_code})):a.lines=a.lineAll.filter((function(e){return e.tobacco_type_code==a.header.type_code})));case 2:case"end":return t.stop()}}),t)})))()},selectInventoryItem:function(e){var t=this;return w(n().mark((function a(){var r,i;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t,i=!1,a.next=4,r.confirmChange(e);case 4:if(a.sent){a.next=7;break}return a.abrupt("return");case 7:return a.next=9,r.resetValidate("inventory_item_id");case 9:r.selectProdItem={},"blend_no"==e&&((i=r.data.item_list.filter((function(e){return e.blend_no==r.header.blend_no}))).length?r.header.inventory_item_id=i[0].inventory_item_id:(r.header.blend_no="",r.header.inventory_item_id="")),"inventory_item_id"==e&&(r.header.inventory_item_id?(i=r.data.item_list.filter((function(e){return e.inventory_item_id==r.header.inventory_item_id}))).length&&(r.header.blend_no=i[0].blend_no):(r.header.blend_no="",r.header.inventory_item_id="")),i&&(r.selectProdItem=i[0]),r.header.blend_no||r.header.inventory_item_id||(r.header.request_quantity="");case 14:case"end":return a.stop()}}),a)})))()},selectAttribute3:function(){var e=this;return w(n().mark((function t(){var a,r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(2!=(a=e).header.case){t.next=6;break}if(2!=a.header.objective_code&&3!=a.header.objective_code){t.next=6;break}if("M05"!=a.header.organization.organization_code&&"MG6"!=a.header.organization.organization_code){t.next=6;break}return a.searchParam=JSON.parse(JSON.stringify(a.header)),t.abrupt("return");case 6:return t.next=8,e.confirmChange("attribute3");case 8:return r=t.sent,t.next=11,e.resetValidate("attribute3");case 11:if(r){t.next=13;break}return t.abrupt("return");case 13:case"end":return t.stop()}}),t)})))()},selectIngredientGroup:function(){var e=this;return w(n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.confirmChange("ingredient_group");case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:e;case 6:case"end":return t.stop()}}),t)})))()},changeQty:function(e,t,a){var r=this;return w(n().mark((function i(){var s,o;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r,"secondary_qty"==a&&(t.transaction_quantity="",(s=t.secondary_uom_list.filter((function(e){return e.from_uom_code==t.secondary_uom}))).length&&(t.transaction_quantity=s[0].conversion_rate*t.secondary_qty)),"secondary_uom"==a&&(o=t.secondary_uom_list.filter((function(e){return e.from_uom_code==t.secondary_uom}))).length&&t.secondary_qty&&(t.transaction_quantity=o[0].conversion_rate*t.secondary_qty),t.is_selected=!1,(t.secondary_qty||t.transaction_quantity)&&(t.is_selected=!0),r.hasUpdateInput(e,t);case 7:case"end":return n.stop()}}),i)})))()},selectLine:function(e,t){var a=this;return w(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.is_selected=!t.is_selected,a.hasUpdateInput(e,t);case 2:case"end":return r.stop()}}),r)})))()},hasUpdateInput:function(e,t){var a=this;return w(n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.is_selected?a.$set(a.updateInput,e,e):a.$delete(a.updateInput,e);case 1:case"end":return r.stop()}}),r)})))()},selectWorkStep:function(){var e=this;return w(n().mark((function t(){var a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1==(a=e).header.objective_code&&2==a.header.attribute2){t.next=3;break}return t.abrupt("return");case 3:a.header.work_step&&""!=a.header.work_step?a.lineAll.length&&(a.lines=a.lineAll.filter((function(e){return e.work_step==a.header.work_step}))):a.lines=a.lineAll;case 4:case"end":return t.stop()}}),t)})))()},selectObjectiveCode:function(e){var t=this;return w(n().mark((function a(){var r;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t,a.next=3,r.confirmChange();case 3:if(a.sent){a.next=6;break}return a.abrupt("return");case 6:r.disabledInput.blend_no=!1,r.disabledInput.inventory_item_id=!1,3==e?(r.header.blend_no="",r.header.inventory_item_id="",r.header.attribute1="",r.header.request_quantity="",r.header.ingredient_group="",r.disabledInput.blend_no=!0,r.disabledInput.inventory_item_id=!0):r.header.attribute3=r.header.attribute3?r.header.attribute3:"",1==r.header.attribute2&&(3==e||2==e?(r.header.blend_no="",r.header.inventory_item_id="",r.header.attribute1="",r.header.request_quantity="",r.header.ingredient_group="",r.disabledInput.blend_no=!0,r.disabledInput.inventory_item_id=!0):r.header.attribute3=r.header.attribute3?r.header.attribute3:"");case 10:case"end":return a.stop()}}),a)})))()},addNewLine:function(){var e=this;return w(n().mark((function t(){var a,r,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(a=e).lineAll.length,t.next=4,_.clone(a.data.new_line);case 4:i=t.sent,a.header.type_code&&"selectAll"!=a.header.type_code&&(i.tobacco_type_code=a.header.type_code),a.$set(a.lineAll,r,i),a.selectTypeCode();case 8:case"end":return t.stop()}}),t)})))()},getLines:function(){var e=arguments,t=this;return w(n().mark((function a(){var r,i,s,o;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=!(e.length>0&&void 0!==e[0])||e[0],i=e.length>1&&void 0!==e[1]?e[1]:"search",o=!0,(s=t).header.type_code="selectAll",a.next=9;break;case 8:o=a.sent;case 9:if(!r){a.next=15;break}return a.next=12,s.validateHeader(r);case 12:if(a.sent){a.next=15;break}return a.abrupt("return");case 15:if(console.log("getLines",r,o),!o){a.next=23;break}return s.loading.lines=!0,s.lineAll=[],s.lines=[],s.searchParam=JSON.parse(JSON.stringify(s.header)),a.next=23,axios.get(s.url.ajax_lines,{params:{blend_no:s.header.blend_no,inventory_item_id:s.header.inventory_item_id,ingredient_group:s.header.ingredient_group,type_code:s.header.type_code,objective_code:s.header.objective_code,request_header_id:s.header.request_header_id,action:i,product_uom_code:s.header.attribute1,case:s.header.attribute2,item_cat_code:s.header.attribute3}}).then((function(e){var t=e.data.data;s.lineAll=t.lines,s.selectTypeCode(),s.changeRequestQuantity()})).catch((function(e){var t=e.response.data;alert(t.message)})).then((function(){s.loading.lines=!1}));case 23:return a.abrupt("return");case 24:case"end":return a.stop()}}),a)})))()},save:function(){var e=this;return w(n().mark((function t(){var a,r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e,!0,t.next=4,a.validateHeader();case 4:if(t.sent){t.next=9;break}return t.next=8,helperAlert.showGenericFailureDialog("กรุณากรอกข้อมูลให้ครบ/ถูกต้อง ก่อนบันทึก ?");case 8:return t.abrupt("return");case 9:return t.next=11,a.validateInput();case 11:if(t.sent){t.next=16;break}return t.next=15,helperAlert.showGenericFailureDialog("กรุณากรอกข้อมูลให้ครบ/ถูกต้อง ก่อนบันทึก ?");case 15:return t.abrupt("return");case 16:return t.next=18,helperAlert.showProgressConfirm("กรุณายืนยันบันทึก ?");case 18:if(!t.sent){t.next=24;break}return a.loading.lines=!0,r=a.lineAll.filter((function(e){return 1==e.is_selected})),t.next=24,axios.post(a.url.ajax_store,{header:a.header,lines:r}).then((function(e){var t=e.data.data;"S"==t.status&&(a.header=t.header,a.url.print_pdf=t.url_print_pdf,setTimeout(w(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getLines(!1,"show");case 2:case"end":return e.stop()}}),e)}))),500)),"S"!=t.status&&swal({title:"Error !",text:t.msg,type:"error",showConfirmButton:!0})})).catch((function(e){var t=e.response.data;alert(t.message)})).then((function(){a.loading.lines=!1}));case 24:case"end":return t.stop()}}),t)})))()},setStatus:function(e){var t=this;return w(n().mark((function a(){var r,i,s;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t,!1,i="","confirmTransfer"==e&&(i="กรุณายืนยันโอนวัถุดิบ"),"cancelTransfer"==e&&(i="กรุณายืนยันยกเลิกขอโอน"),a.next=7,helperAlert.showProgressConfirm(i);case 7:if(!a.sent){a.next=14;break}return r.loading.lines=!0,s=r.url.ajax_set_status,""!=r.header.request_header_id&&null!=r.header.request_header_id&&(s=s.replace("-1",r.header.request_header_id)),a.next=14,axios.post(s,{status:e}).then((function(e){var t=e.data.data;console.log("xxx",t),"S"==t.status&&(r.header.request_status=String(t.request_status),r.header.can=t.can),"S"!=e.data.data.status&&swal({title:"Error !",text:e.data.data.msg,type:"error",showConfirmButton:!0})})).catch((function(e){var t=e.response.data;alert(t.message)})).then((function(){r.loading.lines=!1}));case 14:case"end":return a.stop()}}),a)})))()},validateHeader:function(){var e=arguments,t=this;return w(n().mark((function a(){var r,i;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=!(e.length>0&&void 0!==e[0])||e[0],i=t,!1,a.next=5,i.resetValidate();case 5:if(console.log("request_date_format",i.header.request_date_format),i.header.request_date_format&&"Invalid date"!=i.header.request_date_format){a.next=11;break}return i.$set(i.validateFrom,"request_date_format",{is_valid:!1,message:"กรุณากรอกวันที่ขอเบิก"}),a.next=10,helperAlert.showGenericFailureDialog(i.validateFrom.request_date_format.message);case 10:return a.abrupt("return",!1);case 11:if(1!=i.header.case){a.next=18;break}if(!r||1!=i.header.objective_code||i.isFmOtherProgram){a.next=18;break}if(i.header.blend_no&&i.header.inventory_item_id){a.next=18;break}return i.$set(i.validateFrom,"inventory_item_id",{is_valid:!1,message:"กรุณากรอกข้อมูล สินค้าที่จะผลิตหรือ Blend No"}),a.next=17,helperAlert.showGenericFailureDialog(i.validateFrom.inventory_item_id.message);case 17:return a.abrupt("return",!1);case 18:if(2!=i.header.case){a.next=42;break}if(1!=i.header.objective_code){a.next=30;break}if(i.header.inventory_item_id||"A12"==i.header.organization.organization_code){a.next=25;break}return i.$set(i.validateFrom,"inventory_item_id",{is_valid:!1,message:"กรุณากรอกข้อมูลสินค้าที่จะผลิต"}),a.next=24,helperAlert.showGenericFailureDialog(i.validateFrom.inventory_item_id.message);case 24:return a.abrupt("return",!1);case 25:if(!i.header.inventory_item_id||i.header.request_quantity){a.next=30;break}return i.$set(i.validateFrom,"request_quantity",{is_valid:!1,message:"กรุณากรอกจำนวนที่สั่งผลิต"}),a.next=29,helperAlert.showGenericFailureDialog(i.validateFrom.request_quantity.message);case 29:return a.abrupt("return",!1);case 30:if(2!=i.header.objective_code){a.next=36;break}if(i.header.attribute3){a.next=36;break}return i.$set(i.validateFrom,"attribute3",{is_valid:!1,message:"กรุณากรอกประเภทวัตถุดิบ"}),a.next=35,helperAlert.showGenericFailureDialog(i.validateFrom.attribute3.message);case 35:return a.abrupt("return",!1);case 36:if(3!=i.header.objective_code){a.next=42;break}if(i.header.attribute3){a.next=42;break}return i.$set(i.validateFrom,"attribute3",{is_valid:!1,message:"กรุณากรอกประเภทวัตถุดิบ"}),a.next=41,helperAlert.showGenericFailureDialog(i.validateFrom.attribute3.message);case 41:return a.abrupt("return",!1);case 42:if(i.header.send_date_format){a.next=47;break}return i.$set(i.validateFrom,"send_date_format",{is_valid:!1,message:"กรุณากรอกวันที่นำส่ง ยสท"}),a.next=46,helperAlert.showGenericFailureDialog(i.validateFrom.send_date_format.message);case 46:return a.abrupt("return",!1);case 47:return a.abrupt("return",!0);case 48:case"end":return a.stop()}}),a)})))()},validateInput:function(){var e=this;return w(n().mark((function t(){var a,r,i,s,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=!0,(r=e).header.send_date_format||(a=!1,r.validateFrom.send_date_format.is_valid=!1,r.validateFrom.send_date_format.message="กรุณากรอกวันที่นำส่ง ยสท"),i=r.lineAll.filter((function(e){return 1==e.is_selected})),s=i.map((function(e){var t=i.findIndex((function(t){return t.inventory_item_id==e.inventory_item_id}));t=i[t],console.log("---",t)})),o=i.some((function(e,t){console.log("xx",e,t)})),console.log("xx",s,o),t.abrupt("return",a);case 9:case"end":return t.stop()}}),t)})))()},confirmChange:function(){var e=arguments,t=this;return w(n().mark((function a(){var r,i;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.length>0&&void 0!==e[0]&&e[0],i=!0,1!=!(r=t).header.attribute2){a.next=5;break}return a.abrupt("return",i);case 5:if(0!=Object.keys(r.searchParam).length){a.next=7;break}return a.abrupt("return",i);case 7:return a.next=9,helperAlert.showProgressConfirm("กรุณายืนยันเปลี่ยนแปลงการค้นหา");case 9:return a.sent?(r.lines=[],r.lineAll=[],r.searchParam=JSON.parse(JSON.stringify(r.header))):(i=!1,r.header=JSON.parse(JSON.stringify(r.searchParam))),a.abrupt("return",i);case 12:case"end":return a.stop()}}),a)})))()},resetValidate:function(){var e=arguments,t=this;return w(n().mark((function a(){var r,i,s;return n().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=e.length>0&&void 0!==e[0]&&e[0],i=t,s={is_valid:!0,message:""},""!=r?i.validateFrom[r]=s:(i.validateFrom.send_date_format=s,i.validateFrom.request_date_format=s,i.validateFrom.inventory_item_id=s,i.validateFrom.request_quantity=s,i.validateFrom.attribute3=s);case 4:case"end":return a.stop()}}),a)})))()},stripNonNumber:function(e){for(var t=g(e),a=[],r=0;r<t.length;r++)!1===isNaN(t[r])&&a.push(t[r]);return Number(a.join(""))},numberFormat:function(e){return console.log("xx",e),"".concat(e).replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}}};const q=(0,c.Z)(C,(function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("div",[r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.lines,expression:"loading.lines"}],staticClass:"ibox float-e-margins"},[r("modal-search",{attrs:{transDate:t.transDate,header:t.header,requestStatusList:t.data.request_status_list,transBtn:t.transBtn,url:t.url,countOpenSearch:t.countOpenSearch}}),t._v(" "),r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"row"},[t._m(0),t._v(" "),r("div",{staticClass:"col-9 text-right"},[r("button",{class:t.transBtn.search.class+" btn-lg tw-w-25 ",on:{click:function(e){t.countOpenSearch+=1}}},[r("i",{class:t.transBtn.search.icon}),t._v("\n                        "+t._s(t.transBtn.search.text)+"\n                    ")]),t._v(" "),r("button",{class:t.transBtn.create.class+" btn-lg tw-w-25 mr-2",on:{click:function(e){return e.preventDefault(),t.indexPage(e)}}},[r("i",{class:t.transBtn.create.icon}),t._v("\n                        "+t._s(t.transBtn.create.text)+"\n                    ")]),t._v(" "),r("button",{class:t.transBtn.save.class+" btn-lg tw-w-25",attrs:{disabled:!t.header.can.save},on:{click:function(e){return e.preventDefault(),t.save(e)}}},[r("i",{class:t.transBtn.save.icon}),t._v("\n                        "+t._s(t.transBtn.save.text)+"\n                    ")]),t._v(" "),""==t.header.request_number?r("button",{class:t.transBtn.print.class+" btn-lg tw-w-25",attrs:{disabled:!0}},[r("i",{class:t.transBtn.print.icon}),t._v("\n                        "+t._s(t.transBtn.print.text)+"\n                    ")]):r("a",{class:t.transBtn.print.class+" btn-lg tw-w-25",attrs:{href:t.url.print_pdf,target:"_blank"}},[r("i",{class:t.transBtn.print.icon}),t._v("\n                        "+t._s(t.transBtn.print.text)+"\n                    ")]),t._v(" "),r("button",{staticClass:"btn btn-primary btn-lg",attrs:{disabled:!t.header.can.transfer},on:{click:function(e){return e.preventDefault(),t.setStatus("confirmTransfer")}}},[r("strong",[t._v("ยืนยันขอโอนวัตถุดิบ")])]),t._v(" "),r("button",{staticClass:"btn btn-w-m btn-danger btn-lg",attrs:{disabled:!t.header.can.cancel_transfer},on:{click:function(e){return e.preventDefault(),t.setStatus("cancelTransfer")}}},[r("i",{staticClass:"fa fa-times"}),t._v(" ยกเลิกใบเบิก\n                    ")])])])]),t._v(" "),r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-lg-6 b-r"},[r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right",attrs:{for:"lb-1"}},[t._v("หน่วยงานที่ขอเบิก: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("input",{staticClass:"form-control",attrs:{id:"lb-1",type:"text",name:"department_code",disabled:!0},domProps:{value:t.header.organization.display}})])]),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right",attrs:{for:"lb-2"}},[t._v("เลขที่ใบเบิก: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("input",{staticClass:"form-control",attrs:{id:"lb-2",type:"text",name:"request_number",disabled:!0,value:""},domProps:{value:t.header.request_number}})])]),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right required",attrs:{for:"lb-3"}},[t._v("วันที่ขอเบิก: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{name:"input_date",id:"input_date",placeholder:"โปรดเลือกวันที่",disabled:!t.header.can.edit,value:t.header.request_date_format,format:t.transDate["js-format"]},on:{dateWasSelected:function(e){for(var a=arguments.length,r=Array(a);a--;)r[a]=arguments[a];return t.setdate.apply(void 0,r.concat(["request_date_format"]))}}}),t._v(" "),t.validateFrom.request_date_format.is_valid?t._e():r("div",[r("span",{staticClass:"form-text m-b-none text-danger"},[t._v("\n                                    "+t._s(t.validateFrom.request_date_format.message)+"\n                                ")])])],1)]),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{class:"col-lg-4 font-weight-bold col-form-label text-right "+t.labelAttr3Class},[t._v("\n                            ประเภทวัตถุดิบ:\n                        ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[1==t.header.attribute2?[3==t.header.objective_code?r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",disabled:!t.header.can.edit},on:{change:t.selectAttribute3},model:{value:t.header.attribute3,callback:function(e){t.$set(t.header,"attribute3",e)},expression:"header.attribute3"}},t._l(t.data.item_cat_code_list,(function(e){return r("el-option",{key:JSON.stringify(e.item_cat_code),attrs:{label:e.item_cat_desc,value:e.item_cat_code}})})),1):2==t.header.objective_code?r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",disabled:!t.header.can.edit},on:{change:t.selectIngredientGroup},model:{value:t.header.attribute3,callback:function(e){t.$set(t.header,"attribute3",e)},expression:"header.attribute3"}},t._l(t.data.item_cat_for_prod_list,(function(e){return r("el-option",{key:JSON.stringify(e.item_cat_code),attrs:{label:e.item_cat_desc,value:e.item_cat_code}})})),1):r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",disabled:!t.header.can.edit||2==t.header.attribute2},on:{change:t.selectIngredientGroup},model:{value:t.header.ingredient_group,callback:function(e){t.$set(t.header,"ingredient_group",e)},expression:"header.ingredient_group"}},t._l(t.data.ingredient_group_list,(function(e){return r("el-option",{key:JSON.stringify(e),attrs:{label:e.item_classification,value:e.item_classification_code}})})),1)]:[3==t.header.objective_code?r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",disabled:!t.header.can.edit},on:{change:t.selectAttribute3},model:{value:t.header.attribute3,callback:function(e){t.$set(t.header,"attribute3",e)},expression:"header.attribute3"}},t._l(t.data.item_cat_code_list,(function(e){return r("el-option",{key:JSON.stringify(e.item_cat_code),attrs:{label:e.item_cat_desc,value:e.item_cat_code}})})),1):2==t.header.objective_code?r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",disabled:!t.header.can.edit},on:{change:t.selectAttribute3},model:{value:t.header.attribute3,callback:function(e){t.$set(t.header,"attribute3",e)},expression:"header.attribute3"}},t._l(t.data.item_cat_for_prod_list,(function(e){return r("el-option",{key:JSON.stringify(e.item_cat_code),attrs:{label:e.item_cat_desc,value:e.item_cat_code}})})),1):r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",filterable:"",disabled:!t.header.can.edit||2==t.header.attribute2},on:{change:t.selectIngredientGroup},model:{value:t.header.ingredient_group,callback:function(e){t.$set(t.header,"ingredient_group",e)},expression:"header.ingredient_group"}},t._l(t.data.ingredient_group_list,(function(e){return r("el-option",{key:JSON.stringify(e),attrs:{label:e.item_classification,value:e.item_classification_code}})})),1)],t._v(" "),t.validateFrom.attribute3.is_valid?t._e():r("div",[r("span",{staticClass:"form-text m-b-none text-danger"},[t._v("\n                                    "+t._s(t.validateFrom.attribute3.message)+"\n                                ")])])],2)]),t._v(" "),1!=t.header.attribute2||"M03"==t.header.organization.organization_code||t.isFmOtherProgram?t._e():r("div",{staticClass:"form-group row"},[1==t.header.objective_code?[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right required"},[t._v("\n                                Blend No.:\n                            ")])]:[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v("\n                                Blend No.:\n                            ")])],t._v(" "),r("div",{staticClass:"col-lg-6"},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"blend_no",disabled:t.disabledInput.blend_no||!t.header.can.edit,clearable:"",filterable:""},on:{change:function(e){return t.selectInventoryItem("blend_no")}},model:{value:t.header.blend_no,callback:function(e){t.$set(t.header,"blend_no",e)},expression:"header.blend_no"}},t._l(t.data.blend_no_list,(function(e){return r("el-option",{key:JSON.stringify(e),attrs:{label:e,value:e}})})),1)],1)],2),t._v(" "),r("div",{staticClass:"form-group row"},[1==t.header.objective_code?[r("label",{class:"col-lg-4 font-weight-bold col-form-label text-right "+t.labelItemClass},[t._v("สินค้าที่จะผลิต: ")])]:[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v("สินค้าที่จะผลิต: ")])],t._v(" "),r("div",{staticClass:"col-lg-6"},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"blend_no",disabled:t.disabledInput.inventory_item_id||!t.header.can.edit||"A12"==t.header.organization.organization_code||t.isFmOtherProgram,clearable:"",filterable:""},on:{change:function(e){return t.selectInventoryItem("inventory_item_id")}},model:{value:t.header.inventory_item_id,callback:function(e){t.$set(t.header,"inventory_item_id",e)},expression:"header.inventory_item_id"}},t._l(t.data.item_list,(function(e){return r("el-option",{key:JSON.stringify(e),attrs:{label:e.display,value:e.inventory_item_id}})})),1),t._v(" "),t.validateFrom.inventory_item_id.is_valid?t._e():r("div",[r("span",{staticClass:"form-text m-b-none text-danger"},[t._v("\n                                    "+t._s(t.validateFrom.inventory_item_id.message)+"\n                                ")])])],1)],2),t._v(" "),r("div",{staticClass:"form-group row"},[1==t.header.objective_code?[r("label",{class:"col-lg-4 font-weight-bold col-form-label text-right "+t.labelReqQtyClass},[t._v("จำนวนที่สั่งผลิต: ")])]:[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v("จำนวนที่สั่งผลิต: ")])],t._v(" "),r("div",{staticClass:"col-lg-3"},[r("input",{staticClass:"form-control text-right",attrs:{type:"text",oninput:"validity.valid||(value='');",disabled:!t.header.inventory_item_id||t.disabledInput.inventory_item_id||!t.header.can.edit},domProps:{value:t.numberFormat(t.header.request_quantity)},on:{input:function(a){t.header.request_quantity=t.stripNonNumber(a.target.value),e.header.request_quantity<0&&(e.header.request_quantity=0)}}})]),t._v(" "),r("div",{staticClass:"col-lg-3"},[t.secondaryUomList.length&&t.selectProdItem?r("el-select",{staticClass:"text-right",attrs:{placeholder:"",filterable:"",disabled:!t.header.inventory_item_id||t.disabledInput.inventory_item_id||!t.header.can.edit},on:{change:t.changeRequestQuantity},model:{value:t.header.attribute1,callback:function(e){t.$set(t.header,"attribute1",e)},expression:"header.attribute1"}},t._l(t.secondaryUomList,(function(e){return r("el-option",{key:JSON.stringify(e),attrs:{label:e.from_uom.unit_of_measure,value:e.from_uom_code}})})),1):r("input",{staticClass:"form-control",attrs:{title:t.selectProdItem.primary_uom_code,disabled:""},domProps:{value:t.selectProdItem.product_unit_of_measure}})],1),t._v(" "),t.validateFrom.request_quantity.is_valid?t._e():r("div",{staticClass:"col-lg-6 offset-4"},[r("span",{staticClass:"form-text m-b-none text-danger"},[t._v("\n                                "+t._s(t.validateFrom.request_quantity.message)+"\n                            ")])])],2)]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v("ผู้ขอเบิก: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("input",{staticClass:"form-control",attrs:{type:"text",autocomplete:"off",disabled:"disabled"},domProps:{value:t.user.user_name}})])]),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right required"},[t._v("วัตถุประสงค์ในการเบิก: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"objective_code",disabled:!t.header.can.edit,filterable:""},on:{change:t.selectObjectiveCode},model:{value:t.header.objective_code,callback:function(e){t.$set(t.header,"objective_code",e)},expression:"header.objective_code"}},t._l(t.data.objective_code_list,(function(e){return r("el-option",{key:JSON.stringify(e),attrs:{label:e.description,value:e.lookup_code}})})),1)],1)]),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v("สถานะขอเบิก: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("input",{staticClass:"form-control",attrs:{type:"text",readonly:"",disabled:""},domProps:{value:function(){if(t.header.request_status){var e=t.data.request_status_list.find((function(e){return e.lookup_code==t.header.request_status}));if(e)return e.description}return null}()}})])]),t._v(" "),r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label required text-right"},[t._v("วันที่นำส่ง ยสท.: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{name:"input_date",id:"input_date",disabled:!t.header.can.edit,placeholder:"โปรดเลือกวันที่",value:t.header.send_date_format,format:t.transDate["js-format"],disabledDateTo:t.header.sysdate},on:{dateWasSelected:function(e){for(var a=arguments.length,r=Array(a);a--;)r[a]=arguments[a];return t.setdate.apply(void 0,r.concat(["send_date_format"]))}}}),t._v(" "),t.validateFrom.send_date_format.is_valid?t._e():r("div",[r("span",{staticClass:"form-text m-b-none text-danger"},[t._v("\n                                    "+t._s(t.validateFrom.send_date_format.message)+"\n                                ")])])],1)]),t._v(" "),2==t.header.attribute2&&t.header.inventory_item_id?r("div",{staticClass:"form-group row"},[r("label",{staticClass:"col-lg-4 font-weight-bold col-form-label text-right"},[t._v("ขั้นตอนการทำงาน: ")]),t._v(" "),r("div",{staticClass:"col-lg-6"},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"blend_no",disabled:t.disabledInput.inventory_item_id||!t.header.can.edit,clearable:"",filterable:""},on:{change:t.selectWorkStep},model:{value:t.header.work_step,callback:function(e){t.$set(t.header,"work_step",e)},expression:"header.work_step"}},[r("el-option",{key:"",attrs:{label:"ทุกขั้นตอน",value:""}}),t._v(" "),t._l(t.workStepList,(function(e){return e.oprn_no?r("el-option",{key:JSON.stringify(e.oprn_no),attrs:{label:e.oprn_desc,value:e.oprn_no}}):t._e()}))],2)],1)]):t._e(),t._v(" "),r("div",{staticClass:"form-group row mt-5"},[r("div",{staticClass:"col-lg-10 text-right"},[r("button",{class:t.transBtn.search.class+" btn-lg tw-w-25 mr-2",attrs:{disabled:t.isFmOtherProgram},on:{click:function(e){return e.preventDefault(),t.getLines()}}},[r("i",{class:t.transBtn.search.icon}),t._v(" "),t._v("\n                                แสดงข้อมูล\n                            ")])])])])])])],1),t._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.lines,expression:"loading.lines"}],staticClass:"ibox float-e-margins"},[r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-10 text-left"},[t.data.type_code_list[t.header.ingredient_group]&&1==(1==t.header.attribute2&&t.header.objective_code)?r("div",{},[r("el-radio-group",{attrs:{size:"large"},on:{change:t.selectTypeCode},model:{value:t.header.type_code,callback:function(e){t.$set(t.header,"type_code",e)},expression:"header.type_code"}},[r("el-radio",{staticClass:"mr-0 mb-1",attrs:{label:"selectAll",border:""}},[t._v("\n                                รายการเลือกเบิกทั้งหมด\n                            ")]),t._v(" "),t._l(t.header.ingredient_group?t.data.type_code_list[t.header.ingredient_group]:[],(function(e){return[r("el-radio",{staticClass:"mr-0 mb-1",attrs:{label:e.type_code,border:""}},[t._v("\n                                    "+t._s(e.type_desc)+"\n                                ")])]}))],2)],1):r("div",{},[r("el-radio-group",{attrs:{size:"large"},on:{change:t.selectTypeCode},model:{value:t.header.type_code,callback:function(e){t.$set(t.header,"type_code",e)},expression:"header.type_code"}},[r("el-radio",{staticClass:"mr-0 mb-1",attrs:{label:"selectAll",border:""}},[t._v("\n                                รายการเลือกเบิกทั้งหมด\n                            ")]),t._v(" "),t.data.type_code_list[t.header.ingredient_group]?t._e():r("el-radio",{staticClass:"mr-0 mb-1",attrs:{label:"selectItemList",border:""}},[t._v("\n                                รายการค้นหาทั้งหมด\n                            ")])],1)],1)]),t._v(" "),r("div",{staticClass:"col-2"},[r("div",{staticClass:"text-right"},[r("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[t.header.inventory_item_id?t._e():r("button",{class:t.transBtn.create.class+" btn-lg tw-w-25",attrs:{disabled:!t.header.can.edit||t.isFmOtherProgram},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[r("i",{class:t.transBtn.create.icon}),t._v("\n                                เพิ่มรายการ\n                            ")])])],1)])])]),t._v(" "),r("div",{staticClass:"ibox-content"},[r("div",{staticClass:"table-responsive m-t"},[r("table",{staticClass:"table text-nowrap table-bordered table-hover"},[r("thead",[r("tr",[r("th",{attrs:{width:"10px;"}}),t._v(" "),r("th",{attrs:{width:"150px;"}},[t._v("\n                                        \n                                        \n                                รหัสวัตถุดิบ\n                                        \n                                        \n                            ")]),t._v(" "),r("th",[t._v("รายละเอียด")]),t._v(" "),"M02"==t.header.organization.organization_code||"M03"==t.header.organization.organization_code?r("th",{staticClass:"text-right",attrs:{width:"70px;"}},[t._v("Lot")]):t._e(),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),r("th",{staticClass:"text-right",attrs:{width:"100px;"}},[t._v("\n                                     \n                                ปริมาณเบิก\n                                     \n                            ")]),t._v(" "),r("th",{staticClass:"text-center",staticStyle:{"min-width":"150 px"}},[t._v("\n                                หน่วยเบิก\n                            ")]),t._v(" "),r("th",{staticClass:"text-center",staticStyle:{"min-width":"150 px"}},[t._v("\n                                หมายเหตุ\n                            ")])])]),t._v(" "),r("tbody",t._l(t.lines,(function(e,a){return t.lines.length?r("tr",[r("td",{staticClass:"align-middle text-center",attrs:{date:a}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.is_selected,expression:"line.is_selected"}],attrs:{type:"checkbox",disabled:!t.header.can.edit},domProps:{checked:Array.isArray(e.is_selected)?t._i(e.is_selected,null)>-1:e.is_selected},on:{click:function(r){return t.selectLine(a,e)},change:function(a){var r=e.is_selected,n=a.target,i=!!n.checked;if(Array.isArray(r)){var s=t._i(r,null);n.checked?s<0&&t.$set(e,"is_selected",r.concat([null])):s>-1&&t.$set(e,"is_selected",r.slice(0,s).concat(r.slice(s+1)))}else t.$set(e,"is_selected",i)}}})]),t._v(" "),r("td",[t.header.inventory_item_id?[t._v("\n                                    "+t._s(e.item_number)+"\n                                ")]:[r("div",{staticStyle:{display:"flex"}},[e.is_edit_item&&t.header.can.edit?[r("search-item",{attrs:{pHeader:t.pHeader,inventoryItemId:e.inventory_item_id,url:t.url},on:{itemWasSelected:function(a){for(var r=arguments.length,n=Array(r);r--;)n[r]=arguments[r];return t.itemWasSelected.apply(void 0,n.concat([e]))}}})]:[t._v("\n                                            "+t._s(e.item_number)+"\n                                        ")]],2)]],2),t._v(" "),r("td",[t._v(t._s(e.item_desc))]),t._v(" "),"M02"==t.header.organization.organization_code||"M03"==t.header.organization.organization_code?r("td",{staticClass:"text-right"},[t._v(t._s(e.lot_number))]):t._e(),t._v(" "),r("td",{staticClass:"text-center"},[t._v(t._s(e.use_lose_qty))]),t._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.transaction_quantity,expression:"line.transaction_quantity",modifiers:{number:!0}}],staticClass:"form-control text-right",attrs:{type:"number",min:"0",oninput:"validity.valid||(value='');",disabled:!t.header.can.edit||!e.inventory_item_id||!0},domProps:{value:e.transaction_quantity},on:{change:function(r){return t.changeQty(a,e,"transaction_quantity")},input:function(a){a.target.composing||t.$set(e,"transaction_quantity",t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),r("td",{staticClass:"text-right",attrs:{title:e.transaction_uom}},[t._v("\n                                "+t._s(e.transaction_uom_desc)+"\n                            ")]),t._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.secondary_qty,expression:"line.secondary_qty",modifiers:{number:!0}}],staticClass:"form-control text-right",attrs:{type:"number",min:"0",oninput:"validity.valid||(value='');",disabled:!t.header.can.edit||!e.secondary_uom_list.length},domProps:{value:e.secondary_qty},on:{change:function(r){return t.changeQty(a,e,"secondary_qty")},input:function(a){a.target.composing||t.$set(e,"secondary_qty",t._n(a.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),r("td",{attrs:{title:e.secondary_uom}},[r("el-select",{staticClass:"text-right",attrs:{placeholder:"",filterable:"",disabled:!t.header.can.edit||!e.secondary_uom_list.length},on:{change:function(r){return t.changeQty(a,e,"secondary_uom")}},model:{value:e.secondary_uom,callback:function(a){t.$set(e,"secondary_uom",a)},expression:"line.secondary_uom"}},t._l(e.secondary_uom_list,(function(e){return r("el-option",{key:JSON.stringify(e),attrs:{label:e.from_uom.unit_of_measure,value:e.from_uom_code}})})),1)],1),t._v(" "),r("td",[r("el-input",{attrs:{type:"textarea",name:"description",disabled:!t.header.can.edit,rows:"1",maxlength:"240","show-word-limit":""},model:{value:e.remark_msg,callback:function(a){t.$set(e,"remark_msg",a)},expression:"line.remark_msg"}})],1)]):t._e()})),0)])]),t._v(" "),0===t.lines.length?r("div",{staticClass:"text-center"},[r("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])])}),[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"col-3"},[a("h3",{staticClass:"no-margins"},[e._v(" การขอเบิกวัตถุดิบนอกแผน ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("th",{staticClass:"text-center",attrs:{width:"100px;"}},[e._v("\n                                ปริมาณที่ใช้\n                                "),a("br"),e._v("+\n                                "),a("br"),e._v("สูญเสีย\n                            ")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("th",{staticClass:"text-center",attrs:{width:"100px;"}},[e._v("\n                                              \n                                              \n                                "),a("br"),e._v("ปริมาณเบิก"),a("br"),e._v("หลัก"),a("br"),e._v("\n                                              \n                                              \n                            ")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("th",{staticClass:"text-center",attrs:{width:"100px;"}},[e._v("\n                                              \n                                "),a("br"),e._v("หน่วยเบิก"),a("br"),e._v("หลัก"),a("br"),e._v("\n                                              \n                            ")])}],!1,null,null,null).exports},51900:(e,t,a)=>{"use strict";function r(e,t,a,r,n,i,s,o){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),r&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),s?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=l):n&&(l=o?function(){n.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:n),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}a.d(t,{Z:()=>r})}}]);