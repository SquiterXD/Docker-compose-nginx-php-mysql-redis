(self.webpackChunk=self.webpackChunk||[]).push([[6725],{56725:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>i});var a=s(87757),r=s.n(a);function n(t,e,s,a,r,n,o){try{var l=t[n](o),i=l.value}catch(t){return void s(t)}l.done?e(i):Promise.resolve(i).then(a,r)}function o(t){return function(){var e=this,s=arguments;return new Promise((function(a,r){var o=t.apply(e,s);function l(t){n(o,a,r,l,i,"next",t)}function i(t){n(o,a,r,l,i,"throw",t)}l(void 0)}))}}const l={props:["pUser","pRouteList","pRoleList","pOrgList"],data:function(){return{user:null,email:null,oaUserId:null!=this.pUser&&""!=this.pUser?parseInt(this.pUser.fnd_user_id):"",loading:!1,username:null!=this.pUser&&""!=this.pUser?this.pUser.username:"",orgId:null!=this.pUser&&""!=this.pUser?this.pUser.organization_id:"",users:[],oaUserList:[],roleList:[],invOrgOptions:[],assignDeptList:{}}},mounted:function(){""!=this.username&&this.getUsers({username:this.username}),""!=this.oaUserId&&this.getOAUser({user_id:this.oaUserId}),this.pUser&&this.pUser.department_options.length>0&&(this.assignDeptList=this.pUser.department_options),this.pUser&&this.pUser.inv_org_options.length>0&&(this.invOrgOptions=this.pUser.inv_org_options),this.pUser&&this.pUser.role_options.length>0&&(this.roleList=this.pUser.role_options)},methods:{addAssignDeptList:function(){var t=0;for(var e in this.assignDeptList)t=t<parseFloat(e)?parseFloat(e):t;this.$set(this.assignDeptList,t+1,{department_list:[],department_code:null,end_date:null})},delAssignDeptList:function(t){this.$delete(this.assignDeptList,t)},remoteMethodOAUser:function(t){""!==t&&this.getOAUser({name:t})},getOAUser:function(t){var e=this;return o(r().mark((function s(){var a;return r().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=[],s.next=3,axios.get(e.pRouteList.ajax_get_oa_user,{params:t}).then((function(t){a=t.data.data}));case 3:e.oaUserList=a;case 4:case"end":return s.stop()}}),s)})))()},remoteMethodDept:function(t,e){""!==t&&this.getDepartment({name:t},e)},getDepartment:function(t,e){var s=this;return o(r().mark((function a(){var n;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=[],a.next=3,axios.get(s.pRouteList.ajax_get_department,{params:t}).then((function(t){n=t.data.data}));case 3:s.assignDeptList[e].department_list=n;case 4:case"end":return a.stop()}}),a)})))()},remoteMethod:function(t){""!==t?this.getUsers({name:t}):this.users=[]},getUsers:function(t){var e=this;return o(r().mark((function s(){return r().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e.user=null,e.loading=!0,axios.get(e.pRouteList.ajax_get_user,{params:t}).then((function(t){e.loading=!1,e.users=t.data.data,e.setUser()}));case 3:case"end":return s.stop()}}),s)})))()},setUser:function(){var t=this;return o(r().mark((function e(){var s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.username&&t.users.length>0?(s=t.users.filter((function(e){return e.username==t.username})),t.user=s[0],t.email=t.user.email):t.user=null;case 1:case"end":return e.stop()}}),e)})))()},save:function(){var t=this;return o(r().mark((function e(){var s,a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=t.pUser){e.next=5;break}return e.next=3,axios.post(t.pRouteList.ajax_users_store,{name:t.user.first_name+" "+t.user.last_name,username:t.username,email:t.email,password:t.user.id_card,department_code:t.user.dept_code_account,fnd_user_id:t.oaUserId,role_options:t.roleList,inv_org_options:t.invOrgOptions,department_options:t.assignDeptList,organization_id:t.orgId}).then((function(e){"S"==e.data.data.status&&(window.location.href=t.pRouteList.users_index)}));case 3:e.next=11;break;case 5:return s=t.pUser.name,a="",n=t.pUser.department_code,t.user&&(s=t.user.first_name+" "+t.user.last_name,a=t.user.id_card,n=t.user.dept_code_account),e.next=11,axios.patch(t.pRouteList.ajax_users_update,{username:t.username,name:s,email:t.email,password:a,department_code:n,fnd_user_id:t.oaUserId,role_options:t.roleList,inv_org_options:t.invOrgOptions,department_options:t.assignDeptList,organization_id:t.orgId}).then((function(e){"S"==e.data.data.status&&(window.location.href=t.pRouteList.users_index)}));case 11:case"end":return e.stop()}}),e)})))()}}};const i=(0,s(51900).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"row"},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-6 col-md-6 col-sm-6 col-xs-6 offset-md-3 mt-2"},[t._m(0),t._v(" "),s("el-select",{staticStyle:{width:"100%"},attrs:{disabled:""!=t.pUser,filterable:"",clearable:"",remote:"",placeholder:"ชื่อ หรือ นามสกุล","remote-method":t.remoteMethod,loading:t.loading},on:{change:t.setUser},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}},t._l(t.users,(function(t){return s("el-option",{key:t.lable,attrs:{label:t.lable,value:t.username}})})),1)],1)]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-6 col-md-6 col-sm-6 col-xs-6 offset-md-3 mt-2"},[t._m(1),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control col-12",attrs:{placeholder:"Email",autocomplete:"off",type:"text"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})])]),t._v(" "),s("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[null!=t.user?s("div",{staticClass:"row "},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-3 col-md-3 col-sm-3 col-xs-3 offset-md-3 mt-2"},[s("div",{staticClass:"control-label"},[s("strong",[t._v("HR: First Name ")])]),t._v(" "),s("p",{staticClass:"text-muted pl-3 mb-0"},[s("strong",[t._v(" "+t._s(t.user.first_name)+" ")])])]),t._v(" "),s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-3 col-md-3 col-sm-3 col-xs-3 mt-2"},[s("div",{staticClass:"control-label "},[s("strong",[t._v("HR: Last Name ")])]),t._v(" "),s("p",{staticClass:"text-muted pl-3 mb-0"},[s("strong",[t._v(" "+t._s(t.user.last_name)+" ")])])]),t._v(" "),s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-6 col-md-6 col-sm-6 col-xs-6  offset-md-3 mt-2"},[s("div",{staticClass:"control-label "},[s("strong",[t._v("HR: Department Code ")])]),t._v(" "),s("p",{staticClass:"text-muted pl-3 mb-0"},[s("strong",[t._v(" "+t._s(t.user.dept_code_account)+" ")])]),t._v(" "),""!=t.pUser&&t.user.dept_code_account!=t.pUser.department_code?s("div",{staticClass:"mt-2"},[s("button",{staticClass:"btn btn-w-m btn-primary",attrs:{type:"button"},on:{click:t.save}},[t._v("\n                        อัพเดท Department Code\n                    ")])]):t._e()])]):t._e()]),t._v(" "),t._m(2),t._v(" "),s("div",{staticClass:"row "},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-6 col-md-6 col-sm-6 col-xs-6 offset-md-3 text-right"},[s("button",{staticClass:"btn btn-w-m btn-primary",attrs:{type:"button"},on:{click:t.addAssignDeptList}},[s("i",{staticClass:"fa fa-plus"}),t._v(" Add Dept.\n            ")])])]),t._v(" "),t._l(t.assignDeptList,(function(e,a){return s("div",{staticClass:"row "},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-3 col-md-3 col-sm-3 col-xs-3 offset-md-3 mt-2"},[t._m(3,!0),t._v(" "),s("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",remote:"",placeholder:"Department Code","remote-method":function(e){return t.remoteMethodDept(e,a)},loading:t.loading},model:{value:e.department_code,callback:function(s){t.$set(e,"department_code",s)},expression:"assign.department_code"}},t._l(e.department_list,(function(t){return s("el-option",{key:t.description,attrs:{label:t.description,value:t.department_code}})})),1)],1),t._v(" "),s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-3 col-md-3 col-sm-3 col-xs-3 mt-2"},[t._m(4,!0),t._v(" "),s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"Pick a day"},model:{value:e.end_date,callback:function(s){t.$set(e,"end_date",s)},expression:"assign.end_date"}})],1),t._v(" "),s("div",{staticClass:"form-group text-left pl-12 pr-2 mb-0 col-lg-1 col-md-1 col-sm-1 col-xs-1 mt-2"},[s("div",{staticClass:"control-label mb-2"},[t._v("\n                 \n            ")]),t._v(" "),s("a",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.delAssignDeptList(a)}}},[s("i",{staticClass:"fa fa-times-circle fa-2x text-danger"})])])])})),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-3 col-md-6 col-sm-6 col-xs-6 offset-md-3 mt-2"},[t._m(5),t._v(" "),s("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",remote:"",placeholder:"","remote-method":t.remoteMethodOAUser,loading:t.loading},model:{value:t.oaUserId,callback:function(e){t.oaUserId=e},expression:"oaUserId"}},t._l(t.oaUserList,(function(t){return s("el-option",{key:t.user_name,attrs:{label:t.user_name,value:t.user_id}})})),1)],1),t._v(" "),s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-3 col-md-6 col-sm-6 col-xs-6  mt-2"},[t._m(6),t._v(" "),s("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:""},model:{value:t.orgId,callback:function(e){t.orgId=e},expression:"orgId"}},t._l(t.pOrgList,(function(t,e){return s("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1)]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-6 col-md-6 col-sm-6 col-xs-6 offset-md-3 mt-2"},[t._m(7),t._v(" "),s("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",clearable:"",remote:"",placeholder:""},model:{value:t.roleList,callback:function(e){t.roleList=e},expression:"roleList"}},t._l(t.pRoleList,(function(t,e){return s("el-option",{key:t,attrs:{label:t,value:e}})})),1)],1)]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-6 col-md-6 col-sm-6 col-xs-6 offset-md-3 mt-2"},[t._m(8),t._v(" "),s("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",clearable:"",remote:"",placeholder:""},model:{value:t.invOrgOptions,callback:function(e){t.invOrgOptions=e},expression:"invOrgOptions"}},t._l(t.pOrgList,(function(t,e){return s("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1)]),t._v(" "),s("div",{staticClass:"col-12 mt-3"},[s("hr"),t._v(" "),s("div",{staticClass:"row clearfix m-t-lg text-right"},[s("div",{staticClass:"col-sm-12"},[s("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"},on:{click:t.save}},[t._v(" Save ")]),t._v(" "),s("a",{staticClass:"btn btn-sm btn-white",attrs:{href:t.pRouteList.users_index,type:"button"}},[t._v(" Cancel ")])])])])],2)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label mb-2"},[s("strong",[t._v(" Username ")]),t._v(" "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label mb-2"},[s("strong",[t._v(" Email ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row "},[e("div",{staticClass:"form-group pl-12 pr-2 mb-0 col-lg-6 col-md-6 col-sm-6 col-xs-6 offset-md-3 mt-2"},[e("div",{staticClass:"hr-line-dashed"})])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label"},[s("strong",[t._v(" Department Code ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label "},[s("strong",[t._v(" End Date ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label mb-2"},[s("strong",[t._v(" OA User ")]),t._v(" "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label mb-2"},[s("strong",[t._v(" Organization Control ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label mb-2"},[s("strong",[t._v(" Role ")]),t._v(" "),s("span",{staticClass:"text-danger"},[t._v("*")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"control-label mb-2"},[s("strong",[t._v("Assign Org")])])}],!1,null,null,null).exports}}]);