(self.webpackChunk=self.webpackChunk||[]).push([[7047],{67218:(t,e,a)=>{"use strict";a.d(e,{Z:()=>s});var n=a(23645),r=a.n(n)()((function(t){return t[1]}));r.push([t.id,".fruit-table-move[data-v-447ec99c]{transition:transform 1s}",""]);const s=r},61256:(t,e,a)=>{"use strict";a.d(e,{Z:()=>s});var n=a(23645),r=a.n(n)()((function(t){return t[1]}));r.push([t.id,".fruit-table-move[data-v-41ea9d5c]{transition:transform 1s}",""]);const s=r},56817:(t,e,a)=>{"use strict";a.d(e,{Z:()=>s});var n=a(23645),r=a.n(n)()((function(t){return t[1]}));r.push([t.id,".fruit-table-move[data-v-b501f21e]{transition:transform 1s}",""]);const s=r},47047:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>bt});var n=a(87757),r=a.n(n),s=a(30381),i=a.n(s);function o(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}const l={props:["pHeader","inventoryItemId","url"],computed:{},watch:{},data:function(){return{itemId:null!=this.inventoryItemId&&""!=this.inventoryItemId?parseInt(this.inventoryItemId):"",loading:!1,items:[]}},mounted:function(){console.log("Component mounted."),""!==this.itemId?this.getItems({inventory_item_id:this.itemId,header:this.pHeader}):this.items=[]},methods:{itemWasSelected:function(t){var e,a=this;return(e=r().mark((function e(){var n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(s=(n=a).items.filter((function(e){return e.inventory_item_id==t}))).length&&(s=s[0]),n.$emit("itemWasSelected",s);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(n,r){var s=e.apply(t,a);function i(t){o(s,n,r,i,l,"next",t)}function l(t){o(s,n,r,i,l,"throw",t)}i(void 0)}))})()},remoteMethod:function(t){""!==t?this.getItems({number:t,header:this.pHeader}):this.items=[]},getItems:function(t){var e=this;e.loading=!0,axios.get(e.url.ajax_get_item,{params:t}).then((function(t){var a=t.data.data;e.loading=!1,e.items=a.items}))}}};var c=a(51900);const d=(0,c.Z)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"รหัสวัตถุดิบ","remote-method":t.remoteMethod,loading:t.loading},on:{change:t.itemWasSelected},model:{value:t.itemId,callback:function(e){t.itemId=e},expression:"itemId"}},t._l(t.items,(function(t,e){return a("el-option",{key:parseInt(t.inventory_item_id),attrs:{label:t.display,value:parseInt(t.inventory_item_id)}})})),1)],1)}),[],!1,null,null,null).exports;a(80455);function u(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function f(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){u(s,n,r,i,o,"next",t)}function o(t){u(s,n,r,i,o,"throw",t)}i(void 0)}))}}var p,v;const m={props:["header","leaf","leafProportion","url","transBtn","transDate","pRefresh","data"],computed:{ingredientsCount:function(){if(this.ingredients&&this.ingredients.length){var t=this.ingredients.filter((function(t){return 0==t.is_deleted}));return parseFloat(t.length)}return 0},totalIngredientProp:function(){var t=0;return this.ingredients.forEach((function(e,a){0==e.is_deleted&&(t=parseFloat(t)+parseFloat(e.ingredient_proportions))})),parseFloat(t)},totalQuantityUsed:function(){var t=this,e=0;return t.ingredients.forEach((function(t,a){0==t.is_deleted&&(e=parseFloat(e)+parseFloat(t.quantity_used))})),t.totalQuantityUsedValue=parseFloat(e),t.totalQuantityUsedValue}},watch:{leafProportion:(v=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.ingredients&&this.ingredients.length;case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return v.apply(this,arguments)}),ingredients:(p=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("watch ingredients:  emit => syncIngredients"),this.$emit("syncIngredients",e);case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return p.apply(this,arguments)}),"header.quantity":function(t){this.reCalIngredientProportion()},"header.can.leaf_formulas.ingredient.add_lot_number":function(t){t||this.ingredients.forEach((function(t,e){0==t.is_deleted&&(t.lot_number="")}))}},data:function(){return{loading:!1,leafFormulaProportion:this.leaf.leaf_proportion,ingredients:this.leaf.leaf_dtl,totalQuantityUsedValue:0}},mounted:function(){console.log("LeafIngredient: Component mounted.")},methods:{addNewLine:function(){var t=this;return f(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).ingredients.length,e.next=4,_.clone(a.data.ingredient_new_line);case 4:s=e.sent,a.$set(a.ingredients,n,s),a.remoteMethod(" ",s,"item_list"),a.changeIngredientProportions(s,!1);case 8:case"end":return e.stop()}}),e)})))()},deleteAll:function(){var t=this;return f(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.ingredients.forEach(function(){var t=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.is_deleted=!0;case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))()},selectInventoryItemId:function(t){var e=this;return f(r().mark((function a(){var n;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=t.item_list.findIndex((function(e){return e.value==t.inventory_item_id})),n=t.item_list[n],t.item_code=n.item_number,t.item_desc=n.item_desc,t.lot_number="",e.remoteMethod(" ",t,"lot_list");case 6:case"end":return a.stop()}}),a)})))()},selectLotNumber:function(t,e){var a=this;return f(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a.ingredients.forEach(function(){var a=f(r().mark((function a(n,s){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:0==n.is_deleted&&e!=s&&n.inventory_item_id==t.inventory_item_id&&n.lot_number==t.lot_number&&(t.lot_number="");case 1:case"end":return a.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}());case 2:case"end":return n.stop()}}),n)})))()},changeIngredientProportions:function(t){var e=arguments,a=this;return f(r().mark((function n(){var s,i,o,l,c;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s=!(e.length>1&&void 0!==e[1])||e[1],i=a,s?i.ingredients.length&&i.ingredients.forEach(function(){var t=f(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.changeIngredientProportions(e,!1);case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()):(o=0,l=parseFloat(i.leafProportion),c=parseFloat(t.ingredient_proportions),parseFloat(l)&&parseFloat(c)&&(o=l/100*100*(c/100),o=parseFloat(o)),console.log("else",t),t.quantity_used=o);case 3:case"end":return n.stop()}}),n)})))()},changeQuantityUsed:function(t,e){var a=this;return f(r().mark((function e(){var n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a,s=(s=parseFloat(t.quantity_used?t.quantity_used:0))<0?0:s,t.quantity_used=s,n.reCalIngredientProportion();case 5:case"end":return e.stop()}}),e)})))()},reCalIngredientProportion:function(){var t=this;return f(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("reCalIngredientProportion"),(a=t).ingredients.forEach(function(){var t=f(r().mark((function t(e,n){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.is_deleted){t.next=4;break}return t.next=3,a.calIngredientProportion(e);case 3:e.ingredient_proportions=t.sent;case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),t.$emit("syncIngredients",a.ingredients);case 4:case"end":return e.stop()}}),e)})))()},calIngredientProportion:function(t){var e=this;return f(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,s=t.quantity_used/n.totalQuantityUsedValue*100,a.abrupt("return",1*parseFloat(s||0).toFixed(5));case 3:case"end":return a.stop()}}),a)})))()},remoteMethod:function(t,e,a){var n=this;return f(r().mark((function s(){var i,o;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e[a]=[],i=n,(o=_.clone(e)).item_list=[],""!==t&&n.getData({header:i.header,number:t,line:o,type:a},e,a);case 5:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return f(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:(i=n).loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;i.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()}}};function h(t){return function(t){if(Array.isArray(t))return g(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return g(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function b(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function w(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){b(s,n,r,i,o,"next",t)}function o(t){b(s,n,r,i,o,"throw",t)}i(void 0)}))}}var x,y;const C={components:{LeafIngredient:(0,c.Z)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("h3",{staticClass:"text-navy"},[t._v("\n            รายการวัตถุดิบทั้งหมด: "+t._s(t.ingredientsCount)+"\n\n            "),a("button",{class:t.transBtn.delete.class+" btn-sm tw-w-25 pull-right  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.deleteAll(e)}}},[a("i",{class:t.transBtn.delete.icon}),t._v("\n                ลบทั้งหมด\n            ")]),t._v(" "),a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25 pull-right mr-2  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("table",{staticClass:"table mb-5 table-hover table-bordered"},[a("thead",[a("tr",[a("th",{attrs:{width:"230px;"}},[t._v("\n                    รหัสวัตถุดิบ\n                ")]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[t._v("\n                    เกรดใบยา\n                ")]),t._v(" "),t.header.can.leaf_formulas.ingredient.add_lot_number?[t._m(0)]:t._e(),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("th",{attrs:{width:"50px;"}})],2)]),t._v(" "),a("tbody",[t._l(t.ingredients,(function(e,n){return t.ingredients.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",[a("td",[[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",placeholder:"รหัสวัตถุดิบ","remote-method":function(a){return t.remoteMethod(a,e,"item_list")},disabled:!t.header.can.edit,loading:t.loading},on:{change:function(a){return t.selectInventoryItemId(e)}},model:{value:e.inventory_item_id,callback:function(a){t.$set(e,"inventory_item_id",a)},expression:"ingredient.inventory_item_id"}},t._l(e.item_list,(function(e,n){return a("el-option",{key:e.value,attrs:{label:e.item_number,value:String(e.value)}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.label))])])})),1)]],2),t._v(" "),a("td",[t._v("\n                        "+t._s(e.item_desc)+"\n                    ")]),t._v(" "),t.header.can.leaf_formulas.ingredient.add_lot_number?[a("td",[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",disabled:!e.inventory_item_id||!t.header.can.edit,remote:"",placeholder:"Lot Number","remote-method":function(a){return t.remoteMethod(a,e,"lot_list")},loading:t.loading},on:{change:function(a){return t.selectLotNumber(e,n)}},model:{value:e.lot_number,callback:function(a){t.$set(e,"lot_number",a)},expression:"ingredient.lot_number"}},t._l(e.lot_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1)]:t._e(),t._v(" "),a("td",[a("input",{staticClass:"form-control text-right",attrs:{disabled:"",title:e.ingredient_proportions},domProps:{value:Number(e.ingredient_proportions).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}})]),t._v(" "),a("td",{staticClass:"text-right",attrs:{title:e.uom}},[a("vue-numeric",{staticClass:"form-control text-right font-weight-bold text-navy",attrs:{disabled:!e.inventory_item_id||!t.header.can.edit,separator:",",precision:2,minus:!1},on:{change:function(a){return t.changeQuantityUsed(e,n)}},model:{value:e.quantity_used,callback:function(a){t.$set(e,"quantity_used",a)},expression:"ingredient.quantity_used"}})],1),t._v(" "),a("td",{staticClass:"text-center align-middle"},[a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})])])],2)])]:t._e()})),t._v(" "),a("tr",[a("th",{staticClass:"text-right",attrs:{colspan:t.header.can.leaf_formulas.ingredient.add_lot_number?3:2}},[t._v("\n                    รวม\n                ")]),t._v(" "),a("th",{staticClass:"text-right"},[t._v(t._s(t._f("number2Digit")(t.totalIngredientProp)))]),t._v(" "),a("th",{staticClass:"text-right font-weight-bold tw-text-base text-navy"},[t._v(t._s(t._f("number2Digit")(t.totalQuantityUsed)))]),t._v(" "),a("th")])],2)])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-center",attrs:{width:"200px;"}},[a("div",[t._v("Lot")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-center",attrs:{width:"130px;"}},[a("div",[t._v("สัดส่วน %")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-center",attrs:{width:"130px;"}},[a("div",[t._v("ปริมาณที่ใช้ (กก.)")])])}],!1,null,null,null).exports},props:["header","url","transBtn","transDate","pRefresh","data","leafFormulas","tabs"],computed:{totalProportion:function(){var t=_.sumBy(this.lines,(function(t){if(0==t.is_deleted)return parseFloat(t.leaf_proportion)}));return 1*parseFloat(t||0).toFixed(2)},missingQty:function(){var t=_.sumBy(this.lines,(function(t){if(0==t.is_deleted)return _.sumBy(t.leaf_dtl,(function(t){if(0==t.is_deleted)return parseFloat(t.quantity_used?t.quantity_used:0)}))}));return t=parseFloat(t||0),parseFloat(this.header.quantity?this.header.quantity:0)-t}},watch:{pRefresh:(y=w(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("refresh");case 1:case"end":return t.stop()}}),t)}))),function(t,e){return y.apply(this,arguments)}),leafFormulas:(x=w(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("watch: Leaf",e),this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return x.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],tab:this.tabs}},mounted:function(){console.log("Leaf Formula: Component mounted.")},methods:{syncIngredients:function(t,e,a){var n=0;console.log("Leaf Formula: syncIngredients",t,e,a),e.input_ingredients=t,parseFloat(this.header.quantity)>0&&(t.forEach((function(t,e){0==t.is_deleted&&(n=parseFloat(n)+parseFloat(t.quantity_used))})),n=parseFloat(n)/parseFloat(this.header.quantity)*100),e.leaf_proportion=1*parseFloat(n).toFixed(2),this.checkHasChange=!0},addNewLine:function(){var t=this;return w(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(a=t).lines.length,s=JSON.parse(JSON.stringify(a.data.leaf_new_line)),a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.leaf_formula_line,"has_change",a.lines.length),a.header.can.edit&&a.remoteMethod(" ",a.lines[n]);case 7:case"end":return e.stop()}}),e)})))()},selectLeaf:function(t){var e=this;return w(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!((n=e).lines.filter((function(e){return e.leaf_formula==t.leaf_formula&&0==e.is_deleted})).length>1)){a.next=8;break}return t.leaf_formula="",t.formulaline_id="",t.line_no="",t.leaf_formula_desc="",a.abrupt("return");case 8:s=t.leaf_list.findIndex((function(e){return e.value==t.leaf_formula})),s=t.leaf_list[s],t.formulaline_id="",t.line_no="",t.leaf_formula_desc="",s&&(t.leaf_formula_desc=s.leaf_formula_desc,t.formulaline_id=s.formulaline_id,t.line_no=s.line_no),n.setHasChange();case 15:case"end":return a.stop()}}),a)})))()},changeLeafProportion:function(){this.setHasChange()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e){if(""!==t){var a=this.lines.filter((function(t){return 0==t.is_deleted})),n=h(new Set(a.map((function(t){return t.leaf_formula}))));this.getLeafInput({number:t,header:this.header,type:"leaf_formula",except:n},e)}else e.leaf_list=[]},getLeafInput:function(t,e){var a=this;a.loading.leaf_formula=!0,e.leaf_list=[],axios.get(a.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;a.loading.leaf_formula=!1,e.leaf_list=n.leaf_list}))},getLeafFormulas:function(){var t=this;return w(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,n={header:t.header,type:"leaf_formula_line"},a.loading.page=!0,axios.get(a.url.ajax_get_data,{params:n}).then((function(t){var e=t.data.data;a.$set(a,"lines",e.leaf_formula_lines),a.loading.page=!1}));case 4:case"end":return e.stop()}}),e)})))()},deleteline:function(t){var e=this;return w(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e,t.is_new_row?t.is_deleted=!0:([],s={header:n.header,type:"casings",leaf_formula:t.leaf_formula},axios.get(n.url.ajax_get_data,{params:s}).then(function(){var e=w(r().mark((function e(a){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.data.data,!n.casings.length){e.next=9;break}return e.next=5,helperAlert.showProgressConfirm("ต้องการลบข้อมูล Casing ที่ผูกกับ Leaf Formula: "+t.leaf_formula+" หรือไม่ ?");case 5:confirm=e.sent,confirm&&(t.is_deleted=!0),e.next=10;break;case 9:t.is_deleted=!0;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return a.stop()}}),a)})))()}}};const k=(0,c.Z)(C,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-right"},[a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{staticStyle:{"background-color":"rgb(252, 252, 252)"}},[a("td",{staticClass:"text-right align-middle"},[e.leaf_formula?[a("a",{attrs:{"data-toggle":"collapse","data-parent":"#accordion",href:"#collapse_"+n},on:{click:function(t){e.is_collapse=!e.is_collapse}}},[e.is_collapse?a("i",{staticClass:"fa fa-caret-down",staticStyle:{"font-size":"20px"}}):a("i",{staticClass:"fa fa-caret-right",staticStyle:{"font-size":"20px"}})])]:t._e()],2),t._v(" "),a("td",{staticStyle:{"min-width":"15px !important","max-width":"15px !important"}},[a("el-select",{staticClass:"text-center",staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",placeholder:"Leaf Formula","remote-method":function(a){return t.remoteMethod(a,e)},disabled:!t.header.can.edit,loading:t.loading.leaf_formula},on:{change:function(a){return t.selectLeaf(e)}},model:{value:e.leaf_formula,callback:function(a){t.$set(e,"leaf_formula",a)},expression:"line.leaf_formula"}},t._l(e.leaf_list,(function(e,n){return a("el-option",{key:e.value,attrs:{label:e.value,value:String(e.value)}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.label))])])})),1)],1),t._v(" "),a("td",{attrs:{colspan:"3"}},[t._v("\n                        "+t._s(e.leaf_formula_desc)+"\n                    ")]),t._v(" "),a("td",{staticClass:"font-weight-bold text-success tw-text-base text-right"},[t._v("\n                        "+t._s(Number(parseFloat(e.leaf_proportion?e.leaf_proportion:0)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))+"\n                    ")]),t._v(" "),a("td",{staticClass:"text-center align-middle"},[a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(a){return a.preventDefault(),t.deleteline(e)}}},[a("i",{class:t.transBtn.delete.icon})])])])]),t._v(" "),e.is_deleted?t._e():a("tr",{directives:[{name:"show",rawName:"v-show",value:e.is_collapse,expression:"line.is_collapse"}]},[a("td",{attrs:{colspan:"1"}}),t._v(" "),a("td",{attrs:{colspan:"4"}},[a("div",{staticClass:"collapse",attrs:{id:"collapse_"+n}},[a("leaf-ingredient",{attrs:{leaf:e,url:t.url,leafProportion:e.leaf_proportion,transBtn:t.transBtn,transDate:t.transDate,data:t.data,header:t.header},on:{syncIngredients:function(a){for(var r=arguments.length,s=Array(r);r--;)s[r]=arguments[r];return t.syncIngredients.apply(void 0,s.concat([e],[n]))}}})],1)]),t._v(" "),a("td",{attrs:{colspan:"2"}})])]:t._e()}))],2),t._v(" "),t.lines.length?a("tfoot",[a("tr",{},[t._m(1),t._v(" "),a("th",{staticClass:"font-weight-bold align-bottom text-danger tw-text-lg text-right pt-4"},[t._v("\n                        "+t._s(t._f("number2Digit")(t.missingQty))+"\n                    ")]),t._v(" "),t._m(2),t._v(" "),a("th",{staticClass:"font-weight-bold align-bottom text-success tw-text-lg text-right pt-4"},[t._v("\n                        "+t._s(t._f("number2Digit")(t.totalProportion))+"\n                    ")]),t._v(" "),a("th")])]):t._e()]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"pdp0008-table-th-detail-color"},[a("th",{attrs:{width:"120px"}}),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"240px"}},[a("div",[t._v("Leaf Formula")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"80px"}},[t._v("\n                         \n                    ")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"100px"}},[t._v("\n                         \n                    ")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"80px"}},[a("div",[t._v("สัดส่วน %")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"60px"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-right align-bottom font-weight-bold tw-text-sm pt-4",attrs:{colspan:"3"}},[a("div",[t._v("ปริมาณที่ขาด")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("th",{staticClass:"text-right align-bottom font-weight-bold tw-text-sm pt-4"},[a("div",[t._v("รวมสัดส่วน")])])}],!1,null,null,null).exports;function D(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function S(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){D(s,n,r,i,o,"next",t)}function o(t){D(s,n,r,i,o,"throw",t)}i(void 0)}))}}var I;const N={props:["header","url","transBtn","transDate","data","casings","tabs"],computed:{},watch:{casings:(I=S(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return I.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],tab:this.tabs}},mounted:function(){console.log("Casings: Component mounted.")},methods:{syncIngredients:function(t,e){e.input_ingredients=t,this.checkHasChange=!0},addNewLine:function(){var t=this;return S(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).lines.length,e.next=4,_.clone(a.data.new_line);case 4:s=e.sent,a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.casings,"has_change",a.lines.length),a.header.can.edit&&(a.remoteMethod(" ",a.lines[n],"casing_leaf_formula_list"),a.remoteMethod(" ",a.lines[n],"casing_list"));case 9:case"end":return e.stop()}}),e)})))()},avalidateDup:function(t){return S(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.leaf_formula&&t.casing_id;case 1:case"end":return e.stop()}}),e)})))()},selectLeaf:function(t){var e=this;return S(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.leaf_formula_desc="",!(n.lines.filter((function(e){if(t.casing_id)return e.leaf_formula==t.leaf_formula&&e.casing_id==t.casing_id})).length>1)){a.next=6;break}return t.leaf_formula="",a.abrupt("return");case 6:s=t.casing_leaf_formula_list.findIndex((function(e){return e.value==t.leaf_formula})),(s=t.casing_leaf_formula_list[s])&&(t.leaf_formula_desc=s.leaf_formula_desc),n.setHasChange();case 10:case"end":return a.stop()}}),a)})))()},selectCasing:function(t){var e=this;return S(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.casing_no="",t.casing_desc="",t.casing_items=[],!(n.lines.filter((function(e){if(t.leaf_formula)return e.casing_id==t.casing_id&&e.leaf_formula==t.leaf_formula&&0==e.is_deleted})).length>1)){a.next=8;break}return t.casing_id="",a.abrupt("return");case 8:s=t.casing_list.findIndex((function(e){return e.value==t.casing_id})),(s=t.casing_list[s])&&(t.casing_no=s.casing_no,t.casing_desc=s.casing_desc,t.casing_items=s.casing_items),n.setHasChange();case 12:case"end":return a.stop()}}),a)})))()},changeLeafProportion:function(){this.setHasChange()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e,a){var n=this;return S(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e[a]=[],(i=_.clone(e)).casing_leaf_formula_list=[],i.casing_list=[],""!==t&&n.getData({number:t,header:n.header,line:i,type:a},e,a);case 5:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return S(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e.loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;e.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()}}};var B=a(93379),F=a.n(B),L=a(67218),P={insert:"head",singleton:!1};F()(L.Z,P);L.Z.locals;const H=(0,c.Z)(N,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-right"},[a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",{staticStyle:{"min-width":"65px !important","max-width":"65px !important"}},[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"Leaf Formula","remote-method":function(a){return t.remoteMethod(a,e,"casing_leaf_formula_list")},disabled:!t.header.can.edit||!e.is_new_row,loading:e.loading},on:{change:function(a){return t.selectLeaf(e)}},model:{value:e.leaf_formula,callback:function(a){t.$set(e,"leaf_formula",a)},expression:"line.leaf_formula"}},t._l(e.casing_leaf_formula_list,(function(e,n){return a("el-option",{key:e.value,attrs:{label:e.value,value:String(e.value)}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.label))])])})),1)],1),t._v(" "),a("td",{staticStyle:{"min-width":"100px !important","max-width":"100px !important"}},[t._v("\n                            "+t._s(e.leaf_formula_desc)+"\n                        ")]),t._v(" "),a("td",{staticStyle:{"min-width":"65px !important","max-width":"65px !important"}},[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"","remote-method":function(a){return t.remoteMethod(a,e,"casing_list")},disabled:!t.header.can.edit,loading:e.loading},on:{change:function(a){return t.selectCasing(e)}},model:{value:e.casing_id,callback:function(a){t.$set(e,"casing_id",a)},expression:"line.casing_id"}},t._l(e.casing_list,(function(e,n){return a("el-option",{key:e.value,attrs:{label:e.casing_no,value:String(e.value)}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.label))])])})),1)],1),t._v(" "),a("td",[t._v("\n                            "+t._s(e.casing_desc)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right align-middle"},[a("button",{class:t.transBtn.detail.class+" btn-xs mb-0",on:{click:function(t){t.preventDefault(),e.is_collapse=!e.is_collapse}}},[a("i",{class:t.transBtn.detail.icon}),t._v("\n                                "+t._s(t.transBtn.detail.text)+"\n                            ")]),t._v(" "),a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})])])])]),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_collapse&&e.casing_items.length&&!e.is_deleted?a("tr",[a("td",{attrs:{colspan:"5"}},[a("table",{staticClass:"table pl-3"},[a("thead",[a("tr",[a("th",{attrs:{width:"15%"}},[t._v("รหัสวัตถุดิบ")]),t._v(" "),a("th",[t._v("รายละเอียดวัตถุดิบ")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"20%"}},[t._v("ปริมาณที่ใช้")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"5%"}},[t._v("หน่วย")])])]),t._v(" "),t._l(e.casing_items,(function(e){return a("tr",[a("td",[t._v(t._s(e.item_code))]),t._v(" "),a("td",[t._v(t._s(e.item_desc))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number3Digit")(e.calcula_casing_quantity)))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(e.uom_name))])])}))],2)])]):t._e()])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"pdp0008-table-th-detail-color"},[a("th",{staticStyle:{"min-width":"65px !important","max-width":"65px !important"}},[a("div",[t._v("Leaf Formula")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",staticStyle:{"min-width":"100px !important","max-width":"100px !important"}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticStyle:{"min-width":"65px !important","max-width":"65px !important"}},[a("div",[t._v("Casing No.")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"15%"}})])])}],!1,null,"447ec99c",null).exports;function E(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return T(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return T(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function A(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function O(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){A(s,n,r,i,o,"next",t)}function o(t){A(s,n,r,i,o,"throw",t)}i(void 0)}))}}var q;const M={props:["header","url","transBtn","transDate","data","flavors","tabs"],computed:{},watch:{flavors:(q=O(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return q.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],tab:this.tabs}},mounted:function(){console.log("Flavor: Component mounted.")},methods:{syncIngredients:function(t,e){e.input_ingredients=t,this.checkHasChange=!0},addNewLine:function(){var t=this;return O(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).lines.length,e.next=4,_.clone(a.data.new_line);case 4:s=e.sent,a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.casings,"has_change",a.lines.length),a.header.can.edit&&a.remoteMethod(" ",a.lines[n],"flavor_list");case 9:case"end":return e.stop()}}),e)})))()},selectFlavor:function(t){var e=this;return O(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.flavor_no="",t.flavor_desc="",t.flavor_items=[],!(n.lines.filter((function(e){return e.flavor_id==t.flavor_id&&0==e.is_deleted})).length>1)){a.next=8;break}return t.flavor_id="",a.abrupt("return");case 8:s=t.flavor_list.findIndex((function(e){return e.value==t.flavor_id})),(s=t.flavor_list[s])&&(t.flavor_no=s.flavor_no,t.flavor_desc=s.flavor_desc,t.flavor_items=s.flavor_items),n.setHasChange();case 12:case"end":return a.stop()}}),a)})))()},changeLeafProportion:function(){this.setHasChange()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e,a){var n=this;return O(r().mark((function s(){var i,o,l,c;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e[a]=[],i=n,(o=_.clone(e)).flavor_list=[],l=i.lines.filter((function(t){return 0==t.is_deleted})),c=E(new Set(l.map((function(t){return t.flavor_id})))),""!==t&&n.getData({number:t,header:n.header,line:o,type:a,except:c},e,a);case 7:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return O(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e.loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;e.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()}}};var j=a(56817),U={insert:"head",singleton:!1};F()(j.Z,U);j.Z.locals;const Z=(0,c.Z)(M,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 text-right"},[a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25  btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                เพิ่มรายการ\n            ")])])]),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",{staticClass:"text-center align-middle",staticStyle:{"min-width":"15px !important","max-width":"15px !important"}},[a("el-checkbox",{model:{value:e.flavor_status,callback:function(a){t.$set(e,"flavor_status",a)},expression:"line.flavor_status"}})],1),t._v(" "),a("td",{staticStyle:{"min-width":"30px !important","max-width":"30px !important"}},[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"","remote-method":function(a){return t.remoteMethod(a,e,"flavor_list")},disabled:!t.header.can.edit,loading:e.loading},on:{change:function(a){return t.selectFlavor(e)},click:function(a){return t.remoteMethod(a,e,"flavor_list")}},model:{value:e.flavor_id,callback:function(a){t.$set(e,"flavor_id",a)},expression:"line.flavor_id"}},t._l(e.flavor_list,(function(e,n){return a("el-option",{key:e.value,attrs:{label:e.flavor_no,value:String(e.value)}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.label))])])})),1)],1),t._v(" "),a("td",[t._v("\n                            "+t._s(e.flavor_desc)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right align-middle"},[a("button",{class:t.transBtn.detail.class+" btn-xs mb-0",on:{click:function(t){t.preventDefault(),e.is_collapse=!e.is_collapse}}},[a("i",{class:t.transBtn.detail.icon}),t._v("\n                                "+t._s(t.transBtn.detail.text)+"\n                            ")]),t._v(" "),a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})])])])]),t._v(" "),a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_collapse&&e.flavor_items.length&&!e.is_deleted?a("tr",[a("td",{attrs:{colspan:"4"}},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"15%"}},[t._v("รหัสวัตถุดิบ")]),t._v(" "),a("th",[t._v("รายละเอียดวัตถุดิบ")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"20%"}},[t._v("ปริมาณที่ใช้")]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"5%"}},[t._v("หน่วย")])])]),t._v(" "),t._l(e.flavor_items,(function(e){return a("tr",[a("td",[t._v(t._s(e.item_code))]),t._v(" "),a("td",[t._v(t._s(e.item_desc))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("number3Digit")(e.calcula_flavor_quantity)))]),t._v(" "),a("td",{staticClass:"text-right"},[t._v(t._s(e.uom_name))])])}))],2)])]):t._e()])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"pdp0008-table-th-detail-color"},[a("th",{staticClass:"text-center align-middle",staticStyle:{"min-width":"15px !important","max-width":"15px !important"}},[t._v("\n                        เปิดใช้งาน\n                    ")]),t._v(" "),a("th",{staticStyle:{"min-width":"30px !important","max-width":"30px !important"}},[a("div",[t._v("Flavor No.")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"15%"}})])])}],!1,null,"b501f21e",null).exports;var z=a(23570),R=a.n(z);function J(t){return function(t){if(Array.isArray(t))return Q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Q(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Q(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function V(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function W(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){V(s,n,r,i,o,"next",t)}function o(t){V(s,n,r,i,o,"throw",t)}i(void 0)}))}}var Y,G;const K={props:["header","url","transBtn","transDate","data","cigarettes","cigarDtl","tabs"],computed:{},watch:{cigarettes:(G=W(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return G.apply(this,arguments)}),cigarDtl:(Y=W(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lineCigarDtl=e;case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return Y.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[],lineCigarDtl:[],lineCigarDtlByItem:[],tab:this.tabs,selectLineId:""}},mounted:function(){console.log("Cigarettes: Component mounted.")},methods:{addNewDtlLine:function(){var t=this;return W(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).lineCigarDtl.length,e.next=4,_.clone(a.data.new_dtl_line);case 4:(s=e.sent).fm_cigar_id=a.selectLineId,a.$set(a.lineCigarDtl,n,s),a.setHasChange(),a.$set(a.tab.cigarettes,"has_change",a.lineCigarDtl.length),a.resetLineNoDtlLine();case 10:case"end":return e.stop()}}),e)})))()},delDtlLine:function(t){var e=this;return W(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t.is_deleted=!0,e.resetLineNoDtlLine();case 2:case"end":return a.stop()}}),a)})))()},showLineDetail:function(t){var e=this;return W(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.selectLineId=t.fm_cigar_id;case 1:case"end":return a.stop()}}),a)})))()},resetLineNoDtlLine:function(){var t=this;return W(r().mark((function e(){var a,n,s,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,n=1,e.next=4,a.filterCigarDetail(a.selectLineId);case 4:return s=e.sent,e.next=7,_.maxBy(s,function(){var t=W(r().mark((function t(e){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.is_deleted){t.next=2;break}return t.abrupt("return",e.cigar_line_no);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 7:i=e.sent,n=i.cigar_line_no?parseInt(i.cigar_line_no):1,s.forEach(function(){var t=W(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.is_deleted&&(e.cigar_line_no=n,n+=1);case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e)})))()},addNewLine:function(){var t=this;return W(r().mark((function e(){var a,n,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a=t).lines.length,e.next=4,_.clone(a.data.new_line);case 4:(s=e.sent).fm_cigar_id=R()(),a.$set(a.lines,n,s),a.setHasChange(),a.$set(a.tab.cigarettes,"has_change",a.lines.length),a.header.can.edit&&a.remoteMethod(" ",a.lines[n],"cigar_list"),a.showLineDetail(s),a.$nextTick((function(){a.$refs[s.fm_cigar_id][0].focus()}));case 12:case"end":return e.stop()}}),e)})))()},selectCigarItemId:function(t){var e=this;return W(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e,t.cigar_organization_code="",t.cigar_organization_id="",t.cigar_item_code="",t.cigar_item_desc="",!(n.lines.filter((function(e){return e.cigar_item_id==t.cigar_item_id&&0==e.is_deleted})).length>1)){a.next=9;break}return t.cigar_item_id="",a.abrupt("return");case 9:s=t.cigar_list.findIndex((function(e){return e.value==t.cigar_item_id})),(s=t.cigar_list[s])&&(t.cigar_organization_code=s.cigar_organization_code,t.cigar_organization_id=s.cigar_organization_id,t.cigar_item_code=s.cigar_item_code,t.cigar_item_desc=s.cigar_item_desc),n.setHasChange();case 13:case"end":return a.stop()}}),a)})))()},setHasChange:function(){this.checkHasChange=!0},remoteMethod:function(t,e,a){var n=this;return W(r().mark((function s(){var i,o,l,c;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e[a]=[],o=i.lines.filter((function(t){return 0==t.is_deleted})),l=J(new Set(o.map((function(t){return t.cigar_item_id})))),(c=_.clone(e)).cigar_list=[],""!==t&&n.getData({number:t,header:n.header,line:c,type:a,except:l},e,a);case 7:case"end":return r.stop()}}),s)})))()},getData:function(t,e,a){var n=this;return W(r().mark((function s(){var i;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=n,e.loading=!0,axios.get(i.url.ajax_get_data,{params:t}).then((function(t){var n=t.data.data;e.loading=!1,e[a]=n[a]}));case 3:case"end":return r.stop()}}),s)})))()},filterCigarDetail:function(t){return this.lineCigarDtl.filter((function(e){return e.fm_cigar_id==t}))}}};var X=a(61256),tt={insert:"head",singleton:!1};F()(X.Z,tt);X.Z.locals;const et=(0,c.Z)(K,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-5 b-r"},[a("h3",{staticClass:"no-margins text-center text-navy"},[t._v("\n                รายการบุหรี่\n\n                "),t.header?[t.header.can.cigarettes.multi_cigarettes?a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25 mb-0 btn-outline pull-right",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                        เพิ่มรายการ\n                    ")]):t._e()]:t._e()],2),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table mt-3  table-hover",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{key:n,attrs:{data:n}},[a("td",{staticClass:"text-center align-middle"},[t.selectLineId==e.fm_cigar_id?a("i",{staticClass:"fa fa-check-circle text-success"}):t._e()]),t._v(" "),a("td",{class:t.selectLineId==e.fm_cigar_id?"  ":" ",on:{click:function(a){return a.preventDefault(),t.showLineDetail(e)}}},[a("el-select",{ref:e.fm_cigar_id,refInFor:!0,attrs:{filterable:"",remote:"",placeholder:"","remote-method":function(a){return t.remoteMethod(a,e,"cigar_list")},disabled:!t.header.can.edit,loading:e.loading},on:{change:function(a){return t.selectCigarItemId(e)}},model:{value:e.cigar_item_id,callback:function(a){t.$set(e,"cigar_item_id",a)},expression:"line.cigar_item_id"}},t._l(e.cigar_list,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.label,value:String(t.value)}})})),1)],1),t._v(" "),a("td",{class:t.selectLineId==e.fm_cigar_id?"  ":" ",on:{click:function(a){return a.preventDefault(),t.showLineDetail(e)}}},[t._v("\n                                   "+t._s(e.cigar_item_desc)+"\n                                ")]),t._v(" "),a("td",{staticClass:"text-right align-middle"},[a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(t){t.preventDefault(),e.is_deleted=!0}}},[a("i",{class:t.transBtn.delete.icon})]),t._v(" "),a("button",{class:t.transBtn.detail.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(a){return a.preventDefault(),t.showLineDetail(e)}}},[a("i",{class:t.transBtn.detail.icon}),t._v("\n                                        "+t._s(t.transBtn.detail.text)+"\n                                    ")])])])])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])]),t._v(" "),a("div",{staticClass:"col-7"},[a("h3",{staticClass:"no-margins text-center text-navy"},[t._v("\n                รายการวัตถุห่อมวน\n\n                "),t.header&&t.selectLineId?[t.header.can.cigarettes.multi_cigarettes?a("button",{class:t.transBtn.create.class+" btn-sm tw-w-25 mb-0 btn-outline pull-right",attrs:{disabled:!t.header.can.edit},on:{click:function(e){return e.preventDefault(),t.addNewDtlLine(e)}}},[a("i",{class:t.transBtn.create.icon}),t._v("\n                        เพิ่มรายการ\n                    ")]):t._e()]:t._e()],2),t._v(" "),a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table mt-3",staticStyle:{"margin-bottom":"0px"}},[t._m(1),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.filterCigarDetail(t.selectLineId),(function(e,n,r){return t.filterCigarDetail(t.selectLineId).length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.is_deleted?t._e():a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",{staticClass:"text-center"},[t._v(t._s(e.cigar_line_no))]),t._v(" "),a("td",[a("el-input",{attrs:{type:"textarea",name:"note",disabled:!t.header.can.edit,rows:"1",maxlength:"240","show-word-limit":""},model:{value:e.cigar_description,callback:function(a){t.$set(e,"cigar_description",a)},expression:"cigarDtl.cigar_description"}})],1),t._v(" "),a("td",{staticClass:"text-right align-middle"},[a("button",{class:t.transBtn.delete.class+" btn-xs mb-0 btn-outline",attrs:{disabled:!t.header.can.edit},on:{click:function(a){return t.delDtlLine(e)}}},[a("i",{class:t.transBtn.delete.icon})])])])])]:t._e()}))],2)])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"pdp0008-table-th-detail-color"},[a("th",{attrs:{width:"20px;"}}),t._v(" "),a("th",{attrs:{width:"200px;"}},[a("div",[t._v("รหัสบุหรี่")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"130px;"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"pdp0008-table-th-detail-color"},[a("th",{attrs:{width:"10%"}},[a("div",[t._v("ลำดับ")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียดวัตถุห่อมวน")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"10%"}})])])}],!1,null,"41ea9d5c",null).exports;function at(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}var nt,rt;const st={props:["header","url","transBtn","transDate","cigaretteAll","tabs"],computed:{},watch:{cigaretteAll:(nt=r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.lines=e;case 2:case"end":return t.stop()}}),t,this)})),rt=function(){var t=this,e=arguments;return new Promise((function(a,n){var r=nt.apply(t,e);function s(t){at(r,a,n,s,i,"next",t)}function i(t){at(r,a,n,s,i,"throw",t)}s(void 0)}))},function(t,e){return rt.apply(this,arguments)})},data:function(){return{loading:{page:!1,leaf_formula:!1},lines:[]}},mounted:function(){console.log("Cigarette All: Component mounted.")},methods:{}};const it=(0,c.Z)(st,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}]},[a("div",{staticClass:"table-responsivex"},[a("table",{staticClass:"table",staticStyle:{"margin-bottom":"0px"}},[t._m(0),t._v(" "),a("tbody",{attrs:{id:"accordion"}},[t._l(t.lines,(function(e,n){return t.lines.length?[a("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[a("tr",{key:n,staticStyle:{"background-color":"rgb(252, 252, 252)"},attrs:{data:n}},[a("td",{staticClass:"text-center"},[t._v("\n                           "+t._s(e.tab)+"\n                        ")]),t._v(" "),a("td",[t._v("\n                           "+t._s(e.item_number)+"\n                        ")]),t._v(" "),a("td",[t._v("\n                            "+t._s(e.item_description)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.lot_number)+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-right"},[t._v("\n                            "+t._s(t._f("numberFormat")(e.qty))+"\n                        ")]),t._v(" "),a("td",{staticClass:"text-center"},[t._v("\n                            "+t._s(e.uom)+"\n                        ")])])])]:t._e()}))],2)]),t._v(" "),0===t.lines.length?a("div",{staticClass:"text-center"},[a("span",{staticClass:"lead"},[t._v("No Data.")])]):t._e()])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"pdp0008-table-th-detail-color"},[a("th",{staticClass:"text-center",attrs:{width:"5%"}},[a("div",[t._v("TAB")])]),t._v(" "),a("th",{attrs:{width:"15%"}},[a("div",[t._v("รหัสวัตถุดิบ")])]),t._v(" "),a("th",{staticClass:"hidden-sm hidden-xs",attrs:{width:""}},[a("div",[t._v("รายละเอียด")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"5%"}},[a("div",[t._v("Lot")])]),t._v(" "),a("th",{staticClass:"text-right",attrs:{width:"10%"}},[a("div",[t._v("ปริมาณที่ใช้")])]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"5%"}},[a("div",[t._v("หน่วย")])])])])}],!1,null,"74a24f67",null).exports;function ot(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function lt(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){ot(s,n,r,i,o,"next",t)}function o(t){ot(s,n,r,i,o,"throw",t)}i(void 0)}))}}var ct;const dt={props:["header","transBtn","transDate","url","countOpen","menu"],data:function(){return{loading:!1,getParamlLoading:!1,transactionDateFormat:"",blendNo:"",requestHeaders:[],inputParams:{blend_no_list:[]}}},mounted:function(){},computed:{},watch:{countOpen:(ct=lt(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openModal(),this.getParam(" ");case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return ct.apply(this,arguments)})},methods:{setdate:function(t){var e=this;return lt(r().mark((function a(){var n;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,a.next=3,i()(t).format(n.transDate["js-format"]);case 3:n.transactionDateFormat=a.sent;case 4:case"end":return a.stop()}}),a)})))()},openModal:function(){$("#modal_search").modal("show"),$(".slimScroll").slimScroll({height:"250px",width:"100%"})},search:function(t){var e=this;e.loading=!0,axios.get(e.url.index,{params:t}).then((function(t){var a=t.data.data;e.loading=!1,e.requestHeaders=a.data}))},selectRow:function(t){var e=this;return lt(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:$("#modal_search").modal("hide"),e.requestHeaders=[],e.$emit("selectRow",t);case 3:case"end":return a.stop()}}),a)})))()},searchForm:function(){var t=this;return lt(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.search({blend_no:t.blendNo,action:"search",formula_type_code:t.header.formula_type_code});case 1:case"end":return e.stop()}}),e)})))()},getParam:function(t){var e=this;return lt(r().mark((function a(){var n,s;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:(n=e).getParamlLoading=!0,s={action:"search-get-param",blend_no:t},axios.get(n.url.index,{params:s}).then((function(t){var e=t.data.data;n.getParamlLoading=!1,n.inputParams.blend_no_list=e.blend_no_list}));case 4:case"end":return a.stop()}}),a)})))()}}};const ut=(0,c.Z)(dt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("div",{staticClass:"modal inmodal fade",attrs:{id:"modal_search",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg",staticStyle:{width:"90%","max-width":"950px"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modal-content"},[t._m(0),t._v(" "),a("div",{staticClass:"modal-body text-left"},[a("div",{staticClass:"row col-12"},[a("div",{staticClass:"form-group pl-2 pr-2 mb-0 col-lg-4 col-md-2 col-sm-6 col-xs-6 mt-2"},[a("label",{staticClass:"text-left tw-font-bold tw-uppercase mb-1"},[t._v(" ยาเส้นปรุง Blend No. :")]),t._v(" "),a("div",{staticClass:"input-group "},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"โปรดเลือก ยาเส้นปรุง Blend No.",loading:t.getParamlLoading,"popper-append-to-body":!1,filterable:"",remote:"","remote-method":t.getParam},model:{value:t.blendNo,callback:function(e){t.blendNo=e},expression:"blendNo"}},t._l(t.inputParams.blend_no_list,(function(t){return a("el-option",{key:t.blend_no,attrs:{label:t.blend_no,value:t.blend_no}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group text-right  pr-2 mb-0 col-lg-5 col-md-10 col-sm-12 col-xs-12"},[a("label",{staticClass:" tw-font-bold tw-uppercase mt-2 mb-1"},[t._v(" ")]),t._v(" "),a("div",{staticClass:"text-left"},[a("button",{class:t.transBtn.search.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:t.searchForm}},[a("i",{class:t.transBtn.search.icon}),t._v("\n                                    "+t._s(t.transBtn.search.text)+"\n                                ")])])])]),t._v(" "),a("div",{staticClass:"ibox-content table-responsivex m-t mb-3 "},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"slimScroll"},[a("table",{staticClass:"table table-hover"},[t._m(1),t._v(" "),a("tbody",t._l(t.requestHeaders,(function(e,n){return a("tr",[a("td",{staticClass:"text-center"},[t._v(t._s(e.formula_type))]),t._v(" "),a("td",{attrs:{title:"version: "+e.formula_vers}},[t._v(t._s(e.blend_no))]),t._v(" "),a("td",{staticClass:"text-center"},[t._v(t._s(e.formula_status))]),t._v(" "),a("td",{staticClass:"text-center"},[t._v(t._s(e.formula_approval_date_format))]),t._v(" "),a("td",{staticClass:"text-right"},[a("button",{class:t.transBtn.detail.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(a){return t.selectRow(e)}}},[a("i",{class:t.transBtn.detail.icon}),t._v("\n                                                        "+t._s(t.transBtn.detail.text)+"\n                                                    ")])])])})),0)])])])])])]),t._v(" "),t._m(2)])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),a("span",{staticClass:"sr-only"},[t._v("Close")])]),t._v(" "),a("h4",{staticClass:"modal-title"},[t._v("ค้นหา")]),t._v(" "),a("small",{staticClass:"font-bold"},[t._v("\n                         \n                    ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"text-center",attrs:{width:"90px"}},[t._v("ประเภทสูตร")]),t._v(" "),a("th",{staticClass:"text-left",attrs:{width:""}},[t._v("ยาเส้นปรุง Blend No.")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"90px"}},[t._v("สถานะ")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"90px"}},[t._v("วันที่อนุมัติ")]),t._v(" "),a("th",{staticClass:"text-center",attrs:{width:"150px"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-white",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])}],!1,null,null,null).exports;function ft(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function _t(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){ft(s,n,r,i,o,"next",t)}function o(t){ft(s,n,r,i,o,"throw",t)}i(void 0)}))}}function pt(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const vt={props:["header","data","transBtn","transDate","url","countOpen","menu"],data:function(){var t;return pt(t={newHeader:{},loading:!1,getParamlLoading:!1,transactionDateFormat:"",blendNo:"",requestHeaders:[],inputParams:{blend_no_list:[]}},"loading",{page:!1,before_mount:!1,product_item_id:!1,duplicate:!1}),pt(t,"can",{save:!1}),t},mounted:function(){this.newHeader=JSON.parse(JSON.stringify(this.header)),this.newHeader.formula_type_code=""},computed:{},watch:{countOpen:function(){var t=_t(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openModal();case 1:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},methods:{stripNonNumber:function(t){return parseFloat(t.replace(/,/g,""))},setdate:function(t){var e=this;return _t(r().mark((function a(){var n;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,a.next=3,i()(t).format(n.transDate["js-format"]);case 3:n.transactionDateFormat=a.sent;case 4:case"end":return a.stop()}}),a)})))()},openModal:function(){$("#modal_dup").modal("show"),$(".slimScroll").slimScroll({height:"250px",width:"100%"})},getProductItem:function(){var t=arguments,e=this;return _t(r().mark((function a(){var n,s,i;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:1,(s=e).data.blend_no_list=[],s.data.product_item_id_list=[],s.can.save=!1,""==s.newHeader.tobacco_type_code||""==s.newHeader.formula_type_code){a.next=10;break}return i={blend_no:s.newHeader.blend_no,tobacco_type_code:s.newHeader.tobacco_type_code,formula_type_code:s.newHeader.formula_type_code,is_creation:n,action:"get-blend-no"},s.loading.product_item_id=!0,a.next=10,axios.get(s.url.index,{params:i}).then((function(t){var e=t.data.data;"S"==e.status&&(s.can.save=!0),"E"==e.status&&(swal({title:"Error !",text:e.msg,type:"error",showConfirmButton:!0}),s.newHeader.blend_no=""),s.loading.product_item_id=!1}));case 10:case"end":return a.stop()}}),a)})))()},duplicate:function(){var t=this;return _t(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t).loading.duplicate=!0,a.can.save=!1,e.next=5,axios.post(a.url.ajax_store,{new_header:a.newHeader,action:"duplicate"}).then((function(t){var e=t.data.data;"S"==e.status&&(swal({title:"&nbsp;",text:"บันทึกข้อมูลสำเร็จ",type:"success",html:!0}),a.selectRow(e.header)),"S"!=e.status&&swal({title:"Error !",text:e.msg,type:"error",showConfirmButton:!0})})).catch((function(t){var e=t.response.data;swal({title:"Error !",text:e.message,type:"error",showConfirmButton:!0})})).then((function(){a.loading.duplicate=!1,a.can.save=!0}));case 5:case"end":return e.stop()}}),e)})))()},selectRow:function(t){var e=this;return _t(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:$("#modal_dup").modal("hide"),e.$emit("selectRow",t);case 2:case"end":return a.stop()}}),a)})))()}}};function mt(t,e,a,n,r,s,i){try{var o=t[s](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function ht(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function i(t){mt(s,n,r,i,o,"next",t)}function o(t){mt(s,n,r,i,o,"throw",t)}i(void 0)}))}}const gt={components:{SearchItem:d,TabLeafFormula:k,Casing:H,Flavor:Z,Cigarette:et,CigaretteAll:it,modalSearch:ut,modalDuplicate:(0,c.Z)(vt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("div",{staticClass:"modal inmodal fade",attrs:{id:"modal_dup",tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),a("div",{staticClass:"modal-body text-left",staticStyle:{"font-size":"14px"}},[a("div",{staticClass:"ibox"},[t._m(1),t._v(" "),a("div",{staticClass:"ibox-content no-padding"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 mb-2 mt-3 b-r"},[a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-6 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            ประเภทยาเส้น:\n                                        ")]),t._v(" "),a("label",{staticClass:"col-5  pr-0 font-weight-boldx col-form-label"},[t._v("\n                                            "+t._s(t.header.tobacco_type_desc)+"\n                                        ")])]),t._v(" "),a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-6 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            ประเภทสูตร:\n                                        ")]),t._v(" "),a("label",{staticClass:"col-5  pr-0 font-weight-boldx col-form-label"},[t._v("\n                                            "+t._s(t.header.formula_type)+"\n                                        ")])]),t._v(" "),a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-6 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            ปีงบประมาณ:\n                                        ")]),t._v(" "),a("label",{staticClass:"col-5  pr-0 font-weight-boldx col-form-label"},[t._v("\n                                            "+t._s(t.header.recipe_fiscal_year)+"\n                                        ")])])]),t._v(" "),a("div",{staticClass:"col-6 mb-2 mt-3 b-r"},[a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            Blend No.\n                                        ")]),t._v(" "),a("label",{staticClass:"col-5  pr-0 font-weight-boldx col-form-label"},[t._v("\n                                            "+t._s(t.header.blend_no)+"\n                                        ")])]),t._v(" "),a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            รหัสยาเส้น:\n                                        ")]),t._v(" "),a("label",{staticClass:"col-8  pr-0 font-weight-boldx col-form-label"},[t._v("\n                                            "+t._s(t.header.product_item_code)+" : "+t._s(t.header.product_item_desc)+"\n                                        ")])]),t._v(" "),a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            รายละเอียด:\n                                        ")]),t._v(" "),a("label",{staticClass:"col-8  pr-0 font-weight-boldx col-form-label"},[t._v("\n                                            "+t._s(t.header.description)+"\n                                        ")])])])])]),t._v(" "),t._m(2),t._v(" "),a("div",{staticClass:"ibox-content ",staticStyle:{"border-top":"0px"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 mb-2 mt-3"},[a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            ประเภทยาเส้น:\n                                        ")]),t._v(" "),a("div",{staticClass:"col-7 "},[a("el-select",{staticClass:"required",staticStyle:{width:"100%"},attrs:{"popper-append-to-body":!1,placeholder:"",clearable:"",filterable:""},on:{change:function(t){}},model:{value:t.newHeader.tobacco_type_code,callback:function(e){t.$set(t.newHeader,"tobacco_type_code",e)},expression:"newHeader.tobacco_type_code"}},t._l(t.data.tobacco_type_code_list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.label))])])})),1)],1)])]),t._v(" "),a("div",{staticClass:"col-12 mb-2"},[a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            ประเภทสูตร\n                                        ")]),t._v(" "),a("div",{staticClass:"col-7 "},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:""==t.newHeader.tobacco_type_code,"popper-append-to-body":!1,placeholder:""},model:{value:t.newHeader.formula_type_code,callback:function(e){t.$set(t.newHeader,"formula_type_code",e)},expression:"newHeader.formula_type_code"}},t._l(t.data.formula_type,(function(e,n){return e.lookup_code!=t.header.formula_type_code?a("el-option",{key:e.lookup_code,attrs:{label:e.description,value:e.lookup_code}}):t._e()})),1)],1)])]),t._v(" "),a("div",{staticClass:"col-12 mb-2"},[a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            Blend No.\n                                        ")]),t._v(" "),a("div",{staticClass:"col-7 "},[a("el-input",{attrs:{placeholder:"",disabled:""==t.newHeader.formula_type_code},on:{input:function(e){t.newHeader.blend_no=e.toUpperCase()},change:function(e){t.getProductItem()}},model:{value:t.newHeader.blend_no,callback:function(e){t.$set(t.newHeader,"blend_no",e)},expression:"newHeader.blend_no"}})],1)])]),t._v(" "),a("div",{staticClass:"col-12 mb-2"},[a("div",{staticClass:"form-group mb-1 row"},[a("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[t._v("\n                                            ปริมาณ\n                                        ")]),t._v(" "),a("div",{staticClass:"col-4 "},[a("div",{staticClass:"input-group "},[a("input",{staticClass:"form-control text-right ",attrs:{type:"text"},domProps:{value:t._f("number2Digit")(t.newHeader.quantity)},on:{change:function(e){t.newHeader.quantity=t.stripNonNumber(e.target.value),t.newHeader.quantity<0&&(t.newHeader.quantity=0)}}})])])])])])])])]),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{class:t.transBtn.save.class+" btn-lg tw-w-25",attrs:{type:"button",disabled:!t.can.save},on:{click:function(e){return e.preventDefault(),t.duplicate()}}},[a("i",{class:t.transBtn.save.icon}),t._v("\n                        "+t._s(t.transBtn.save.text)+"\n                    ")]),t._v(" "),a("button",{staticClass:"btn btn-white",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])])])])])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),a("span",{staticClass:"sr-only"},[t._v("Close")])]),t._v(" "),a("h4",{staticClass:"modal-title"},[t._v("คัดลอกสูตร")]),t._v(" "),a("small",{staticClass:"font-bold"},[t._v("\n                         \n                    ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ibox-title"},[a("h3",[t._v("ต้นฉบับ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ibox-content text-success",staticStyle:{"border-top":"0px"}},[a("h3",{staticClass:"no-margins"},[a("i",{staticClass:"fa fa-copy"}),t._v(" คัดลอก")])])}],!1,null,null,null).exports},props:["pUrl","pMenu"],computed:{},watch:{},data:function(){return{url:this.pUrl,menu:this.pMenu,data:!1,header:!1,profile:!1,uomDesc:"",transBtn:{},transDate:{},isActive:!1,lines:[],originalData:[],originalDtlData:[],leafFormulas:[],casings:[],flavors:[],cigarettes:[],cigarDtl:[],cigaretteAll:[],leafFormulaHasChange:!1,loading:{page:!1,before_mount:!1,product_item_id:!1},firstLoad:!0,countOpenModal:0,countOpenModalDup:0,selTabName:"tab1",tabs:{leaf_formula_line:{loading:!1,refreshCount:1,has_change:!1},casings:{loading:!1,refreshCount:1,has_change:!1},flavors:{loading:!1,refreshCount:1,has_change:!1},cigarettes:{loading:!1,refreshCount:1,has_change:!1},cigarette_all:{loading:!1,refreshCount:1,has_change:!1}},rules:{name:[{required:!0,message:"Please input Activity name",trigger:"blur"},{min:3,max:5,message:"Length should be 3 to 5",trigger:"blur"}]},ruleForm:{name:""}}},beforeMount:function(){console.log("beforeMount"),this.getInfo()},mounted:function(){console.log("Component mounted. PDP0008")},methods:{stripNonNumber:function(t){return parseFloat(t.replace(/,/g,""))},upper:function(t){t.target.value=t.target.value.toUpperCase()},getProductItem:function(){var t=arguments,e=this;return ht(r().mark((function a(){var n,s,i;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:1,(s=e).data.blend_no_list=[],s.data.product_item_id_list=[],s.header.product_item_id="",""==s.header.tobacco_type_code){a.next=10;break}return i={blend_no:s.header.blend_no,tobacco_type_code:s.header.tobacco_type_code,formula_type_code:s.header.formula_type_code,is_creation:n,action:"get-blend-no"},s.loading.product_item_id=!0,a.next=10,axios.get(s.url.index,{params:i}).then((function(t){var e=t.data.data;"S"==e.status&&(s.data.product_item_id_list=e.product_item_id_list),"E"==e.status&&(swal({title:"Error !",text:e.msg,type:"error",showConfirmButton:!0}),s.header.blend_no=""),s.loading.product_item_id=!1}));case 10:case"end":return a.stop()}}),a)})))()},show:function(t){var e=this;return ht(r().mark((function a(){return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.loading.before_mount=!1,e.getInfo(t.formula_id,t.blend_no,t.tobacco_organization_id);case 2:case"end":return a.stop()}}),a)})))()},setdate:function(t,e){var a=this;return ht(r().mark((function n(){var s;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=a,n.next=3,i()(t).format(s.transDate["js-format"]);case 3:s.header[e]=n.sent,s.getLines();case 5:case"end":return n.stop()}}),n)})))()},changeStatus:function(){var t=this;return ht(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"INACTIVE"==t.header.formula_status.toUpperCase()?t.isActive=!0:t.isActive=!1,t.header.can.edit=1==t.isActive,t.header.can.edit=!0;case 3:case"end":return e.stop()}}),e)})))()},getInfo:function(){var t=arguments,e=this;return ht(r().mark((function a(){var n,s,i,o,l,c;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:"",s=t.length>1&&void 0!==t[1]?t[1]:"",i=t.length>2&&void 0!==t[2]?t[2]:"",l={lookup_code:(o=e).header.lookup_code,formula_id:n,blend_no:s,tobacco_organization_id:i},c=!1,o.loading.page=!0,o.loading.before_mount=!0,a.next=10,axios.get(o.url.index,{params:l}).then((function(t){"S"==(c=t.data.data).status&&(c=c.info),o.loading.page=!1}));case 10:if(!c){a.next=21;break}return console.log("xx",c),o.data=c.data,o.header=c.header,o.profile=c.profile,o.transBtn=c.transBtn,o.transDate=c.transDate,o.url=c.url,o.header.formula_id&&(o.uomDesc=o.header.uom_name),a.next=21,o.resetData();case 21:o.loading.before_mount=!1,""!=o.header.formula_id&&null!=o.header.formula_id||o.getProductItem(0),o.changeTab(o.selTabName,o.selTabName,!1),o.changeStatus(),o.defRecipeFiscalYear(),o.checkFmlType();case 27:case"end":return a.stop()}}),a)})))()},getLines:function(){var t=arguments;return ht(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!(t.length>0&&void 0!==t[0])||t[0],t.length>1&&void 0!==t[1]?t[1]:"search",e.abrupt("return");case 8:e.sent;case 9:case"end":return e.stop()}}),e)})))()},delay:function(t){return ht(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(3e3!=t){e.next=2;break}throw"Error "+t;case 2:return a=new Promise((function(e,a){setTimeout((function(){return e("done!"+t)}),t)})),e.next=5,a;case 5:n=e.sent,console.log(n);case 7:case"end":return e.stop()}}),e)})))()},changeTab:function(t,e){var a=arguments,n=this;return ht(r().mark((function s(){var i,o,l,c,d;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!(a.length>2&&void 0!==a[2])||a[2],o=n,!0,l="","tab1"==t?l="leaf_formula_line":"tab2"==t?l="casings":"tab3"==t?l="flavors":"tab4"==t?l="cigarettes":"tab5"==t&&(l="cigarette_all"),!1,(t==e||"tab5"==e||!i)&&o.header.formula_id){r.next=36;break}return r.next=9,o.compareData(e);case 9:if(r.sent){r.next=36;break}return r.next=13,helperAlert.showProgressConfirm("ต้องการบันทึกข้อมูลที่แก้ไขหรือไม่ ?");case 13:if(!r.sent){r.next=36;break}return"",r.prev=16,o.loading.page=!0,r.next=20,n.validateTab();case 20:return r.sent,r.next=23,n.store(!1);case 23:return c=r.sent,r.next=26,o.show(c);case 26:r.next=35;break;case 28:return r.prev=28,r.t0=r.catch(16),o.loading.page=!1,console.log("catch error",r.t0),r.next=34,helperAlert.showGenericFailureDialog(r.t0);case 34:return r.abrupt("return");case 35:o.loading.page=!1;case 36:return o.selTabName=t,r.next=39,o.resetData();case 39:d={header:o.header,type:l},o.tabs[l].loading=!0,o.tabs[l].has_change=!1,axios.get(o.url.ajax_get_data,{params:d}).then((function(t){var e=t.data.data;"leaf_formula_line"==l&&(o.originalData=JSON.parse(JSON.stringify(e.leaf_formula_lines)),o.leafFormulas=e.leaf_formula_lines),"casings"==l&&(o.originalData=JSON.parse(JSON.stringify(e.casings)),o.casings=e.casings),"flavors"==l&&(o.originalData=JSON.parse(JSON.stringify(e.flavors)),o.flavors=e.flavors),"cigarettes"==l&&(o.originalData=JSON.parse(JSON.stringify(e.cigarettes)),o.originalDtlData=JSON.parse(JSON.stringify(e.cigar_dtl)),o.cigarettes=e.cigarettes,o.cigarDtl=e.cigar_dtl),"cigarette_all"==l&&(o.cigaretteAll=e[l]),o.tabs[l].loading=!1}));case 43:case"end":return r.stop()}}),s,null,[[16,28]])})))()},resetData:function(){var t=this;return ht(r().mark((function e(){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t).originalData=[],a.originalDtlData=[],a.leafFormulas=[],a.casings=[],a.flavors=[],a.cigarettes=[],a.cigarDtl=[],a.cigaretteAll=[];case 9:case"end":return e.stop()}}),e)})))()},compareData:function(t){var e=this;return ht(r().mark((function a(){var n,s,i;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e,s=!1,i="","tab1"==t?i="leaf_formula_line":"tab2"==t?i="casings":"tab3"==t?i="flavors":"tab4"==t?i="cigarettes":"tab5"==t&&(i="cigarette_all"),a.next=6,axios.post(n.url.ajax_compare_data,{header:n.header,original_data:n.originalData,original_dtl_data:n.originalDtlData,type:i,leaf_formulas:n.leafFormulas,casings:n.casings,flavors:n.flavors,cigarettes:n.cigarettes,cigar_dtl:n.cigarDtl}).then((function(t){var e=t.data.data;s=e.is_equal})).catch((function(t){var e=t.response.data;swal({title:"Error !",text:e.message,type:"error",showConfirmButton:!0})})).then((function(){n.loading.page=!1}));case 6:return console.log("compareData"),a.abrupt("return",s);case 8:case"end":return a.stop()}}),a)})))()},store:function(){var t=arguments,e=this;return ht(r().mark((function a(){var n,s,i;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return!(t.length>0&&void 0!==t[0])||t[0],!0,!0,"",(n=e).loading.page=!0,s=new Promise(function(){var t=ht(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.post(n.url.ajax_store,{header:n.header,leaf_formulas:n.leafFormulas,casings:n.casings,flavors:n.flavors,cigarettes:n.cigarettes,cigar_dtl:n.cigarDtl}).then((function(t){var r=t.data.data;"S"==r.status&&(n.hasChange=!1,swal({title:"&nbsp;",text:"บันทึกข้อมูลสำเร็จ",type:"success",html:!0}),e(r.header)),"S"!=r.status&&a(r.msg)})).catch((function(t){var e=t.response.data;a(e.message)})).then((function(){n.loading.page=!1}));case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),a.next=9,s;case 9:return i=a.sent,a.abrupt("return",i);case 11:case"end":return a.stop()}}),a)})))()},save:function(){var t=arguments,e=this;return ht(r().mark((function a(){var n,s,i;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=!(t.length>0&&void 0!==t[0])||t[0],s=e,!0,!0,a.prev=4,s.loading.page=!0,a.next=8,s.validateTab();case 8:if(!n){a.next=22;break}if(s.header.blend_no){a.next=11;break}throw"โปรดระบุยาเส้นปรุง Blend No.";case 11:if(!s.header.can.is_standart_formula_type||""!=s.header.recipe_fiscal_year){a.next=13;break}throw"โปรดระบุปีงบประมาณ";case 13:return a.next=15,helperAlert.showProgressConfirm("กรุณายืนยัน บันทึกสูตรผลิต");case 15:if(!a.sent){a.next=22;break}return a.next=19,e.store(!1);case 19:return i=a.sent,a.next=22,s.show(i);case 22:a.next=31;break;case 24:return a.prev=24,a.t0=a.catch(4),s.loading.page=!1,console.error(a.t0),a.next=30,helperAlert.showGenericFailureDialog(a.t0);case 30:return a.abrupt("return");case 31:s.loading.page=!1;case 32:case"end":return a.stop()}}),a,null,[[4,24]])})))()},sctProduct:function(){var t=this;return ht(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t).uomDesc="",a.header.description="",a.header.formula_no="",a.header.product_item_code="",a.header.uom_name="",a.header.uom="",n=a.data.product_item_id_list.findIndex((function(t){return t.value==a.header.product_item_id})),(n=a.data.product_item_id_list[n])&&(a.header.description=n.description,a.header.formula_no=n.formula_no,a.header.product_item_code=n.product_item_code,a.header.uom=n.uom,a.header.uom_name=n.uom_name,a.uomDesc=n.uom,a.data.recipe_routing_no_list.length>0&&!a.header.recipe_routing_no&&(a.header.recipe_routing_no=a.data.recipe_routing_no_list[0].value)),a.header.product_item_id||(a.header.formula_status="Inactive",a.header.recipe_routing_no="");case 11:case"end":return e.stop()}}),e)})))()},selectFlavour:function(){var t=this;return ht(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t).header.flavour="",a.header.formula_organization_code="",a.header.organization_code="",a.header.department="",n=a.data.flavour_list.findIndex((function(t){return t.value==a.header.flavour_code})),(n=a.data.flavour_list[n])&&(a.header.flavour=n.flavour,a.header.formula_organization_code=n.formula_organization_code,a.header.organization_code=n.organization_code,a.header.department=n.department);case 8:case"end":return e.stop()}}),e)})))()},checkFmlType:function(){var t=this;return ht(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(a=t).data.formula_type.findIndex((function(t){return t.lookup_code==a.header.formula_type_code})),(n=a.data.formula_type[n]).description,a.header.can.leaf_formulas.ingredient.add_lot_number="สูตรชนป."!=n.description,a.header.can.is_standart_formula_type="S"==n.lookup_code;case 6:case"end":return e.stop()}}),e)})))()},defRecipeFiscalYear:function(){var t=this;return ht(r().mark((function e(){var a,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(a=t).data.formula_type.findIndex((function(t){return t.lookup_code==a.header.formula_type_code})),n=a.data.formula_type[n],a.header.has_tmp_table?"สูตรมาตรฐาน"==n.description?a.header.recipe_fiscal_year=a.header.recipe_fiscal_year?a.header.recipe_fiscal_year:a.header.def_recipe_fiscal_year:a.header.recipe_fiscal_year=a.header.recipe_fiscal_year?a.header.recipe_fiscal_year:"":"สูตรมาตรฐาน"==n.description?a.header.recipe_fiscal_year=a.header.recipe_fiscal_year?a.header.recipe_fiscal_year:a.header.def_recipe_fiscal_year:a.header.recipe_fiscal_year="";case 4:case"end":return e.stop()}}),e)})))()},validateTab:function(){var t=this;return ht(r().mark((function e(){var a,n,s,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,!0,!0,n="",e.next=6,t.delay(500);case 6:return s=new Promise(function(){var t=ht(r().mark((function t(e,s){var i,o,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("tab1"!=a.selTabName){t.next=13;break}return t.next=3,a.leafFormulas.forEach(function(){var t=ht(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.is_deleted){t.next=5;break}if(0!=parseFloat(e.leaf_proportion)&&""!=e.leaf_proportion){t.next=5;break}return n="โปรดระบุ สัดส่วน % (Leaf Formula: ".concat(e.leaf_formula," ").concat(e.leaf_formula_desc,")"),s(n),t.abrupt("return");case 5:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 3:if(!a.leafFormulas.length){t.next=13;break}return 0,!0,i=!1,o=0,l=0,t.next=12,a.leafFormulas.forEach(function(){var t=ht(r().mark((function t(e,n){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.is_deleted){t.next=3;break}return t.next=3,e.leaf_dtl.forEach(function(){var t=ht(r().mark((function t(e,n){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.is_deleted&&(i=!0,o=parseFloat(o)+parseFloat(e.ingredient_proportions),l=parseFloat(l)+parseFloat(e.quantity_used),""==e.lot_number&&a.header.can.leaf_formulas.ingredient.add_lot_number);case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}());case 12:i&&parseFloat(l).toFixed(2)!=parseFloat(a.header.quantity).toFixed(2)&&(n="Leaf Detail: ยอดรวมปริมาณที่ใช้ (กก.): "+parseFloat(l)+"  ของวัตถุดิบ ไม่เท่ากับปริมาณของสูตร: "+parseFloat(a.header.quantity),s(n));case 13:"tab2"==a.selTabName&&a.casings.forEach(function(){var t=ht(r().mark((function t(e,a){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.is_deleted&&""==e.casing_id&&(n="โปรดระบุ casing (Leaf Formula: ".concat(e.leaf_formula," ").concat(e.leaf_formula_desc,")"),s(n));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),""!=a.header.product_item_id&&(""!=a.header.recipe_routing_no&&null!=a.header.recipe_routing_no||s(n="โปรดระบุขั้นตอนการทำงาน")),e(!0);case 16:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),e.next=9,s;case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})))()}}};const bt=(0,c.Z)(gt,(function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[e.loading.before_mount?e._e():n("div",[n("modal-search",{attrs:{transDate:e.transDate,menu:e.data.menu,header:e.header,transBtn:e.transBtn,url:e.url,countOpen:e.countOpenModal},on:{selectRow:e.show}}),e._v(" "),n("modal-duplicate",{attrs:{data:e.data,transDate:e.transDate,menu:e.data.menu,header:e.header,transBtn:e.transBtn,url:e.url,countOpen:e.countOpenModalDup},on:{selectRow:e.show}}),e._v(" "),n("div",{staticClass:"ibox float-e-margins"},[n("div",{staticClass:"ibox-content pb-1",staticStyle:{"border-bottom":"0px"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-3"}),e._v(" "),n("div",{staticClass:"col-9 text-right"},[n("button",{class:e.transBtn.create.class+" btn-lg tw-w-25",on:{click:function(t){return t.preventDefault(),e.getInfo()}}},[n("i",{class:e.transBtn.create.icon}),e._v("\n                        "+e._s(e.transBtn.create.text)+"\n                    ")]),e._v(" "),n("button",{class:e.transBtn.search.class+" btn-lg tw-w-25 mr-2",on:{click:function(t){t.preventDefault(),e.countOpenModal+=1}}},[n("i",{class:e.transBtn.search.icon}),e._v("\n                        "+e._s(e.transBtn.search.text)+"\n                    ")]),e._v(" "),n("button",{class:e.transBtn.save.class+" btn-lg tw-w-25",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.save()}}},[n("i",{class:e.transBtn.save.icon}),e._v("\n                        "+e._s(e.transBtn.save.text)+"\n                    ")]),e._v(" "),n("button",{class:e.transBtn.copy.class+" btn-lg tw-w-25 mr-2",attrs:{disabled:!e.header.can.copy_formula},on:{click:function(t){t.preventDefault(),e.countOpenModalDup+=1}}},[n("i",{class:e.transBtn.copy.icon}),e._v("\n                        "+e._s(e.transBtn.copy.text)+"สูตร\n                    ")]),e._v(" "),n("button",{staticClass:"btn btn-default",attrs:{"data-toggle":"modal","data-target":"#historyModal"}},[n("i",{staticClass:"fa fa-file-text-o"}),e._v(" ประวัติแก้ไข")])])])]),e._v(" "),n("div",{staticClass:"ibox-content"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-9"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-4 mb-2 mt-3"},[n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-5 pl-0 pr-0 font-weight-bold col-form-label required text-right"},[e._v("\n                                    ประเภทยาเส้น\n                                ")]),e._v(" "),n("div",{staticClass:"col-7"},[n("el-select",{staticClass:"required",staticStyle:{width:"100%"},attrs:{placeholder:"",disabled:e.header.has_tmp_table,clearable:"",filterable:""},on:{change:function(t){e.getProductItem()}},model:{value:e.header.tobacco_type_code,callback:function(t){e.$set(e.header,"tobacco_type_code",t)},expression:"header.tobacco_type_code"}},e._l(e.data.tobacco_type_code_list,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[n("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))])])})),1)],1)]),e._v(" "),n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-5 pl-0 pr-0 font-weight-bold col-form-label required text-right"},[e._v("\n                                    ประเภทสูตร\n                                ")]),e._v(" "),n("div",{staticClass:"col-7"},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"formula_type_code",disabled:e.header.has_tmp_table},on:{change:function(t){e.checkFmlType(),e.getProductItem(),e.defRecipeFiscalYear()}},model:{value:e.header.formula_type_code,callback:function(t){e.$set(e.header,"formula_type_code",t)},expression:"header.formula_type_code"}},e._l(e.data.formula_type,(function(t,e){return n("el-option",{key:t.lookup_code,attrs:{label:t.description,value:t.lookup_code}})})),1)],1)]),e._v(" "),n("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[n("div",{staticClass:"form-group mb-2 row"},[n("label",{class:(e.header.can.is_standart_formula_type?"required":"")+" col-5 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[e._v("\n                                        ปีงบประมาณ\n                                    ")]),e._v(" "),n("div",{staticClass:"col-7"},[n("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"","value-key":"recipe_fiscal_year",disabled:!e.header.can.is_standart_formula_type},on:{change:function(t){}},model:{value:e.header.recipe_fiscal_year,callback:function(t){e.$set(e.header,"recipe_fiscal_year",t)},expression:"header.recipe_fiscal_year"}},[""!=e.header.recipe_fiscal_year&&null!=e.header.recipe_fiscal_year?e._l(e.data.recipe_fiscal_year_list,(function(t,a){return t.value>=e.header.recipe_fiscal_year?n("el-option",{key:t.value,attrs:{label:t.value,value:t.value}}):e._e()})):e._l(e.data.recipe_fiscal_year_list,(function(t,e){return n("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})}))],2)],1)])]),e._v(" "),n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-5 pl-0 pr-0 font-weight-bold col-form-label text-right"},[e._v("\n                                    ขั้นตอนการทำงาน\n                                ")]),e._v(" "),n("div",{staticClass:"col-7"},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"recipe_fiscal_year",disabled:!e.header.can.edit||""==e.header.product_item_id},on:{change:function(t){}},model:{value:e.header.recipe_routing_no,callback:function(t){e.$set(e.header,"recipe_routing_no",t)},expression:"header.recipe_routing_no"}},e._l(e.data.recipe_routing_no_list,(function(t,e){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])],1),e._v(" "),n("div",{staticClass:"col-4 mb-2 mt-3"},[n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label required text-right"},[e._v("\n                                    Blend No.\n                                ")]),e._v(" "),n("div",{staticClass:"col-8"},[n("el-input",{attrs:{placeholder:"",disabled:!e.header.can.edit||""==e.header.tobacco_type_code||""==e.header.formula_type_code||e.header.has_tmp_table},on:{input:function(t){e.header.blend_no=t.toUpperCase()},change:function(t){e.getProductItem(),t&&e.changeTab(e.selTabName,e.selTabName,!1)}},model:{value:e.header.blend_no,callback:function(t){e.$set(e.header,"blend_no",t)},expression:"header.blend_no"}})],1)]),e._v(" "),n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[e._v("\n                                    รสชาติ\n                                ")]),e._v(" "),n("div",{staticClass:"col-8"},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"flavour_code",disabled:!e.header.can.edit,clearable:"",filterable:""},on:{change:function(t){return e.selectFlavour()}},model:{value:e.header.flavour_code,callback:function(t){e.$set(e.header,"flavour_code",t)},expression:"header.flavour_code"}},e._l(e.data.flavour_list,(function(t){return n("el-option",{key:String(t.value),attrs:{label:t.label,value:String(t.value)}})})),1)],1)]),e._v(" "),n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[e._v("\n                                    รายละเอียด\n                                ")]),e._v(" "),n("div",{staticClass:"col-8"},[n("el-input",{attrs:{type:"textarea",name:"note",disabled:!e.header.can.edit,rows:"4",maxlength:"240","show-word-limit":""},model:{value:e.header.description,callback:function(t){e.$set(e.header,"description",t)},expression:"header.description"}})],1)])]),e._v(" "),n("div",{staticClass:"col-4 mb-2 mt-3"},[n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[e._v("\n                                    รหัสยาเส้น\n                                ")]),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.product_item_id,expression:"loading.product_item_id"}],staticClass:"col-8"},[e.header.formula_id?n("el-input",{attrs:{disabled:!0},model:{value:e.header.product_item_code,callback:function(t){e.$set(e.header,"product_item_code",t)},expression:"header.product_item_code"}}):n("el-select",{staticClass:"required",staticStyle:{width:"100%"},attrs:{placeholder:"","value-key":"blend_no",disabled:!e.header.can.edit||""==e.header.blend_no,clearable:"",filterable:""},on:{change:function(e){t.sctProduct()}},model:{value:e.header.product_item_id,callback:function(t){e.$set(e.header,"product_item_id",t)},expression:"header.product_item_id"}},e._l(e.data.product_item_id_list,(function(t){return n("el-option",{key:t.value,attrs:{label:t.cust_label,value:t.value}},[n("span",{staticStyle:{float:"left"}},[e._v(e._s(t.cust_label))])])})),1)],1)]),e._v(" "),n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label text-right"},[e._v("\n                                    ปริมาณ\n                                ")]),e._v(" "),n("div",{staticClass:"col-8"},[n("div",{staticClass:"input-group "},[n("input",{staticClass:"form-control text-right ",attrs:{type:"text"},domProps:{value:e._f("number2Digit")(e.header.quantity)},on:{change:function(t){e.header.quantity=e.stripNonNumber(t.target.value),e.header.quantity<0&&(e.header.quantity=0)}}}),e._v(" "),n("div",{staticClass:"input-group-append",attrs:{title:e.header.uom}},[n("span",{staticClass:"input-group-addon"},[e._v("\n                                                "+e._s(e.uomDesc)+"\n                                            ")])])])])]),e._v(" "),n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label text-right"},[e._v("\n                                    หมายเหตุ\n                                ")]),e._v(" "),n("div",{staticClass:"col-8"},[n("el-input",{attrs:{type:"textarea",name:"note",disabled:!e.header.can.edit,rows:"4",maxlength:"240","show-word-limit":""},model:{value:e.header.comments,callback:function(t){e.$set(e.header,"comments",t)},expression:"header.comments"}})],1)])])])]),e._v(" "),n("div",{staticClass:"col-lg-3 mt-3"},[n("dl",{staticClass:"row mb-2"},[n("div",{staticClass:"col-sm-4 text-sm-right pt-2"},[n("dt",{attrs:{title:""}},[e._v("ผู้บันทึก: ")])]),e._v(" "),n("div",{staticClass:"col-sm-7 text-sm-left"},[n("dd",{staticClass:"mb-1"},[n("el-input",{attrs:{title:e.header.user_name,disabled:!0},model:{value:e.header.web_user_name,callback:function(t){e.$set(e.header,"web_user_name",t)},expression:"header.web_user_name"}})],1)])]),e._v(" "),n("dl",{staticClass:"row mb-2"},[n("div",{staticClass:"col-sm-4 text-sm-right pt-2"},[n("dt",{attrs:{title:""}},[e._v("วันที่สร้าง: ")])]),e._v(" "),n("div",{staticClass:"col-sm-7 text-sm-left"},[n("dd",{staticClass:"mb-1"},[n("el-input",{attrs:{disabled:!0},model:{value:e.header.formula_creation_date_format,callback:function(t){e.$set(e.header,"formula_creation_date_format",t)},expression:"header.formula_creation_date_format"}})],1)])]),e._v(" "),n("dl",{staticClass:"row mb-2"},[n("div",{staticClass:"col-sm-4 text-sm-right pt-2"},[n("dt",{attrs:{title:""}},[e._v("วันที่แก้ไขล่าสุด: ")])]),e._v(" "),n("div",{staticClass:"col-sm-7 text-sm-left"},[n("dd",{staticClass:"mb-1"},[n("el-input",{attrs:{disabled:!0},model:{value:e.header.formula_last_update_date_format,callback:function(t){e.$set(e.header,"formula_last_update_date_format",t)},expression:"header.formula_last_update_date_format"}})],1)])])])]),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-9"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-4 mb-2 mt-3"},[n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-5 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[e._v("\n                                    สถานะ\n                                ")]),e._v(" "),n("div",{staticClass:"col-7"},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",disabled:""==e.header.blend_no||""==e.header.product_item_id,"value-key":"formula_status"},on:{change:e.changeStatus},model:{value:e.header.formula_status,callback:function(t){e.$set(e.header,"formula_status",t)},expression:"header.formula_status"}},e._l(e.data.status_list,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1)])]),e._v(" "),n("div",{staticClass:"col-4 mb-2 mt-3"},[n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[e._v("\n                                    วันที่อนุมัติ\n                                ")]),e._v(" "),n("div",{staticClass:"col-8"},["ACTIVE"==e.header.formula_status.toUpperCase()?n("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{placeholder:"โปรดเลือกวันที่",disabled:!e.header.can.edit,value:e.header.formula_approval_date_format,format:e.transDate["js-format"]},on:{dateWasSelected:function(t){for(var a=arguments.length,n=Array(a);a--;)n[a]=arguments[a];return e.setdate.apply(void 0,n.concat(["formula_approval_date_format"]))}}}):n("el-input",{attrs:{disabled:!0}})],1)])]),e._v(" "),n("div",{staticClass:"col-4 mb-2 mt-3"},[n("div",{staticClass:"form-group mb-2 row"},[n("label",{staticClass:"col-4 pl-0 pr-0 font-weight-bold col-form-label  text-right"},[e._v("\n                                    วันที่เริ่มใช้\n                                ")]),e._v(" "),n("div",{staticClass:"col-8"},["ACTIVE"==e.header.formula_status.toUpperCase()?n("datepicker-th",{staticClass:"form-control md:tw-mb-0 tw-mb-2",staticStyle:{width:"100%"},attrs:{placeholder:"โปรดเลือกวันที่",disabled:!e.header.can.edit,value:e.header.formula_start_date_format,format:e.transDate["js-format"]},on:{dateWasSelected:function(t){for(var a=arguments.length,n=Array(a);a--;)n[a]=arguments[a];return e.setdate.apply(void 0,n.concat(["formula_start_date_format"]))}}}):n("el-input",{attrs:{disabled:!0}})],1)])])])]),e._v(" "),n("div",{staticClass:"col-lg-3 mt-3"},[e.header.can.is_standart_formula_type?n("dl",{staticClass:"row mb-2"},[n("div",{staticClass:"col-sm-4 text-sm-right pt-1"},[n("dt",{attrs:{title:""}},[e._v("กองบริหารต้นทุนนำไปใช้แล้ว: ")])]),e._v(" "),n("div",{staticClass:"col-sm-7 text-sm-left"},[n("dd",{staticClass:"mb-1 ",staticStyle:{"font-size":"1.5em"}},[n("div",{staticClass:"pt-2 pl-2",domProps:{innerHTML:e._s(e.header.invoice_flag_icon_html)}})])])]):e._e()])])])]),e._v(" "),n("transition",{attrs:{"enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeOutDown"}},[e.header.blend_no?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.page,expression:"loading.page"}],staticClass:"ibox float-e-margins"},[n("div",{staticClass:"ibox-content"},[n("div",{staticClass:"tabs-container"},[n("ul",{staticClass:"nav nav-tabs",attrs:{role:"tablist"}},[n("li",[n("a",{class:"tab1"==e.selTabName?"nav-link active":"nav-link",on:{click:function(t){return e.changeTab("tab1",e.selTabName)}}},[e._v("\n                            Leaf Formula\n                        ")])]),e._v(" "),n("li",[(e.header.formula_id,n("a",{class:"tab2"==e.selTabName?"nav-link active":"nav-link",on:{click:function(t){return e.changeTab("tab2",e.selTabName)}}},[e._v("\n                            Casing\n                        ")]))]),e._v(" "),n("li",[(e.header.formula_id,n("a",{class:"tab3"==e.selTabName?"nav-link active":"nav-link",on:{click:function(t){return e.changeTab("tab3",e.selTabName)}}},[e._v("\n                            Flavor\n                        ")]))]),e._v(" "),n("li",[(e.header.formula_id,n("a",{class:"tab4"==e.selTabName?"nav-link active":"nav-link",on:{click:function(t){return e.changeTab("tab4",e.selTabName)}}},[e._v("\n                            บุหรี่\n                        ")]))]),e._v(" "),n("li",[(e.header.formula_id,n("a",{class:"tab5"==e.selTabName?"nav-link active":"nav-link",on:{click:function(t){return e.changeTab("tab5",e.selTabName)}}},[e._v("\n                            ทั้งหมด\n                        ")]))])]),e._v(" "),n("div",{staticClass:"tab-content"},[n("div",{class:"tab1"==e.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tabs.leaf_formula_line.loading,expression:"tabs.leaf_formula_line.loading"}],staticClass:"panel-body pt-3 "},["tab1"==e.selTabName?n("tab-leaf-formula",{attrs:{header:e.header,url:e.url,transBtn:e.transBtn,transDate:e.transDate,data:e.data.tabs.leaf_formula_line,leafFormulas:e.leafFormulas,pRefresh:e.tabs.leaf_formula_line.refreshCount,tabs:e.tabs}}):e._e()],1)]),e._v(" "),n("div",{class:"tab2"==e.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tabs.casings.loading,expression:"tabs.casings.loading"}],staticClass:"panel-body pt-3"},["tab2"==e.selTabName&&(e.header.formula_id||e.header.blend_no)?n("casing",{attrs:{header:e.header,url:e.url,transBtn:e.transBtn,transDate:e.transDate,data:e.data.tabs.casings,casings:e.casings,tabs:e.tabs}}):e._e()],1)]),e._v(" "),n("div",{class:"tab3"==e.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tabs.flavors.loading,expression:"tabs.flavors.loading"}],staticClass:"panel-body pt-3"},["tab3"==e.selTabName&&e.header?n("flavor",{attrs:{header:e.header,url:e.url,transBtn:e.transBtn,transDate:e.transDate,data:e.data.tabs.flavors,flavors:e.flavors,tabs:e.tabs}}):e._e()],1)]),e._v(" "),n("div",{class:"tab4"==e.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tabs.cigarettes.loading,expression:"tabs.cigarettes.loading"}],staticClass:"panel-body pt-3"},["tab4"==e.selTabName&&e.header&&(e.header.formula_id||e.header.blend_no)?n("cigarette",{attrs:{header:e.header,url:e.url,transBtn:e.transBtn,transDate:e.transDate,data:e.data.tabs.cigarettes,cigarettes:e.cigarettes,cigarDtl:e.cigarDtl,tabs:e.tabs}}):e._e()],1)]),e._v(" "),n("div",{class:"tab5"==e.selTabName?"tab-pane active":"tab-pane",attrs:{role:"tabpanel"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tabs.cigarette_all.loading,expression:"tabs.cigarette_all.loading"}],staticClass:"panel-body pt-3"},["tab5"==e.selTabName&&e.header&&(e.header.formula_id||e.header.blend_no)?n("cigarette-all",{attrs:{transBtn:e.transBtn,transDate:e.transDate,cigaretteAll:e.cigaretteAll,tabs:e.tabs}}):e._e()],1)])])])])]):e._e()])],1)])}),[],!1,null,null,null).exports}}]);