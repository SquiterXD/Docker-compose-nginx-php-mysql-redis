<table class="table table-bordered">
    <thead>
        <tr>
            <th colspan="5" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: left; padding-left: 10px;"> 
                โปรแกรม : {{ $programCode }}
            </th>
            <th colspan="11" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: center;"> 
                การยาสูบแห่งประเทศไทย
            </th>
            <th colspan="3" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: right; padding-right: 10px;"> 
                วันที่ {{ $reportDate }}
            </th>
        </tr>
        <tr>
            <th colspan="5" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: left; padding-left: 10px;"> 
                
            </th>
            <th colspan="11" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: center;"> 
                <p style="font-size: 16px; font-weight: bold;"> รายงานผลการตรวจวัดอัตรารั่วของฟิล์มห่อซองบุหรี่ ( PP film ) โดยเครื่องมือวัด </p>
            </th>
            <th colspan="3" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: right; padding-right: 10px;"> 
                เวลา {{ $reportTime }}
            </th>
        </tr>
        <tr>
            <th colspan="5" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: left; padding-left: 10px;"> 
                หน่วยงาน : กองควบคุมคุณภาพผลิตภัณฑ์และวัตถุดิบ
            </th>
            <th colspan="11" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: center;"> 
                <p class="tw-mb-0" style="font-size: 14px; font-weight: bold;"> ประจำวันที่ {{ $sampleDateFrom }} ถึงวันที่ {{ $sampleDateTo }} </p>
            </th>
            <th colspan="3" style="height: 30px; border: 1px solid #ffffff; font-weight: bold; vertical-align: middle; text-align: right; padding-right: 10px;"> 
                หน้าที่ 1 / 1
            </th>
        </tr>
        <tr>
            <th rowspan="2" width="15" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> หมายเลขเครื่อง </th>
            <th rowspan="2" width="20" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ประเภทเครื่อง </th>
            <th rowspan="2" width="20" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> วันที่บันทึก </th>
            <th rowspan="2" width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> เวลา </th>
            <th rowspan="2" width="20" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ตราบุหรี่ </th>
            <th colspan="11" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ค่ามาตรฐาน ≤ 200 มล./นาที</th>
            <th rowspan="2" width="15" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ตำแหน่งที่รั่ว </th>
            <th rowspan="2" width="25" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> เลขที่การตรวจสอบ </th>
            <th rowspan="2" width="20" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> เขตตรวจคุณภาพ </th>
        </tr>
        <tr>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ซองที่ 1 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> P1 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ซองที่ 2 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> P2 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ซองที่ 3 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> P3 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ซองที่ 4 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> P4 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ซองที่ 5 </th>
            <th width="10" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> P5 </th>
            <th width="20" style="height: 30px; background-color: #F5F5F6; border: 1px solid #000000; font-weight: bold; vertical-align: middle; text-align: center;"> ค่าเฉลี่ย </th>
        </tr>
    </thead>
    <tbody>
            
        @foreach($reportItemByDates as $rdIndex => $reportItemByDate)

            @foreach($reportItemByDate->report_items as $index => $reportItem)
            
                <tr>
                    @if($reportItem->result_status == "FAILED")
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center; background-color: #fff0a0;"> {{ $reportItem->machine_set ? $reportItem->machine_set : "-" }} </td>
                    @else
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->machine_set ? $reportItem->machine_set : "-" }} </td>
                    @endif
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->machine_type_desc ? $reportItem->machine_type_desc : "-" }} </td>
                    
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->date_drawn_formatted ? $reportItem->date_drawn_formatted : "-" }} </td>

                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->time_drawn_formatted ? $reportItem->time_drawn_formatted : "-" }} </td>
                    
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->brand_desc ? $reportItem->brand_desc : "-" }} </td>
                    
                    @if($reportItem->status1 == "FAILED")
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center; background-color: #fff0a0;"> {{ $reportItem->leak1 !== null ? $reportItem->leak1 : "-" }} </td>
                    @else
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->leak1 !== null ? $reportItem->leak1 : "-" }} </td>
                    @endif
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->position1 ? $reportItem->position1 : "-" }} </td>
                    
                    @if($reportItem->status2 == "FAILED")
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center; background-color: #fff0a0;"> {{ $reportItem->leak2 ? $reportItem->leak2 : "-" }} </td>
                    @else
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->leak2 !== null ? $reportItem->leak2 : "-" }} </td>
                    @endif
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->position2 ? $reportItem->position2 : "-" }} </td>
                    
                    @if($reportItem->status3 == "FAILED")
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center; background-color: #fff0a0;"> {{ $reportItem->leak3 !== null ? $reportItem->leak3 : "-" }} </td>
                    @else
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->leak3 !== null ? $reportItem->leak3 : "-" }} </td>
                    @endif
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->position3 ? $reportItem->position3 : "-" }} </td>
                    
                    @if($reportItem->status4 == "FAILED")
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center; background-color: #fff0a0;"> {{ $reportItem->leak4 !== null ? $reportItem->leak4 : "-" }} </td>
                    @else
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->leak4 !== null ? $reportItem->leak4 : "-" }} </td>
                    @endif
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->position4 ? $reportItem->position4 : "-" }} </td>
                    
                    @if($reportItem->status5 == "FAILED")
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center; background-color: #fff0a0;"> {{ $reportItem->leak5 !== null ? $reportItem->leak5 : "-" }} </td>
                    @else
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->leak5 !== null ? $reportItem->leak5 : "-" }} </td>
                    @endif
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->position5 ? $reportItem->position5 : "-" }} </td>

                    @if($reportItem->status_average == "FAILED")
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center; background-color: #fff0a0;"> {{ $reportItem->average ? $reportItem->average : "-" }} </td>
                    @else
                        <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->average ? $reportItem->average : "-" }} </td>
                    @endif
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->position_leak_desc ? $reportItem->position_leak_desc : "-" }} </td>
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->sample_no ? $reportItem->sample_no : "-" }} </td>
                    <td style="height: 20px; border: 1px solid #000000; vertical-align: top; text-align: center;"> {{ $reportItem->qc_area }}</td>

                </tr>

            @endforeach
        
        @endforeach

    </tbody>
</table>